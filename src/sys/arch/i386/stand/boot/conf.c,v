head	1.23;
access;
symbols
	tg-mergetmp-mirosx-1:1.23
	tg-mergefixes-1-branch:1.23.0.8
	tg-mergefixes-1-base:1.23
	MIROS_X:1.23.0.6
	MIROS_X_BASE:1.23
	tg-mergetmp-3:1.23
	MIRBSD_XP_MIRPPC:1.23.0.4
	MIRBSD_XP_SPARC_BASE:1.23
	MIRBSD_XP_SPARC:1.23.0.2
	MIRBSD_7quater:1.11
	cvs-200405160640:1.1.1.8
	cvs-200401271800:1.1.1.7
	cvs-200401261630:1.1.1.7
	cvs-200401021645:1.1.1.7
	MIRBSD_7_ALPHA:1.11.0.6
	MIRBSD_7:1.11.0.4
	cvs-200312222040:1.1.1.7
	cvs-200312171912:1.1.1.7
	MIRBSD_7ter:1.11
	MIRBSD_7_DEV:1.11.0.2
	cvs-200310020700:1.1.1.6
	cvs-200309271030:1.1.1.6
	cvs-200309261655:1.1.1.6
	cvs-200309251530:1.1.1.6
	cvs-200309192030:1.1.1.6
	cvs-200309181930:1.1.1.5
	cvs-200309131952:1.1.1.4
	cvs-200308302005:1.1.1.3
	cvs-200308221505:1.1.1.3
	cvs-200308171200:1.1.1.3
	ctm-3496:1.1.1.3
	ctm-3449:1.1.1.3
	ctm-3437:1.1.1.3
	cvs-200307191805:1.1.1.3
	ctm-3425:1.1.1.3
	cvs-200307091500:1.1.1.3
	cvs-200307072125:1.1.1.3
	ctm-3389:1.1.1.3
	cvs-200307021520:1.1.1.3
	cvs-200306291430:1.1.1.3
	ctm-3341:1.1.1.3
	MIRBSD_5:1.6
	cvs-200306082100:1.1.1.3
	ctm-3316:1.1.1.3
	ctm-3272:1.1.1.2
	ctm-3264:1.1.1.2
	cvs-200305071630:1.1.1.2
	ctm-3255:1.1.1.2
	ctm-3229:1.1.1.2
	MIRBSD_4:1.2
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@ * @;


1.23
date	2004.08.02.17.56.40;	author tg;	state Stab;
branches;
next	1.22;

1.22
date	2004.05.23.20.15.40;	author tg;	state Exp;
branches;
next	1.21;

1.21
date	2003.12.17.20.42.33;	author tg;	state Exp;
branches;
next	1.20;

1.20
date	2003.12.01.18.49.38;	author tg;	state Exp;
branches;
next	1.19;

1.19
date	2003.11.14.23.37.25;	author tg;	state Exp;
branches;
next	1.18;

1.18
date	2003.11.14.22.23.33;	author tg;	state Exp;
branches;
next	1.17;

1.17
date	2003.11.14.20.49.43;	author tg;	state Exp;
branches;
next	1.16;

1.16
date	2003.11.09.12.54.22;	author tg;	state Exp;
branches;
next	1.15;

1.15
date	2003.10.31.21.07.52;	author tg;	state Exp;
branches;
next	1.14;

1.14
date	2003.10.31.15.46.49;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2003.10.30.17.49.14;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2003.10.30.13.18.44;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.09.19.20.44.03;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.09.18.19.42.26;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.09.13.20.17.59;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.08.16.15.25.40;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.06.22.12.40.40;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.07.13.55.40;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.05.21.35.53;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.05.20.35.31;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.22.14.08.24;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.23.21.52.17;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.49.37;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.49.37;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.04.24.09.05.38;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.06.05.17.34.27;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.09.13.19.55.23;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.09.18.19.33.58;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.09.19.20.36.40;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2003.12.17.19.13.19;	author tg;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2004.05.16.08.43.04;	author tg;	state Exp;
branches;
next	;


desc
@@


1.23
log
@I'm sick that every piece of code has got to have its own version
number - just use the MirOS patchlevel for the bootloader.

Also, rename /usr/mdec/pbr_ffs to ffspbr for a better tabcomplete,
now that we've got the pxeboot
@
text
@/* $MirBSD: src/sys/arch/i386/stand/boot/conf.c,v 1.22 2004/05/23 20:15:40 tg Exp $	*/
/* $OpenBSD: conf.c,v 1.28 2004/03/19 13:48:19 tom Exp $	*/

/*
 * Copyright (c) 1996 Michael Shalayeff
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 */

#include <sys/types.h>
#include <netinet/in.h>
#include <libsa.h>
#include <lib/libsa/ufs.h>
#include <lib/libsa/cd9660.h>
#include <tori.h>
#ifdef notdef
#include <lib/libsa/fat.h>
#include <lib/libsa/nfs.h>
#include <lib/libsa/tftp.h>
#include <lib/libsa/netif.h>
#endif
#include <lib/libsa/unixdev.h>
#include <biosdev.h>
#include <dev/cons.h>
#include "debug.h"

const char version[] = __BOOT_VER;
int	debug = 1;


void (*sa_cleanup)(void) = NULL;


void (*i386_probe1[])(void) = {
	ps2probe, gateA20on, debug_init, cninit,
	apmprobe, pciprobe, /* smpprobe, */ memprobe
};
void (*i386_probe2[])(void) = {
 	diskprobe
};

struct i386_boot_probes probe_list[] = {
	{ "probing", i386_probe1, NENTS(i386_probe1) },
	{ "disk",    i386_probe2, NENTS(i386_probe2) }
};
int nibprobes = NENTS(probe_list);


struct fs_ops file_system[] = {
	{ cd9660_open, cd9660_close, cd9660_read, cd9660_write, cd9660_seek,
	  cd9660_stat, cd9660_readdir },
	{ ufs_open,    ufs_close,    ufs_read,    ufs_write,    ufs_seek,
	  ufs_stat,    ufs_readdir    },
#ifdef notdef
	{ fat_open,    fat_close,    fat_read,    fat_write,    fat_seek,
	  fat_stat,    fat_readdir    },
	{ nfs_open,    nfs_close,    nfs_read,    nfs_write,    nfs_seek,
	  nfs_stat,    nfs_readdir    },
#endif
#ifdef _TEST
	{ null_open,   null_close,   null_read,   null_write,   null_seek,
	  null_stat,   null_readdir   }
#endif
};
int nfsys = NENTS(file_system);

struct devsw	devsw[] = {
#ifdef _TEST
	{ "UNIX", unixstrategy, unixopen, unixclose, unixioctl },
#else
	{ "TORI", toristrategy, toriopen, toriclose, toriioctl },
	{ "BIOS", biosstrategy, biosopen, biosclose, biosioctl },
#endif
#if 0
	{ "TFTP", tftpstrategy, tftpopen, tftpclose, tftpioctl },
#endif
};
int ndevs = NENTS(devsw);

#ifdef notdef
struct netif_driver	*netif_drivers[] = {
	NULL
};
int n_netif_drivers = NENTS(netif_drivers);
#endif

struct consdev constab[] = {
#ifdef _TEST
	{ unix_probe, unix_init, unix_getc, unix_putc },
#else
	{ pc_probe, pc_init, pc_getc, pc_putc },
	{ com_probe, com_init, com_getc, com_putc },
#endif
	{ NULL }
};
struct consdev *cn_tab = constab;
@


1.22
log
@* first futile attempt to merge OpenBSD 3.5-current
* damn! they got pxeboot! -> disable for now
  (there's still ports/sysutils/pxegrub; we'll have pxeboot later)
* I don't know if that ... bootloader still works
* nuke netbsd emul (was unused anyways)
* nuke a plethora of syscalls not being used, and mark
  the other two (COMPAT_35) for deletion RSN
* merge new MI-GENERIC into i386 GENERIC
* resolve numeric conflicts for
  - syscalls
  - sysctls
  - device majors
  - pcidevs
* (c) cleanup - no need to add a bsd-like licence when
  there's already one; just add my name
* and much more
@
text
@d1 2
a2 2
/*	$MirBSD: src/sys/arch/i386/stand/boot/conf.c,v 1.21 2003/12/17 20:42:33 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.28 2004/03/19 13:48:19 tom Exp $	*/
@


1.21
log
@merge OpenBSD
@
text
@d1 2
a2 2
/*	$MirBSD: conf.c,v 1.20 2003/12/01 18:49:38 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.27 2003/10/23 18:33:45 fgsch Exp $	*/
d46 1
d50 19
@


1.20
log
@The boot loader seems to have been broken since the MirOS #7 releases.
Apologies to Jannis Konrad for blaming on his (nevertheless
totally broken) hardware. Thanks to Bill Gates and his company
for writing DEBUG.COM which allowed me to get into my system
again, since it apparently can't boot our /boot from CD-ROM
(this is still not fixed, but it's fine in bochs, and my box
 doesn't even get as far as the Lsrt0 message,
	MirOS boot(8) 2.54 srt0 initializing
 when booting from CD, so it must be broke too).

While here, rewrite several chunks of the code, and extend the
size of the argv[] array for boot commands to make echo work.

Tested:
 bochs CD passed
 mybox CD failed
 mybox HD passed
 mybox MS-DOS passed
@
text
@d1 2
a2 2
/*	$MirBSD: conf.c,v 1.19 2003/11/14 23:37:25 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.26 2003/09/19 05:25:12 fgsch Exp $	*/
d47 1
a47 1
const char version[] = "[" __BOOT_VER "]";
@


1.19
log
@yay. I am your god. (Or root. What is difference?)

Tested:
 * boot cd0, kernel cd0:gzip'd
 * boot cd0, kernel cd0:stripped
 * boot cd0, kernel cd0:stripped and gzip'd
 * boot cd0, kernel fd1:floppyM34.fs
 * boot fd0, kernel fd1:floppyM34.fs
 * boot hd0, kernel fd1:floppyM34.fs
 * boot cd0, kernel hd0:floppyM34.fs
 * boot hd0, kernel hd0:floppyM34.fs

All tests have been passed in bochs, except the one below.
No tests at all have been performed on real hardware.

Tested and failed:
 * boot cd0, kernel cd0:plain bsd.rd

NM: fixed some minor bits in files touched, too
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.18 2003/11/14 22:23:33 tg Exp $	*/
d47 1
a47 1
const char version[] = "[" __BOOT_VER "] for ISO9660 and FFS";
@


1.18
log
@bump version number and shrink displaying layout a bit
we're almost there: it can boot a kernel from CD and floppy,
although it only succeeded for bsd.gz (ramdiskM) and bsd.rd.gz (ramdisk_cd)
plus, it only handles 8.3 filenames

while here: don't come back into timeout mode if cmd boot fails

status:
 * boots fd1a:/bsd if loaded from fd0
 * boots fd1a:/bsd if loaded from cd0
 * boots cd0a:/bsd.gz if loaded from cd0
 * boots cd0a:/bsd.str if loaded from cd0 (XXX bsd.strip)
 * boots cd0a:/bsdrd.gz if loaded from cd0
 * loads cd0a:/bsd.rd if loaded from cd0; segfault in rdsize()
   before root is mounted [wtf? XXX]
 * you still need to burn boot.bin
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.17 2003/11/14 20:49:43 tg Exp $	*/
d47 1
a47 1
const char version[] = "Release " __BOOT_VER ", for ISO9660 and FFS";
@


1.17
log
@switch to boot-new, which shares a common srt0 between CD and BIOS
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.16 2003/11/09 12:54:22 tg Exp $	*/
d47 1
a47 1
const char version[] = "[" __BOOT_VER "] for the ISO9660 and FFS filesystem";
a48 1

@


1.16
log
@Mostly... not fully...

One weekend's worth of work.

- catch up website log with changes really done till today
- add catch-up entries for wbx@@ and bsiegert@@, too
- move GNU documentation to src/gnu/doc and simplify it
- re-run autoconf on the gnu part of the tree again, to
  catch up with the GFDL-documentation removal
- provide non-GFDL-licenced as(1) and ld(1) manual pages
  XXX these are more than outdated!
- bump MirOS patchlevel
- build the system through, fixing showstoppers where
  they are encountered
- index.cgi and index.php come before index.htm,
  default.htm and index.html in httpd.conf
- speed up PHP processing
- prepare for "new" OpenBSD pkgtools (unsupported by MirBSD,
  but some MirPorts people want to play with them)
- move old weblog to CMS; update my info again
- update hRef""s in old weblogs
- move release announcements to /historic/
- copy feature list from last release announcement
  XXX need a "readible short list", or even
  XXX	a separation for the target environment
  XXX	(e.g. suits / techies / clients)
- add some recent news, so the page ain't empty
  missing:
	- about
	  + MirOS
	  + MirPorts
	- get MirOS!	(http d/l, http install, install docs)
	- relations	(to other BSD)
	  + ??? events ??? (here?)
	- history
	- older releases	(historic)
	- help pages
	  + FAQ
	  + Docs/Tuts	(hi wbx@@ here comes your place)
	    + install docs
	  + mailing lists
	- developers
	  + wbx
	  + bsiegert
	  + cnuke
	- CVSweb	(XXX need BSDadvocacy.org fix before)
	- AnonCVS	(howto; link to)
	- Links
  alternatively, change the layout? suggestions?
  why am I the only one who cares about www?
- merge development plan
- put a "project" into the miros page head
- fix cdboot Makefile
- fix gas wanting us a.out again (wut?)
  (turned out to be a must-fix in configure.in)
- stand/cdboot/NOTES merged into stand/README
- sync distrib set lists
- have TORI device (i386 libsa) always use bounce buffers
  (which, in fact, makes it succeed in loading the kernel)
  XXX kernel says it has less than 4 meg ram (degraded mode)
  XXX may be a bochs issue?
- fix random.S again
- move determining of file name / raw file flag in both
  bios/toridev.c to the end of bios/toriopen()
  => enables us to have two drivers at once
- fix disk probing for CD devices wrt BIOS driver

(eww. The tree isn't fully broken, but neither boot
 nor cdboot.bin are usable at all at the moment.
 I'll fix that ASAP.)
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.15 2003/10/31 21:07:52 tg Exp $	*/
a34 1
//#ifdef	CDBOOT
a36 1
//#endif
d47 1
a47 5
#ifdef	CDBOOT
const char version[] = "[" __BOOT_VER "] for the ISO9660 filesystem";
#else
const char version[] = "[" __BOOT_VER "] for the FFS filesystem";
#endif
a51 1
//#ifdef	CDBOOT
a53 1
//#endif
a72 1
//#ifdef	CDBOOT
a73 1
//#endif
@


1.15
log
@I've come so far that it at least boots /boot (in bochs)
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.14 2003/10/31 15:46:49 tg Exp $	*/
d35 1
a35 1
#ifdef	CDBOOT
d38 1
a38 1
#endif
d58 1
a58 1
#ifdef	CDBOOT
d61 1
a61 1
#endif
d81 1
a81 1
#ifdef	CDBOOT
d83 1
a83 1
#endif
@


1.14
log
@apparently we need a disktype TORI, which emulates BIOS
but with 2048 bytes sector size and using only the LBA
commands.
I think, re-implementing most of the asm stuff is easier
than just copying the BIOS code, but for the rest I'll
copy or even include.
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.13 2003/10/30 17:49:14 tg Exp $	*/
d37 1
@


1.13
log
@I see no reason why CDBOOT should not be able to read ffs
(e.g. from a floppy) too?
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.12 2003/10/30 13:18:44 tg Exp $	*/
d80 3
@


1.12
log
@* add (experimental, untested) cdboot programme
* fix swapped thinko, which led to mbr being installed as
  ELF binary, and pbr installed RAW (must be the reverse)
* move version number declare to stand/Makefile.inc
  and bump to 2.30
* mention CDBOOT in boot(8)
* whitespace, etc. cleanup while here
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.11 2003/09/19 20:44:03 tg Exp $	*/
a33 1
#ifndef	CDBOOT
d35 1
a35 1
#else
d60 1
a60 1
#else
a62 1
#endif
@


1.11
log
@sync boot code with latest OpenBSD and bump minor
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.10 2003/09/18 19:42:26 tg Exp $	*/
d34 1
d36 3
a39 1
#include <lib/libsa/cd9660.h>
d49 5
a53 1
const char version[] = "2.22";
d58 4
d64 1
a69 2
	{ cd9660_open, cd9660_close, cd9660_read, cd9660_write, cd9660_seek,
	  cd9660_stat, cd9660_readdir },
@


1.10
log
@screw up bootcode again (neccessarily...)
@
text
@d1 2
a2 2
/*	$MirBSD: conf.c,v 1.9 2003/09/13 20:17:59 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.25 2003/09/18 08:24:10 fgsch Exp $	*/
d46 1
a46 1
const char version[] = "2.21";
@


1.9
log
@bump version
@
text
@d1 2
a2 2
/*	$MirBSD: conf.c,v 1.8 2003/08/16 15:25:40 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.24 2003/09/11 17:39:33 deraadt Exp $	*/
d46 1
a46 1
const char version[] = "2.20";
@


1.8
log
@Merge OpenBSD
@
text
@d1 2
a2 2
/*	$MirBSD: conf.c,v 1.7 2003/06/22 12:40:40 tg Exp $	*/
/*	$OpenBSD: conf.c,v 1.23 2003/06/03 20:22:11 mickey Exp $	*/
d17 2
a18 2
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR 
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
d46 1
a46 1
const char version[] = "2.17";
a96 1

@


1.7
log
@bump minor
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.6 2003/06/07 13:55:40 tg Exp $	*/
d46 1
a46 1
const char version[] = "2.16";
@


1.6
log
@bump minor for the MirBSD boot loader to ship with MirBSD#5
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.5 2003/06/05 21:35:53 tg Exp $	*/
d46 1
a46 1
const char version[] = "2.15";
@


1.5
log
@bump minor, we get full autoLBA capability
(i.e. IT WORKS!!!)
@
text
@d1 1
a1 1
/*	$MirBSD: conf.c,v 1.4 2003/06/05 20:35:31 tg Exp $	*/
d46 1
a46 1
const char version[] = "2.12";
@


1.4
log
@merge cvs import conflicts in i386-stand
so I can continue bootloader work
@
text
@d1 1
a1 1
/*	$MirBSD$	*/
d46 1
a46 1
const char version[] = "2.11";
@


1.3
log
@merge CVS import stuff
@
text
@d1 2
a2 1
/*	$OpenBSD: conf.c,v 1.20 2003/04/17 03:43:18 drahn Exp $	*/
a15 5
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by Michael Shalayeff.
 * 4. The name of the author may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
a44 1
#include <lib/libsa/exec.h>
d46 1
a46 1
const char version[] = "2.10";
@


1.2
log
@Merge MirBSD-old entirely
Remove krb, yp, afs, GPL'd stuff in kernel
Adjust some other stuff

Not to be compiled yet...
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.19 2002/06/21 21:02:57 weingart Exp $	*/
a4 1
 * Copyright (c) 2002 by Thorsten "mirabile" Glaser <x86@@ePost.de>
d21 1
a21 1
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR 
d51 1
a51 1
const char version[] = "2.00m";
a53 7
#if 0
const struct x_sw execsw[] = {
	{ "aout", aout_probe, aout_load, aout_ldsym },
	{ "elf", elf_probe, elf_load, elf_ldsym },
	{ "",     NULL,       NULL,      NULL       },
};
#endif
d102 1
@


1.1
log
@Initial revision
@
text
@d5 1
d22 1
a22 1
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR 
d52 1
a52 1
const char version[] = "1.29";
d55 1
d58 1
d61 1
a109 1

@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import some parts of OpenBSD-current (after their ELF switch) to ease future merging and reduce diffs against their codebase
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.20 2003/04/17 03:43:18 drahn Exp $	*/
d51 1
a51 1
const char version[] = "2.00";
d54 4
@


1.1.1.3
log
@Import latest OpenBSD CVS tree by CTM in order
to sync the base system and ports tree with Them.

This includes the recent licence changes as well - by
importing the changed base and re-applying the diffs
(with cvs up -j -j) they are inherited, and we're not
bound to the removed clauses any longer.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.23 2003/06/03 20:22:11 mickey Exp $	*/
d15 5
d49 1
d51 1
a51 1
const char version[] = "2.01";
@


1.1.1.4
log
@Import the last "new" OpenBSD boot loader code
reason: we've got to bump version number anyways...
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.24 2003/09/11 17:39:33 deraadt Exp $	*/
d45 1
a45 1
const char version[] = "2.02";
@


1.1.1.5
log
@Whoops, they did it again... boot system changes
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.25 2003/09/18 08:24:10 fgsch Exp $	*/
d45 1
a45 1
const char version[] = "2.03";
@


1.1.1.6
log
@live import from NetzLaden.org: boot code from OpenBSD, again.
Rationale: test with broken BIOS (I've access to one here), and release.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.26 2003/09/19 05:25:12 fgsch Exp $	*/
d45 1
a45 1
const char version[] = "2.04";
@


1.1.1.7
log
@some OpenBSD boot code sync (so I don't have to do it later)
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.27 2003/10/23 18:33:45 fgsch Exp $	*/
d45 1
a45 1
const char version[] = "2.05";
@


1.1.1.8
log
@large-scale import of OpenBSD 3.5-current source base including many fixes
note: from now, we will not be binary compatible with OpenBSD apps any
longer (due to syscall numbering differences); both an OpenBSD compat and
a conversion tool for old MirOS #7 apps will be delivered later.

The src/ tree is locked from now.
@
text
@d1 1
a1 1
/*	$OpenBSD: conf.c,v 1.28 2004/03/19 13:48:19 tom Exp $	*/
a43 1
#include "debug.h"
d45 1
a45 1
const char version[] = "2.06";
a48 18
void (*sa_cleanup)(void) = NULL;


void (*i386_probe1[])(void) = {
	ps2probe, gateA20on, debug_init, cninit,
	apmprobe, pciprobe, /* smpprobe, */ memprobe
};
void (*i386_probe2[])(void) = {
 	diskprobe
};

struct i386_boot_probes probe_list[] = {
	{ "probing", i386_probe1, NENTS(i386_probe1) },
	{ "disk",    i386_probe2, NENTS(i386_probe2) }
};
int nibprobes = NENTS(probe_list);


d96 1
@


