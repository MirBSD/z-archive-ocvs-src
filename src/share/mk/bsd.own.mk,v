head	1.66;
access;
symbols
	tg-mergetmp-mirosx-1:1.66.2.4
	tg-mergefixes-1-branch:1.66.0.4
	tg-mergefixes-1-base:1.66
	MIROS_X:1.66.0.2
	MIROS_X_BASE:1.66
	tg-mergetmp-3:1.66
	MIRBSD_XP_MIRPPC:1.62.0.4
	MIRBSD_XP_SPARC_BASE:1.62
	MIRBSD_XP_SPARC:1.62.0.2
	cvs-200406230955:1.1.1.10
	MIRBSD_7quater:1.15.2.1
	cvs-200405160640:1.1.1.9
	cvs-200401271800:1.1.1.8
	cvs-200401261630:1.1.1.8
	cvs-200401021645:1.1.1.8
	MIRBSD_7_ALPHA:1.15.2.1.0.4
	MIRBSD_7:1.15.2.1.0.2
	cvs-200312222040:1.1.1.7
	MIRBSD_7ter:1.15.2.1
	MIRBSD_7_DEV:1.15.0.2
	cvs-200310020700:1.1.1.7
	cvs-200309271030:1.1.1.7
	cvs-200309251530:1.1.1.7
	cvs-200308302005:1.1.1.6
	cvs-200308221505:1.1.1.6
	cvs-200308171200:1.1.1.5
	ctm-3496:1.1.1.5
	ctm-3449:1.1.1.5
	ctm-3437:1.1.1.4
	cvs-200307191805:1.1.1.4
	ctm-3425:1.1.1.4
	cvs-200307091500:1.1.1.4
	cvs-200307072125:1.1.1.3
	ctm-3389:1.1.1.3
	cvs-200306291430:1.1.1.3
	ctm-3341:1.1.1.3
	MIRBSD_5:1.6
	cvs-200306082100:1.1.1.3
	ctm-3316:1.1.1.3
	ctm-3272:1.1.1.3
	ctm-3264:1.1.1.2
	cvs-200305071630:1.1.1.2
	MIRBSD_4:1.3
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.66
date	2004.11.30.17.05.20;	author tg;	state Exp;
branches
	1.66.2.1
	1.66.4.1;
next	1.65;

1.65
date	2004.11.30.16.47.44;	author tg;	state Exp;
branches;
next	1.64;

1.64
date	2004.11.27.19.53.00;	author tg;	state Exp;
branches;
next	1.63;

1.63
date	2004.10.22.19.26.36;	author tg;	state Exp;
branches;
next	1.62;

1.62
date	2004.09.27.17.11.13;	author tg;	state Exp;
branches;
next	1.61;

1.61
date	2004.09.18.12.36.39;	author tg;	state Exp;
branches;
next	1.60;

1.60
date	2004.09.17.20.16.42;	author tg;	state Exp;
branches;
next	1.59;

1.59
date	2004.09.13.21.23.38;	author tg;	state Exp;
branches;
next	1.58;

1.58
date	2004.09.07.15.24.01;	author tg;	state Exp;
branches;
next	1.57;

1.57
date	2004.08.23.16.35.21;	author tg;	state Stab;
branches;
next	1.56;

1.56
date	2004.08.22.03.23.06;	author tg;	state Exp;
branches;
next	1.55;

1.55
date	2004.08.14.00.01.51;	author tg;	state Exp;
branches;
next	1.54;

1.54
date	2004.08.13.04.52.48;	author tg;	state Exp;
branches;
next	1.53;

1.53
date	2004.08.11.23.19.24;	author tg;	state Exp;
branches;
next	1.52;

1.52
date	2004.08.09.19.53.46;	author tg;	state Exp;
branches;
next	1.51;

1.51
date	2004.08.09.18.36.54;	author tg;	state Exp;
branches;
next	1.50;

1.50
date	2004.08.08.16.02.12;	author tg;	state Exp;
branches;
next	1.49;

1.49
date	2004.08.05.13.09.57;	author tg;	state Exp;
branches;
next	1.48;

1.48
date	2004.07.18.13.39.09;	author tg;	state Exp;
branches;
next	1.47;

1.47
date	2004.07.15.19.48.48;	author tg;	state Exp;
branches;
next	1.46;

1.46
date	2004.07.15.15.39.21;	author tg;	state Exp;
branches;
next	1.45;

1.45
date	2004.07.02.20.21.34;	author tg;	state Exp;
branches;
next	1.44;

1.44
date	2004.06.29.15.49.47;	author tg;	state Exp;
branches;
next	1.43;

1.43
date	2004.06.25.08.25.06;	author tg;	state Exp;
branches;
next	1.42;

1.42
date	2004.06.23.16.58.41;	author tg;	state Exp;
branches;
next	1.41;

1.41
date	2004.06.23.10.14.54;	author tg;	state Exp;
branches;
next	1.40;

1.40
date	2004.06.23.10.05.20;	author tg;	state Exp;
branches;
next	1.39;

1.39
date	2004.06.20.02.56.50;	author tg;	state Exp;
branches;
next	1.38;

1.38
date	2004.06.19.20.28.30;	author tg;	state Exp;
branches;
next	1.37;

1.37
date	2004.06.15.19.59.08;	author tg;	state Exp;
branches;
next	1.36;

1.36
date	2004.06.15.14.19.35;	author tg;	state Exp;
branches;
next	1.35;

1.35
date	2004.06.14.00.25.49;	author tg;	state Exp;
branches;
next	1.34;

1.34
date	2004.06.13.17.42.10;	author tg;	state Exp;
branches;
next	1.33;

1.33
date	2004.06.11.15.54.13;	author tg;	state Exp;
branches;
next	1.32;

1.32
date	2004.06.09.15.33.37;	author tg;	state Exp;
branches;
next	1.31;

1.31
date	2004.06.04.17.55.09;	author tg;	state Exp;
branches;
next	1.30;

1.30
date	2004.05.23.15.57.42;	author tg;	state Exp;
branches;
next	1.29;

1.29
date	2004.05.02.14.32.44;	author tg;	state Exp;
branches;
next	1.28;

1.28
date	2004.05.02.14.28.34;	author tg;	state Exp;
branches;
next	1.27;

1.27
date	2004.03.09.21.10.50;	author tg;	state Exp;
branches;
next	1.26;

1.26
date	2004.03.07.18.01.42;	author tg;	state Exp;
branches;
next	1.25;

1.25
date	2004.03.02.10.32.14;	author tg;	state Exp;
branches;
next	1.24;

1.24
date	2004.03.02.09.18.45;	author tg;	state Exp;
branches;
next	1.23;

1.23
date	2004.02.29.01.19.48;	author tg;	state Exp;
branches;
next	1.22;

1.22
date	2004.02.08.19.49.17;	author tg;	state Exp;
branches;
next	1.21;

1.21
date	2004.01.29.21.32.59;	author tg;	state Exp;
branches;
next	1.20;

1.20
date	2004.01.18.15.23.18;	author tg;	state Exp;
branches;
next	1.19;

1.19
date	2004.01.03.02.27.44;	author tg;	state Exp;
branches;
next	1.18;

1.18
date	2003.12.17.18.55.18;	author tg;	state Exp;
branches;
next	1.17;

1.17
date	2003.11.09.12.54.14;	author tg;	state Exp;
branches;
next	1.16;

1.16
date	2003.10.26.22.32.15;	author tg;	state Exp;
branches;
next	1.15;

1.15
date	2003.09.25.20.59.59;	author tg;	state Exp;
branches
	1.15.2.1;
next	1.14;

1.14
date	2003.09.03.12.56.53;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2003.08.31.20.54.47;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2003.07.26.16.08.06;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.07.09.19.03.08;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.07.08.14.20.36;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.07.06.01.00.16;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.06.00.59.06;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.07.05.22.26.13;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.22.14.08.20;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.05.13.18.36.14;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.05.07.20.54.21;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.03.29.22.25.02;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.23.21.52.11;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.49.10;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.49.10;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.05.07.17.45.14;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.05.21.19.04.14;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.07.09.16.41.44;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.07.26.13.16.08;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.08.22.15.31.21;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2003.09.25.16.34.10;	author tg;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2004.01.02.18.03.16;	author tg;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2004.05.16.08.35.00;	author tg;	state Exp;
branches;
next	1.1.1.10;

1.1.1.10
date	2004.06.23.09.58.47;	author tg;	state Exp;
branches;
next	;

1.15.2.1
date	2003.10.23.22.02.42;	author tg;	state Exp;
branches;
next	;

1.66.2.1
date	2004.12.27.23.43.40;	author tg;	state Exp;
branches;
next	1.66.2.2;

1.66.2.2
date	2004.12.28.11.18.19;	author tg;	state Exp;
branches;
next	1.66.2.3;

1.66.2.3
date	2004.12.28.11.33.49;	author tg;	state Exp;
branches;
next	1.66.2.4;

1.66.2.4
date	2004.12.28.15.18.48;	author tg;	state Exp;
branches;
next	;

1.66.4.1
date	2004.12.28.18.42.16;	author tg;	state Exp;
branches;
next	;


desc
@@


1.66
log
@optimise by giving default values for ${NO*}
and nuking the defined(NO*) checks
@
text
@# $MirBSD: src/share/mk/bsd.own.mk,v 1.65 2004/11/30 16:47:44 tg Exp $
# $OpenBSD: bsd.own.mk,v 1.88 2004/09/06 06:38:02 deraadt Exp $
# $NetBSD: bsd.own.mk,v 1.24 1996/04/13 02:08:09 thorpej Exp $
#-
# Copyright (c) 2002, 2003, 2004
#	Thorsten "mirabile" Glaser <tg@@66h.42h.de>
#
# Licensee is hereby permitted to deal in this work without restric-
# tion, including unlimited rights to use, publically perform, modi-
# fy, merge, distribute, sell, give away or sublicence, provided the
# above copyright notices, these terms and the disclaimer are retai-
# ned in all redistributions, or reproduced in accompanying documen-
# tation or other materials provided with binary redistributions.
#
# Licensor hereby provides this work "AS IS" and WITHOUT WARRANTY of
# any kind, expressed or implied, to the maximum extent permitted by
# applicable law, but with the warranty of being written without ma-
# licious intent or gross negligence; in no event shall licensor, an
# author or contributor be held liable for any damage, direct, indi-
# rect or other, however caused, arising in any way out of the usage
# of covered work, even if advised of the possibility of such damage.
#-
# Sort of central configuration Makefile include (someone has a bet-
# ter description as to which purpose this file has?).

.ifndef	BSD_OWN_MK

# Host-specific overrides
.if defined(MAKECONF) && exists(${MAKECONF})
.  include "${MAKECONF}"
.elif exists(/etc/mk.conf)
.  include "/etc/mk.conf"
.endif


# Calculate machine capabilities
.ifndef	MACHINE
# uh oh. trouble.
DEFFLAGS=	No
.elif ${MACHINE} == "i386"
HAS_GCC3=	Yes
.else
DEFFLAGS=	No
.endif


CROSS_MODE?=	No
.if ${CROSS_MODE:L} == "yes"
DEFFLAGS=	No
HOSTCC=		gcc
.endif	# CROSS_MODE

# Automatic CC/COPTS assignment system
DEFFLAGS?=	Yes

.if ${DEFFLAGS:L} != "no"

CC=		gcc
COPTS?=		${DEFCOPTS} ${GCEXTRA}
HOSTCC=		${CC}

.endif	# DEFFLAGS

# crtbegin.o/crtend.o from gcc3 (yes) or src/lib/csu (no)?
GCC3_EXT_TOOLCHAIN?=	Yes
# Set 'WARNINGS' to 'yes' to add appropriate warnings to each compilation
WARNINGS?=		No
# Set 'SKEY' to 'yes' to build with support for S/key authentication.
SKEY?=			Yes
# Set 'TCP_WRAPPERS' to 'yes' to build certain networking daemons with
# integrated support for libwrap.
TCP_WRAPPERS?=		No
# Set 'DEBUGLIBS' to 'yes' to build libraries with debugging symbols
DEBUGLIBS?=		No
# Ignore USA-only patents for build (by default, build it, MirOS is EU not US)
MKC_USAP?=		No
# Set 'SUDO' to 'sudo' to build releases, packages etc. as user
SUDO?=
# where the system object and source trees are kept; can be configurable
# by the user in case they want them in ~/foosrc and ~/fooobj, for example
BSDSRCDIR?=		/usr/src
BSDOBJDIR?=		/usr/obj
PORTSDIR?=		/usr/ports
# Shared files for system gnu configure
GNUSYSTEM_AUX_DIR?=	${BSDSRCDIR}/gnu/share


BINGRP?=	bin
BINOWN?=	root
BINMODE?=	555
NONBINMODE?=	444
DIRMODE?=	755

SHAREDIR?=	/usr/share
SHAREGRP?=	bin
SHAREOWN?=	root
SHAREMODE?=	${NONBINMODE}

MANDIR?=	/usr/share/man/cat
MANGRP?=	bin
MANOWN?=	root
MANMODE?=	${NONBINMODE}

LIBDIR?=	/usr/lib
LINTLIBDIR?=	/usr/libdata/lint
LIBGRP?=	${BINGRP}
LIBOWN?=	${BINOWN}
LIBMODE?=	${NONBINMODE}

DOCDIR?=	/usr/share/doc
DOCGRP?=	bin
DOCOWN?=	root
DOCMODE?=	${NONBINMODE}

LKMDIR?=	/usr/lkm
LKMGRP?=	${BINGRP}
LKMOWN?=	${BINOWN}
LKMMODE?=	${NONBINMODE}

INSTALL_COPY?=	-c
.ifndef	DEBUG
INSTALL_STRIP?=	-s
.else
INSTALL_STRIP?=
.endif

# This may be changed for _single filesystem_ configurations (such as
# routers and other embedded systems); normal systems should leave it alone!
STATIC?=	-static

# Define SYS_INCLUDE to indicate whether you want symbolic links to the system
# source (''symlinks''), or a separate copy (''copies''); (latter useful
# in environments where it's not possible to keep /sys publicly readable)
SYS_INCLUDE?=	copies

# don't try to generate PIC versions of libraries on machines
# which don't support PIC.
#.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "m88k")
#NOPIC=		yes
#.endif

NOLINT?=	yes
NOMAN?=		no
NOOBJ?=		no
NOPIC?=		no

LDFLAGS?=
.if ${NOPIC:L} != "no" && !${LDFLAGS:M-static}
LDFLAGS+=	${STATIC}
.endif

# MirOS is always ELF for now, although the possible choices
# are: ELF a.out COFF Mach-O PE (consistent with nbsd)
OBJECT_FMT=	ELF

# PIC relocation flags.
#.if ${MACHINE_ARCH} == "sparc64"
#PICFLAG=	-fPIC
#.else
PICFLAG=	-fpic
#.  if ${MACHINE_ARCH} == "m68k"
# Function CSE makes gas -k not recognize external function calls as lazily
# resolvable symbols, thus sometimes making ld.so report undefined symbol
# errors on symbols found in shared library members that would never be
# called.  Ask niklas@@openbsd.org for details.
#PICFLAG+=-fno-function-cse
#.  endif
#.endif

#.if (${MACHINE_ARCH} == "sparc64") || (${MACHINE_ARCH} == "sparc")
#ASPICFLAG=	-KPIC
#.elif ${OBJECT_FMT:L} == "aout"
#ASPICFLAG=	-k
#.endif

# XXX fixme
PIC?=		cat --
BIB?=		cat --

BIB?=		bib
EQN?=		neqn
GREMLIN?=	grn
GRIND?=		vgrind -f
INDXBIB?=	indxbib
MKSH?=		/bin/ksh
NROFF?=		nrcon ${MACROS} ${PAGES}
PIC?=		pic
REFER?=		refer
ROFF?=		groff -Tps -M/usr/share/tmac ${MACROS} ${PAGES}
SOELIM?=	soelim
TBL?=		tbl

.PHONY: spell clean cleandir obj manpages print all \
	depend beforedepend afterdepend cleandepend \
	all lint cleanman includes \
	beforeinstall realinstall maninstall afterinstall install

BSD_OWN_MK=done
.endif
@


1.66.4.1
log
@merge the first bunch of MirOS X (branch MIROS_X tag tg-mergetmp-mirosx-1) into mergefixes branch
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.66.2.4 2004/12/28 15:18:48 tg Exp $
d9 5
a13 5
# tion, including unlimited rights to use, publicly perform, modify,
# merge, distribute, sell, give away or sublicence, provided all co-
# pyright notices above, these terms and the disclaimer are retained
# in all redistributions or reproduced in accompanying documentation
# or other materials provided with binary redistributions.
d21 1
a21 1
# of this work, even if advised of the possibility of such damage.
a47 3
.if make(obj)
CROSS_MODE:=	No
.endif
a50 1
EXPERIMENTAL=	Yes
a191 4

.if ${MACHINE} == "macppc"
CRTN?=		${DESTDIR}/usr/lib/ncrtn.o
.endif
@


1.66.2.1
log
@first MirOS X stage

I've been able to build a few static libraries, but
didn't try gnat, the crt*.o don't install themselfes,
and the multilib:soft-float removat must be tested.

Though, the following appeared:
tg@@odem:/usr/src/bin/cat/obj.macppc $ file cat
cat: ELF 32-bit MSB executable, PowerPC, version 1, for MirOS BSD, statically linked, not stripped
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.66 2004/11/30 17:05:20 tg Exp $
a50 1
EXPERIMENTAL=	Yes
@


1.66.2.2
log
@if make(obj) don't cross_mode
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.66.2.1 2004/12/27 23:43:40 tg Exp $
a47 3
.if make(obj)
CROSS_MODE=	No
.endif
@


1.66.2.3
log
@unbreak make obj
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.66.2.2 2004/12/28 11:18:19 tg Exp $
d49 1
a49 1
CROSS_MODE:=	No
@


1.66.2.4
log
@first stage of MirOS X: userland (mostly) builds cross
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.66.2.3 2004/12/28 11:33:49 tg Exp $
d9 5
a13 5
# tion, including unlimited rights to use, publicly perform, modify,
# merge, distribute, sell, give away or sublicence, provided all co-
# pyright notices above, these terms and the disclaimer are retained
# in all redistributions or reproduced in accompanying documentation
# or other materials provided with binary redistributions.
d21 1
a21 1
# of this work, even if advised of the possibility of such damage.
a195 4

.if ${MACHINE} == "macppc"
CRTN?=		${DESTDIR}/usr/lib/ncrtn.o
.endif
@


1.65
log
@remove NOPROFILE traces (we can't build profiled libs anyway)
switch NOMAN, NOLINT, NOPROG to yes/no logic (defaulting to yes if defined)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.64 2004/00/11 27:19:53 tg Exp $
d142 5
d148 1
a148 1
.if defined(NOPIC) && ${NOPIC:L} != "no" && !${LDFLAGS:M-static}
a174 3

# No lint, for now.
NOLINT?=	Yes
@


1.64
log
@switch NOLINT from defined to yes, allowing user to override
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.63 2004/10/22 19:26:36 tg Exp $
d139 1
a139 1
#NOPIC=		defined
d143 1
a143 1
.if defined(NOPIC) && !${LDFLAGS:M-static}
@


1.63
log
@merge most of the changes of recent OpenBSD appropriately for our goals
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.62 2004/09/27 17:11:13 tg Exp $
d172 1
a172 1
NOLINT=		Yes
@


1.62
log
@it's a bad idea to put the shlib versions into <bsd.own.mk>
not because it's bad per se, but because I think ppl would
forget to cd /usr/src/share/mk; sudo make install before
upgrading... :)
@
text
@d1 2
a2 2
# $MirBSD: src/share/mk/bsd.own.mk,v 1.61 2004/09/18 12:36:39 tg Exp $
# $OpenBSD: bsd.own.mk,v 1.84 2004/06/22 19:50:01 pvalchev Exp $
@


1.61
log
@* remove C2OPTS, since pgcc is gone
* unify C0OPTS, C3OPTS to DEFCOPTS
* we can build an automatic ISO by default
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.60 2004/09/17 20:16:42 tg Exp $
a189 34

# Shared library versions
LIBbfd_VERSION?=	0.2
LIBc_VERSION?=		2.0	# note: If changes were made to the file
#				# src/lib/libc/include/thread_private.h or
#				# system calls have been added/changed,
#				# libpthread must also be updated.
LIBcrypto_VERSION?=	1.0
LIBcurses_VERSION?=	1.0
LIBdes_VERSION?=	1.0
LIBedit_VERSION?=	1.0
LIBform_VERSION?=	1.0
LIBgcc_VERSION?=	1.0
LIBiberty_VERSION?=	2.0
LIBkvm_VERSION?=	1.0
LIBm_VERSION?=		1.0
LIBmenu_VERSION?=	1.0
LIBocurses_VERSION?=	1.0
LIBopcodes_VERSION?=	0.2
LIBossaudio_VERSION?=	1.0
LIBpanel_VERSION?=	1.0
LIBpcap_VERSION?=	1.0
LIBperl_VERSION?=	1.0
LIBpng_VERSION?=	1.1
LIBpthread_VERSION?=	1.0
LIBreadline_VERSION?=	2.1
LIBrx_VERSION?=		1.0
LIBsectok_VERSION?=	1.0
LIBskey_VERSION?=	1.0
LIBssl_VERSION?=	1.0
LIBusbhid_VERSION?=	1.0
LIButil_VERSION?=	1.0
LIBwrap_VERSION?=	1.0
LIBz_VERSION?=		1.0
@


1.60
log
@like a week of hard work.
* .cvsignore: add build.log
* X: remove unused code
* distrib: shrink floppy ramdisk until it fits, factor out some
  essentials (ping, netcat, hexdump, df, mknod, update, MBRmgr)
  into just another list
* disktab, conf/FLOPPY: in-kernel floppy image shrinks by 256 KiB
* distrib/lists: sync
* gcc: Ada now always disables -fstack-protector-all (not SSP in
  general); I learned it protects by itself
* ld.so, sed: gcc -fstack-protector-all mis-compiles some files
* bsd.own.mk: libbfd and libopcodes need a minor bump
* sys.mk, param.h, gcc version.c: bump MirOS version/patchlevel

I *hope* a make b-r "could" now succeed. I've done like 50 this week.
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.59 2004/09/13 21:23:38 tg Exp $
d59 1
a59 1
COPTS?=		$(C3OPTS) $(C0OPTS) $(GCEXTRA)
@


1.59
log
@my bad: libiberty's xmalloc needs xexit; add that and bump minor
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.58 2004/09/07 15:24:01 tg Exp $
d192 1
a192 1
LIBbfd_VERSION?=	0.1
d208 1
a208 1
LIBopcodes_VERSION?=	0.1
@


1.58
log
@add MKSH definition (location of installed mirbsdksh,
defaults to /bin/ksh)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.57 2004/08/23 16:35:21 tg Stab $
d215 1
a215 1
LIBreadline_VERSION?=	2.0
@


1.57
log
@enumerate possible OBJECT_FMT values (compatible with TNF, where I
just can't find PE (for Interix pkgsrc? isn't in there...))
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.56 2004/08/22 03:23:06 tg Exp $
a65 2


d183 2
a187 1
NROFF?=		nrcon ${MACROS} ${PAGES}
a223 1

@


1.56
log
@as promised, deliver an all-target 64-bit bfd and appropriate libs,
binutils, ld and gas (though it can only support one target, it does
support alternative output (a.out, elf, coff for example) now).
it's -Wall -Werror SHELL=ksh clean.

then, regenerate the configure scripts etc.
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.55 2004/08/14 00:01:51 tg Exp $
d149 2
a150 1
# MirOS is always ELF for now, neither aout nor PE
@


1.55
log
@* Makefile:
	add contbuild-x as an undocumented helper target
	(I thought I had already committed this, wtf?)
* time.h, taitime.c:
	It's a _absolutely_ stoopid idea to name a function tai_now()
	if it has a different calling signature than the libtai one
	from DJB, especially if included in libc. Found while linking
	some DJB ware statically (d'oh).
	Rename tai[na]_now() to tai[na]_time() and add an optional
	pointer argument to tai_time() so it behaves exactly the
	same as time(3), just with tai64_t not time_t.
	Fix some comments and build warnings (-Wall).
* time.h:
	always expose TAI functions
	for this, pull <machine/types.h>
	fix a bit
* bsd.own.mk:
	libc interface has changed, bump major
	no need to bump libpthread
* sys.mk / param.h:
	bump
* tai_make.c:
	adjust for new time.h
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.54 2004/08/13 04:52:48 tg Exp $
d192 1
a192 1
LIBbfd_VERSION?=	0.0
d208 1
a208 1
LIBopcodes_VERSION?=	0.0
@


1.54
log
@no C++, Java(TM), Pascal, Objective C or Fortran 77 for a while
as discussed on the mailing list
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.53 2004/08/11 23:19:24 tg Exp $
d193 1
a193 1
LIBc_VERSION?=		1.0	# note: If changes were made to the file
@


1.53
log
@looks like "commonbfdlib" won't work. prepare libopcodes.so.0.0 :(
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.52 2004/08/09 19:53:46 tg Exp $
a58 5
CXX=		c++
NO_CXX?=	No
NO_GADA?=	No
NO_GOBJC?=	No
NO_PASCAL?=	No
a62 7

# Ensure these are defined to sane values
NO_CXX?=	Yes
NO_GADA?=	Yes
NO_GOBJC?=	Yes
NO_PASCAL?=	Yes
NO_GJC?=	Yes
@


1.52
log
@present a working libiberty bumped to 2.0, and a libreadline
sharing code with libiberty on a source base
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.51 2004/08/09 18:36:54 tg Exp $
d204 1
d220 1
@


1.51
log
@Update to GNU libreadline 5.0 (with fixes), shared library revision 2.0

XXX the source code for readline-5.0 is *not* in src/ yet, only
XXX in testing/  - but then src/ doesn't build through yet any-
XXX way (because binutils-2.15 needs to be merged)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.50 2004/08/08 16:02:12 tg Exp $
d214 1
a214 1
LIBiberty_VERSION?=	1.0
@


1.50
log
@* first shadows of moving GNU stuff
* skeleton for new libreadline Makefiles
* LIB*_VERSION= -> ?= in <bsd.own.mk> for allowing overrides
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.49 2004/08/05 13:09:57 tg Exp $
d225 1
a225 1
LIBreadline_VERSION?=	1.0
@


1.49
log
@bump libpng minor, there have been functions added
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.48 2004/07/18 13:39:09 tg Exp $
d204 1
a204 1
LIBc_VERSION=		1.0	# note: If changes were made to the file
d208 26
a233 26
LIBcrypto_VERSION=	1.0
LIBcurses_VERSION=	1.0
LIBdes_VERSION=		1.0
LIBedit_VERSION=	1.0
LIBform_VERSION=	1.0
LIBgcc_VERSION=		1.0
LIBiberty_VERSION=	1.0
LIBkvm_VERSION=		1.0
LIBm_VERSION=		1.0
LIBmenu_VERSION=	1.0
LIBocurses_VERSION=	1.0
LIBossaudio_VERSION=	1.0
LIBpanel_VERSION=	1.0
LIBpcap_VERSION=	1.0
LIBperl_VERSION=	1.0
LIBpng_VERSION=		1.1
LIBpthread_VERSION=	1.0
LIBreadline_VERSION=	1.0
LIBrx_VERSION=		1.0
LIBsectok_VERSION=	1.0
LIBskey_VERSION=	1.0
LIBssl_VERSION=		1.0
LIBusbhid_VERSION=	1.0
LIButil_VERSION=	1.0
LIBwrap_VERSION=	1.0
LIBz_VERSION=		1.0
@


1.48
log
@nuke egcs (pgcc, gcc2) and simplify the system a bit
also fix placement of GNUSYSTEM_AUX_DIR equation in <bsd.own.mk> while here
remove some sparc and xc-old/xc-mit remnants
for now, all distribution lists are mi, since we only have 1 arch

XXX comp is second-largest now (after xfont), need ideas, come to IRC

agreed: <benz|lernen> joa, warum nicht
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.47 2004/07/15 19:48:48 tg Exp $
d223 1
a223 1
LIBpng_VERSION=		1.0
@


1.47
log
@F77 bites the dust (it's broken anyway)  <-- look, without s! :)
and gcc 3.6+ will have F95 or so...

<benz> jo, dann...
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.46 2004/07/15 15:39:21 tg Exp $
a40 1
HAS_GCC2=	Yes
a41 3
.elif ${MACHINE} == "sparc"
HAS_GCC2=	Yes
HAS_GCC3=	No
a49 3
.  if ${HAS_GCC3:L} != "yes"
HOSTCC=		pgcc
.  else
a50 1
.  endif
a57 18
.  if ${HAS_GCC3:L} != "yes"
# Architectures with in-tree egcs
USE_PGCC=	Yes
.  endif
.  if ${HAS_GCC2:L} == "no"
# Architectures with only in-tree gcc3 (AMD64)
USE_PGCC=	No
.  endif

USE_PGCC?=	No
.  if ${USE_PGCC:L} == "yes"
CC=		pgcc
CXX?=		false
.    if ${CXX} == "false"
NO_CXX=		Yes
.    endif
COPTS?=		$(C2OPTS) $(C0OPTS) $(GCEXTRA)
.  else
a64 2
.  endif

d76 3
d89 1
a89 1
# Ignore USA-only patents for build (by default, build patented code)
d93 5
a97 7


.if ${HAS_GCC3:L} != "yes"
GCC3_EXT_TOOLCHAIN?=	No	# crtbegin.o/crtend.o in lib/csu
.else
GCC3_EXT_TOOLCHAIN?=	Yes	# crt*.o provided by gcc
.endif
a101 6
# where the system object and source trees are kept; can be configurable
# by the user in case they want them in ~/foosrc and ~/fooobj, for example
BSDSRCDIR?=	/usr/src
BSDOBJDIR?=	/usr/obj
PORTSDIR?=	/usr/ports

d152 3
a154 3
.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "m88k")
NOPIC=		defined
.endif
d165 3
a167 3
.if ${MACHINE_ARCH} == "sparc64"
PICFLAG=	-fPIC
.else
d169 1
a169 1
.  if ${MACHINE_ARCH} == "m68k"
d174 9
a182 9
PICFLAG+=-fno-function-cse
.  endif
.endif

.if (${MACHINE_ARCH} == "sparc64") || (${MACHINE_ARCH} == "sparc")
ASPICFLAG=	-KPIC
.elif ${OBJECT_FMT:L} == "aout"
ASPICFLAG=	-k
.endif
@


1.46
log
@move GNUSYSTEM_AUX_DIR to src/gnu/share
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.45 2004/07/02 20:21:34 tg Exp $
a99 1
NO_GF77?=	Yes
@


1.45
log
@damn make(1) syntax
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.44 2004/06/29 15:49:47 tg Exp $
d127 1
a127 1
GNUSYSTEM_AUX_DIR?=	${BSDSRCDIR}/gnu/egcs
@


1.44
log
@add comment from obsd about when to bump libpthread with libc
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.43 2004/06/25 08:25:06 tg Exp $
d238 4
a241 4
LIBc_VERSION=		1.0	# note: If changes were made to
				# src/lib/libc/include/thread_private.h or
				# if system calls were added/changed then
				# libpthread must also be updated.
@


1.43
log
@basic build fixes for a dynamically linked system
some things I forgot, some typos, some libraries

libstdc++ finally gets around to install itself,
tho this means we don't have (that easy) control
over the shared library revision. For now, just
let's trust the FSF (whom I sold 2 T-Shirts and
a Dæmon pin yesterday, by the way) to get them right.
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.42 2004/06/23 16:58:41 tg Exp $
d238 4
a241 1
LIBc_VERSION=		1.0
@


1.42
log
@* lalala, ABI change...
  change the calling convention for the mjd2tm and tm2mjd functions,
  to be
  - similar between themselfes
  - equal between kernel and userland
  - not using malloc
* add TAI stuff to the kernel, including leap seconds(!) :)
  -> we can soon(TM) set the RTC to UTC, even when
     having the kernel on dru^H^H^HLS^H^HTAI
* some Makefile adjustments for
  - new library stuff
  - bsd.cfwrap.mk
  - simplifications
* start fixing the build (still static, tho I didn't intend that...)
* add missing shlib version for libsupc++
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.41 2004/06/23 10:14:54 tg Exp $
d238 1
d255 1
a260 2
LIBstdc++_VERSION=	1.0
LIBsupc++_VERSION=	1.0
@


1.41
log
@we have global shared library versions now

note for current users: please don't build dynamically right now,
there's some ongoing stuff (time related, doh) for libc missing,
and I won't bump the major for you.
(you _can_ build dynamically if you lower LIBc_VERSION to 0.0 first)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.40 2004/06/23 10:05:20 tg Exp $
d260 1
@


1.40
log
@merge
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.39 2004/06/20 02:56:50 tg Exp $
d236 29
@


1.39
log
@first (user-land) part of time_t64 building
* gcc and egcs are only half-made, using GCC_FOR_TARGET=pgcc/gcc
  (I hope I won't lose Ada now...)
* perl isn't made at all (miniperl...)
* ndat is obsolete anyways
@
text
@d1 2
a2 2
# $MirBSD: src/share/mk/bsd.own.mk,v 1.38 2004/06/19 20:28:30 tg Exp $
# $OpenBSD: bsd.own.mk,v 1.81 2004/03/02 18:18:27 miod Exp $
d186 2
a187 3
.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "hppa") || \
    (${MACHINE_ARCH} == "m88k")
NOPIC=		Yes
d203 7
d211 1
@


1.38
log
@add -static to LDFLAGS if NOPIC
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.37 2004/06/15 19:59:08 tg Exp $
d86 4
a89 4
NO_CXX=		No
NO_GADA=	No
NO_GOBJC=	No
NO_PASCAL=	No
@


1.37
log
@ok, no <bsd.gnuwrap.mk> - they are far too different
but the Makefile look and feel police cleans here

maybe we should still unify more of these
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.36 2004/06/15 14:19:35 tg Exp $
d189 5
@


1.36
log
@* use OBJECT_FMT (NetBSDish) rather than ELF_TOOLCHAIN, because
  the latter is a boolean, and we're probably going to support
  another format in addition to ELF, which is not a.out
* spacing, indenting
* fixes
* sync list of libraries with reality
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.35 2004/06/14 00:25:49 tg Exp $
d158 1
a158 1
DOCDIR?=        /usr/share/doc
d161 1
a161 1
DOCMODE?=       ${NONBINMODE}
@


1.35
log
@First (probably not working[1]) attempt at modernizing the framework:
* MANZ, MANPS, NOPROFILE die (always set to false, false, true)
* Fortran generating code for <bsd.prog.mk> dies (pascal to follow)
* GLOBAL_AUTOCONF_CACHE dies (birth of <bsd.gnuwrap.mk> to follow...)
* sanitize my head and rewrite certain pieces of certain Makefiles
* move most mk.conf functionality out of there, so a system
  without mk.conf works really well(TM)
* attempt at synching docs with reality

[1] First update *.mk, then remove old mk.conf and mk.conf.local,
    then install new mk.conf and adapt it to suit your needs.

Why don't the OpenBSD people modernize parts of this? The indenting
is really really bad in places, and MANSUBDIR was... well. I have
done it with 1/3 of the code now, and it works. Even better.

There will definitively follow more ;-)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.34 2004/06/13 17:42:10 tg Exp $
d23 2
d117 2
d171 2
d188 1
a188 1
NOPIC=		defined
d191 1
a191 1
# MirOS is always ELF for now
a192 1
ELF_TOOLCHAIN=	Yes
d202 1
a202 1
.elif ${ELF_TOOLCHAIN:L} == "no"
d207 1
a207 1
NOLINT=		defined
@


1.34
log
@honour CC...
add more comments for .if orgies

XXX this HAS to die. redesign the *.mk stuff.
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.33 2004/06/11 15:54:13 tg Exp $
d24 2
d28 1
a28 1
.include "${MAKECONF}"
d30 1
a30 1
.include "/etc/mk.conf"
d33 11
a43 3
HAS_GCC2?=	yes
.if ${MACHINE} == "sparc"
HAS_GCC3?=	no
d45 1
a45 1
HAS_GCC3?=	yes
a47 14
.if ${HAS_GCC3:L} != "yes"
# Architectures with in-tree egcs (optionally gcc3 from ports)
MKC_PGCC=	Yes
NO_GCC3=	Yes
.else
# Architectures with also in-tree gcc3 (thus no gcc3 from ports)
MKC_EGCC=	No
NO_CXX?=	No
NO_GADA?=	No
NO_GF77?=	Yes	# broken RTS
NO_GOBJC?=	No
NO_PASCAL?=	No
NO_GJC?=	Yes	# no RTS
.endif	# ! not HAS_GCC3
d49 20
a68 1
.if ${HAS_GCC2:L} == "no"
d70 2
a71 3
MKC_PGCC=	No
MKC_EGCC=	No
.endif
d73 2
a74 10
.ifndef	MAKECONF_OVERRIDE
.if ${MKC_EGCC:L} == "yes"
MKC_PGCC=	no
NO_GCC3=	no
.endif	# MKC_EGCC
NO_GCC3?=	no
.if ${NO_GCC3:L} == "yes"
MKC_PGCC=	yes
.endif	# NO_GCC3
.if ${MKC_PGCC:L} == "yes"
d76 8
a83 6
CXX=		false
NO_GCC3=	Yes
.else	# ! MKC_PGCC
.if ${MKC_EGCC:L} == "yes"
CC=		egcc
CXX?=		ec++
d85 9
a93 9
.else	# ! MKC_EGCC
CC=		gcc
.if defined(NO_CXX) && ${NO_CXX:L} == "yes"
CXX?=		c++
.endif	# NO_CXX
.endif	# ! MKC_EGCC
.endif	# ! MKC_PGCC
HOSTCC?=	${CC}
.endif	# ndef MAKECONF_OVERRIDE
d95 1
a102 5
.if ${MKC_PGCC:L} == "yes"
COPTS?=		$(C2OPTS) $(C0OPTS) $(GCEXTRA)
.else
COPTS?=		$(C3OPTS) $(C0OPTS) $(GCEXTRA)
.endif
d105 1
a105 1
WARNINGS?=		no
d107 1
a107 1
SKEY?=			yes
d110 1
a110 1
TCP_WRAPPERS?=		no
d112 4
a115 6
DEBUGLIBS?=		no
# Set 'MIRBSD_PKGTOOLS' to 'no' to build the MirBSD-unsupported,
# "new" OpenBSD pkgtools for MirOS/MirPorts
MIRBSD_PKGTOOLS?=	yes
# Ignore USA-only patents for build by default, build patented code
MKC_USAP?=		no
d118 1
a118 1
GCC3_EXT_TOOLCHAIN?=	no	# crtbegin.o/crtend.o in lib/csu
d120 1
a120 1
GCC3_EXT_TOOLCHAIN?=	yes	# crt*.o provided by gcc
d122 3
d130 1
a137 7
# Define MANZ to have the man pages compressed (gzip)
#MANZ=		1

# Define MANPS to have PostScript manual pages generated
# XXX needs troff or GNU groff
#MANPS=		1

a147 5
PSDIR?=		/usr/share/man/ps
PSGRP?=		bin
PSOWN?=		root
PSMODE?=	${NONBINMODE}

a163 3
# Shared files for system gnu configure
GNUSYSTEM_AUX_DIR?=${BSDSRCDIR}/gnu/egcs

d165 1
a165 1
.ifndef DEBUG
d176 1
a176 1
#SYS_INCLUDE= 	symlinks
d180 15
a194 13
#.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "hppa") || \
#    (${MACHINE_ARCH} == "m88k")
#NOPIC=defined
#.endif

# MirOS is always ELF for now and long
OBJECT_FMT?=	ELF
ELF_TOOLCHAIN?= yes

#pic relocation flags.
#.if (${MACHINE_ARCH} == "sparc64")
#PICFLAG=-fPIC
#.endif
d196 3
a198 3
ASPICFLAG=-KPIC
.elif (${ELF_TOOLCHAIN:L} == "no")
ASPICFLAG=-k
a200 3
# No profiling libs.
NOPROFILE=	defined

d204 5
a208 1
#BIB?=		bib
d213 1
a213 1
#PIC?=		pic
a219 6
# XXX fixme
PIC?=		cat --
BIB?=		cat --

BSD_OWN_MK=Done

d224 3
@


1.33
log
@* Fortran RTS is broken as of now -> disable Fortran
* GJC RTS isn't even available as a port -> disable Java(TM)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.32 2004/06/09 15:33:37 tg Exp $
d5 2
a6 2
# Copyright (c) 2004
#	Thorsten "mirabile" Glaser <x86@@ePost.de>
d51 1
a51 1
.endif
d59 1
d63 1
a63 1
.endif
d67 1
a67 1
.endif
d69 1
a69 2
CC?=		pgcc
HOSTCC?=	pgcc
d72 1
a72 1
.else
d74 1
a74 2
CC?=		egcc
HOSTCC?=	egcc
d77 2
a78 3
.else
CC?=		gcc
HOSTCC?=	gcc
d81 5
a85 3
.endif
.endif
.endif
@


1.32
log
@simplify and share more code between bsd.doc.mk and bsd.man.mk in bsd.own.mk
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.31 2004/06/04 17:55:09 tg Exp $
d47 1
a47 1
NO_GF77?=	No
d50 1
a50 1
NO_GJC?=	No
@


1.31
log
@fix up some documentation shitup, and use less mana devouring paper.txt
generation algorithm (tho a tricky one...)
XXX might break due to paper.\${PRINTER} allowance removal
XXX might break paper.ps plus paper.txt generation, where
XXX a) paper.ps is generated before paper.txt
XXX especially b) paper.ps depends on stuff (vi... I always told you it suxx)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.30 2004/05/23 15:57:42 tg Exp $
d6 1
a6 1
#	Thorsten Glaser <x86@@ePost.de>
d18 4
a21 4
# licious intent or gross negligence; in no event shall an author or
# contributor be held liable for any direct, indirect or other dama-
# ge, however caused, arising in any way out of the usage of covered
# work, even if advised of the possibility of such damage.
d221 1
a221 1
ROFF?=		groff -M/usr/share/tmac ${MACROS} ${PAGES}
@


1.30
log
@* merge OpenBSD 3.5-current
* fix every single Makefile for papers/USD/PSD/SMM
* improve <bsd.doc.mk> - tbl(1) is called by default now
* move programme definitions from <bsd.doc.mk> into <bsd.own.mk>
* move a bunch of compiler selection stuff from /etc/mk.conf
  into <bsd.own.mk> and improve it largely
* overhaul gcc-local(1) and style(9), referencing our licence
  template in the latter
* overhaul (mostly shorten and clarify) the COPYRIGHT file;
  make clear where the other licences (Apache, Sendmail, GNU, ...)
  are listed, by pathname and www URI
* employ new mechanism to check for paper/doc Makefiles/SUBDIRs
* fix mdoc macros
* merge more acronymes from NetBSD

This merge took me more than three hours, just FYI
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.29 2004/05/02 14:32:44 tg Exp $
d223 1
a223 1
#SOELIM?=	soelim
a224 1
PRINTER?=	ps
a226 1
SOELIM?=	cat --
@


1.29
log
@better SHELL
@
text
@d1 2
a2 2
# $MirBSD: src/share/mk/bsd.own.mk,v 1.28 2004/05/02 14:28:34 tg Exp $
# $OpenBSD: bsd.own.mk,v 1.71 2003/12/27 23:23:21 espie Exp $
d4 19
d31 69
d115 1
a115 5
NO_GCC3?=		no
.if ${NO_GCC3:L} == "yes"
.  if ${MKC_EGCC:L} != "yes"
MKC_PGCC=		yes	# if no gcc3, use pgcc
.  endif
a119 9
.if ${MKC_PGCC:L} == "yes" && !exists(/usr/bin/c++)
CXX=			false
.endif
NO_CXX?=		no	# Language Options
NO_GADA?=		no
NO_GF77?=		no
NO_GOBJC?=		no
NO_PASCAL?=		no
NO_GJC?=		no
d189 3
a191 3
#.if (${MACHINE_ARCH} == "vax") || \
#    (${MACHINE_ARCH} == "hppa") || (${MACHINE_ARCH} == "m88k")
#NOPIC=
d199 3
a201 3
.if (${MACHINE_ARCH} == "sparc64")
PICFLAG=-fPIC
.endif
d208 2
a209 1
NOPROFILE=1
d212 19
a230 1
NOLINT=1
@


1.28
log
@add SHELL
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.own.mk,v 1.27 2004/03/09 21:10:50 tg Exp $
a55 2

SHELL?=		/bin/ksh
@


1.27
log
@* nuke obsolete files and parts of files
* enable pascal frontend
* enable CPIO naming convention:
  sv4cpio = .cpio
  sv4crc  = .cpio
  sv4cpio gzipped = .ngz (newc/gz)
  svrcrc  gzipped = .cgz (crc/gz)
* all packages are .cgz, all sets are .ngz
* add hooks for gjc frontend
* add stubbed out gpc and gjc rts hooks in src/gnu/gcc/Makefile
* enable java frontend (with almost no changes; this is what I
  call a _really_ nice langspec-subdir... amazing)
* bump patchlevel for these changes
* better document some changes
* matthieu@@openbsd.org assured me we need no X piclibs any more
* improve comments
* export whole libz to XFree86 .a modules
* correct usage of languages when bootstrapping gcc
* fix MKC_PGCC when USE_GCC3=no (since USE_GCC3 is a post-#7
  thing, and ports/lang/egcs is not available for -current)
* install man- and texinfopages for gpc

most of this stuff is tested. however, I *strongly* recommend
to not update, but rather wait for the next snapshot.

Now missing:
* pascal RTS
* a port for libgjc (I won't like it in base, due to the
  _heavy_ overhead (jar, ffi, boehm-gc*cough*, ...), but
  since the compiler is there, it should be easy)
* test pascal (c, cp, f, objc, and ada are fine already)
* test gcov? (proto is fine, all right)
* documentation improvements
* quality tests and improvements
* more ~/.etc
* get the damn cvs conflict script right ;)

Next projects:
* update binutils
* sync with openbsd
* rewrite large parts of build system
* write boot loader
* rewrite install system
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.26 2004/03/07 18:01:42 tg Exp $
d56 2
@


1.26
log
@make MKC_USAP a global yes/NO toggle
no being the default, i.e. to build code which infringes
patents in the USA (has been like this since... long)
enable truetype bytecode hinting interpreter if not MKC_USAP
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.25 2004/03/02 10:32:14 tg Exp $
d43 2
a44 1
NO_PASCAL?=		yes
@


1.25
log
@fortran (untested), RCS IDs, no a.out/coff any more and style nits
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.24 2004/03/02 09:18:45 tg Exp $
d24 2
@


1.24
log
@welcome to the wonderful world of peace in MirOS,
Objective C and associated libraries/includes

thank you for being so nice to use standardized
make prereq / make includes mechanism

[x] test programme (hello world) runs
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.23 2004/02/29 01:19:48 tg Exp $
d34 3
d39 1
a39 1
NO_GF77?=		yes
d58 1
d111 4
a114 4
.if (${MACHINE_ARCH} == "vax") || \
    (${MACHINE_ARCH} == "hppa") || (${MACHINE_ARCH} == "m88k")
NOPIC=
.endif
d116 1
a116 4
# Set to a.out, ELF, [E]COFF, PE, ...
.if ${MACHINE_ARCH} == "ns32k"	# sample... MirBSD is {i386,sparc}/ELF only
OBJECT_FMT?=	a.out		# allow overrides, to ease transition
.else
a117 4
.endif

# Set toolchain to be able to know differences.
.if ${OBJECT_FMT} == "ELF"
a118 3
.else
ELF_TOOLCHAIN?= no
.endif
@


1.23
log
@so, OpenBSD is for baby mulching machines. boring.
MirOS BSD is now for nuclear warheads driven in Ada, too.

well, it bootstraps itself, and the propolice problem is
documented. for upgrading you will need a binary snapshot.
in any case, update /usr/share/mk/ first.
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.22 2004/02/08 19:49:17 tg Exp $
d37 1
a37 1
NO_GOBJC?=		yes
@


1.22
log
@* bump to 0x079D (a bit late for tiff, but hey)
* sync lists
* regenerate configure files
* remove MirLibtool, go back to gcc3 libtool :-(
* fix for $stuff
* remove dupes (libz, etc.) and unused (libintl, getopt)
* update lynx
* update texinfo.tex
etc.

XXX borked commit, eleventh try
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.21 2004/01/29 21:32:59 tg Exp $
d34 5
@


1.21
log
@the first part of making a release (non-X)
* sync sets (for now)
* mention set sizes in INSTALL.i386
* install all files, but not more than wanted
* fix build time warnings
  (the mktemp in lpd is said to be safe)
* update docs a bit
* the eqn -> neqn move
* improved man page generation
* anoncvsbin removes tmp before making new symlink
* sendmail generated files are now in sendmail, and
  SKIPDIRS is checked before (asked for by Waldemar Brodkorb)
* more SKIPDIR checks, mostly for GNU stuff
@
text
@d1 1
a1 1
# $MirBSD: bsd.own.mk,v 1.20 2004/01/18 15:23:18 tg Exp $
a81 5

NLSDIR?=	/usr/share/nls
NLSGRP?=	bin
NLSOWN?=	root
NLSMODE?=	${NONBINMODE}
@


1.20
log
@* in gcc3,
  - fix possible recursive circular make dependencies
  - fix bootstrapping with differing CFLAGS
* enable use of the gcc3 crt{begin,end}{,S}.o for i386
* bump patchlevel
* split out some of the perl and gcc3 stuff

survives make and make bootstrap MKC_PGCC=yes in gnu/gcc/gcc
@
text
@d1 3
a3 3
#	$MirBSD: bsd.own.mk,v 1.19 2004/01/03 02:27:44 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.71 2003/12/27 23:23:21 espie Exp $
#	$NetBSD: bsd.own.mk,v 1.24 1996/04/13 02:08:09 thorpej Exp $
@


1.19
log
@Merge OpenBSD
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.18 2003/12/17 18:55:18 tg Exp $
d13 1
a13 1
WARNINGS?=	no
d15 1
a15 1
SKEY?=		yes
d18 1
a18 1
TCP_WRAPPERS?=	no
d20 1
a20 1
DEBUGLIBS?=	no
d23 11
a33 1
MIRBSD_PKGTOOLS?=yes
@


1.18
log
@second (piecewise) attempt to merge MirBSD #7ter into HEAD
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.17 2003/11/09 12:54:14 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.70 2003/09/06 18:20:23 miod Exp $
@


1.17
log
@Mostly... not fully...

One weekend's worth of work.

- catch up website log with changes really done till today
- add catch-up entries for wbx@@ and bsiegert@@, too
- move GNU documentation to src/gnu/doc and simplify it
- re-run autoconf on the gnu part of the tree again, to
  catch up with the GFDL-documentation removal
- provide non-GFDL-licenced as(1) and ld(1) manual pages
  XXX these are more than outdated!
- bump MirOS patchlevel
- build the system through, fixing showstoppers where
  they are encountered
- index.cgi and index.php come before index.htm,
  default.htm and index.html in httpd.conf
- speed up PHP processing
- prepare for "new" OpenBSD pkgtools (unsupported by MirBSD,
  but some MirPorts people want to play with them)
- move old weblog to CMS; update my info again
- update hRef""s in old weblogs
- move release announcements to /historic/
- copy feature list from last release announcement
  XXX need a "readible short list", or even
  XXX	a separation for the target environment
  XXX	(e.g. suits / techies / clients)
- add some recent news, so the page ain't empty
  missing:
	- about
	  + MirOS
	  + MirPorts
	- get MirOS!	(http d/l, http install, install docs)
	- relations	(to other BSD)
	  + ??? events ??? (here?)
	- history
	- older releases	(historic)
	- help pages
	  + FAQ
	  + Docs/Tuts	(hi wbx@@ here comes your place)
	    + install docs
	  + mailing lists
	- developers
	  + wbx
	  + bsiegert
	  + cnuke
	- CVSweb	(XXX need BSDadvocacy.org fix before)
	- AnonCVS	(howto; link to)
	- Links
  alternatively, change the layout? suggestions?
  why am I the only one who cares about www?
- merge development plan
- put a "project" into the miros page head
- fix cdboot Makefile
- fix gas wanting us a.out again (wut?)
  (turned out to be a must-fix in configure.in)
- stand/cdboot/NOTES merged into stand/README
- sync distrib set lists
- have TORI device (i386 libsa) always use bounce buffers
  (which, in fact, makes it succeed in loading the kernel)
  XXX kernel says it has less than 4 meg ram (degraded mode)
  XXX may be a bochs issue?
- fix random.S again
- move determining of file name / raw file flag in both
  bios/toridev.c to the end of bios/toriopen()
  => enables us to have two drivers at once
- fix disk probing for CD devices wrt BIOS driver

(eww. The tree isn't fully broken, but neither boot
 nor cdboot.bin are usable at all at the moment.
 I'll fix that ASAP.)
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.16 2003/10/26 22:32:15 tg Exp $
d103 1
a103 1
.if ${MACHINE_ARCH} == "ns32k"	# sample... MirBSD is x86-32/ELF only
d106 1
a106 1
OBJECT_FMT=	ELF
@


1.16
log
@* nuke some bsd.nls.mk includes
* add missing RCS IDs
* fix a small bug
* remove compatibility cruft

If something breaks, fix it. Don't revert this diff
(unless it's broken itself :)
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.15 2003/09/25 20:59:59 tg Exp $
d21 3
@


1.15
log
@Merge OpenBSD-current
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.14 2003/09/03 12:56:53 tg Exp $
a15 5
# Unconditionally set, for OpenBSD compatibility
AFS=		no
KERBEROS5=	no
NONLS=		yes
YP=		no
d126 1
a126 1
NOLINT=
d132 1
a132 1
	all lint cleanman nlsinstall cleannls includes \
@


1.15.2.1
log
@whitespace cleanup
NLS removal
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.15 2003/09/25 20:59:59 tg Exp $
d105 1
a105 1
.if ${MACHINE_ARCH} == "ns32k"	# sample... MirBSD is {i386,sparc}/ELF only
d108 1
a108 1
OBJECT_FMT?=	ELF
@


1.14
log
@gcc 3.3.1 has proven not ready for prime-time yet.
o isolate libiberty from the gcc tree
o move stuff around for $GNUSYSTEM_AUX_DIR
o update and sync gcc-2.95 with moved-again libiberty and $GNUSYSTEM_AUX_DIR
o prepare for nuking gcc 3.3 in favour of gcc 3.2 (if it works)
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.13 2003/08/31 20:54:47 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.69 2003/08/21 07:04:09 deraadt Exp $
@


1.13
log
@Merge import of OpenBSD source, ports and XF4 tree.

While here,
o clean up differences where possible
o whitespace cleanup
o ifdef ./. if defined()
o '...' ./. "..."
o echo foo > bar ./. echo foo >bar
o `...` ./. $(...) ./. $$(...)
o `...' ./. '...'
o modernize "our" tree, e.g. WWW in ports
o fix some typos and brainos introduced when renaming OpenBSD to MirBSD
o use hardware 80387 by default
o migrate Apache 1.3.28 OpenBSD ./. MirBSD ./. KAME
o work around as many CVS bugs as possible (add back/delete files, ...)

Synchronize stuff, ready for ongoing changes.
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.12 2003/07/26 16:08:06 tg Exp $
d80 2
a81 2
# Shared files for system gnu configure, not used yet
GNUSYSTEM_AUX_DIR?=${BSDSRCDIR}/share/gnu
@


1.12
log
@merge CVS; fix here and there a bit
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.11 2003/07/09 19:03:08 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.68 2003/07/22 17:26:06 brad Exp $
d16 1
a16 1
# Unconditionally set for OpenBSD compatibility
@


1.11
log
@mop up, sweep clean
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.10 2003/07/08 14:20:36 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.67 2003/07/08 13:59:13 espie Exp $
d124 1
a124 1
.elif (${ELF_TOOLCHAIN:L} != "yes")
@


1.10
log
@use :L for yes/no variables
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.9 2003/07/06 01:00:16 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.66 2003/05/14 08:01:02 mho Exp $
@


1.9
log
@cvs hates me
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.8 2003/07/06 00:59:06 tg Exp $
d124 1
a124 1
.elif (${ELF_TOOLCHAIN} != "yes")
@


1.8
log
@OBJECT_FMT fixes
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.7 2003/07/05 22:26:13 tg Exp $
d106 1
a106 1
OBJECT_FMT?=	"a.out"		# allow overrides, to ease transition
d108 1
a108 1
OBJECT_FMT=	"ELF"
@


1.7
log
@define OBJECT_FMT
from NetBSD
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.6 2003/05/22 14:08:20 tg Exp $
d106 1
a106 1
OBJECT_FMT?=	a.out		# allow overrides, to ease transition
d108 1
a108 1
OBJECT_FMT=	ELF
@


1.6
log
@merge CVS import stuff
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.5 2003/05/13 18:36:14 tg Exp $
d16 2
a17 1
# Set 'KERBEROS5' to 'yes' to build with support for Kerberos5 authentication.
d19 1
a19 1
# Set 'YP' to 'yes' to build with support for NIS/YP.
a23 2
# You can't build AFS or Kerberos.
AFS=		no
a25 4
# Set toolchain to be able to know differences.
ELF_TOOLCHAIN?=	yes
# No native language support here
NONLS=		yes
d102 14
@


1.5
log
@clean up bsd.own.mk a bit more
put some things out, from mk.conf,
since they're common to MirBSD
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.4 2003/05/07 20:54:21 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.64 2003/04/17 03:50:24 drahn Exp $
a15 2
# Set 'KERBEROS' to 'yes' to build with support for Kerberos authentication.
KERBEROS=	no
d23 1
a23 1
# Set 'AFS' to 'yes' to build with AFS support.
@


1.4
log
@merge conflicts; fix what(1) stdin
@
text
@d1 1
a1 1
#	$MirBSD: bsd.own.mk,v 1.3 2003/03/29 22:25:02 tg Exp $
a29 3
.if (${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "powerpc" || \
     ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "sparc64" || \
     ${MACHINE_ARCH} == "sparc" || ${MACHINE_ARCH} == "i386")
d31 2
a32 3
.else
ELF_TOOLCHAIN?=	no
.endif
d121 1
a121 7
# don't try to generate PROFILED versions of libraries on machines
# which don't support profiling.
# to add this back use the following line
.if (${MACHINE_ARCH} == "m88k")
#.if 0
NOPROFILE=
.endif
@


1.3
log
@accents et al.
@
text
@d1 2
a2 2
#	$MirBSD: bsd.own.mk,v 1.2 2003/03/23 21:52:11 tg Exp $
#	$OpenBSD: bsd.own.mk,v 1.63 2002/12/07 22:31:00 millert Exp $
@


1.2
log
@Merge MirBSD-old entirely
Remove krb, yp, afs, GPL'd stuff in kernel
Adjust some other stuff

Not to be compiled yet...
@
text
@d1 1
a1 1
#	$MirBSD$
d12 1
a12 1
# Set `WARNINGS' to `yes' to add appropriate warnings to each compilation
d14 1
a14 1
# Set `SKEY' to `yes' to build with support for S/key authentication.
d16 1
a16 1
# Set `KERBEROS' to `yes' to build with support for Kerberos authentication.
d18 1
a18 1
# Set `KERBEROS5' to `yes' to build with support for Kerberos5 authentication.
d20 1
a20 1
# Set `YP' to `yes' to build with support for NIS/YP.
d22 1
a22 1
# Set `TCP_WRAPPERS' to `yes' to build certain networking daemons with
d25 1
a25 1
# Set `AFS` to `yes' to build with AFS support.
d27 1
a27 1
# Set `DEBUGLIBS' to `yes' to build libraries with debugging symbols
d104 1
a104 1
# source (``symlinks''), or a separate copy (``copies''); (latter useful
@


1.1
log
@Initial revision
@
text
@d1 1
d17 1
a17 1
KERBEROS?=	yes
d19 1
a19 1
KERBEROS5?=	yes
d21 1
a21 1
YP?=		yes
d24 1
a24 1
TCP_WRAPPERS?=	yes
d26 1
a26 5
.if (${MACHINE_ARCH} == "m88k")
AFS?=		no
.else
AFS?=		yes
.endif
d32 1
a32 1
     ${MACHINE_ARCH} == "sparc")
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import OpenBSD source tree of short before 17:00 UTC today
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.64 2003/04/17 03:50:24 drahn Exp $
d35 1
a35 1
     ${MACHINE_ARCH} == "sparc" || ${MACHINE_ARCH} == "i386")
@


1.1.1.3
log
@Sync MirBSD main source tree against OpenBSD-current,
which should be fairly stable after the Hackathon now.
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.66 2003/05/14 08:01:02 mho Exp $
d15 2
d28 1
a28 2
# AFS needs updating to work w/o krb4 - disable for now.
AFS?=		no
@


1.1.1.4
log
@Bring the entire base system and ports tree in sync with OpenBSD
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.67 2003/07/08 13:59:13 espie Exp $
d123 1
a123 1
.elif (${ELF_TOOLCHAIN:L} != "yes")
@


1.1.1.5
log
@Import latest OpenBSD ports, XFree and source in sync
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.68 2003/07/22 17:26:06 brad Exp $
d123 1
a123 1
.elif (${ELF_TOOLCHAIN:L} == "no")
@


1.1.1.6
log
@Pull in a bit of current OpenBSD, to the least
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.69 2003/08/21 07:04:09 deraadt Exp $
d23 6
a28 1
AFS?=		yes
@


1.1.1.7
log
@Release Time. Synchronize with OpenBSD 3.4-current (base system).
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.70 2003/09/06 18:20:23 miod Exp $
a22 3
.if (${MACHINE_ARCH} == "m88k")
AFS?=		no
.else
a23 1
.endif
@


1.1.1.8
log
@Import OpenBSD again, for various reasons.
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.71 2003/12/27 23:23:21 espie Exp $
a37 3

# don't use yet.
USE_GCC3?=no
@


1.1.1.9
log
@large-scale import of OpenBSD 3.5-current source base including many fixes
note: from now, we will not be binary compatible with OpenBSD apps any
longer (due to syscall numbering differences); both an OpenBSD compat and
a conversion tool for old MirOS #7 apps will be delivered later.

The src/ tree is locked from now.
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.81 2004/03/02 18:18:27 miod Exp $
d23 3
d27 1
d31 3
a33 5
.if ( ${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "arm" || \
     ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "i386" || \
     ${MACHINE_ARCH} == "powerpc" || ${MACHINE_ARCH} == "sparc" || \
     ${MACHINE_ARCH} == "sparc64" || ${MACHINE_ARCH} == "x86_64") || \
     ${MACHINE} == "amd64"
d39 1
a39 6
# do the dew
.if (${MACHINE_ARCH} == "arm" || ${MACHINE_ARCH} == "hppa64" || \
    ${MACHINE_ARCH} == "x86_64" || ${MACHINE_ARCH} == "sparc64") || \
    ${MACHINE} == "amd64"
USE_GCC3?=yes
.else
a40 1
.endif
d114 2
a115 2
.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "hppa") || \
    (${MACHINE_ARCH} == "m88k")
@


1.1.1.10
log
@updated Makefile includes
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.own.mk,v 1.84 2004/06/22 19:50:01 pvalchev Exp $
d27 7
a33 2
.if ${MACHINE_ARCH} == "m68k" || ${MACHINE_ARCH} == "m88k" || \
    ${MACHINE_ARCH} == "vax"
a34 2
.else
ELF_TOOLCHAIN?=	yes
d38 3
a40 3
.if ${MACHINE} == "amd64" || (${MACHINE_ARCH} == "arm" || \
    ${MACHINE_ARCH} == "hppa" || ${MACHINE_ARCH} == "hppa64" || \
    ${MACHINE_ARCH} == "sparc64" || ${MACHINE_ARCH} == "x86_64")
d118 2
a119 1
.if (${MACHINE_ARCH} == "vax") || (${MACHINE_ARCH} == "m88k")
d123 1
a123 1
# pic relocation flags.
a125 9
.else
PICFLAG=-fpic
. if ${MACHINE_ARCH} == "m68k"
# Function CSE makes gas -k not recognize external function calls as lazily
# resolvable symbols, thus sometimes making ld.so report undefined symbol
# errors on symbols found in shared library members that would never be
# called.  Ask niklas@@openbsd.org for details.
PICFLAG+=-fno-function-cse
. endif
a126 1

@


