head	1.26;
access;
symbols
	tg-mergetmp-mirosx-1:1.26
	tg-mergefixes-1-branch:1.26.0.4
	tg-mergefixes-1-base:1.26
	MIROS_X:1.26.0.2
	MIROS_X_BASE:1.26
	tg-mergetmp-3:1.26
	MIRBSD_XP_MIRPPC:1.21.0.4
	MIRBSD_XP_SPARC_BASE:1.21
	MIRBSD_XP_SPARC:1.21.0.2
	cvs-200406230955:1.1.1.6
	MIRBSD_7quater:1.10
	cvs-200405160640:1.1.1.5
	cvs-200401271800:1.1.1.5
	cvs-200401261630:1.1.1.5
	cvs-200401021645:1.1.1.5
	MIRBSD_7_ALPHA:1.10.0.6
	MIRBSD_7:1.10.0.4
	cvs-200312222040:1.1.1.5
	MIRBSD_7ter:1.10
	MIRBSD_7_DEV:1.10.0.2
	cvs-200310020700:1.1.1.5
	cvs-200309271030:1.1.1.5
	cvs-200309251530:1.1.1.5
	cvs-200308302005:1.1.1.5
	cvs-200308221505:1.1.1.4
	cvs-200308171200:1.1.1.4
	ctm-3496:1.1.1.3
	ctm-3449:1.1.1.3
	ctm-3437:1.1.1.3
	cvs-200307191805:1.1.1.3
	ctm-3425:1.1.1.3
	cvs-200307091500:1.1.1.2
	cvs-200307072125:1.1.1.1
	ctm-3389:1.1.1.1
	cvs-200306291430:1.1.1.1
	ctm-3341:1.1.1.1
	MIRBSD_5:1.3
	cvs-200306082100:1.1.1.1
	ctm-3316:1.1.1.1
	ctm-3272:1.1.1.1
	ctm-3264:1.1.1.1
	cvs-200305071630:1.1.1.1
	MIRBSD_4:1.3
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.26
date	2004.12.08.18.42.21;	author tg;	state Exp;
branches;
next	1.25;

1.25
date	2004.11.30.17.05.20;	author tg;	state Exp;
branches;
next	1.24;

1.24
date	2004.11.30.16.47.46;	author tg;	state Exp;
branches;
next	1.23;

1.23
date	2004.10.22.19.26.36;	author tg;	state Exp;
branches;
next	1.22;

1.22
date	2004.10.14.22.28.58;	author tg;	state Exp;
branches;
next	1.21;

1.21
date	2004.09.27.18.58.14;	author tg;	state Exp;
branches;
next	1.20;

1.20
date	2004.06.23.10.05.20;	author tg;	state Stab;
branches;
next	1.19;

1.19
date	2004.06.16.15.44.31;	author tg;	state Exp;
branches;
next	1.18;

1.18
date	2004.06.15.14.19.36;	author tg;	state Exp;
branches;
next	1.17;

1.17
date	2004.06.14.00.25.49;	author tg;	state Exp;
branches;
next	1.16;

1.16
date	2004.06.04.17.18.19;	author tg;	state Exp;
branches;
next	1.15;

1.15
date	2004.05.02.15.04.37;	author tg;	state Exp;
branches;
next	1.14;

1.14
date	2004.04.08.16.01.40;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2004.01.29.21.32.59;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2004.01.16.23.39.10;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.10.26.22.32.15;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.08.31.20.54.47;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.08.19.14.58.42;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.08.17.18.56.10;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.07.18.19.20.46;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.07.09.19.03.08;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.07.08.14.20.36;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.07.07.14.21.39;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.03.23.21.52.12;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.23.19.29.58;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.49.10;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.49.10;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.07.09.16.41.44;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.07.18.13.44.23;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.08.17.14.25.41;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.08.30.23.06.50;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2004.06.23.09.58.47;	author tg;	state Exp;
branches;
next	;


desc
@@


1.26
log
@if hard links fail, do a cp
build break if /usr/bin != /bin noticed by sap@@
@
text
@# $MirBSD: src/share/mk/bsd.prog.mk,v 1.25 2004/11/30 17:05:20 tg Exp $
# $OpenBSD: bsd.prog.mk,v 1.42 2004/10/20 09:28:17 espie Exp $
# $NetBSD: bsd.prog.mk,v 1.55 1996/04/08 21:19:26 jtc Exp $
# @@(#)bsd.prog.mk	5.26 (Berkeley) 6/25/91

.if exists(${.CURDIR}/../Makefile.inc)
.  include "${.CURDIR}/../Makefile.inc"
.endif

.ifndef	BSD_OWN_MK
.  include <bsd.own.mk>
.endif

.SUFFIXES: .out .o .c .cc .C .cxx .y .l .s .8 .7 .6 .5 .4 .3 .2 .1 .0

.if ${WARNINGS:L} == "yes"
CFLAGS+=	${CDIAGFLAGS}
CXXFLAGS+=	${CXXDIAGFLAGS}
.endif
CFLAGS+=	${COPTS}
CXXFLAGS+=	${CXXOPTS}

.if ${OBJECT_FMT:U} == "ELF"
CRTBEGIN?=	${DESTDIR}/usr/lib/crtbegin.o
CRTEND?=	${DESTDIR}/usr/lib/crtend.o
CRTI?=		${DESTDIR}/usr/lib/crti.o
CRTN?=		${DESTDIR}/usr/lib/crtn.o
.endif

LIBCRT0?=	${DESTDIR}/usr/lib/crt0.o
LIBC?=		${DESTDIR}/usr/lib/libc.a
LIBCDK?=	${DESTDIR}/usr/lib/libcdk.a
LIBCOMPAT?=	${DESTDIR}/usr/lib/libcompat.a
LIBCRYPTO?=	${DESTDIR}/usr/lib/libcrypto.a
LIBCURSES?=	${DESTDIR}/usr/lib/libcurses.a
LIBDES?=	${DESTDIR}/usr/lib/libdes.a
LIBEDIT?=	${DESTDIR}/usr/lib/libedit.a
LIBEVENT?=	${DESTDIR}/usr/lib/libevent.a
LIBEXPAT?=	${DESTDIR}/usr/lib/libexpat.a
LIBF2C?=	${DESTDIR}/usr/lib/libg2c.a
LIBFL?=		${DESTDIR}/usr/lib/libfl.a
LIBFORM?=	${DESTDIR}/usr/lib/libform.a
LIBFRTBEGIN?=	${DESTDIR}/usr/lib/libfrtbegin.a
LIBG2C?=	${DESTDIR}/usr/lib/libg2c.a
LIBGCC?=	${DESTDIR}/usr/lib/libgcc.a
LIBGPC?=	${DESTDIR}/usr/lib/libgpc.a
LIBKEYNOTE?=	${DESTDIR}/usr/lib/libkeynote.a
LIBKVM?=	${DESTDIR}/usr/lib/libkvm.a
LIBL?=		${DESTDIR}/usr/lib/libl.a
LIBM?=		${DESTDIR}/usr/lib/libm.a
LIBMENU?=	${DESTDIR}/usr/lib/libmenu.a
LIBMILTER?=	${DESTDIR}/usr/lib/libmilter.a
LIBOBJC?=	${DESTDIR}/usr/lib/libobjc.a
LIBOLDCURSES?=	${DESTDIR}/usr/lib/libocurses.a
LIBPANEL?=	${DESTDIR}/usr/lib/libpanel.a
LIBPCAP?=	${DESTDIR}/usr/lib/libpcap.a
LIBPERL?=	${DESTDIR}/usr/lib/libperl.a
LIBPNG?=	${DESTDIR}/usr/lib/libpng.a
LIBRPCSVC?=	${DESTDIR}/usr/lib/librpcsvc.a
LIBRX?=		${DESTDIR}/usr/lib/librx.a
LIBSECTOK?=	${DESTDIR}/usr/lib/libsectok.a
LIBSKEY?=	${DESTDIR}/usr/lib/libskey.a
LIBSSL?=	${DESTDIR}/usr/lib/libssl.a
LIBTERMCAP?=	${DESTDIR}/usr/lib/libtermcap.a
LIBTERMLIB?=	${DESTDIR}/usr/lib/libtermlib.a
LIBUSB?=	${DESTDIR}/usr/lib/libusbhid.a
LIBUTIL?=	${DESTDIR}/usr/lib/libutil.a
LIBWRAP?=	${DESTDIR}/usr/lib/libwrap.a
LIBY?=		${DESTDIR}/usr/lib/liby.a
LIBZ?=		${DESTDIR}/usr/lib/libz.a

.if (${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" || \
     ${MACHINE_ARCH} == "i386")
LIBARCH?=	${DESTDIR}/usr/lib/lib${MACHINE_ARCH}.a
.else
LIBARCH?=
.endif

# old stuff
LIBOSSAUDIO?=	${DESTDIR}/usr/lib/libossaudio.a
LIBOTERMCAP?=	${DESTDIR}/usr/lib/libotermcap.a
LIBRESOLV?=	${DESTDIR}/usr/lib/libresolv.a

.ifdef	SHAREDSTRINGS
CLEANFILES+=	strings
.c.o:
	${CC} -E ${CFLAGS} ${.IMPSRC} | xstr -c -
	@@${CC} ${CFLAGS} -c x.c -o ${.TARGET}
	@@rm -f x.c

.cc.o:
	${CXX} -E ${CXXFLAGS} ${.IMPSRC} | xstr -c -
	@@mv -f x.c x.cc
	@@${CXX} ${CXXFLAGS} -c x.cc -o ${.TARGET}
	@@rm -f x.cc

.C.o:
	${CXX} -E ${CXXFLAGS} ${.IMPSRC} | xstr -c -
	@@mv -f x.c x.C
	@@${CXX} ${CXXFLAGS} -c x.C -o ${.TARGET}
	@@rm -f x.C

.cxx.o:
	${CXX} -E ${CXXFLAGS} ${.IMPSRC} | xstr -c -
	@@mv -f x.c x.cxx
	@@${CXX} ${CXXFLAGS} -c x.cxx -o ${.TARGET}
	@@rm -f x.cxx
.endif


.if defined(PROG) && !empty(PROG)
SRCS?=	${PROG}.c
.  if !empty(SRCS:N*.h:N*.sh)
OBJS+=	${SRCS:N*.h:N*.sh:R:S/$/.o/g}
LOBJS+=	${LSRCS:.c=.ln} ${SRCS:M*.c:.c=.ln}
.  endif

.  if !empty(SRCS:M*.C) || !empty(SRCS:M*.cc) || !empty(SRCS:M*.cxx)
LINKER?=${CXX}
.  else
LINKER?=${CC}
.  endif

.  if defined(OBJS) && !empty(OBJS)
${PROG}: ${LIBCRT0} ${OBJS} ${LIBC} ${CRTBEGIN} ${CRTEND} ${CRTI} ${CRTN} ${DPADD}
	${LINKER} ${LDFLAGS} ${LDSTATIC} -o ${.TARGET} ${OBJS} ${LDADD}
.  endif

MAN?=	${PROG}.1
.endif	# def/not empty PROG

.MAIN: all
all: ${PROG} _SUBDIRUSE

.if !target(clean)
clean: _SUBDIRUSE
	rm -f a.out [Ee]rrs mklog core *.core \
	    ${PROG} ${OBJS} ${LOBJS} ${CLEANFILES}
.endif

cleandir: _SUBDIRUSE clean
.if ${NOMAN:L} != "no"
	rm -f *.cat?
.endif

.if !target(install)
.  if !target(beforeinstall)
beforeinstall:
.  endif
.  if !target(afterinstall)
afterinstall:
.  endif

.  if !target(realinstall)
realinstall:
.    if defined(PROG) && !empty(PROG)
	${INSTALL} ${INSTALL_COPY} ${INSTALL_STRIP} -o ${BINOWN} -g ${BINGRP} \
	    -m ${BINMODE} ${PROG} ${DESTDIR}${BINDIR}
.    endif
.  endif

install: maninstall _SUBDIRUSE
.  if defined(LINKS) && !empty(LINKS)
.    for lnk file in ${LINKS}
	@@l=${DESTDIR}${lnk}; \
	 t=${DESTDIR}${file}; \
	 echo $$t -\> $$l; \
	 rm -f $$t; ln $$l $$t || cp $$l $$t
.    endfor
.  endif

maninstall: afterinstall
afterinstall: realinstall
realinstall: beforeinstall
.endif	# !target install

.if !target(lint)
.  if empty(LINTFLAGS:M-l*)
LINTFLAGS+=	-lstdc
.  endif
lint: ${LOBJS}
.  if defined(LOBJS) && !empty(LOBJS)
	@@${LINT} ${LINTFLAGS} ${LDFLAGS:M-L*} ${LOBJS} ${LDADD}
.  endif
.endif

.if ${NOMAN:L} == "no"
.  include <bsd.man.mk>
.endif

.include <bsd.obj.mk>
.include <bsd.dep.mk>
.include <bsd.subdir.mk>
.include <bsd.sys.mk>
@


1.25
log
@optimise by giving default values for ${NO*}
and nuking the defined(NO*) checks
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.24 2004/11/30 16:47:46 tg Exp $
d168 1
a168 1
	 rm -f $$t; ln $$l $$t
@


1.24
log
@remove NOPROFILE traces (we can't build profiled libs anyway)
switch NOMAN, NOLINT, NOPROG to yes/no logic (defaulting to yes if defined)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.23 2004/10/22 19:26:36 tg Exp $
d142 1
a142 1
.if defined(NOMAN) && ${NOMAN:L} != "no"
d187 1
a187 1
.if !defined(NOMAN) || ${NOMAN:L} == "no"
@


1.23
log
@merge most of the changes of recent OpenBSD appropriately for our goals
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.22 2004/10/14 22:28:58 tg Exp $
d142 1
a142 1
.ifdef	NOMAN
d187 1
a187 1
.ifndef	NOMAN
@


1.22
log
@some expat remnants
@
text
@d1 2
a2 2
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.21 2004/09/27 18:58:14 tg Exp $
# $OpenBSD: bsd.prog.mk,v 1.39 2004/06/03 20:51:07 miod Exp $
d118 3
d122 1
a124 6
.    if defined(DESTDIR)
${PROG}: ${LIBCRT0} ${OBJS} ${LIBC} ${CRTBEGIN} ${CRTEND} ${CRTI} ${CRTN} ${DPADD}
	${LINKER} ${LDFLAGS} ${LDSTATIC} -o ${.TARGET} -nostdlib \
	    -L${DESTDIR}/usr/lib ${CRTI} ${LIBCRT0} ${CRTBEGIN} \
	    ${OBJS} ${LDADD} -lgcc -lc -lgcc ${CRTEND} ${CRTN}
.    else
a126 1
.    endif
@


1.21
log
@give dave@@ and tyler@@ something to play with

how about
--default <arg> (to be selected, instead the first)
--timeout <arg> (waits <arg> seconds, then returns the default argument)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.20 2004/06/23 10:05:20 tg Stab $
d39 1
@


1.20
log
@merge
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.19 2004/06/16 15:44:31 tg Exp $
d32 1
@


1.19
log
@                             Tadaa!

                 MirSolutions proudly presents:
      The GNU Autoconf'd directory configure script wrapper

First, a simple attempt to convert the "easy" cases (CVS, RCS, Lynx)
and the one which _needs_ it (less) to <bsd.cfwrap.mk> - I said it
was impossible, but it's actually possible, tho hard.

More to follow.
@
text
@d1 2
a2 2
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.18 2004/06/15 14:19:36 tg Exp $
# $OpenBSD: bsd.prog.mk,v 1.38 2003/08/29 00:04:41 jolan Exp $
d70 3
a72 2
.if ${MACHINE_ARCH} == "i386"
LIBARCH?=	${DESTDIR}/usr/lib/libi386.a
@


1.18
log
@* use OBJECT_FMT (NetBSDish) rather than ELF_TOOLCHAIN, because
  the latter is a boolean, and we're probably going to support
  another format in addition to ELF, which is not a.out
* spacing, indenting
* fixes
* sync list of libraries with reality
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.17 2004/06/14 00:25:49 tg Exp $
d137 1
a137 1
	rm -f a.out [Ee]rrs mklog core *.core *.cat? \
d142 3
@


1.17
log
@First (probably not working[1]) attempt at modernizing the framework:
* MANZ, MANPS, NOPROFILE die (always set to false, false, true)
* Fortran generating code for <bsd.prog.mk> dies (pascal to follow)
* GLOBAL_AUTOCONF_CACHE dies (birth of <bsd.gnuwrap.mk> to follow...)
* sanitize my head and rewrite certain pieces of certain Makefiles
* move most mk.conf functionality out of there, so a system
  without mk.conf works really well(TM)
* attempt at synching docs with reality

[1] First update *.mk, then remove old mk.conf and mk.conf.local,
    then install new mk.conf and adapt it to suit your needs.

Why don't the OpenBSD people modernize parts of this? The indenting
is really really bad in places, and MANSUBDIR was... well. I have
done it with 1/3 of the code now, and it works. Even better.

There will definitively follow more ;-)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.16 2004/06/04 17:18:19 tg Exp $
d23 1
a23 1
.if ${ELF_TOOLCHAIN:L} == "yes"
d40 1
d49 2
d53 1
d58 1
d77 2
@


1.16
log
@add -lstdc to lint if not defined
(I don't know where all these errors come from, tho...
 probably one should wrap the function declarations
 inside posix/all/bsd_source ifdefs? someone?)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.15 2004/05/02 15:04:37 tg Exp $
d7 1
a7 1
.include "${.CURDIR}/../Makefile.inc"
d75 1
a75 1
CLEANFILES+=strings
d101 1
a101 1
.ifdef	PROG
d103 1
a103 1
.if !empty(SRCS:N*.h:N*.sh)
d106 1
a106 1
.endif
d110 2
a111 3
.if defined(OBJS) && !empty(OBJS)
.if defined(DESTDIR)

d116 1
a116 3

.else

d119 2
a120 3

.endif	# defined(DESTDIR)
.endif	# defined(OBJS) && !empty(OBJS)
d123 1
a123 1
.endif	# defined(PROG)
d137 1
a137 1
.if !target(beforeinstall)
d139 2
a140 2
.endif
.if !target(afterinstall)
d142 1
a142 1
.endif
d144 1
a144 1
.if !target(realinstall)
d146 1
a146 1
.if defined(PROG)
d149 2
a150 2
.endif
.endif
d153 2
a154 2
.if defined(LINKS) && !empty(LINKS)
.  for lnk file in ${LINKS}
d159 2
a160 2
.  endfor
.endif
d165 1
a165 1
.endif
d178 1
a178 1
.include <bsd.man.mk>
@


1.15
log
@mop up and add alternate linker support
(hmm, second time I've seen this. first time was... bloatzilla-firebird port)
@
text
@d1 1
a1 1
# $MirBSD: src/share/mk/bsd.prog.mk,v 1.14 2004/04/08 16:01:40 tg Exp $
d172 3
d176 1
a176 1
.if defined(LOBJS) && !empty(LOBJS)
d178 1
a178 1
.endif
@


1.14
log
@fix stuff, add pascal, add ${CFLAGS_target.o} and friends
@
text
@d1 1
a1 1
# $MirBSD: bsd.prog.mk,v 1.13 2004/01/29 21:32:59 tg Exp $
d23 1
a23 1
.if (${ELF_TOOLCHAIN:L} == "yes")
d74 1
a74 1
.if defined(SHAREDSTRINGS)
d101 1
a101 1
.if defined(PROG)
d108 2
d114 3
a116 1
	${CC} ${LDFLAGS} ${LDSTATIC} -o ${.TARGET} -nostdlib -L${DESTDIR}/usr/lib ${CRTI} ${LIBCRT0} ${CRTBEGIN} ${OBJS} ${LDADD} -lgcc -lc -lgcc ${CRTEND} ${CRTN}
d121 1
a121 1
	${CC} ${LDFLAGS} ${LDSTATIC} -o ${.TARGET} ${OBJS} ${LDADD}
d126 1
a126 3
.if	!defined(MAN)
MAN=	${PROG}.1
.endif	# !defined(MAN)
d178 1
a178 1
.if !defined(NOMAN)
@


1.13
log
@the first part of making a release (non-X)
* sync sets (for now)
* mention set sizes in INSTALL.i386
* install all files, but not more than wanted
* fix build time warnings
  (the mktemp in lpd is said to be safe)
* update docs a bit
* the eqn -> neqn move
* improved man page generation
* anoncvsbin removes tmp before making new symlink
* sendmail generated files are now in sendmail, and
  SKIPDIRS is checked before (asked for by Waldemar Brodkorb)
* more SKIPDIR checks, mostly for GNU stuff
@
text
@d1 1
a1 1
# $MirBSD: bsd.prog.mk,v 1.12 2004/01/16 23:39:10 tg Exp $
d38 4
d43 1
d48 1
d52 1
@


1.12
log
@shuffle set lists around (split out perl and egcs), as discussed with
Waldemar Brodkorb earlier
a full install still includes these sets, but think firewalls...

add (a bit of) protection around includes

NO_GCC3 flag
@
text
@d1 4
a4 4
#	$MirBSD: bsd.prog.mk,v 1.11 2003/10/26 22:32:15 tg Exp $
#	$OpenBSD: bsd.prog.mk,v 1.38 2003/08/29 00:04:41 jolan Exp $
#	$NetBSD: bsd.prog.mk,v 1.55 1996/04/08 21:19:26 jtc Exp $
#	@@(#)bsd.prog.mk	5.26 (Berkeley) 6/25/91
@


1.11
log
@* nuke some bsd.nls.mk includes
* add missing RCS IDs
* fix a small bug
* remove compatibility cruft

If something breaks, fix it. Don't revert this diff
(unless it's broken itself :)
@
text
@d1 1
a1 1
#	$MirBSD: bsd.prog.mk,v 1.10 2003/08/31 20:54:47 tg Exp $
d10 3
a12 1
.include <bsd.own.mk>
@


1.10
log
@Merge import of OpenBSD source, ports and XF4 tree.

While here,
o clean up differences where possible
o whitespace cleanup
o ifdef ./. if defined()
o '...' ./. "..."
o echo foo > bar ./. echo foo >bar
o `...` ./. $(...) ./. $$(...)
o `...' ./. '...'
o modernize "our" tree, e.g. WWW in ports
o fix some typos and brainos introduced when renaming OpenBSD to MirBSD
o use hardware 80387 by default
o migrate Apache 1.3.28 OpenBSD ./. MirBSD ./. KAME
o work around as many CVS bugs as possible (add back/delete files, ...)

Synchronize stuff, ready for ongoing changes.
@
text
@d1 1
a1 1
#	$MirBSD: bsd.prog.mk,v 1.9 2003/08/19 14:58:42 tg Exp $
a28 3
LIB45?=		${DESTDIR}/usr/lib/lib45.a
LIBACL?=	${DESTDIR}/usr/lib/libacl.a
LIBASN1?=	${DESTDIR}/usr/lib/libasn1.a
a36 7
LIBGSSAPI?=	${DESTDIR}/usr/lib/libgssapi.a
LIBHDB?=	${DESTDIR}/usr/lib/libhdb.a
LIBKADM?=	${DESTDIR}/usr/lib/libkadm.a
LIBKADM5CLNT?=	${DESTDIR}/usr/lib/libkadm5clnt.a
LIBKADM5SRV?=	${DESTDIR}/usr/lib/libkadm5srv.a
LIBKAFS?=	${DESTDIR}/usr/lib/libkafs.a
LIBKDB?=	${DESTDIR}/usr/lib/libkdb.a
a37 2
LIBKRB?=	${DESTDIR}/usr/lib/libkrb.a
LIBKRB5?=	${DESTDIR}/usr/lib/libkrb5.a
a47 1
LIBTELNET?=	${DESTDIR}/usr/lib/libtelnet.a
a62 4
LIBDBM?=	${DESTDIR}/usr/lib/libdbm.a
LIBMP?=		${DESTDIR}/usr/lib/libmp.a
LIBPC?=		${DESTDIR}/usr/lib/libpc.a
LIBPLOT?=	${DESTDIR}/usr/lib/libplot.a
@


1.9
log
@o there's a reason why .depend isn't cleaned by 'make clean',
  only by 'make cleandir'
o while here, nuke whitespace diff to openbsd
o while here, nuke NLS support
@
text
@d1 2
a2 2
#	$MirBSD: bsd.prog.mk,v 1.8 2003/08/17 18:56:10 tg Exp $
#	$OpenBSD: bsd.prog.mk,v 1.37 2003/08/11 17:31:51 jakob Exp $
a158 3
.endif
.if defined(HIDEGAME)
	(cd ${DESTDIR}/usr/games; rm -f ${PROG}; ln -s dm ${PROG})
@


1.8
log
@merge OpenBSD, remove a few 0x60
@
text
@d1 1
a1 1
#	$MirBSD: bsd.prog.mk,v 1.7 2003/07/18 19:20:46 tg Exp $
d140 1
a140 1
	rm -f a.out [Ee]rrs mklog core *.core *.cat? .depend \
d169 3
a171 3
	t=${DESTDIR}${file}; \
	echo $$t -\> $$l; \
	rm -f $$t; ln $$l $$t
a188 4
.endif

.if !defined(NONLS)
.include <bsd.nls.mk>
@


1.7
log
@die, die, die!
@
text
@d1 2
a2 2
#	$MirBSD: bsd.prog.mk,v 1.6 2003/07/09 19:03:08 tg Exp $
#	$OpenBSD: bsd.prog.mk,v 1.35 2003/07/08 13:59:13 espie Exp $
d40 1
@


1.6
log
@mop up, sweep clean
@
text
@d1 1
a1 1
#	$MirBSD: bsd.prog.mk,v 1.5 2003/07/08 14:20:36 tg Exp $
a32 1
LIBCOM_ERR?=	${DESTDIR}/usr/lib/libcom_err.a
@


1.5
log
@use :L for yes/no variables
@
text
@d1 2
a2 2
#	$MirBSD: bsd.prog.mk,v 1.4 2003/07/07 14:21:39 tg Exp $
#	$OpenBSD: bsd.prog.mk,v 1.34 2002/11/10 23:03:55 mickey Exp $
d15 2
a16 2
CFLAGS+=       ${CDIAGFLAGS}
CXXFLAGS+=     ${CXXDIAGFLAGS}
a21 1
CRTI?=		${DESTDIR}/usr/lib/crti.o
d24 1
d169 3
a171 3
	 t=${DESTDIR}${file}; \
	 echo $$t -\> $$l; \
	 rm -f $$t; ln $$l $$t
@


1.4
log
@crti/crtn
@
text
@d1 1
a1 1
#	$MirBSD: bsd.prog.mk,v 1.3 2003/03/23 21:52:12 tg Exp $
d21 1
a21 1
.if (${ELF_TOOLCHAIN} == "yes")
@


1.3
log
@Merge MirBSD-old entirely
Remove krb, yp, afs, GPL'd stuff in kernel
Adjust some other stuff

Not to be compiled yet...
@
text
@d1 1
a1 1
#	$MirBSD$
d22 4
a25 2
CRTBEGIN?=       ${DESTDIR}/usr/lib/crtbegin.o
CRTEND?=         ${DESTDIR}/usr/lib/crtend.o
d119 2
a120 2
${PROG}: ${LIBCRT0} ${OBJS} ${LIBC} ${CRTBEGIN} ${CRTEND} ${DPADD}
	${CC} ${LDFLAGS} ${LDSTATIC} -o ${.TARGET} -nostdlib -L${DESTDIR}/usr/lib ${LIBCRT0} ${CRTBEGIN} ${OBJS} ${LDADD} -lgcc -lc -lgcc ${CRTEND}
d124 1
a124 1
${PROG}: ${LIBCRT0} ${OBJS} ${LIBC} ${CRTBEGIN} ${CRTEND} ${DPADD}
@


1.2
log
@Include CURDIR whenever possible
@
text
@d1 1
d138 1
a138 1
	rm -f a.out [Ee]rrs mklog core *.core \
@


1.1
log
@Initial revision
@
text
@d18 1
a18 1
CXXFLAGS+=     ${CXXOPTS}
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Bring the entire base system and ports tree in sync with OpenBSD
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.prog.mk,v 1.35 2003/07/08 13:59:13 espie Exp $
d20 1
a20 1
.if (${ELF_TOOLCHAIN:L} == "yes")
@


1.1.1.3
log
@Synchronize source tree with OpenBSD
note: due to recent changes in the codebase of OpenBSD,
out libcom_err will be incompatible with theirs...
but this is no issue because we don't provide a dynamically
linked one, and theirs won't be provided longer any more anyways.
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.prog.mk,v 1.36 2003/07/16 01:29:34 deraadt Exp $
d30 1
@


1.1.1.4
log
@Import OpenBSD source tree from CVS (anoncvs canada)
of roughly 12:00 UTC today. Bumps us to OpenBSD 3.4
and makes source/ports in sync. Hopefully.
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.prog.mk,v 1.37 2003/08/11 17:31:51 jakob Exp $
a36 1
LIBGSSAPI?=	${DESTDIR}/usr/lib/libgssapi.a
@


1.1.1.5
log
@Synchronize with OpenBSD 3.4-beta
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.prog.mk,v 1.38 2003/08/29 00:04:41 jolan Exp $
d156 3
@


1.1.1.6
log
@updated Makefile includes
@
text
@d1 1
a1 1
#	$OpenBSD: bsd.prog.mk,v 1.39 2004/06/03 20:51:07 miod Exp $
d66 2
a67 3
.if (${MACHINE_ARCH} == "alpha" || ${MACHINE_ARCH} == "amd64" || \
     ${MACHINE_ARCH} == "i386")
LIBARCH?=	${DESTDIR}/usr/lib/lib${MACHINE_ARCH}.a
@


