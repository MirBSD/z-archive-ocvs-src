head	1.6;
access;
symbols
	lynx-2_8_6dev10:1.1.2.1
	FSF:1.1.2
	tg-mergetmp-mirosx-1:1.5
	tg-mergefixes-1-branch:1.5.0.8
	tg-mergefixes-1-base:1.5
	MIROS_X:1.5.0.6
	MIROS_X_BASE:1.5
	MIRBSD_XP_MIRPPC:1.5.0.4
	lynx-2_8_6dev_7b:1.1.3.3
	lynx-2_8_6dev_6:1.1.3.3
	MIRBSD_XP_SPARC_BASE:1.5
	MIRBSD_XP_SPARC:1.5.0.2
	lynx-2_8_6dev_5-iz2:1.1.3.3
	lynx-2_8_6dev_5:1.1.3.3
	cvs-200406091940:1.1.1.2
	MIRBSD_7quater:1.3
	cvs-200405160640:1.1.1.2
	lynx-2_8_6dev2:1.1.3.2
	lynx-2_8_5:1.1.3.1
	cvs-200401271800:1.1.1.2
	cvs-200401261630:1.1.1.2
	lynx_2-8-5_dev17d:1.1.3.1
	cvs-200401021645:1.1.1.2
	MIRBSD_7_ALPHA:1.3.0.6
	MIRBSD_7:1.3.0.4
	cvs-200312222040:1.1.1.2
	MIRBSD_7ter:1.3
	MIRBSD_7_DEV:1.3.0.2
	cvs-200310020700:1.1.1.2
	lynx_2-8-5_dev16c:1.1.3.1
	cvs-200309271030:1.1.1.2
	cvs-200309251530:1.1.1.2
	lynx_2-8-5_dev16:1.1.3.1
	tg:1.1.3
	cvs-200308302005:1.1.1.2
	cvs-200308171200:1.1.1.2
	ctm-3496:1.1.1.2
	ctm-3449:1.1.1.2
	ctm-3437:1.1.1.2
	cvs-200307191805:1.1.1.2
	ctm-3425:1.1.1.2
	cvs-200307091500:1.1.1.2
	VENDOR_LYNX_285dev16:1.3
	ctm-3389:1.1.1.2
	cvs-200306291430:1.1.1.2
	ctm-3341:1.1.1.2
	MIRBSD_5:1.1.1.2
	cvs-200306082100:1.1.1.2
	ctm-3316:1.1.1.2
	ctm-3272:1.1.1.2
	ctm-3264:1.1.1.2
	cvs-200305071630:1.1.1.2
	MIRBSD_4:1.1.1.1
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@ * @;


1.6
date	2005.01.03.00.45.58;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2004.07.15.18.16.57;	author tg;	state Stab;
branches;
next	1.4;

1.4
date	2004.04.30.16.32.34;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.07.07.18.58.35;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.07.07.18.49.32;	author tg;	state dead;
branches;
next	1.1;

1.1
date	2003.03.22.17.42.19;	author tg;	state Exp;
branches
	1.1.1.1
	1.1.2.1
	1.1.3.1;
next	;

1.1.1.1
date	2003.03.22.17.42.19;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.05.07.17.30.24;	author tg;	state Exp;
branches;
next	;

1.1.2.1
date	2005.01.03.00.30.56;	author tg;	state Exp;
branches;
next	;

1.1.3.1
date	2003.09.17.14.20.15;	author tg;	state Exp;
branches;
next	1.1.3.2;

1.1.3.2
date	2004.04.30.16.15.54;	author tg;	state Exp;
branches;
next	1.1.3.3;

1.1.3.3
date	2004.07.15.15.51.47;	author tg;	state Exp;
branches;
next	;


desc
@@


1.6
log
@soft merge
@
text
@#ifndef LYKEYMAP_H
#define LYKEYMAP_H

#include <HTUtils.h>
#include <HTList.h>
#include <LYCurses.h>

#ifdef __cplusplus
extern "C" {
#endif
    extern BOOLEAN LYisNonAlnumKeyname(int ch, int KeyName);
    extern HTList *LYcommandList(void);
    extern char *LYKeycodeToString(int c, BOOLEAN upper8);
    extern char *fmt_keys(int lkc_first, int lkc_second);
    extern char *key_for_func(int func);
    extern char *key_for_func_ext(int lac, int context_code);
    extern int LYReverseKeymap(int KeyName);
    extern int LYStringToKeycode(char *src);
    extern int lacname_to_lac(const char *func);
    extern int lecname_to_lec(const char *func);
    extern int lkcstring_to_lkc(const char *src);
    extern int remap(char *key, const char *func, BOOLEAN for_dired);
    extern void print_keymap(char **newfile);
    extern void reset_emacs_keys(void);
    extern void reset_numbers_as_arrows(void);
    extern void reset_vi_keys(void);
    extern void set_emacs_keys(void);
    extern void set_numbers_as_arrows(void);
    extern void set_vi_keys(void);
    extern void set_vms_keys(void);

/* We only use unsigned keycodes; if there's a problem matching with enum
 * (which is supposed to be 'int'), that would be okay, but not as clean
 * for type-checking.
 */
    typedef unsigned short LYKeymap_t;

#define KEYMAP_SIZE 661
    extern LYKeymap_t keymap[KEYMAP_SIZE];	/* main keymap matrix */

#ifdef EXP_KEYBOARD_LAYOUT
    typedef unsigned short LYKbLayout_t;
    extern int current_layout;
    extern LYKbLayout_t *LYKbLayouts[];
    extern const char *LYKbLayoutNames[];
    extern int LYSetKbLayout(char *layout_id);
#endif

#if defined(DIRED_SUPPORT) && defined(OK_OVERRIDE)
    extern LYKeymap_t key_override[];
#endif

/* * *  LynxKeyCodes  * * */
#define LKC_ISLECLAC	0x8000	/* flag: contains lynxaction + editaction */
#define LKC_MOD1	0x4000	/* a modifier bit - currently for ^x-map */
#define LKC_MOD2	0x2000	/* another one - currently for esc-map */
#define LKC_MOD3	0x1000	/* another one - currently for double-map */
#define LKC_ISLAC	0x0800	/* flag: lynxkeycode already lynxactioncode */

/* Used to distinguish internal Lynx keycodes of (say) extended ncurses once. */
#define LKC_ISLKC	0x0400	/* flag: already lynxkeycode (not native) */
    /* 0x0400  is MOUSE_KEYSYM for slang in LYStrings.c */
#define LKC_MASK	0x07FF	/* mask for lynxkeycode proper */

#define LKC_DONE	0x07FE	/* special value - operation done, not-a-key */

/* * *  LynxActionCodes  * * */
#define LAC_SHIFT	8	/* shift for lynxactioncode - must not
				   overwrite any assigned LYK_* values */
#define LAC_MASK	((1<<LAC_SHIFT)-1)
    /* mask for lynxactioncode - must cover all
       assigned LYK_* values */

/*  Return lkc masking single actioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LKC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    (((c) & LAC_MASK) | LKC_ISLAC))

/*  Return lynxeditactioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LEC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    ((((c)&~LKC_ISLECLAC)>>LAC_SHIFT) & LAC_MASK))

/*  Convert lynxkeycode to lynxactioncode.  Modifiers are dropped.  */
#define LKC_TO_LAC(ktab,c) (((c) == -1) ? ktab[0] : \
			    ((c) & (LKC_ISLECLAC|LKC_ISLAC)) ? ((c) & LAC_MASK) : \
			    ktab[((c) & LKC_MASK) + 1])

/*  Mask lynxactioncode as a lynxkeycode.  */
#define LAC_TO_LKC0(a) ((a)|LKC_ISLAC)

/*  Mask a lynxactioncode and an editactioncode as a lynxkeycode.  */
#define LACLEC_TO_LKC0(a,b) ((a)|((b)<<LAC_SHIFT)|LKC_ISLECLAC)

/*  Convert lynxactioncode to a lynxkeycode, attempting reverse mapping.  */
#define LAC_TO_LKC(a) ((LYReverseKeymap(a)>=0)?LYReverseKeymap(a):LAC_TO_LKC0(a))

/*  Simplify a lynxkeycode:
    attempt reverse mapping if a single masked lynxactioncode, drop modifiers.  */
#define LKC_TO_C(c) ((c&LKC_ISLECLAC)? c : (c&LKC_ISLAC)? LAC_TO_LKC(c&LAC_MASK) : (c&LKC_MASK))

#define LKC_HAS_ESC_MOD(c) (c >= 0 && !(c&LKC_ISLECLAC) && (c&LKC_MOD2))

/* *  The defined LynxActionCodes  * */

/* Variables for holding and passing around lynxactioncodes are generally of
 * type int, the types LYKeymap_t and LYKeymapCodes are currently only used for
 * the definitions.  That could change.  - kw
 *
 * The values in this enum are indexed against the command names in the
 * 'revmap[]' array in LYKeymap.c
 */
    typedef enum {
	LYK_UNKNOWN = 0
	,LYK_COMMAND
	,LYK_1
	,LYK_2
	,LYK_3
	,LYK_4
	,LYK_5
	,LYK_6
	,LYK_7
	,LYK_8
	,LYK_9
	,LYK_SOURCE
	,LYK_RELOAD
	,LYK_QUIT
	,LYK_ABORT
	,LYK_NEXT_PAGE
	,LYK_PREV_PAGE
	,LYK_UP_TWO
	,LYK_DOWN_TWO
	,LYK_UP_HALF
	,LYK_DOWN_HALF
	,LYK_REFRESH
	,LYK_HOME
	,LYK_END
	,LYK_FIRST_LINK
	,LYK_LAST_LINK
	,LYK_PREV_LINK
	,LYK_NEXT_LINK
	,LYK_LPOS_PREV_LINK
	,LYK_LPOS_NEXT_LINK
	,LYK_FASTBACKW_LINK
	,LYK_FASTFORW_LINK
	,LYK_UP_LINK
	,LYK_DOWN_LINK
	,LYK_RIGHT_LINK
	,LYK_LEFT_LINK
	,LYK_HISTORY
	,LYK_PREV_DOC
	,LYK_NEXT_DOC
	,LYK_ACTIVATE
	,LYK_SUBMIT		/* mostly like LYK_ACTIVATE, for mouse use, don't map */
	,LYK_GOTO
	,LYK_ECGOTO
	,LYK_HELP
	,LYK_DWIMHELP
	,LYK_INDEX
	,LYK_NOCACHE
	,LYK_INTERRUPT
	,LYK_MAIN_MENU
	,LYK_OPTIONS
	,LYK_INDEX_SEARCH
	,LYK_WHEREIS
	,LYK_PREV
	,LYK_NEXT
	,LYK_COMMENT
	,LYK_EDIT
	,LYK_INFO
	,LYK_PRINT
	,LYK_ADD_BOOKMARK
	,LYK_DEL_BOOKMARK
	,LYK_VIEW_BOOKMARK
	,LYK_VLINKS
	,LYK_SHELL
	,LYK_DOWNLOAD
	,LYK_TRACE_TOGGLE
	,LYK_TRACE_LOG
	,LYK_IMAGE_TOGGLE
	,LYK_INLINE_TOGGLE
	,LYK_HEAD
	,LYK_DO_NOTHING
	,LYK_TOGGLE_HELP
	,LYK_JUMP
	,LYK_KEYMAP
	,LYK_LIST
	,LYK_TOOLBAR
	,LYK_HISTORICAL
	,LYK_MINIMAL
	,LYK_SOFT_DQUOTES
	,LYK_RAW_TOGGLE
	,LYK_COOKIE_JAR
	,LYK_F_LINK_NUM
	,LYK_CLEAR_AUTH
	,LYK_SWITCH_DTD
	,LYK_ELGOTO
	,LYK_CHANGE_LINK
	,LYK_DWIMEDIT
	,LYK_EDIT_TEXTAREA
	,LYK_GROW_TEXTAREA
	,LYK_INSERT_FILE

#ifdef EXP_ADDRLIST_PAGE
	,LYK_ADDRLIST
#else
#define LYK_ADDRLIST      LYK_ADD_BOOKMARK
#endif

#ifdef USE_EXTERNALS
	,LYK_EXTERN_LINK
	,LYK_EXTERN_PAGE
#else
#define LYK_EXTERN_LINK   LYK_UNKNOWN
#define LYK_EXTERN_PAGE   LYK_UNKNOWN
#endif				/* !defined(USE_EXTERNALS) */

#if defined(VMS) || defined(DIRED_SUPPORT)
	,LYK_DIRED_MENU
#else
#define LYK_DIRED_MENU    LYK_UNKNOWN
#endif				/* VMS || DIRED_SUPPORT */

#ifdef DIRED_SUPPORT
	,LYK_CREATE
	,LYK_REMOVE
	,LYK_MODIFY
	,LYK_TAG_LINK
	,LYK_UPLOAD
	,LYK_INSTALL
#else
#define LYK_TAG_LINK      LYK_UNKNOWN
#endif				/* DIRED_SUPPORT */

	,LYK_CHG_CENTER

#ifdef KANJI_CODE_OVERRIDE
	,LYK_CHG_KCODE
#endif

#ifdef SUPPORT_CHDIR
	,LYK_CHDIR
#endif

#ifdef USE_CURSES_PADS
	,LYK_SHIFT_LEFT
	,LYK_SHIFT_RIGHT
	,LYK_LINEWRAP_TOGGLE
#else
#define LYK_SHIFT_LEFT      LYK_UNKNOWN
#define LYK_SHIFT_RIGHT     LYK_UNKNOWN
#define LYK_LINEWRAP_TOGGLE LYK_UNKNOWN
#endif

#ifdef CAN_CUT_AND_PASTE
	,LYK_PASTE_URL
	,LYK_TO_CLIPBOARD
#else
#define LYK_PASTE_URL      LYK_UNKNOWN
#define LYK_TO_CLIPBOARD   LYK_UNKNOWN
#endif

#ifdef EXP_NESTED_TABLES
	,LYK_NESTED_TABLES
#else
#define LYK_NESTED_TABLES  LYK_UNKNOWN
#endif

    } LYKeymapCode;

/*
 * Symbol table for internal commands.
 */
    typedef struct {
	LYKeymapCode code;
	const char *name;
	const char *doc;
    } Kcmd;

    extern Kcmd *LYKeycodeToKcmd(LYKeymapCode code);
    extern Kcmd *LYStringToKcmd(const char *name);

#ifdef __cplusplus
}
#endif
#endif				/* LYKEYMAP_H */
@


1.5
log
@automatic merge of lynx-current
@
text
@d8 23
a30 20
extern BOOLEAN LYisNonAlnumKeyname(int ch, int KeyName);
extern HTList *LYcommandList(void);
extern char *LYKeycodeToString(int c, BOOLEAN upper8);
extern char *fmt_keys(int lkc_first, int lkc_second);
extern char *key_for_func(int func);
extern char *key_for_func_ext(int lac, int context_code);
extern int LYReverseKeymap(int KeyName);
extern int LYStringToKeycode(char *src);
extern int lacname_to_lac(const char *func);
extern int lecname_to_lec(const char *func);
extern int lkcstring_to_lkc(const char *src);
extern int remap(char *key, char *func, BOOLEAN for_dired);
extern void print_keymap(char **newfile);
extern void reset_emacs_keys(void);
extern void reset_numbers_as_arrows(void);
extern void reset_vi_keys(void);
extern void set_emacs_keys(void);
extern void set_numbers_as_arrows(void);
extern void set_vi_keys(void);
extern void set_vms_keys(void);
d36 1
a36 1
typedef unsigned short LYKeymap_t;
d39 1
a39 1
extern LYKeymap_t keymap[KEYMAP_SIZE];	/* main keymap matrix */
d42 5
a46 5
typedef unsigned short LYKbLayout_t;
extern int current_layout;
extern LYKbLayout_t *LYKbLayouts[];
extern char *LYKbLayoutNames[];
extern int LYSetKbLayout(char *layout_id);
d50 1
a50 1
extern LYKeymap_t key_override[];
d62 1
a62 1
		     /* 0x0400  is MOUSE_KEYSYM for slang in LYStrings.c */
d71 2
a72 2
				/* mask for lynxactioncode - must cover all
				   assigned LYK_* values */
d111 90
a200 90
typedef enum {
    LYK_UNKNOWN = 0
    ,LYK_COMMAND
    ,LYK_1
    ,LYK_2
    ,LYK_3
    ,LYK_4
    ,LYK_5
    ,LYK_6
    ,LYK_7
    ,LYK_8
    ,LYK_9
    ,LYK_SOURCE
    ,LYK_RELOAD
    ,LYK_QUIT
    ,LYK_ABORT
    ,LYK_NEXT_PAGE
    ,LYK_PREV_PAGE
    ,LYK_UP_TWO
    ,LYK_DOWN_TWO
    ,LYK_UP_HALF
    ,LYK_DOWN_HALF
    ,LYK_REFRESH
    ,LYK_HOME
    ,LYK_END
    ,LYK_FIRST_LINK
    ,LYK_LAST_LINK
    ,LYK_PREV_LINK
    ,LYK_NEXT_LINK
    ,LYK_LPOS_PREV_LINK
    ,LYK_LPOS_NEXT_LINK
    ,LYK_FASTBACKW_LINK
    ,LYK_FASTFORW_LINK
    ,LYK_UP_LINK
    ,LYK_DOWN_LINK
    ,LYK_RIGHT_LINK
    ,LYK_LEFT_LINK
    ,LYK_HISTORY
    ,LYK_PREV_DOC
    ,LYK_NEXT_DOC
    ,LYK_ACTIVATE
    ,LYK_SUBMIT			/* mostly like LYK_ACTIVATE, for mouse use, don't map */
    ,LYK_GOTO
    ,LYK_ECGOTO
    ,LYK_HELP
    ,LYK_DWIMHELP
    ,LYK_INDEX
    ,LYK_NOCACHE
    ,LYK_INTERRUPT
    ,LYK_MAIN_MENU
    ,LYK_OPTIONS
    ,LYK_INDEX_SEARCH
    ,LYK_WHEREIS
    ,LYK_PREV
    ,LYK_NEXT
    ,LYK_COMMENT
    ,LYK_EDIT
    ,LYK_INFO
    ,LYK_PRINT
    ,LYK_ADD_BOOKMARK
    ,LYK_DEL_BOOKMARK
    ,LYK_VIEW_BOOKMARK
    ,LYK_VLINKS
    ,LYK_SHELL
    ,LYK_DOWNLOAD
    ,LYK_TRACE_TOGGLE
    ,LYK_TRACE_LOG
    ,LYK_IMAGE_TOGGLE
    ,LYK_INLINE_TOGGLE
    ,LYK_HEAD
    ,LYK_DO_NOTHING
    ,LYK_TOGGLE_HELP
    ,LYK_JUMP
    ,LYK_KEYMAP
    ,LYK_LIST
    ,LYK_TOOLBAR
    ,LYK_HISTORICAL
    ,LYK_MINIMAL
    ,LYK_SOFT_DQUOTES
    ,LYK_RAW_TOGGLE
    ,LYK_COOKIE_JAR
    ,LYK_F_LINK_NUM
    ,LYK_CLEAR_AUTH
    ,LYK_SWITCH_DTD
    ,LYK_ELGOTO
    ,LYK_CHANGE_LINK
    ,LYK_DWIMEDIT
    ,LYK_EDIT_TEXTAREA
    ,LYK_GROW_TEXTAREA
    ,LYK_INSERT_FILE
d203 1
a203 1
    ,LYK_ADDRLIST
d209 2
a210 2
    ,LYK_EXTERN_LINK
    ,LYK_EXTERN_PAGE
d217 1
a217 1
    ,LYK_DIRED_MENU
d223 6
a228 6
    ,LYK_CREATE
    ,LYK_REMOVE
    ,LYK_MODIFY
    ,LYK_TAG_LINK
    ,LYK_UPLOAD
    ,LYK_INSTALL
d233 1
a233 1
    ,LYK_CHG_CENTER
d236 1
a236 1
    ,LYK_CHG_KCODE
d240 1
a240 1
    ,LYK_CHDIR
d244 3
a246 3
    ,LYK_SHIFT_LEFT
    ,LYK_SHIFT_RIGHT
    ,LYK_LINEWRAP_TOGGLE
d254 2
a255 2
    ,LYK_PASTE_URL
    ,LYK_TO_CLIPBOARD
d262 1
a262 1
    ,LYK_NESTED_TABLES
d267 1
a267 1
} LYKeymapCode;
d272 5
a276 5
typedef struct {
    LYKeymapCode code;
    const char *name;
    const char *doc;
} Kcmd;
d278 2
a279 2
extern Kcmd *LYKeycodeToKcmd(LYKeymapCode code);
extern Kcmd *LYStringToKcmd(const char *name);
d281 4
a284 1
#endif /* LYKEYMAP_H */
@


1.4
log
@pretty much automatic merge of Lynx update
now, we live in an ANSI C world...
@
text
@d8 20
a27 20
extern BOOLEAN LYisNonAlnumKeyname (int ch, int KeyName);
extern HTList *LYcommandList (void);
extern char *LYKeycodeToString (int c, BOOLEAN upper8);
extern char *fmt_keys (int lkc_first, int lkc_second);
extern char *key_for_func (int func);
extern char *key_for_func_ext (int lac, int context_code);
extern int LYReverseKeymap (int KeyName);
extern int LYStringToKeycode (char *src);
extern int lacname_to_lac (const char *func);
extern int lecname_to_lec (const char *func);
extern int lkcstring_to_lkc (const char *src);
extern int remap (char *key, char *func, BOOLEAN for_dired);
extern void print_keymap (char **newfile);
extern void reset_emacs_keys (void);
extern void reset_numbers_as_arrows (void);
extern void reset_vi_keys (void);
extern void set_emacs_keys (void);
extern void set_numbers_as_arrows (void);
extern void set_vi_keys (void);
extern void set_vms_keys (void);
d36 1
a36 1
extern LYKeymap_t keymap[KEYMAP_SIZE]; /* main keymap matrix */
d41 3
a43 3
extern LYKbLayout_t * LYKbLayouts[];
extern char * LYKbLayoutNames[];
extern int LYSetKbLayout (char *layout_id);
a83 1

a98 1

d101 3
a103 3
/*  Variables for holding and passing around lynxactioncodes are
 *  generally of type int, the types LYKeymap_t and LYKeymapCodes
 *  are currently only used for the definitions.  That could change. - kw
d105 2
a106 2
 *  The values in this enum are indexed against the command names in the
 *  'revmap[]' array in LYKeymap.c
d109 89
a197 89
    LYK_UNKNOWN=0
  , LYK_COMMAND
  , LYK_1
  , LYK_2
  , LYK_3
  , LYK_4
  , LYK_5
  , LYK_6
  , LYK_7
  , LYK_8
  , LYK_9
  , LYK_SOURCE
  , LYK_RELOAD
  , LYK_QUIT
  , LYK_ABORT
  , LYK_NEXT_PAGE
  , LYK_PREV_PAGE
  , LYK_UP_TWO
  , LYK_DOWN_TWO
  , LYK_UP_HALF
  , LYK_DOWN_HALF
  , LYK_REFRESH
  , LYK_HOME
  , LYK_END
  , LYK_FIRST_LINK
  , LYK_LAST_LINK
  , LYK_PREV_LINK
  , LYK_NEXT_LINK
  , LYK_LPOS_PREV_LINK
  , LYK_LPOS_NEXT_LINK
  , LYK_FASTBACKW_LINK
  , LYK_FASTFORW_LINK
  , LYK_UP_LINK
  , LYK_DOWN_LINK
  , LYK_RIGHT_LINK
  , LYK_LEFT_LINK
  , LYK_HISTORY
  , LYK_PREV_DOC
  , LYK_NEXT_DOC
  , LYK_ACTIVATE
  , LYK_SUBMIT	/* mostly like LYK_ACTIVATE, for mouse use, don't map */
  , LYK_GOTO
  , LYK_ECGOTO
  , LYK_HELP
  , LYK_DWIMHELP
  , LYK_INDEX
  , LYK_NOCACHE
  , LYK_INTERRUPT
  , LYK_MAIN_MENU
  , LYK_OPTIONS
  , LYK_INDEX_SEARCH
  , LYK_WHEREIS
  , LYK_PREV
  , LYK_NEXT
  , LYK_COMMENT
  , LYK_EDIT
  , LYK_INFO
  , LYK_PRINT
  , LYK_ADD_BOOKMARK
  , LYK_DEL_BOOKMARK
  , LYK_VIEW_BOOKMARK
  , LYK_VLINKS
  , LYK_SHELL
  , LYK_DOWNLOAD
  , LYK_TRACE_TOGGLE
  , LYK_TRACE_LOG
  , LYK_IMAGE_TOGGLE
  , LYK_INLINE_TOGGLE
  , LYK_HEAD
  , LYK_DO_NOTHING
  , LYK_TOGGLE_HELP
  , LYK_JUMP
  , LYK_KEYMAP
  , LYK_LIST
  , LYK_TOOLBAR
  , LYK_HISTORICAL
  , LYK_MINIMAL
  , LYK_SOFT_DQUOTES
  , LYK_RAW_TOGGLE
  , LYK_COOKIE_JAR
  , LYK_F_LINK_NUM
  , LYK_CLEAR_AUTH
  , LYK_SWITCH_DTD
  , LYK_ELGOTO
  , LYK_CHANGE_LINK
  , LYK_DWIMEDIT
  , LYK_EDIT_TEXTAREA
  , LYK_GROW_TEXTAREA
  , LYK_INSERT_FILE
d200 1
a200 1
  , LYK_ADDRLIST
d206 2
a207 2
  , LYK_EXTERN_LINK
  , LYK_EXTERN_PAGE
d211 1
a211 1
#endif /* !defined(USE_EXTERNALS) */
d214 1
a214 1
  , LYK_DIRED_MENU
d217 1
a217 1
#endif /* VMS || DIRED_SUPPORT */
d220 6
a225 6
  , LYK_CREATE
  , LYK_REMOVE
  , LYK_MODIFY
  , LYK_TAG_LINK
  , LYK_UPLOAD
  , LYK_INSTALL
d228 1
a228 1
#endif /* DIRED_SUPPORT */
d230 1
a230 1
  , LYK_CHG_CENTER
d233 1
a233 1
  , LYK_CHG_KCODE
d237 1
a237 1
  , LYK_CHDIR
d241 3
a243 3
  , LYK_SHIFT_LEFT
  , LYK_SHIFT_RIGHT
  , LYK_LINEWRAP_TOGGLE
d251 2
a252 2
  , LYK_PASTE_URL
  , LYK_TO_CLIPBOARD
d259 1
a259 1
  , LYK_NESTED_TABLES
d270 3
a272 3
	LYKeymapCode code;
	const char *name;
	const char *doc;
d275 2
a276 2
extern Kcmd * LYKeycodeToKcmd (LYKeymapCode code);
extern Kcmd * LYStringToKcmd (const char * name);
@


1.3
log
@un-tar the file
>>> lynx2.8.5dev.16.tar.gz
from http://lynx.isc.org/current/

the following files need -kb:
- LYStyle.c
- Xsystem.c
- WWW HTMIME.c
@
text
@d8 20
a27 20
extern BOOLEAN LYisNonAlnumKeyname PARAMS((int ch, int KeyName));
extern HTList *LYcommandList NOPARAMS;
extern char *LYKeycodeToString PARAMS((int c, BOOLEAN upper8));
extern char *fmt_keys PARAMS((int lkc_first, int lkc_second));
extern char *key_for_func PARAMS((int func));
extern char *key_for_func_ext PARAMS((int lac, int context_code));
extern int LYReverseKeymap PARAMS((int KeyName));
extern int LYStringToKeycode PARAMS((char *src));
extern int lacname_to_lac PARAMS((CONST char *func));
extern int lecname_to_lec PARAMS((CONST char *func));
extern int lkcstring_to_lkc PARAMS((CONST char *src));
extern int remap PARAMS((char *key, char *func, BOOLEAN for_dired));
extern void print_keymap PARAMS((char **newfile));
extern void reset_emacs_keys NOPARAMS;
extern void reset_numbers_as_arrows NOPARAMS;
extern void reset_vi_keys NOPARAMS;
extern void set_emacs_keys NOPARAMS;
extern void set_numbers_as_arrows NOPARAMS;
extern void set_vi_keys NOPARAMS;
extern void set_vms_keys NOPARAMS;
d43 1
a43 1
extern int LYSetKbLayout PARAMS((char *layout_id));
d273 2
a274 2
	CONST char *name;
	CONST char *doc;
d277 2
a278 2
extern Kcmd * LYKeycodeToKcmd PARAMS((LYKeymapCode code));
extern Kcmd * LYStringToKcmd PARAMS((CONST char * name));
@


1.2
log
@remove lynx 2.8.4 patchlevel 1d
@
text
@a3 1
#ifndef HTUTILS_H
d5 2
a6 1
#endif
d8 4
a11 1
extern BOOLEAN LYisNonAlnumKeyname PARAMS((int ch, int key_name));
d13 7
a19 3
extern int LYReverseKeymap PARAMS((int key_name));
extern int lookup_keymap PARAMS((int code));
extern int remap PARAMS((char *key, char *func));
d39 1
d41 1
a41 1
extern LYKeymap_t * LYKbLayouts[];
d50 60
a109 1
/* The order of this enum must match the 'revmap[]' array in LYKeymap.c */
d112 1
a123 1
  , LYK_PIPE
d135 2
d139 2
d149 1
d151 1
d155 1
d163 1
d196 1
d208 5
a212 1
  , LYK_EXTERN
d232 44
a275 1
} LYKeymapCodes;
d277 2
@


1.1
log
@Initial revision
@
text
@@


1.1.2.1
log
@Lynx 2.8.6dev.10 as imported into ncvs
@
text
@d4 1
d6 1
a6 2
#include <HTList.h>
#include <LYCurses.h>
d8 13
a20 23
#ifdef __cplusplus
extern "C" {
#endif
    extern BOOLEAN LYisNonAlnumKeyname(int ch, int KeyName);
    extern HTList *LYcommandList(void);
    extern char *LYKeycodeToString(int c, BOOLEAN upper8);
    extern char *fmt_keys(int lkc_first, int lkc_second);
    extern char *key_for_func(int func);
    extern char *key_for_func_ext(int lac, int context_code);
    extern int LYReverseKeymap(int KeyName);
    extern int LYStringToKeycode(char *src);
    extern int lacname_to_lac(const char *func);
    extern int lecname_to_lec(const char *func);
    extern int lkcstring_to_lkc(const char *src);
    extern int remap(char *key, const char *func, BOOLEAN for_dired);
    extern void print_keymap(char **newfile);
    extern void reset_emacs_keys(void);
    extern void reset_numbers_as_arrows(void);
    extern void reset_vi_keys(void);
    extern void set_emacs_keys(void);
    extern void set_numbers_as_arrows(void);
    extern void set_vi_keys(void);
    extern void set_vms_keys(void);
d26 1
a26 1
    typedef unsigned short LYKeymap_t;
d29 1
a29 1
    extern LYKeymap_t keymap[KEYMAP_SIZE];	/* main keymap matrix */
d32 4
a35 5
    typedef unsigned short LYKbLayout_t;
    extern int current_layout;
    extern LYKbLayout_t *LYKbLayouts[];
    extern const char *LYKbLayoutNames[];
    extern int LYSetKbLayout(char *layout_id);
d39 1
a39 1
    extern LYKeymap_t key_override[];
d42 82
a123 148
/* * *  LynxKeyCodes  * * */
#define LKC_ISLECLAC	0x8000	/* flag: contains lynxaction + editaction */
#define LKC_MOD1	0x4000	/* a modifier bit - currently for ^x-map */
#define LKC_MOD2	0x2000	/* another one - currently for esc-map */
#define LKC_MOD3	0x1000	/* another one - currently for double-map */
#define LKC_ISLAC	0x0800	/* flag: lynxkeycode already lynxactioncode */

/* Used to distinguish internal Lynx keycodes of (say) extended ncurses once. */
#define LKC_ISLKC	0x0400	/* flag: already lynxkeycode (not native) */
    /* 0x0400  is MOUSE_KEYSYM for slang in LYStrings.c */
#define LKC_MASK	0x07FF	/* mask for lynxkeycode proper */

#define LKC_DONE	0x07FE	/* special value - operation done, not-a-key */

/* * *  LynxActionCodes  * * */
#define LAC_SHIFT	8	/* shift for lynxactioncode - must not
				   overwrite any assigned LYK_* values */
#define LAC_MASK	((1<<LAC_SHIFT)-1)
    /* mask for lynxactioncode - must cover all
       assigned LYK_* values */

/*  Return lkc masking single actioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LKC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    (((c) & LAC_MASK) | LKC_ISLAC))

/*  Return lynxeditactioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LEC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    ((((c)&~LKC_ISLECLAC)>>LAC_SHIFT) & LAC_MASK))

/*  Convert lynxkeycode to lynxactioncode.  Modifiers are dropped.  */
#define LKC_TO_LAC(ktab,c) (((c) == -1) ? ktab[0] : \
			    ((c) & (LKC_ISLECLAC|LKC_ISLAC)) ? ((c) & LAC_MASK) : \
			    ktab[((c) & LKC_MASK) + 1])

/*  Mask lynxactioncode as a lynxkeycode.  */
#define LAC_TO_LKC0(a) ((a)|LKC_ISLAC)

/*  Mask a lynxactioncode and an editactioncode as a lynxkeycode.  */
#define LACLEC_TO_LKC0(a,b) ((a)|((b)<<LAC_SHIFT)|LKC_ISLECLAC)

/*  Convert lynxactioncode to a lynxkeycode, attempting reverse mapping.  */
#define LAC_TO_LKC(a) ((LYReverseKeymap(a)>=0)?LYReverseKeymap(a):LAC_TO_LKC0(a))

/*  Simplify a lynxkeycode:
    attempt reverse mapping if a single masked lynxactioncode, drop modifiers.  */
#define LKC_TO_C(c) ((c&LKC_ISLECLAC)? c : (c&LKC_ISLAC)? LAC_TO_LKC(c&LAC_MASK) : (c&LKC_MASK))

#define LKC_HAS_ESC_MOD(c) (c >= 0 && !(c&LKC_ISLECLAC) && (c&LKC_MOD2))

/* *  The defined LynxActionCodes  * */

/* Variables for holding and passing around lynxactioncodes are generally of
 * type int, the types LYKeymap_t and LYKeymapCodes are currently only used for
 * the definitions.  That could change.  - kw
 *
 * The values in this enum are indexed against the command names in the
 * 'revmap[]' array in LYKeymap.c
 */
    typedef enum {
	LYK_UNKNOWN = 0
	,LYK_COMMAND
	,LYK_1
	,LYK_2
	,LYK_3
	,LYK_4
	,LYK_5
	,LYK_6
	,LYK_7
	,LYK_8
	,LYK_9
	,LYK_SOURCE
	,LYK_RELOAD
	,LYK_QUIT
	,LYK_ABORT
	,LYK_NEXT_PAGE
	,LYK_PREV_PAGE
	,LYK_UP_TWO
	,LYK_DOWN_TWO
	,LYK_UP_HALF
	,LYK_DOWN_HALF
	,LYK_REFRESH
	,LYK_HOME
	,LYK_END
	,LYK_FIRST_LINK
	,LYK_LAST_LINK
	,LYK_PREV_LINK
	,LYK_NEXT_LINK
	,LYK_LPOS_PREV_LINK
	,LYK_LPOS_NEXT_LINK
	,LYK_FASTBACKW_LINK
	,LYK_FASTFORW_LINK
	,LYK_UP_LINK
	,LYK_DOWN_LINK
	,LYK_RIGHT_LINK
	,LYK_LEFT_LINK
	,LYK_HISTORY
	,LYK_PREV_DOC
	,LYK_NEXT_DOC
	,LYK_ACTIVATE
	,LYK_SUBMIT		/* mostly like LYK_ACTIVATE, for mouse use, don't map */
	,LYK_GOTO
	,LYK_ECGOTO
	,LYK_HELP
	,LYK_DWIMHELP
	,LYK_INDEX
	,LYK_NOCACHE
	,LYK_INTERRUPT
	,LYK_MAIN_MENU
	,LYK_OPTIONS
	,LYK_INDEX_SEARCH
	,LYK_WHEREIS
	,LYK_PREV
	,LYK_NEXT
	,LYK_COMMENT
	,LYK_EDIT
	,LYK_INFO
	,LYK_PRINT
	,LYK_ADD_BOOKMARK
	,LYK_DEL_BOOKMARK
	,LYK_VIEW_BOOKMARK
	,LYK_VLINKS
	,LYK_SHELL
	,LYK_DOWNLOAD
	,LYK_TRACE_TOGGLE
	,LYK_TRACE_LOG
	,LYK_IMAGE_TOGGLE
	,LYK_INLINE_TOGGLE
	,LYK_HEAD
	,LYK_DO_NOTHING
	,LYK_TOGGLE_HELP
	,LYK_JUMP
	,LYK_KEYMAP
	,LYK_LIST
	,LYK_TOOLBAR
	,LYK_HISTORICAL
	,LYK_MINIMAL
	,LYK_SOFT_DQUOTES
	,LYK_RAW_TOGGLE
	,LYK_COOKIE_JAR
	,LYK_F_LINK_NUM
	,LYK_CLEAR_AUTH
	,LYK_SWITCH_DTD
	,LYK_ELGOTO
	,LYK_CHANGE_LINK
	,LYK_DWIMEDIT
	,LYK_EDIT_TEXTAREA
	,LYK_GROW_TEXTAREA
	,LYK_INSERT_FILE
d126 1
a126 1
	,LYK_ADDRLIST
d132 2
a133 6
	,LYK_EXTERN_LINK
	,LYK_EXTERN_PAGE
#else
#define LYK_EXTERN_LINK   LYK_UNKNOWN
#define LYK_EXTERN_PAGE   LYK_UNKNOWN
#endif				/* !defined(USE_EXTERNALS) */
d136 1
a136 1
	,LYK_DIRED_MENU
d139 1
a139 1
#endif				/* VMS || DIRED_SUPPORT */
d142 6
a147 6
	,LYK_CREATE
	,LYK_REMOVE
	,LYK_MODIFY
	,LYK_TAG_LINK
	,LYK_UPLOAD
	,LYK_INSTALL
d150 1
a150 1
#endif				/* DIRED_SUPPORT */
d152 1
a152 1
	,LYK_CHG_CENTER
a153 3
#ifdef KANJI_CODE_OVERRIDE
	,LYK_CHG_KCODE
#endif
d155 1
a155 46
#ifdef SUPPORT_CHDIR
	,LYK_CHDIR
#endif

#ifdef USE_CURSES_PADS
	,LYK_SHIFT_LEFT
	,LYK_SHIFT_RIGHT
	,LYK_LINEWRAP_TOGGLE
#else
#define LYK_SHIFT_LEFT      LYK_UNKNOWN
#define LYK_SHIFT_RIGHT     LYK_UNKNOWN
#define LYK_LINEWRAP_TOGGLE LYK_UNKNOWN
#endif

#ifdef CAN_CUT_AND_PASTE
	,LYK_PASTE_URL
	,LYK_TO_CLIPBOARD
#else
#define LYK_PASTE_URL      LYK_UNKNOWN
#define LYK_TO_CLIPBOARD   LYK_UNKNOWN
#endif

#ifdef EXP_NESTED_TABLES
	,LYK_NESTED_TABLES
#else
#define LYK_NESTED_TABLES  LYK_UNKNOWN
#endif

    } LYKeymapCode;

/*
 * Symbol table for internal commands.
 */
    typedef struct {
	LYKeymapCode code;
	const char *name;
	const char *doc;
    } Kcmd;

    extern Kcmd *LYKeycodeToKcmd(LYKeymapCode code);
    extern Kcmd *LYStringToKcmd(const char *name);

#ifdef __cplusplus
}
#endif
#endif				/* LYKEYMAP_H */
@


1.1.3.1
log
@Import Lynx 2.8.5.dev16 again, this time via a vendor branch (tg),
to ease tracking of the upcoming dev17 (2.8.6-prerelease) update.
@
text
@d4 1
d6 1
a6 2
#include <HTList.h>
#include <LYCurses.h>
d8 1
a8 4
extern BOOLEAN LYisNonAlnumKeyname PARAMS((int ch, int KeyName));
extern HTList *LYcommandList NOPARAMS;
extern char *LYKeycodeToString PARAMS((int c, BOOLEAN upper8));
extern char *fmt_keys PARAMS((int lkc_first, int lkc_second));
d10 3
a12 7
extern char *key_for_func_ext PARAMS((int lac, int context_code));
extern int LYReverseKeymap PARAMS((int KeyName));
extern int LYStringToKeycode PARAMS((char *src));
extern int lacname_to_lac PARAMS((CONST char *func));
extern int lecname_to_lec PARAMS((CONST char *func));
extern int lkcstring_to_lkc PARAMS((CONST char *src));
extern int remap PARAMS((char *key, char *func, BOOLEAN for_dired));
a31 1
typedef unsigned short LYKbLayout_t;
d33 1
a33 1
extern LYKbLayout_t * LYKbLayouts[];
d42 1
a42 60
/* * *  LynxKeyCodes  * * */
#define LKC_ISLECLAC	0x8000	/* flag: contains lynxaction + editaction */
#define LKC_MOD1	0x4000	/* a modifier bit - currently for ^x-map */
#define LKC_MOD2	0x2000	/* another one - currently for esc-map */
#define LKC_MOD3	0x1000	/* another one - currently for double-map */
#define LKC_ISLAC	0x0800	/* flag: lynxkeycode already lynxactioncode */

/* Used to distinguish internal Lynx keycodes of (say) extended ncurses once. */
#define LKC_ISLKC	0x0400	/* flag: already lynxkeycode (not native) */
		     /* 0x0400  is MOUSE_KEYSYM for slang in LYStrings.c */
#define LKC_MASK	0x07FF	/* mask for lynxkeycode proper */

#define LKC_DONE	0x07FE	/* special value - operation done, not-a-key */

/* * *  LynxActionCodes  * * */
#define LAC_SHIFT	8	/* shift for lynxactioncode - must not
				   overwrite any assigned LYK_* values */
#define LAC_MASK	((1<<LAC_SHIFT)-1)
				/* mask for lynxactioncode - must cover all
				   assigned LYK_* values */

/*  Return lkc masking single actioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LKC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    (((c) & LAC_MASK) | LKC_ISLAC))

/*  Return lynxeditactioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LEC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    ((((c)&~LKC_ISLECLAC)>>LAC_SHIFT) & LAC_MASK))

/*  Convert lynxkeycode to lynxactioncode.  Modifiers are dropped.  */
#define LKC_TO_LAC(ktab,c) (((c) == -1) ? ktab[0] : \
			    ((c) & (LKC_ISLECLAC|LKC_ISLAC)) ? ((c) & LAC_MASK) : \
			    ktab[((c) & LKC_MASK) + 1])


/*  Mask lynxactioncode as a lynxkeycode.  */
#define LAC_TO_LKC0(a) ((a)|LKC_ISLAC)

/*  Mask a lynxactioncode and an editactioncode as a lynxkeycode.  */
#define LACLEC_TO_LKC0(a,b) ((a)|((b)<<LAC_SHIFT)|LKC_ISLECLAC)

/*  Convert lynxactioncode to a lynxkeycode, attempting reverse mapping.  */
#define LAC_TO_LKC(a) ((LYReverseKeymap(a)>=0)?LYReverseKeymap(a):LAC_TO_LKC0(a))

/*  Simplify a lynxkeycode:
    attempt reverse mapping if a single masked lynxactioncode, drop modifiers.  */
#define LKC_TO_C(c) ((c&LKC_ISLECLAC)? c : (c&LKC_ISLAC)? LAC_TO_LKC(c&LAC_MASK) : (c&LKC_MASK))

#define LKC_HAS_ESC_MOD(c) (c >= 0 && !(c&LKC_ISLECLAC) && (c&LKC_MOD2))


/* *  The defined LynxActionCodes  * */

/*  Variables for holding and passing around lynxactioncodes are
 *  generally of type int, the types LYKeymap_t and LYKeymapCodes
 *  are currently only used for the definitions.  That could change. - kw
 *
 *  The values in this enum are indexed against the command names in the
 *  'revmap[]' array in LYKeymap.c
 */
a44 1
  , LYK_COMMAND
d56 1
a67 2
  , LYK_FIRST_LINK
  , LYK_LAST_LINK
a69 2
  , LYK_LPOS_PREV_LINK
  , LYK_LPOS_NEXT_LINK
a77 1
  , LYK_NEXT_DOC
a78 1
  , LYK_SUBMIT	/* mostly like LYK_ACTIVATE, for mouse use, don't map */
a81 1
  , LYK_DWIMHELP
a88 1
  , LYK_PREV
a120 1
  , LYK_DWIMEDIT
d132 1
a132 5
  , LYK_EXTERN_LINK
  , LYK_EXTERN_PAGE
#else
#define LYK_EXTERN_LINK   LYK_UNKNOWN
#define LYK_EXTERN_PAGE   LYK_UNKNOWN
d152 1
a152 44
  , LYK_CHG_CENTER

#ifdef KANJI_CODE_OVERRIDE
  , LYK_CHG_KCODE
#endif

#ifdef SUPPORT_CHDIR
  , LYK_CHDIR
#endif

#ifdef USE_CURSES_PADS
  , LYK_SHIFT_LEFT
  , LYK_SHIFT_RIGHT
  , LYK_LINEWRAP_TOGGLE
#else
#define LYK_SHIFT_LEFT      LYK_UNKNOWN
#define LYK_SHIFT_RIGHT     LYK_UNKNOWN
#define LYK_LINEWRAP_TOGGLE LYK_UNKNOWN
#endif

#ifdef CAN_CUT_AND_PASTE
  , LYK_PASTE_URL
  , LYK_TO_CLIPBOARD
#else
#define LYK_PASTE_URL      LYK_UNKNOWN
#define LYK_TO_CLIPBOARD   LYK_UNKNOWN
#endif

#ifdef EXP_NESTED_TABLES
  , LYK_NESTED_TABLES
#else
#define LYK_NESTED_TABLES  LYK_UNKNOWN
#endif

} LYKeymapCode;

/*
 * Symbol table for internal commands.
 */
typedef struct {
	LYKeymapCode code;
	CONST char *name;
	CONST char *doc;
} Kcmd;
a153 2
extern Kcmd * LYKeycodeToKcmd PARAMS((LYKeymapCode code));
extern Kcmd * LYStringToKcmd PARAMS((CONST char * name));
@


1.1.3.2
log
@A three-days old development version of Lynx, the best web browser ever,
which follows the OpenBSD paradigma to only provide high-quality, func-
tional snapshots.
@
text
@d8 20
a27 20
extern BOOLEAN LYisNonAlnumKeyname (int ch, int KeyName);
extern HTList *LYcommandList (void);
extern char *LYKeycodeToString (int c, BOOLEAN upper8);
extern char *fmt_keys (int lkc_first, int lkc_second);
extern char *key_for_func (int func);
extern char *key_for_func_ext (int lac, int context_code);
extern int LYReverseKeymap (int KeyName);
extern int LYStringToKeycode (char *src);
extern int lacname_to_lac (const char *func);
extern int lecname_to_lec (const char *func);
extern int lkcstring_to_lkc (const char *src);
extern int remap (char *key, char *func, BOOLEAN for_dired);
extern void print_keymap (char **newfile);
extern void reset_emacs_keys (void);
extern void reset_numbers_as_arrows (void);
extern void reset_vi_keys (void);
extern void set_emacs_keys (void);
extern void set_numbers_as_arrows (void);
extern void set_vi_keys (void);
extern void set_vms_keys (void);
d43 1
a43 1
extern int LYSetKbLayout (char *layout_id);
d273 2
a274 2
	const char *name;
	const char *doc;
d277 2
a278 2
extern Kcmd * LYKeycodeToKcmd (LYKeymapCode code);
extern Kcmd * LYStringToKcmd (const char * name);
@


1.1.3.3
log
@Lynx 2.8.6dev.5 fresh from the ISC
@
text
@d8 20
a27 20
extern BOOLEAN LYisNonAlnumKeyname(int ch, int KeyName);
extern HTList *LYcommandList(void);
extern char *LYKeycodeToString(int c, BOOLEAN upper8);
extern char *fmt_keys(int lkc_first, int lkc_second);
extern char *key_for_func(int func);
extern char *key_for_func_ext(int lac, int context_code);
extern int LYReverseKeymap(int KeyName);
extern int LYStringToKeycode(char *src);
extern int lacname_to_lac(const char *func);
extern int lecname_to_lec(const char *func);
extern int lkcstring_to_lkc(const char *src);
extern int remap(char *key, char *func, BOOLEAN for_dired);
extern void print_keymap(char **newfile);
extern void reset_emacs_keys(void);
extern void reset_numbers_as_arrows(void);
extern void reset_vi_keys(void);
extern void set_emacs_keys(void);
extern void set_numbers_as_arrows(void);
extern void set_vi_keys(void);
extern void set_vms_keys(void);
d36 1
a36 1
extern LYKeymap_t keymap[KEYMAP_SIZE];	/* main keymap matrix */
d41 3
a43 3
extern LYKbLayout_t *LYKbLayouts[];
extern char *LYKbLayoutNames[];
extern int LYSetKbLayout(char *layout_id);
d84 1
d100 1
d103 3
a105 3
/* Variables for holding and passing around lynxactioncodes are generally of
 * type int, the types LYKeymap_t and LYKeymapCodes are currently only used for
 * the definitions.  That could change.  - kw
d107 2
a108 2
 * The values in this enum are indexed against the command names in the
 * 'revmap[]' array in LYKeymap.c
d111 89
a199 89
    LYK_UNKNOWN = 0
    ,LYK_COMMAND
    ,LYK_1
    ,LYK_2
    ,LYK_3
    ,LYK_4
    ,LYK_5
    ,LYK_6
    ,LYK_7
    ,LYK_8
    ,LYK_9
    ,LYK_SOURCE
    ,LYK_RELOAD
    ,LYK_QUIT
    ,LYK_ABORT
    ,LYK_NEXT_PAGE
    ,LYK_PREV_PAGE
    ,LYK_UP_TWO
    ,LYK_DOWN_TWO
    ,LYK_UP_HALF
    ,LYK_DOWN_HALF
    ,LYK_REFRESH
    ,LYK_HOME
    ,LYK_END
    ,LYK_FIRST_LINK
    ,LYK_LAST_LINK
    ,LYK_PREV_LINK
    ,LYK_NEXT_LINK
    ,LYK_LPOS_PREV_LINK
    ,LYK_LPOS_NEXT_LINK
    ,LYK_FASTBACKW_LINK
    ,LYK_FASTFORW_LINK
    ,LYK_UP_LINK
    ,LYK_DOWN_LINK
    ,LYK_RIGHT_LINK
    ,LYK_LEFT_LINK
    ,LYK_HISTORY
    ,LYK_PREV_DOC
    ,LYK_NEXT_DOC
    ,LYK_ACTIVATE
    ,LYK_SUBMIT			/* mostly like LYK_ACTIVATE, for mouse use, don't map */
    ,LYK_GOTO
    ,LYK_ECGOTO
    ,LYK_HELP
    ,LYK_DWIMHELP
    ,LYK_INDEX
    ,LYK_NOCACHE
    ,LYK_INTERRUPT
    ,LYK_MAIN_MENU
    ,LYK_OPTIONS
    ,LYK_INDEX_SEARCH
    ,LYK_WHEREIS
    ,LYK_PREV
    ,LYK_NEXT
    ,LYK_COMMENT
    ,LYK_EDIT
    ,LYK_INFO
    ,LYK_PRINT
    ,LYK_ADD_BOOKMARK
    ,LYK_DEL_BOOKMARK
    ,LYK_VIEW_BOOKMARK
    ,LYK_VLINKS
    ,LYK_SHELL
    ,LYK_DOWNLOAD
    ,LYK_TRACE_TOGGLE
    ,LYK_TRACE_LOG
    ,LYK_IMAGE_TOGGLE
    ,LYK_INLINE_TOGGLE
    ,LYK_HEAD
    ,LYK_DO_NOTHING
    ,LYK_TOGGLE_HELP
    ,LYK_JUMP
    ,LYK_KEYMAP
    ,LYK_LIST
    ,LYK_TOOLBAR
    ,LYK_HISTORICAL
    ,LYK_MINIMAL
    ,LYK_SOFT_DQUOTES
    ,LYK_RAW_TOGGLE
    ,LYK_COOKIE_JAR
    ,LYK_F_LINK_NUM
    ,LYK_CLEAR_AUTH
    ,LYK_SWITCH_DTD
    ,LYK_ELGOTO
    ,LYK_CHANGE_LINK
    ,LYK_DWIMEDIT
    ,LYK_EDIT_TEXTAREA
    ,LYK_GROW_TEXTAREA
    ,LYK_INSERT_FILE
d202 1
a202 1
    ,LYK_ADDRLIST
d208 2
a209 2
    ,LYK_EXTERN_LINK
    ,LYK_EXTERN_PAGE
d213 1
a213 1
#endif				/* !defined(USE_EXTERNALS) */
d216 1
a216 1
    ,LYK_DIRED_MENU
d219 1
a219 1
#endif				/* VMS || DIRED_SUPPORT */
d222 6
a227 6
    ,LYK_CREATE
    ,LYK_REMOVE
    ,LYK_MODIFY
    ,LYK_TAG_LINK
    ,LYK_UPLOAD
    ,LYK_INSTALL
d230 1
a230 1
#endif				/* DIRED_SUPPORT */
d232 1
a232 1
    ,LYK_CHG_CENTER
d235 1
a235 1
    ,LYK_CHG_KCODE
d239 1
a239 1
    ,LYK_CHDIR
d243 3
a245 3
    ,LYK_SHIFT_LEFT
    ,LYK_SHIFT_RIGHT
    ,LYK_LINEWRAP_TOGGLE
d253 2
a254 2
    ,LYK_PASTE_URL
    ,LYK_TO_CLIPBOARD
d261 1
a261 1
    ,LYK_NESTED_TABLES
d272 3
a274 3
    LYKeymapCode code;
    const char *name;
    const char *doc;
d277 2
a278 2
extern Kcmd *LYKeycodeToKcmd(LYKeymapCode code);
extern Kcmd *LYStringToKcmd(const char *name);
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import OpenBSD source tree of short before 17:00 UTC today
@
text
@d4 1
d6 1
a6 2
#include <HTList.h>
#include <LYCurses.h>
d8 1
a8 4
extern BOOLEAN LYisNonAlnumKeyname PARAMS((int ch, int KeyName));
extern HTList *LYcommandList NOPARAMS;
extern char *LYKeycodeToString PARAMS((int c, BOOLEAN upper8));
extern char *fmt_keys PARAMS((int lkc_first, int lkc_second));
d10 3
a12 7
extern char *key_for_func_ext PARAMS((int lac, int context_code));
extern int LYReverseKeymap PARAMS((int KeyName));
extern int LYStringToKeycode PARAMS((char *src));
extern int lacname_to_lac PARAMS((CONST char *func));
extern int lecname_to_lec PARAMS((CONST char *func));
extern int lkcstring_to_lkc PARAMS((CONST char *src));
extern int remap PARAMS((char *key, char *func, BOOLEAN for_dired));
a31 1
typedef unsigned short LYKbLayout_t;
d33 1
a33 1
extern LYKbLayout_t * LYKbLayouts[];
d42 1
a42 60
/* * *  LynxKeyCodes  * * */
#define LKC_ISLECLAC	0x8000	/* flag: contains lynxaction + editaction */
#define LKC_MOD1	0x4000	/* a modifier bit - currently for ^x-map */
#define LKC_MOD2	0x2000	/* another one - currently for esc-map */
#define LKC_MOD3	0x1000	/* another one - currently for double-map */
#define LKC_ISLAC	0x0800	/* flag: lynxkeycode already lynxactioncode */

/* Used to distinguish internal Lynx keycodes of (say) extended ncurses once. */
#define LKC_ISLKC	0x0400	/* flag: already lynxkeycode (not native) */
		     /* 0x0400  is MOUSE_KEYSYM for slang in LYStrings.c */
#define LKC_MASK	0x07FF	/* mask for lynxkeycode proper */

#define LKC_DONE	0x07FE	/* special value - operation done, not-a-key */

/* * *  LynxActionCodes  * * */
#define LAC_SHIFT	8	/* shift for lynxactioncode - must not
				   overwrite any assigned LYK_* values */
#define LAC_MASK	((1<<LAC_SHIFT)-1)
				/* mask for lynxactioncode - must cover all
				   assigned LYK_* values */

/*  Return lkc masking single actioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LKC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    (((c) & LAC_MASK) | LKC_ISLAC))

/*  Return lynxeditactioncode, given an lkc masking a lac + lec */
#define LKC2_TO_LEC(c)   (((c) == -1 || !((c) & LKC_ISLECLAC)) ? (c) : \
			    ((((c)&~LKC_ISLECLAC)>>LAC_SHIFT) & LAC_MASK))

/*  Convert lynxkeycode to lynxactioncode.  Modifiers are dropped.  */
#define LKC_TO_LAC(ktab,c) (((c) == -1) ? ktab[0] : \
			    ((c) & (LKC_ISLECLAC|LKC_ISLAC)) ? ((c) & LAC_MASK) : \
			    ktab[((c) & LKC_MASK) + 1])


/*  Mask lynxactioncode as a lynxkeycode.  */
#define LAC_TO_LKC0(a) ((a)|LKC_ISLAC)

/*  Mask a lynxactioncode and an editactioncode as a lynxkeycode.  */
#define LACLEC_TO_LKC0(a,b) ((a)|((b)<<LAC_SHIFT)|LKC_ISLECLAC)

/*  Convert lynxactioncode to a lynxkeycode, attempting reverse mapping.  */
#define LAC_TO_LKC(a) ((LYReverseKeymap(a)>=0)?LYReverseKeymap(a):LAC_TO_LKC0(a))

/*  Simplify a lynxkeycode:
    attempt reverse mapping if a single masked lynxactioncode, drop modifiers.  */
#define LKC_TO_C(c) ((c&LKC_ISLECLAC)? c : (c&LKC_ISLAC)? LAC_TO_LKC(c&LAC_MASK) : (c&LKC_MASK))

#define LKC_HAS_ESC_MOD(c) (c >= 0 && !(c&LKC_ISLECLAC) && (c&LKC_MOD2))


/* *  The defined LynxActionCodes  * */

/*  Variables for holding and passing around lynxactioncodes are
 *  generally of type int, the types LYKeymap_t and LYKeymapCodes
 *  are currently only used for the definitions.  That could change. - kw
 *
 *  The values in this enum are indexed against the command names in the
 *  'revmap[]' array in LYKeymap.c
 */
a44 1
  , LYK_COMMAND
d56 1
a67 2
  , LYK_FIRST_LINK
  , LYK_LAST_LINK
a69 2
  , LYK_LPOS_PREV_LINK
  , LYK_LPOS_NEXT_LINK
a77 1
  , LYK_NEXT_DOC
a78 1
  , LYK_SUBMIT	/* mostly like LYK_ACTIVATE, for mouse use, don't map */
a81 1
  , LYK_DWIMHELP
a88 1
  , LYK_PREV
a120 1
  , LYK_DWIMEDIT
d132 1
a132 5
  , LYK_EXTERN_LINK
  , LYK_EXTERN_PAGE
#else
#define LYK_EXTERN_LINK   LYK_UNKNOWN
#define LYK_EXTERN_PAGE   LYK_UNKNOWN
d152 1
a152 46
#ifdef SH_EX
  , LYK_CHG_CENTER
#endif /* SH_EX */

#ifdef KANJI_CODE_OVERRIDE
  , LYK_CHG_KCODE
#endif

#ifdef SUPPORT_CHDIR
  , LYK_CHDIR
#endif

#ifdef USE_CURSES_PADS
  , LYK_SHIFT_LEFT
  , LYK_SHIFT_RIGHT
  , LYK_LINEWRAP_TOGGLE
#else
#define LYK_SHIFT_LEFT      LYK_UNKNOWN
#define LYK_SHIFT_RIGHT     LYK_UNKNOWN
#define LYK_LINEWRAP_TOGGLE LYK_UNKNOWN
#endif

#ifdef CAN_CUT_AND_PASTE
  , LYK_PASTE_URL
  , LYK_TO_CLIPBOARD
#else
#define LYK_PASTE_URL      LYK_UNKNOWN
#define LYK_TO_CLIPBOARD   LYK_UNKNOWN
#endif

#ifdef EXP_NESTED_TABLES
  , LYK_NESTED_TABLES
#else
#define LYK_NESTED_TABLES  LYK_UNKNOWN
#endif

} LYKeymapCode;

/*
 * Symbol table for internal commands.
 */
typedef struct {
	LYKeymapCode code;
	CONST char *name;
	CONST char *doc;
} Kcmd;
a153 2
extern Kcmd * LYKeycodeToKcmd PARAMS((LYKeymapCode code));
extern Kcmd * LYStringToKcmd PARAMS((CONST char * name));
@

