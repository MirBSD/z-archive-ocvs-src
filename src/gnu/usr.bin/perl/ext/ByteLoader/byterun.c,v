head	1.1;
branch	1.1.1;
access;
symbols
	tg-mergetmp-mirosx-1:1.1.1.2
	tg-mergefixes-1-branch:1.1.1.2.0.8
	tg-mergefixes-1-base:1.1.1.2
	MIROS_X:1.1.1.2.0.6
	MIROS_X_BASE:1.1.1.2
	tg-mergetmp-3:1.1.1.2
	MIRBSD_XP_MIRPPC:1.1.1.2.0.4
	cvs-200410231830:1.1.1.2
	MIRBSD_XP_SPARC_BASE:1.1.1.2
	MIRBSD_XP_SPARC:1.1.1.2.0.2
	cvs-200406091940:1.1.1.2
	MIRBSD_7quater:1.1.1.1
	cvs-200405160640:1.1.1.2
	cvs-200401271800:1.1.1.2
	cvs-200401261630:1.1.1.2
	cvs-200401021645:1.1.1.2
	MIRBSD_7_ALPHA:1.1.1.1.0.6
	MIRBSD_7:1.1.1.1.0.4
	cvs-200312222040:1.1.1.2
	cvs-200312031730:1.1.1.2
	MIRBSD_7ter:1.1.1.1
	MIRBSD_7_DEV:1.1.1.1.0.2
	cvs-200310020700:1.1.1.1
	cvs-200309271030:1.1.1.1
	cvs-200309251530:1.1.1.1
	cvs-200308302005:1.1.1.1
	cvs-200308171200:1.1.1.1
	ctm-3496:1.1.1.1
	ctm-3449:1.1.1.1
	ctm-3437:1.1.1.1
	cvs-200307191805:1.1.1.1
	ctm-3425:1.1.1.1
	cvs-200307091500:1.1.1.1
	ctm-3389:1.1.1.1
	cvs-200306291430:1.1.1.1
	ctm-3341:1.1.1.1
	MIRBSD_5:1.1.1.1
	cvs-200306082100:1.1.1.1
	ctm-3316:1.1.1.1
	ctm-3272:1.1.1.1
	ctm-3264:1.1.1.1
	cvs-200305071630:1.1.1.1
	MIRBSD_4:1.1.1.1
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@ * @;


1.1
date	2003.03.22.17.42.42;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.42.42;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.12.03.17.53.55;	author tg;	state Stab;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@/*
 *      Copyright (c) 1996-1999 Malcolm Beattie
 *
 *      You may distribute under the terms of either the GNU General Public
 *      License or the Artistic License, as specified in the README file.
 *
 */
/*
 * This file is autogenerated from bytecode.pl. Changes made here will be lost.
 */

#define PERL_NO_GET_CONTEXT
#include "EXTERN.h"
#include "perl.h"
#define NO_XSLOCKS
#include "XSUB.h"

#include "byterun.h"
#include "bytecode.h"


static const int optype_size[] = {
    sizeof(OP),
    sizeof(UNOP),
    sizeof(BINOP),
    sizeof(LOGOP),
    sizeof(LISTOP),
    sizeof(PMOP),
    sizeof(SVOP),
    sizeof(PADOP),
    sizeof(PVOP),
    sizeof(LOOP),
    sizeof(COP)
};

void *
bset_obj_store(pTHX_ struct byteloader_state *bstate, void *obj, I32 ix)
{
    if (ix > bstate->bs_obj_list_fill) {
	Renew(bstate->bs_obj_list, ix + 32, void*);
	bstate->bs_obj_list_fill = ix + 31;
    }
    bstate->bs_obj_list[ix] = obj;
    return obj;
}

void
byterun(pTHX_ register struct byteloader_state *bstate)
{
    register int insn;
    U32 ix;
    SV *specialsv_list[6];

    BYTECODE_HEADER_CHECK;	/* croak if incorrect platform */
    New(666, bstate->bs_obj_list, 32, void*); /* set op objlist */
    bstate->bs_obj_list_fill = 31;

    specialsv_list[0] = Nullsv;
    specialsv_list[1] = &PL_sv_undef;
    specialsv_list[2] = &PL_sv_yes;
    specialsv_list[3] = &PL_sv_no;
    specialsv_list[4] = pWARN_ALL;
    specialsv_list[5] = pWARN_NONE;

    while ((insn = BGET_FGETC()) != EOF) {
	switch (insn) {
	  case INSN_COMMENT:		/* 35 */
	    {
		comment_t arg;
		BGET_comment_t(arg);
		arg = arg;
		break;
	    }
	  case INSN_NOP:		/* 10 */
	    {
		break;
	    }
	  case INSN_RET:		/* 0 */
	    {
		BSET_ret(none);
		break;
	    }
	  case INSN_LDSV:		/* 1 */
	    {
		svindex arg;
		BGET_svindex(arg);
		bstate->bs_sv = arg;
		break;
	    }
	  case INSN_LDOP:		/* 2 */
	    {
		opindex arg;
		BGET_opindex(arg);
		PL_op = arg;
		break;
	    }
	  case INSN_STSV:		/* 3 */
	    {
		U32 arg;
		BGET_U32(arg);
		BSET_OBJ_STORE(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_STOP:		/* 4 */
	    {
		U32 arg;
		BGET_U32(arg);
		BSET_OBJ_STORE(PL_op, arg);
		break;
	    }
	  case INSN_STPV:		/* 5 */
	    {
		U32 arg;
		BGET_U32(arg);
		BSET_stpv(bstate->bs_pv.xpv_pv, arg);
		break;
	    }
	  case INSN_LDSPECSV:		/* 6 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_ldspecsv(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_NEWSV:		/* 7 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_newsv(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_NEWOP:		/* 8 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_newop(PL_op, arg);
		break;
	    }
	  case INSN_NEWOPN:		/* 9 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_newopn(PL_op, arg);
		break;
	    }
	  case INSN_NEWPV:		/* 11 */
	    {
		PV arg;
		BGET_PV(arg);
		break;
	    }
	  case INSN_PV_CUR:		/* 12 */
	    {
		STRLEN arg;
		BGET_U32(arg);
		bstate->bs_pv.xpv_cur = arg;
		break;
	    }
	  case INSN_PV_FREE:		/* 13 */
	    {
		BSET_pv_free(bstate->bs_pv);
		break;
	    }
	  case INSN_SV_UPGRADE:		/* 14 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_sv_upgrade(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_SV_REFCNT:		/* 15 */
	    {
		U32 arg;
		BGET_U32(arg);
		SvREFCNT(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_SV_REFCNT_ADD:		/* 16 */
	    {
		I32 arg;
		BGET_I32(arg);
		BSET_sv_refcnt_add(SvREFCNT(bstate->bs_sv), arg);
		break;
	    }
	  case INSN_SV_FLAGS:		/* 17 */
	    {
		U32 arg;
		BGET_U32(arg);
		SvFLAGS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XRV:		/* 18 */
	    {
		svindex arg;
		BGET_svindex(arg);
		SvRV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XPV:		/* 19 */
	    {
		BSET_xpv(bstate->bs_sv);
		break;
	    }
	  case INSN_XIV32:		/* 20 */
	    {
		I32 arg;
		BGET_I32(arg);
		SvIVX(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIV64:		/* 21 */
	    {
		IV64 arg;
		BGET_IV64(arg);
		SvIVX(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XNV:		/* 22 */
	    {
		NV arg;
		BGET_NV(arg);
		SvNVX(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XLV_TARGOFF:		/* 23 */
	    {
		STRLEN arg;
		BGET_U32(arg);
		LvTARGOFF(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XLV_TARGLEN:		/* 24 */
	    {
		STRLEN arg;
		BGET_U32(arg);
		LvTARGLEN(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XLV_TARG:		/* 25 */
	    {
		svindex arg;
		BGET_svindex(arg);
		LvTARG(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XLV_TYPE:		/* 26 */
	    {
		char arg;
		BGET_U8(arg);
		LvTYPE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XBM_USEFUL:		/* 27 */
	    {
		I32 arg;
		BGET_I32(arg);
		BmUSEFUL(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XBM_PREVIOUS:		/* 28 */
	    {
		U16 arg;
		BGET_U16(arg);
		BmPREVIOUS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XBM_RARE:		/* 29 */
	    {
		U8 arg;
		BGET_U8(arg);
		BmRARE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XFM_LINES:		/* 30 */
	    {
		IV arg;
		BGET_IV(arg);
		FmLINES(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_LINES:		/* 31 */
	    {
		IV arg;
		BGET_IV(arg);
		IoLINES(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_PAGE:		/* 32 */
	    {
		IV arg;
		BGET_IV(arg);
		IoPAGE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_PAGE_LEN:		/* 33 */
	    {
		IV arg;
		BGET_IV(arg);
		IoPAGE_LEN(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_LINES_LEFT:		/* 34 */
	    {
		IV arg;
		BGET_IV(arg);
		IoLINES_LEFT(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_TOP_NAME:		/* 36 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		IoTOP_NAME(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_TOP_GV:		/* 37 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&IoTOP_GV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_FMT_NAME:		/* 38 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		IoFMT_NAME(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_FMT_GV:		/* 39 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&IoFMT_GV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_BOTTOM_NAME:		/* 40 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		IoBOTTOM_NAME(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_BOTTOM_GV:		/* 41 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&IoBOTTOM_GV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_SUBPROCESS:		/* 42 */
	    {
		short arg;
		BGET_U16(arg);
		IoSUBPROCESS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_TYPE:		/* 43 */
	    {
		char arg;
		BGET_U8(arg);
		IoTYPE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XIO_FLAGS:		/* 44 */
	    {
		char arg;
		BGET_U8(arg);
		IoFLAGS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_STASH:		/* 45 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&CvSTASH(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_START:		/* 46 */
	    {
		opindex arg;
		BGET_opindex(arg);
		CvSTART(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_ROOT:		/* 47 */
	    {
		opindex arg;
		BGET_opindex(arg);
		CvROOT(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_GV:		/* 48 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&CvGV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_FILE:		/* 49 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		CvFILE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_DEPTH:		/* 50 */
	    {
		long arg;
		BGET_I32(arg);
		CvDEPTH(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_PADLIST:		/* 51 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&CvPADLIST(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_OUTSIDE:		/* 52 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&CvOUTSIDE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_FLAGS:		/* 53 */
	    {
		U16 arg;
		BGET_U16(arg);
		CvFLAGS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_AV_EXTEND:		/* 54 */
	    {
		SSize_t arg;
		BGET_I32(arg);
		BSET_av_extend(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_AV_PUSH:		/* 55 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_av_push(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_XAV_FILL:		/* 56 */
	    {
		SSize_t arg;
		BGET_I32(arg);
		AvFILLp(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XAV_MAX:		/* 57 */
	    {
		SSize_t arg;
		BGET_I32(arg);
		AvMAX(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XAV_FLAGS:		/* 58 */
	    {
		U8 arg;
		BGET_U8(arg);
		AvFLAGS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XHV_RITER:		/* 59 */
	    {
		I32 arg;
		BGET_I32(arg);
		HvRITER(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XHV_NAME:		/* 60 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		HvNAME(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_HV_STORE:		/* 61 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_hv_store(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_SV_MAGIC:		/* 62 */
	    {
		char arg;
		BGET_U8(arg);
		BSET_sv_magic(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_MG_OBJ:		/* 63 */
	    {
		svindex arg;
		BGET_svindex(arg);
		SvMAGIC(bstate->bs_sv)->mg_obj = arg;
		break;
	    }
	  case INSN_MG_PRIVATE:		/* 64 */
	    {
		U16 arg;
		BGET_U16(arg);
		SvMAGIC(bstate->bs_sv)->mg_private = arg;
		break;
	    }
	  case INSN_MG_FLAGS:		/* 65 */
	    {
		U8 arg;
		BGET_U8(arg);
		SvMAGIC(bstate->bs_sv)->mg_flags = arg;
		break;
	    }
	  case INSN_MG_PV:		/* 66 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		BSET_mg_pv(SvMAGIC(bstate->bs_sv), arg);
		break;
	    }
	  case INSN_XMG_STASH:		/* 67 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&SvSTASH(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GV_FETCHPV:		/* 68 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_gv_fetchpv(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_GV_STASHPV:		/* 69 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_gv_stashpv(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_GP_SV:		/* 70 */
	    {
		svindex arg;
		BGET_svindex(arg);
		GvSV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_REFCNT:		/* 71 */
	    {
		U32 arg;
		BGET_U32(arg);
		GvREFCNT(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_REFCNT_ADD:		/* 72 */
	    {
		I32 arg;
		BGET_I32(arg);
		BSET_gp_refcnt_add(GvREFCNT(bstate->bs_sv), arg);
		break;
	    }
	  case INSN_GP_AV:		/* 73 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvAV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_HV:		/* 74 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvHV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_CV:		/* 75 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvCV(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_FILE:		/* 76 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		GvFILE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_IO:		/* 77 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvIOp(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_FORM:		/* 78 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvFORM(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_CVGEN:		/* 79 */
	    {
		U32 arg;
		BGET_U32(arg);
		GvCVGEN(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_LINE:		/* 80 */
	    {
		line_t arg;
		BGET_U16(arg);
		GvLINE(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_GP_SHARE:		/* 81 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_gp_share(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_XGV_FLAGS:		/* 82 */
	    {
		U8 arg;
		BGET_U8(arg);
		GvFLAGS(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_OP_NEXT:		/* 83 */
	    {
		opindex arg;
		BGET_opindex(arg);
		PL_op->op_next = arg;
		break;
	    }
	  case INSN_OP_SIBLING:		/* 84 */
	    {
		opindex arg;
		BGET_opindex(arg);
		PL_op->op_sibling = arg;
		break;
	    }
	  case INSN_OP_PPADDR:		/* 85 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_op_ppaddr(PL_op->op_ppaddr, arg);
		break;
	    }
	  case INSN_OP_TARG:		/* 86 */
	    {
		PADOFFSET arg;
		BGET_U32(arg);
		PL_op->op_targ = arg;
		break;
	    }
	  case INSN_OP_TYPE:		/* 87 */
	    {
		OPCODE arg;
		BGET_U16(arg);
		BSET_op_type(PL_op, arg);
		break;
	    }
	  case INSN_OP_SEQ:		/* 88 */
	    {
		U16 arg;
		BGET_U16(arg);
		PL_op->op_seq = arg;
		break;
	    }
	  case INSN_OP_FLAGS:		/* 89 */
	    {
		U8 arg;
		BGET_U8(arg);
		PL_op->op_flags = arg;
		break;
	    }
	  case INSN_OP_PRIVATE:		/* 90 */
	    {
		U8 arg;
		BGET_U8(arg);
		PL_op->op_private = arg;
		break;
	    }
	  case INSN_OP_FIRST:		/* 91 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cUNOP->op_first = arg;
		break;
	    }
	  case INSN_OP_LAST:		/* 92 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cBINOP->op_last = arg;
		break;
	    }
	  case INSN_OP_OTHER:		/* 93 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cLOGOP->op_other = arg;
		break;
	    }
	  case INSN_OP_PMREPLROOT:		/* 94 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cPMOP->op_pmreplroot = arg;
		break;
	    }
	  case INSN_OP_PMREPLROOTGV:		/* 95 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&cPMOP->op_pmreplroot = arg;
		break;
	    }
	  case INSN_OP_PMREPLSTART:		/* 96 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cPMOP->op_pmreplstart = arg;
		break;
	    }
	  case INSN_OP_PMNEXT:		/* 97 */
	    {
		opindex arg;
		BGET_opindex(arg);
		*(OP**)&cPMOP->op_pmnext = arg;
		break;
	    }
	  case INSN_PREGCOMP:		/* 98 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		BSET_pregcomp(PL_op, arg);
		break;
	    }
	  case INSN_OP_PMFLAGS:		/* 99 */
	    {
		U16 arg;
		BGET_U16(arg);
		cPMOP->op_pmflags = arg;
		break;
	    }
	  case INSN_OP_PMPERMFLAGS:		/* 100 */
	    {
		U16 arg;
		BGET_U16(arg);
		cPMOP->op_pmpermflags = arg;
		break;
	    }
	  case INSN_OP_SV:		/* 101 */
	    {
		svindex arg;
		BGET_svindex(arg);
		cSVOP->op_sv = arg;
		break;
	    }
	  case INSN_OP_PADIX:		/* 102 */
	    {
		PADOFFSET arg;
		BGET_U32(arg);
		cPADOP->op_padix = arg;
		break;
	    }
	  case INSN_OP_PV:		/* 103 */
	    {
		pvcontents arg;
		BGET_pvcontents(arg);
		cPVOP->op_pv = arg;
		break;
	    }
	  case INSN_OP_PV_TR:		/* 104 */
	    {
		op_tr_array arg;
		BGET_op_tr_array(arg);
		cPVOP->op_pv = arg;
		break;
	    }
	  case INSN_OP_REDOOP:		/* 105 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cLOOP->op_redoop = arg;
		break;
	    }
	  case INSN_OP_NEXTOP:		/* 106 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cLOOP->op_nextop = arg;
		break;
	    }
	  case INSN_OP_LASTOP:		/* 107 */
	    {
		opindex arg;
		BGET_opindex(arg);
		cLOOP->op_lastop = arg;
		break;
	    }
	  case INSN_COP_LABEL:		/* 108 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		cCOP->cop_label = arg;
		break;
	    }
	  case INSN_COP_STASHPV:		/* 109 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		BSET_cop_stashpv(cCOP, arg);
		break;
	    }
	  case INSN_COP_FILE:		/* 110 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		BSET_cop_file(cCOP, arg);
		break;
	    }
	  case INSN_COP_SEQ:		/* 111 */
	    {
		U32 arg;
		BGET_U32(arg);
		cCOP->cop_seq = arg;
		break;
	    }
	  case INSN_COP_ARYBASE:		/* 112 */
	    {
		I32 arg;
		BGET_I32(arg);
		cCOP->cop_arybase = arg;
		break;
	    }
	  case INSN_COP_LINE:		/* 113 */
	    {
		line_t arg;
		BGET_U16(arg);
		BSET_cop_line(cCOP, arg);
		break;
	    }
	  case INSN_COP_WARNINGS:		/* 114 */
	    {
		svindex arg;
		BGET_svindex(arg);
		cCOP->cop_warnings = arg;
		break;
	    }
	  case INSN_MAIN_START:		/* 115 */
	    {
		opindex arg;
		BGET_opindex(arg);
		PL_main_start = arg;
		break;
	    }
	  case INSN_MAIN_ROOT:		/* 116 */
	    {
		opindex arg;
		BGET_opindex(arg);
		PL_main_root = arg;
		break;
	    }
	  case INSN_CURPAD:		/* 117 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_curpad(PL_curpad, arg);
		break;
	    }
	  case INSN_PUSH_BEGIN:		/* 118 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_push_begin(PL_beginav, arg);
		break;
	    }
	  case INSN_PUSH_INIT:		/* 119 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_push_init(PL_initav, arg);
		break;
	    }
	  case INSN_PUSH_END:		/* 120 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_push_end(PL_endav, arg);
		break;
	    }
	  default:
	    Perl_croak(aTHX_ "Illegal bytecode instruction %d\n", insn);
	    /* NOTREACHED */
	}
    }
}
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import selected parts of the OpenBSD base system:
 * vnd change - you'll have to re-run MAKEDEV after booting a new kernel
 * misc. changes in /etc, mostly user related
 * Perl 5.8.2 (diff to MirPorts will be committed RSN)
 * some changes to binutils
 * Updates in bc and dc
@
text
@d47 1
a47 1
int
a56 2
    bstate->bs_obj_list[0] = NULL; /* first is always Null */
    bstate->bs_ix = 1;
d125 1
a125 8
	  case INSN_LDSPECSVX:		/* 7 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_ldspecsvx(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_NEWSV:		/* 8 */
d132 1
a132 8
	  case INSN_NEWSVX:		/* 9 */
	    {
		U32 arg;
		BGET_U32(arg);
		BSET_newsvx(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_NEWOP:		/* 11 */
d139 1
a139 8
	  case INSN_NEWOPX:		/* 12 */
	    {
		U16 arg;
		BGET_U16(arg);
		BSET_newopx(PL_op, arg);
		break;
	    }
	  case INSN_NEWOPN:		/* 13 */
d146 1
a146 1
	  case INSN_NEWPV:		/* 14 */
d152 1
a152 1
	  case INSN_PV_CUR:		/* 15 */
d155 1
a155 1
		BGET_PADOFFSET(arg);
d159 1
a159 1
	  case INSN_PV_FREE:		/* 16 */
d164 1
a164 1
	  case INSN_SV_UPGRADE:		/* 17 */
d171 1
a171 1
	  case INSN_SV_REFCNT:		/* 18 */
d178 1
a178 1
	  case INSN_SV_REFCNT_ADD:		/* 19 */
d185 1
a185 1
	  case INSN_SV_FLAGS:		/* 20 */
d192 1
a192 1
	  case INSN_XRV:		/* 21 */
d199 1
a199 1
	  case INSN_XPV:		/* 22 */
d204 1
a204 1
	  case INSN_XPV_CUR:		/* 23 */
d206 3
a208 10
		STRLEN arg;
		BGET_PADOFFSET(arg);
		SvCUR(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XPV_LEN:		/* 24 */
	    {
		STRLEN arg;
		BGET_PADOFFSET(arg);
		SvLEN(bstate->bs_sv) = arg;
d211 1
a211 1
	  case INSN_XIV:		/* 25 */
d213 2
a214 2
		IV arg;
		BGET_IV(arg);
d218 1
a218 1
	  case INSN_XNV:		/* 26 */
d225 1
a225 1
	  case INSN_XLV_TARGOFF:		/* 27 */
d228 1
a228 1
		BGET_PADOFFSET(arg);
d232 1
a232 1
	  case INSN_XLV_TARGLEN:		/* 28 */
d235 1
a235 1
		BGET_PADOFFSET(arg);
d239 1
a239 1
	  case INSN_XLV_TARG:		/* 29 */
d246 1
a246 1
	  case INSN_XLV_TYPE:		/* 30 */
d253 1
a253 1
	  case INSN_XBM_USEFUL:		/* 31 */
d260 1
a260 1
	  case INSN_XBM_PREVIOUS:		/* 32 */
d267 1
a267 1
	  case INSN_XBM_RARE:		/* 33 */
d274 1
a274 1
	  case INSN_XFM_LINES:		/* 34 */
d281 1
a281 1
	  case INSN_XIO_LINES:		/* 36 */
d288 1
a288 1
	  case INSN_XIO_PAGE:		/* 37 */
d295 1
a295 1
	  case INSN_XIO_PAGE_LEN:		/* 38 */
d302 1
a302 1
	  case INSN_XIO_LINES_LEFT:		/* 39 */
d309 1
a309 1
	  case INSN_XIO_TOP_NAME:		/* 40 */
d311 2
a312 2
		pvindex arg;
		BGET_pvindex(arg);
d316 1
a316 1
	  case INSN_XIO_TOP_GV:		/* 41 */
d323 1
a323 1
	  case INSN_XIO_FMT_NAME:		/* 42 */
d325 2
a326 2
		pvindex arg;
		BGET_pvindex(arg);
d330 1
a330 1
	  case INSN_XIO_FMT_GV:		/* 43 */
d337 1
a337 1
	  case INSN_XIO_BOTTOM_NAME:		/* 44 */
d339 2
a340 2
		pvindex arg;
		BGET_pvindex(arg);
d344 1
a344 1
	  case INSN_XIO_BOTTOM_GV:		/* 45 */
d351 1
a351 1
	  case INSN_XIO_SUBPROCESS:		/* 46 */
d358 1
a358 1
	  case INSN_XIO_TYPE:		/* 47 */
d365 1
a365 1
	  case INSN_XIO_FLAGS:		/* 48 */
d372 1
a372 8
	  case INSN_XCV_XSUBANY:		/* 49 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&CvXSUBANY(bstate->bs_sv).any_ptr = arg;
		break;
	    }
	  case INSN_XCV_STASH:		/* 50 */
d379 1
a379 1
	  case INSN_XCV_START:		/* 51 */
d386 1
a386 1
	  case INSN_XCV_ROOT:		/* 52 */
d393 1
a393 1
	  case INSN_XCV_GV:		/* 53 */
d400 1
a400 1
	  case INSN_XCV_FILE:		/* 54 */
d407 1
a407 1
	  case INSN_XCV_DEPTH:		/* 55 */
d410 1
a410 1
		BGET_long(arg);
d414 1
a414 1
	  case INSN_XCV_PADLIST:		/* 56 */
d421 1
a421 1
	  case INSN_XCV_OUTSIDE:		/* 57 */
d428 1
a428 8
	  case INSN_XCV_OUTSIDE_SEQ:		/* 58 */
	    {
		U32 arg;
		BGET_U32(arg);
		CvOUTSIDE_SEQ(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_XCV_FLAGS:		/* 59 */
d435 1
a435 1
	  case INSN_AV_EXTEND:		/* 60 */
d438 1
a438 1
		BGET_PADOFFSET(arg);
d442 1
a442 8
	  case INSN_AV_PUSHX:		/* 61 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_av_pushx(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_AV_PUSH:		/* 62 */
d449 1
a449 1
	  case INSN_XAV_FILL:		/* 63 */
d452 1
a452 1
		BGET_PADOFFSET(arg);
d456 1
a456 1
	  case INSN_XAV_MAX:		/* 64 */
d459 1
a459 1
		BGET_PADOFFSET(arg);
d463 1
a463 1
	  case INSN_XAV_FLAGS:		/* 65 */
d470 1
a470 1
	  case INSN_XHV_RITER:		/* 66 */
d477 1
a477 1
	  case INSN_XHV_NAME:		/* 67 */
d479 2
a480 2
		pvindex arg;
		BGET_pvindex(arg);
d484 1
a484 8
	  case INSN_XHV_PMROOT:		/* 68 */
	    {
		opindex arg;
		BGET_opindex(arg);
		*(OP**)&HvPMROOT(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_HV_STORE:		/* 69 */
d491 1
a491 1
	  case INSN_SV_MAGIC:		/* 70 */
d498 1
a498 1
	  case INSN_MG_OBJ:		/* 71 */
d505 1
a505 1
	  case INSN_MG_PRIVATE:		/* 72 */
d512 1
a512 1
	  case INSN_MG_FLAGS:		/* 73 */
d519 1
a519 1
	  case INSN_MG_NAME:		/* 74 */
d523 1
a523 1
		BSET_mg_name(SvMAGIC(bstate->bs_sv), arg);
d526 1
a526 8
	  case INSN_MG_NAMEX:		/* 75 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_mg_namex(SvMAGIC(bstate->bs_sv), arg);
		break;
	    }
	  case INSN_XMG_STASH:		/* 76 */
d533 1
a533 1
	  case INSN_GV_FETCHPV:		/* 77 */
d540 1
a540 8
	  case INSN_GV_FETCHPVX:		/* 78 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_gv_fetchpvx(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_GV_STASHPV:		/* 79 */
d547 1
a547 8
	  case INSN_GV_STASHPVX:		/* 80 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_gv_stashpvx(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_GP_SV:		/* 81 */
d554 1
a554 1
	  case INSN_GP_REFCNT:		/* 82 */
d561 1
a561 1
	  case INSN_GP_REFCNT_ADD:		/* 83 */
d568 1
a568 1
	  case INSN_GP_AV:		/* 84 */
d575 1
a575 1
	  case INSN_GP_HV:		/* 85 */
d582 1
a582 1
	  case INSN_GP_CV:		/* 86 */
d589 1
a589 1
	  case INSN_GP_FILE:		/* 87 */
d596 1
a596 1
	  case INSN_GP_IO:		/* 88 */
d603 1
a603 1
	  case INSN_GP_FORM:		/* 89 */
d610 1
a610 1
	  case INSN_GP_CVGEN:		/* 90 */
d617 1
a617 1
	  case INSN_GP_LINE:		/* 91 */
d620 1
a620 1
		BGET_U32(arg);
d624 1
a624 1
	  case INSN_GP_SHARE:		/* 92 */
d631 1
a631 1
	  case INSN_XGV_FLAGS:		/* 93 */
d638 1
a638 1
	  case INSN_OP_NEXT:		/* 94 */
d645 1
a645 1
	  case INSN_OP_SIBLING:		/* 95 */
d652 1
a652 1
	  case INSN_OP_PPADDR:		/* 96 */
d659 1
a659 1
	  case INSN_OP_TARG:		/* 97 */
d662 1
a662 1
		BGET_PADOFFSET(arg);
d666 1
a666 1
	  case INSN_OP_TYPE:		/* 98 */
d673 1
a673 1
	  case INSN_OP_SEQ:		/* 99 */
d680 1
a680 1
	  case INSN_OP_FLAGS:		/* 100 */
d687 1
a687 1
	  case INSN_OP_PRIVATE:		/* 101 */
d694 1
a694 1
	  case INSN_OP_FIRST:		/* 102 */
d701 1
a701 1
	  case INSN_OP_LAST:		/* 103 */
d708 1
a708 1
	  case INSN_OP_OTHER:		/* 104 */
d715 1
a715 1
	  case INSN_OP_PMREPLROOT:		/* 105 */
d722 8
a729 1
	  case INSN_OP_PMREPLSTART:		/* 106 */
d736 1
a736 1
	  case INSN_OP_PMNEXT:		/* 107 */
d743 1
a743 32
#ifdef USE_ITHREADS
	  case INSN_OP_PMSTASHPV:		/* 108 */
	    {
		pvindex arg;
		BGET_pvindex(arg);
		BSET_op_pmstashpv(cPMOP, arg);
		break;
	    }
	  case INSN_OP_PMREPLROOTPO:		/* 109 */
	    {
		PADOFFSET arg;
		BGET_PADOFFSET(arg);
		cPMOP->op_pmreplroot = (OP*)arg;
		break;
	    }
#else
	  case INSN_OP_PMSTASH:		/* 110 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&cPMOP->op_pmstash = arg;
		break;
	    }
	  case INSN_OP_PMREPLROOTGV:		/* 111 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&cPMOP->op_pmreplroot = arg;
		break;
	    }
#endif
	  case INSN_PREGCOMP:		/* 112 */
d750 1
a750 1
	  case INSN_OP_PMFLAGS:		/* 113 */
d757 1
a757 1
	  case INSN_OP_PMPERMFLAGS:		/* 114 */
d764 1
a764 8
	  case INSN_OP_PMDYNFLAGS:		/* 115 */
	    {
		U8 arg;
		BGET_U8(arg);
		cPMOP->op_pmdynflags = arg;
		break;
	    }
	  case INSN_OP_SV:		/* 116 */
d771 1
a771 1
	  case INSN_OP_PADIX:		/* 117 */
d774 1
a774 1
		BGET_PADOFFSET(arg);
d778 1
a778 1
	  case INSN_OP_PV:		/* 118 */
d785 1
a785 1
	  case INSN_OP_PV_TR:		/* 119 */
d792 1
a792 1
	  case INSN_OP_REDOOP:		/* 120 */
d799 1
a799 1
	  case INSN_OP_NEXTOP:		/* 121 */
d806 1
a806 1
	  case INSN_OP_LASTOP:		/* 122 */
d813 1
a813 1
	  case INSN_COP_LABEL:		/* 123 */
d820 1
a820 2
#ifdef USE_ITHREADS
	  case INSN_COP_STASHPV:		/* 124 */
d827 1
a827 1
	  case INSN_COP_FILE:		/* 125 */
d834 1
a834 17
#else
	  case INSN_COP_STASH:		/* 126 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_cop_stash(cCOP, arg);
		break;
	    }
	  case INSN_COP_FILEGV:		/* 127 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_cop_filegv(cCOP, arg);
		break;
	    }
#endif
	  case INSN_COP_SEQ:		/* 128 */
d841 1
a841 1
	  case INSN_COP_ARYBASE:		/* 129 */
d848 1
a848 1
	  case INSN_COP_LINE:		/* 130 */
d851 2
a852 9
		BGET_U32(arg);
		cCOP->cop_line = arg;
		break;
	    }
	  case INSN_COP_IO:		/* 131 */
	    {
		svindex arg;
		BGET_svindex(arg);
		cCOP->cop_io = arg;
d855 1
a855 1
	  case INSN_COP_WARNINGS:		/* 132 */
d862 1
a862 1
	  case INSN_MAIN_START:		/* 133 */
d869 1
a869 1
	  case INSN_MAIN_ROOT:		/* 134 */
d876 1
a876 8
	  case INSN_MAIN_CV:		/* 135 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&PL_main_cv = arg;
		break;
	    }
	  case INSN_CURPAD:		/* 136 */
d883 1
a883 1
	  case INSN_PUSH_BEGIN:		/* 137 */
d890 1
a890 1
	  case INSN_PUSH_INIT:		/* 138 */
d897 1
a897 1
	  case INSN_PUSH_END:		/* 139 */
a903 79
	  case INSN_CURSTASH:		/* 140 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&PL_curstash = arg;
		break;
	    }
	  case INSN_DEFSTASH:		/* 141 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&PL_defstash = arg;
		break;
	    }
	  case INSN_DATA:		/* 142 */
	    {
		U8 arg;
		BGET_U8(arg);
		BSET_data(none, arg);
		break;
	    }
	  case INSN_INCAV:		/* 143 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvAV(PL_incgv) = arg;
		break;
	    }
	  case INSN_LOAD_GLOB:		/* 144 */
	    {
		svindex arg;
		BGET_svindex(arg);
		BSET_load_glob(none, arg);
		break;
	    }
#ifdef USE_ITHREADS
	  case INSN_REGEX_PADAV:		/* 145 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&PL_regex_padav = arg;
		break;
	    }
#endif
	  case INSN_DOWARN:		/* 146 */
	    {
		U8 arg;
		BGET_U8(arg);
		PL_dowarn = arg;
		break;
	    }
	  case INSN_COMPPAD_NAME:		/* 147 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&PL_comppad_name = arg;
		break;
	    }
	  case INSN_XGV_STASH:		/* 148 */
	    {
		svindex arg;
		BGET_svindex(arg);
		*(SV**)&GvSTASH(bstate->bs_sv) = arg;
		break;
	    }
	  case INSN_SIGNAL:		/* 149 */
	    {
		strconst arg;
		BGET_strconst(arg);
		BSET_signal(bstate->bs_sv, arg);
		break;
	    }
	  case INSN_FORMFEED:		/* 150 */
	    {
		svindex arg;
		BGET_svindex(arg);
		PL_formfeed = arg;
		break;
	    }
a908 1
    return 0;
@

