head	1.18;
access;
symbols
	MIRBSD_7quater:1.11
	cvs-200401271800:1.1.1.9
	cvs-200401261630:1.1.1.9
	cvs-200401021645:1.1.1.8
	MIRBSD_7_ALPHA:1.11.0.6
	MIRBSD_7:1.11.0.4
	cvs-200312222040:1.1.1.7
	MIRBSD_7ter:1.11
	MIRBSD_7_DEV:1.11.0.2
	cvs-200310020700:1.1.1.7
	cvs-200309271030:1.1.1.7
	cvs-200309251530:1.1.1.7
	cvs-200308302005:1.1.1.7
	cvs-200308171200:1.1.1.6
	ctm-3496:1.1.1.6
	ctm-3449:1.1.1.6
	ctm-3437:1.1.1.5
	cvs-200307191805:1.1.1.5
	ctm-3425:1.1.1.5
	cvs-200307091500:1.1.1.5
	ctm-3389:1.1.1.5
	cvs-200306291430:1.1.1.5
	ctm-3341:1.1.1.4
	MIRBSD_5:1.4
	cvs-200306082100:1.1.1.3
	ctm-3316:1.1.1.3
	ctm-3272:1.1.1.2
	ctm-3264:1.1.1.2
	cvs-200305071630:1.1.1.2
	MIRBSD_4:1.3
	ctm-3203:1.1.1.2
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.18
date	2004.06.09.21.27.31;	author tg;	state dead;
branches;
next	1.17;

1.17
date	2004.05.02.16.37.14;	author tg;	state Exp;
branches;
next	1.16;

1.16
date	2004.05.02.13.46.57;	author tg;	state Exp;
branches;
next	1.15;

1.15
date	2004.04.19.23.08.35;	author tg;	state Exp;
branches;
next	1.14;

1.14
date	2004.02.29.01.09.13;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2004.01.27.17.41.39;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2004.01.03.02.10.36;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.08.31.20.54.20;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.07.26.16.06.52;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.07.26.11.59.19;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.07.19.14.07.36;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.07.06.13.15.11;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.29.19.45.53;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.19.16.43.21;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.06.18.26.49;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.04.15.20.10.30;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.23.21.48.07;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.36.02;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.36.02;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.04.15.16.46.36;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.06.05.17.01.26;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.06.19.12.18.21;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.06.29.14.57.48;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.07.26.12.48.50;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2003.08.30.21.12.35;	author tg;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2004.01.02.17.11.16;	author tg;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2004.01.26.16.58.19;	author tg;	state Exp;
branches;
next	;


desc
@@


1.18
log
@merging src/gnu/{doc,egcs,gcc}
@
text
@.\" $MirBSD: src/gnu/egcs/gcc/gcc-local.1,v 1.17 2004/05/02 16:37:14 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.17 2004/01/04 07:08:09 pvalchev Exp $
.\"
.\" Copyright (c) 2002 Marc Espie
.\" Copyright (c) 2003 Anil Madhavapeddy
.\"
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE DEVELOPERS "AS IS" AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE DEVELOPERS BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd December 1, 2002
.Dt GCC-LOCAL 1
.Os
.Sh NAME
.Nm gcc-local
.Nd local modifications to gcc
.Sh DESCRIPTION
The GNU Compiler Collections come with special modifications for
.Mx .
.br
There are two compilers for the C language and assorted utilities available.
.Mx
currently delivers
.Sy GCC 2.95.x
and
.Sy GCC 3.2.3 .
On some architectures, both compilers are available, on others, only one
of these.
.Sy GCC 2.95
only comes with a C compiler, whereas
.Sy GCC 3.x
also delivers at least a C++ compiler.
.Bl -dash
.It
.Nm pgcc
is installed as
.Pa /usr/bin/pgcc
in
.Mx ,
and the only language supported is C.
This is a heavily modified
.Sy GCC 2.95 .
.It
.Nm gcc ,
if installed, is gcc3 which should support at least
C, C++, protoize, gcov, and in addition to that, can
support Ada, Pascal, Objective C.
Most of the extensions have been brought to both, and
gcc3 is believed to be the better compiler in general.
However, it has its shortcomings, thus
.Nm pgcc
is still left in as fall-back compiler.
.It
.Nm cpp ,
the C Preprocessor (refer to
.Xr cccp 1
for details) is always the version which comes with
gcc 2, unless only gcc 3 is available (for example on AMD64).
.It
.Nm pgcc
does not search under
.Pa /usr/local
for include files nor for libraries:
as a system compiler, it only searches the system paths by default.
.It
On
.Mx ,
the
.Fl pthread
option should be used to link threaded code, isolating the program from
operating system details.
.It
On most architectures,
trampoline code marks the smallest possible area around the trampoline stub
executable using
.Xr mprotect 2 ,
since the stack area is by default non-executable.
.It
The
.Fl O2
option does not include
.Fl fstrict-aliasing ,
as this option causes issues on some legacy code.
.Fl fstrict-aliasing
is very unsafe with code that plays tricks with casts, bypassing the
already weak type system of C.
.It
The option
.Fl fno-builtin-<function>
was backported from
.Nm gcc
version 3,
yielding greater control over what functions
.Nm pgcc
inlines.
.It
.Nm pgcc
recognizes the extra format attribute syslog, to better match
the definition of
.Xr syslog 3 ,
and silence erroneous warnings when used with
.Fl pedantic .
.It
.Nm pgcc
recognizes the extra attribute nonnull, which can be used to mark
arguments that can't be
.Dv NULL .
On the other hand, the printf format attribute does not imply nonnull
for the format.
This allows for correct format checking on the
.Xr err 3
function family.
.It
.Nm pgcc
recognizes the extra attribute sentinel, which can be used to mark varargs
function that need a
.Dv NULL
pointer to mark argument termination, like
.Xr execl 3 .
This exposes latent bugs for 64 bit architectures,
where a terminating 0 will expand to a 32 bit int, and not a full-fledged
64 bits pointer.
.It
On some platforms,
.Nm pgcc
still uses
.Xr setjmp 3 /
.Xr longjmp 3 -
style exceptions, and so needs extra fixes beyond the pure 2.95.3 release.
.It
On some
platforms (mostly a.out),
.Nm pgcc
uses a linker wrapper to write stubs that call global constructors and
destructors.
On
.Mx
those calls can be traced using
.Fl Wl,-trace-ctors-dtors ,
using
.Xr syslog_r 3 .
.It
On i386, the gcc2 optimizer features an extra
peephole which reduces the function
prologues enough to allow for the ramdisk to fit on one floppy.
.It
On
.Mx ,
.Nm pgcc
and
.Nm gcc
come with the
.Dq propolice
stack protection extension, which is enabled by default.
This extension reorders local variable declarations and adds stack consistency
checks at run time, in order to detect stack overflows, and will attempt to
report the problem in the system logs, and abort the faulting process.
It can be turned off using the
.Fl fno-stack-protector
commandline option.
Note that the stack protector relies on some support code in libc.
Stand-alone programs not linked against libc must either provide their own
support bits, or use the
.Fl fno-stack-protector
option.
.It
.Nm pgcc
recognizes a new flag,
.Fl Wbounded ,
to perform basic checks on functions which accept buffers and sizes.
An extra attribute,
.Dv __bounded__ ,
has been added to mark functions that can be
checked this way.
.It
.Nm pgcc
recognizes a new format attribute, kprintf, to deal with the extra format
arguments
.Ql %b ,
.Ql %r ,
and
.Ql %z
used in the kernel.
.It
.Nm pgcc
does not store its version string in objects.
This behavior can be restored with
.Fl fident .
.It
.Nm pgcc
has been adjusted for the new
.Pa src/lib/csu/
layout in
.Mx 6 ,
including update of the specs for
.Pa /usr/lib/crti.o
and
.Pa /usr/lib/crtn.o
(from
.Nx ,
idea from defaults of other compilers).
.It
The
.Nm cccp
manual page does not get installed as
.Nm cpp
any longer since
.Mx 7 .
.It
A new option,
.Fl femit-memmove ,
has been added to both
.Nm gcc No and Nm pgcc
in
.Mx 8 .
If set, library calls to
.Xr memcpy 3
which can be emitted under certain circumstances
will be replaced with calls to
.Xr memmove 3 .
This is being used in the bootloader.
.El
.Pp
Most of the changes above also relate to gcc 3.
.Sh ATTRIBUTES
The
.Dv __bounded__
attribute is used to type-check functions whose parameters pass fixed-length
buffers and their sizes.
The syntax for normal buffers is:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __buffer__ ,
.Va buffer ,
.Va length
.Li )))
.Pp
where
.Fa buffer
contains the parameter number (starting from 1) of the pointer to the buffer,
and
.Fa length
contains the parameter number of the buffer length argument.
.Pp
.Nm pgcc
will emit a warning if the length argument is a constant larger than the
actual size of the buffer.
If the buffer is not a statically declared array of fixed length, no warnings
will be generated.
Refer to
.Xr memcpy 3
for an example of a function with this check.
.Pp
For checking strings, just use
.Dv __string__
instead of
.Dv __buffer__ :
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __string__ ,
.Va buffer ,
.Va length
.Li )))
.Pp
In addition to the checks described above, this also tests if the
.Va length
argument was wrongly derived from a
.Fn sizeof "void *"
operation.
.Xr strlcpy 3
is a good example of a string function with this check.
.Pp
Some functions specify the length as two arguments:
the number of elements and the size of each element.
In this case, use the
.Dv __size__
attribute:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __size__ ,
.Va buffer ,
.Va nmemb ,
.Va size
.Li )))
.Pp
where
.Va buffer
contains the parameter number of the pointer to the buffer,
.Va nmemb
contains the parameter number of the number of members, and
.Va size
has the parameter number of the size of each element.
The type checks performed by
.Dv __size__
are the same as the
.Dv __buffer__
attribute.
See
.Xr fread 3
for an example of this type of function.
.Pp
If a function accepts a buffer parameter and specifies that it has to be of a
minimum length, the __minbytes__ attribute can be used:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __minbytes__ ,
.Va buffer ,
.Va minsize
.Li )))
.Pp
where
.Va buffer
contains the parameter number of the pointer to the buffer, and
.Va minsize
specifies the minimum number of bytes that the buffer should be.
.Xr ctime_r 3
is an example of this type of function.
.Pp
If
.Fl Wbounded
is specified with
.Fl Wformat ,
additional checks are performed on
.Xr sscanf 3
format strings.
The
.Ql %s
fields are checked for incorrect bound lengths by checking the size of the
buffer associated with the format argument.
.Sh SEE ALSO
.Xr cccp 1 ,
.Xr pgcc 1 ,
.Xr cpp 1 ,
.Xr gcc 1
.Pp
.Pa http://www.research.ibm.com/trl/projects/security/ssp/
.Sh CAVEATS
The
.Fl Wbounded
flag only works with statically allocated fixed-size buffers.
Since it is applied at compile-time, dynamically allocated memory buffers
and non-constant arguments are ignored.
.Pp
For the
.Nm gnat
compiler (gcc 3.x Ada), the stack protector is known to have
bugs and be unable to compile certain files.
For example, when bootstrapping itself, it needs
.Fl fno-stack-protector
on eight files (compiler and library) out of ca. 1300 files.
.Pp
Neither the
.Fl Wbounded
nor
.Fl Wnonnull
options work on gcc3.
Worse, the latter option generates a syntax error,
and null pointer warnings are silently discarded in
favour of a well-building base system.
Thus, if you want to really check code on
.Mx ,
use
.Xr pgcc 1 .
.Pp
The
.Xr cpp 1
and
.Xr gcc 1
manual pages are part of GCC 3, and cannot be included in the
.Mx
operating system due to licence issues.
If you rely on these manual pages and the associated texinfo
documents, please install the
.Em books/gfdl-doc
package from MirPorts.
@


1.17
log
@* make use of capabilities (HAS_GCC2, HAS_GCC3) in
  - descending into gnu/gcc or gnu/egcs/gcc directory
  - distribution set lists
* fix gcc2 -femit-memmove
* document changes in manpages
* install cccp and gcc-local manpages from gnu/doc/
* install gcc3 /usr/libexec/cpp if HAS_GCC2=no
* fold gpcrts into gcc3 again, since utils are now external,
  and don't warn on installation any more
* fix calls to scripts
@
text
@d1 1
a1 1
.\" $MirBSD: src/gnu/egcs/gcc/gcc-local.1,v 1.16 2004/05/02 13:46:57 tg Exp $
@


1.16
log
@fix the kludge for memcpy() vs memmove() correctly:
* add new -femit-memmove to gcc
* switch back to old (emit memcpy calls) behaviour by default
* sync pgcc with gcc
* document new switch
* add .Xr to pgcc(1) to gcc-local(1)
* bump versions
@
text
@d1 1
a1 1
.\" $MirBSD: src/gnu/egcs/gcc/gcc-local.1,v 1.15 2004/04/19 23:08:35 tg Exp $
d36 15
a50 4
The
.Nm pgcc
software comes with specific modifications for
.Ox .
d59 2
d72 6
d85 1
a85 1
.Ox ,
d142 1
a142 3
On some
.Ox
platforms,
d155 1
a155 1
.Ox
d161 2
a162 1
On i386, the optimizer features an extra peephole which reduces the function
d166 1
a166 1
.Ox ,
d168 3
a170 1
comes with the
d201 1
a201 3
used in the
.Ox
kernel.
d241 2
d349 1
d351 1
d382 12
@


1.15
log
@enhance comments about gcc3, and fix a pgcc/gcc confusion.
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.14 2004/02/29 01:09:13 tg Exp $
d209 13
d329 1
@


1.14
log
@document gnat propolice bug
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.13 2004/01/27 17:41:39 tg Exp $
d49 10
d90 1
a90 1
.Nm pgcc
d333 13
@


1.13
log
@first part of mergeing OpenBSD and fixing whitespace and RCS IDs
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.12 2004/01/03 02:10:36 tg Exp $
d315 8
@


1.12
log
@merge OpenBSD
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.11 2003/08/31 20:54:20 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.16 2003/12/28 18:09:46 miod Exp $
d309 1
a309 1
.Sh BUGS
@


1.11
log
@Merge import of OpenBSD source, ports and XF4 tree.

While here,
o clean up differences where possible
o whitespace cleanup
o ifdef ./. if defined()
o '...' ./. "..."
o echo foo > bar ./. echo foo >bar
o `...` ./. $(...) ./. $$(...)
o `...' ./. '...'
o modernize "our" tree, e.g. WWW in ports
o fix some typos and brainos introduced when renaming OpenBSD to MirBSD
o use hardware 80387 by default
o migrate Apache 1.3.28 OpenBSD ./. MirBSD ./. KAME
o work around as many CVS bugs as possible (add back/delete files, ...)

Synchronize stuff, ready for ongoing changes.
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.10 2003/07/26 16:06:52 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.15 2003/08/26 02:19:13 tedu Exp $
a167 1
.Ql %: ,
@


1.10
log
@merge CVS; fix here and there a bit
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.9 2003/07/26 11:59:19 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.14 2003/07/25 06:18:44 jmc Exp $
d175 5
@


1.9
log
@remove cpp(1) manual page
it'll be used by gcc 3.
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.8 2003/07/19 14:07:36 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.12 2003/06/26 18:32:12 avsm Exp $
d165 12
d282 1
a282 1
where 
d297 1
a297 1
The 
@


1.8
log
@Propolice URI changes.
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.7 2003/07/06 13:15:11 tg Exp $
d176 7
@


1.7
log
@src/lib/csu/ update
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.6 2003/06/29 19:45:53 tg Exp $
d285 1
a285 1
.Pa http://www.trl.ibm.com/projects/security/ssp
@


1.6
log
@merge the import
amd (automount dæmon) bites the dust
rewrite fake-NLS emulation, copyright to me
foobar! fnord!
@
text
@d1 1
a1 1
.\" $MirBSD: gcc-local.1,v 1.5 2003/06/19 16:43:21 tg Exp $
d37 1
a37 1
.Nm gcc
d42 1
a42 1
.Nm gcc
d49 1
a49 1
.Nm gcc
d80 1
a80 1
.Nm gcc
d83 1
a83 1
.Nm gcc
d86 1
a86 1
.Nm gcc
d93 1
a93 1
.Nm gcc
d103 1
a103 1
.Nm gcc
d116 1
a116 1
.Nm gcc
d124 1
a124 1
.Nm gcc
d139 1
a139 1
.Nm gcc
d155 1
a155 1
.Nm gcc
d163 13
d197 1
a197 1
.Nm gcc
@


1.5
log
@merge cvs import - OpenBSD tree as of Thu Jun 19 16:13:15 UTC 2003
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.4 2003/06/06 18:26:49 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.11 2003/06/14 05:13:18 jmc Exp $
d5 1
d18 1
a18 1
.\" THIS SOFTWARE IS PROVIDED BY THE DEVELOPERS ``AS IS'' AND ANY EXPRESS OR
d44 3
a46 1
.Pa /usr/bin/pgcc ,
d154 9
d164 105
d273 6
@


1.4
log
@Merge OpenBSD-current
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.3 2003/04/15 20:10:30 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.10 2003/06/04 17:59:01 espie Exp $
d47 1
a47 1
does not search under 
d54 1
a54 1
the 
d60 2
a61 2
trampoline code marks the smallest possible area around the trampoline stub 
executable using 
d65 1
a65 1
The 
d67 1
a67 1
option does not include 
d71 1
a71 1
is very unsafe with code that plays tricks with casts, bypassing the 
d76 1
a76 1
was backported from 
d85 1
a85 1
the definition of 
d92 1
a92 1
arguments that can't be 
d112 1
a112 1
platforms, 
d114 1
a114 1
still uses 
d153 1
a153 1
.Xr gcc 1 
@


1.3
log
@clean up after cvs
fix some stuff

in the hope to fully have removed sys_mhint... they implemented
it in the name of sys_mquery *d'oh*
@
text
@d1 2
a2 2
.\" $MirBSD: gcc-local.1,v 1.2 2003/03/23 21:48:07 tg Exp $
.\" $OpenBSD: gcc-local.1,v 1.9 2003/04/14 06:51:49 jmc Exp $
d73 9
@


1.2
log
@Merge MirBSD-old entirely
Remove krb, yp, afs, GPL'd stuff in kernel
Adjust some other stuff

Not to be compiled yet...
@
text
@d1 2
a2 2
.\" $MirBSD$
.\" $OpenBSD: gcc-local.1,v 1.8 2003/03/12 22:52:17 deraadt Exp $
d138 1
a138 1
Standalone programs not linked against libc must either provide their own
@


1.1
log
@Initial revision
@
text
@d1 1
d40 5
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import OpenBSD source with the "new" command line as well,
in order to be able to provide a MirBSD release which bases
upon a fairly current OpenBSD base source code tree deemed
stable enough.
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.9 2003/04/14 06:51:49 jmc Exp $
d132 1
a132 1
Stand-alone programs not linked against libc must either provide their own
@


1.1.1.3
log
@Import latest OpenBSD CVS tree by CTM in order
to sync the base system and ports tree with Them.

This includes the recent licence changes as well - by
importing the changed base and re-applying the diffs
(with cvs up -j -j) they are inherited, and we're not
bound to the removed clauses any longer.
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.10 2003/06/04 17:59:01 espie Exp $
a66 9
.It
The option
.Fl fno-builtin-<function>
was backported from 
.Nm gcc
version 3,
yielding greater control over what functions
.Nm gcc
inlines.
@


1.1.1.4
log
@sync with OpenBSD, this gives us a fair amount of fixes
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.11 2003/06/14 05:13:18 jmc Exp $
d41 1
a41 1
does not search under
d48 1
a48 1
the
d54 2
a55 2
trampoline code marks the smallest possible area around the trampoline stub
executable using
d59 1
a59 1
The
d61 1
a61 1
option does not include
d65 1
a65 1
is very unsafe with code that plays tricks with casts, bypassing the
d70 1
a70 1
was backported from
d79 1
a79 1
the definition of
d86 1
a86 1
arguments that can't be
d106 1
a106 1
platforms,
d108 1
a108 1
still uses
d147 1
a147 1
.Xr gcc 1
@


1.1.1.5
log
@Sync OpenBSD source tree from -current CVS.
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.12 2003/06/26 18:32:12 avsm Exp $
a3 1
.\" Copyright (c) 2003 Anil Madhavapeddy
a144 9
.It
.Nm gcc
recognizes a new flag,
.Fl Wbounded ,
to perform basic checks on functions which accept buffers and sizes.
An extra attribute,
.Dv __bounded__ ,
has been added to mark functions that can be
checked this way.
a145 105
.Sh ATTRIBUTES
The
.Dv __bounded__
attribute is used to type-check functions whose parameters pass fixed-length
buffers and their sizes.
The syntax for normal buffers is:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __buffer__ ,
.Va buffer ,
.Va length
.Li )))
.Pp
where
.Fa buffer
contains the parameter number (starting from 1) of the pointer to the buffer,
and
.Fa length
contains the parameter number of the buffer length argument.
.Pp
.Nm gcc
will emit a warning if the length argument is a constant larger than the
actual size of the buffer.
If the buffer is not a statically declared array of fixed length, no warnings
will be generated.
Refer to
.Xr memcpy 3
for an example of a function with this check.
.Pp
For checking strings, just use
.Dv __string__
instead of
.Dv __buffer__ :
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __string__ ,
.Va buffer ,
.Va length
.Li )))
.Pp
In addition to the checks described above, this also tests if the
.Va length
argument was wrongly derived from a
.Fn sizeof "void *"
operation.
.Xr strlcpy 3
is a good example of a string function with this check.
.Pp
Some functions specify the length as two arguments:
the number of elements and the size of each element.
In this case, use the
.Dv __size__
attribute:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __size__ ,
.Va buffer ,
.Va nmemb ,
.Va size
.Li )))
.Pp
where
.Va buffer
contains the parameter number of the pointer to the buffer,
.Va nmemb
contains the parameter number of the number of members, and
.Va size
has the parameter number of the size of each element.
The type checks performed by
.Dv __size__
are the same as the
.Dv __buffer__
attribute.
See
.Xr fread 3
for an example of this type of function.
.Pp
If a function accepts a buffer parameter and specifies that it has to be of a
minimum length, the __minbytes__ attribute can be used:
.Pp
.Li __attribute__ ((__bounded__ (
.Dv __minbytes__ ,
.Va buffer ,
.Va minsize
.Li )))
.Pp
where 
.Va buffer
contains the parameter number of the pointer to the buffer, and
.Va minsize
specifies the minimum number of bytes that the buffer should be.
.Xr ctime_r 3
is an example of this type of function.
.Pp
If
.Fl Wbounded
is specified with
.Fl Wformat ,
additional checks are performed on
.Xr sscanf 3
format strings.
The 
.Ql %s
fields are checked for incorrect bound lengths by checking the size of the
buffer associated with the format argument.
a149 6
.Sh BUGS
The
.Fl Wbounded
flag only works with statically allocated fixed-size buffers.
Since it is applied at compile-time, dynamically allocated memory buffers
and non-constant arguments are ignored.
@


1.1.1.6
log
@Import latest OpenBSD ports, XFree and source in sync
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.14 2003/07/25 06:18:44 jmc Exp $
a154 12
.It
.Nm gcc
recognizes a new format attribute, kprintf, to deal with the extra format
arguments
.Ql %b ,
.Ql %: ,
.Ql %r ,
and
.Ql %z
used in the
.Ox
kernel.
d242 1
a242 1
where
d257 1
a257 1
The
@


1.1.1.7
log
@Synchronize with OpenBSD 3.4-beta
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.15 2003/08/26 02:19:13 tedu Exp $
a166 5
.It
.Nm gcc
does not store its version string in objects.
This behavior can be restored with
.Fl fident .
@


1.1.1.8
log
@Import OpenBSD again, for various reasons.
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.16 2003/12/28 18:09:46 miod Exp $
d160 1
@


1.1.1.9
log
@Import OpenBSD as of today again (seems pretty stable, I hope)

Prominent changes: more bgpd, tcpmd5; tcpdump/isakmpd fixes
@
text
@d1 1
a1 1
.\" $OpenBSD: gcc-local.1,v 1.17 2004/01/04 07:08:09 pvalchev Exp $
d281 1
a281 1
.Sh CAVEATS
@


