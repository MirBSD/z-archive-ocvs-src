head	1.9;
access;
symbols
	tg-mergetmp-mirosx-1:1.9
	tg-mergefixes-1-branch:1.9.0.4
	tg-mergefixes-1-base:1.9
	MIROS_X:1.9.0.2
	MIROS_X_BASE:1.9
	tg-mergetmp-3:1.9
	cvs-200412111650:1.1.1.7
	MIRBSD_XP_MIRPPC:1.8.0.4
	cvs-200410141645:1.1.1.6
	MIRBSD_XP_SPARC_BASE:1.8
	MIRBSD_XP_SPARC:1.8.0.2
	MIRBSD_7quater:1.5
	cvs-200405160640:1.1.1.6
	cvs-200401271800:1.1.1.6
	cvs-200401261630:1.1.1.6
	cvs-200401021645:1.1.1.6
	MIRBSD_7_ALPHA:1.5.0.6
	MIRBSD_7:1.5.0.4
	cvs-200312222040:1.1.1.5
	MIRBSD_7ter:1.5
	MIRBSD_7_DEV:1.5.0.2
	cvs-200310020700:1.1.1.4
	cvs-200309271030:1.1.1.4
	cvs-200309251530:1.1.1.4
	cvs-200308302005:1.1.1.3
	cvs-200308171200:1.1.1.3
	ctm-3496:1.1.1.3
	ctm-3449:1.1.1.3
	ctm-3437:1.1.1.3
	cvs-200307191805:1.1.1.3
	ctm-3425:1.1.1.3
	cvs-200307091500:1.1.1.3
	ctm-3389:1.1.1.3
	cvs-200306291430:1.1.1.3
	ctm-3341:1.1.1.2
	MIRBSD_5:1.3
	cvs-200306082100:1.1.1.2
	ctm-3316:1.1.1.2
	ctm-3272:1.1.1.1
	ctm-3264:1.1.1.1
	cvs-200305071630:1.1.1.1
	MIRBSD_4:1.1.1.1
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.9
date	2004.12.11.17.00.28;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2004.01.03.18.29.45;	author tg;	state Stab;
branches;
next	1.7;

1.7
date	2004.01.03.00.37.53;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.12.27.00.30.37;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.09.25.20.59.49;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.29.19.48.40;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.06.06.18.28.27;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.05.20.20.00.57;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.48.23;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.48.23;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.06.05.17.30.44;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.06.29.17.26.56;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.09.25.16.32.06;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.12.22.21.10.21;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2004.01.02.18.00.52;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2004.12.11.16.57.33;	author tg;	state Exp;
branches;
next	;


desc
@@


1.9
log
@merge
@
text
@.\"	$MirBSD: src/sbin/disklabel/disklabel.8,v 1.8 2004/01/03 18:29:45 tg Stab $
.\"	$OpenBSD: disklabel.8,v 1.58 2004/10/25 08:14:46 otto Exp $
.\"	$NetBSD: disklabel.8,v 1.9 1995/03/18 14:54:38 cgd Exp $
.\"
.\" Copyright (c) 1987, 1988, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Symmetric Computer Systems.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS "AS IS" AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@@(#)disklabel.8	8.2 (Berkeley) 4/19/94
.\"
.Dd October 27, 1997
.Dt DISKLABEL 8
.Os
.Sh NAME
.Nm disklabel
.Nd read and write disk pack label
.Sh SYNOPSIS
.Nm disklabel
.Op Fl c | d | r | t
.Op Fl v
.Op Fl p Ar unit
.Ar disk
.Nm disklabel
.Fl w
.Op Fl c | d | r
.Op Fl nv
.Ar disk Ar disktype
.Oo Ar packid Oc
.Nm disklabel
.Fl e
.Op Fl c | d | r
.Op Fl nv
.Ar disk
.Nm disklabel
.Fl E
.Op Fl c | d | r
.Op Fl nv
.Op Fl f Ar tempfile
.Ar disk
.Nm disklabel
.Fl R
.Op Fl nrv
.Ar disk Ar protofile
.Nm disklabel
.Fl N | W
.Op Fl nv
.Ar disk
.Pp
.Nm disklabel
.Fl B\ \&
.Op Fl nv
.Op Fl b Ar boot1
.Op Fl s Ar boot2
.Ar disk
.Oo Ar disktype Oc
.Nm disklabel
.Fl Bw
.Op Fl nv
.Op Fl b Ar boot1
.Op Fl s Ar boot2
.Ar disk Ar disktype
.Op Ar packid
.Nm disklabel
.Fl BR
.Op Fl nv
.Op Fl b Ar boot1
.Op Fl s Ar boot2
.Ar disk Ar protofile
.Op Ar disktype
.Sh DESCRIPTION
The
.Nm
utility can be used to install, examine, or modify the label on a disk drive or
pack.
The disk label contains information about disk characteristics
.Pq size, type, etc.
and the slice layout, stored on the disk itself.
It is used by the operating system to optimize disk I/O and
locate the filesystems resident on the disk.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl B
Install bootstrap code.
The
.Fl r
flag is implied by
.Fl B
and never needs to be specified.
.It Fl b
Specify the single level boot program, or the primary boot program,
depending on the system boot architecture
.Pq single or two-level .
.It Fl c
Clear the system's in-core copy of the label and update it based on
the on-disk label.
May not be used in conjunction with the
.Fl r
flag.
.It Fl d
Use the
.Em default
label.
This ignores any existing
.Mx
slices on the disk.
Note that this option will only work for disks
that are capable of reporting their geometry, such as SCSI, IDE, and ESDI.
May not be used in conjunction with the
.Fl r
flag.
.It Fl E
Use a simple initial label editor, using the command-driven built-in
editor described below.
.It Fl e
Edit an existing disk label using the editor specified in the
.Ev EDITOR
environment variable, or
.Xr vi 1
if none is specified.
.It Fl f Ar tempfile
Write entries to
.Ar tempfile
in
.Xr fstab 5
format for any slices for which mount point information has been
specified.
The
.Fl f
flag is only valid when used in conjunction with the
.Fl E
flag.
If
.Ar tempfile
already exists, it will be overwritten.
.It Fl N
Disallow writing of the pack label area on the selected disk.
.It Fl n
Make no permanent changes to the disklabel
.Pq useful for debugging purposes .
.It Fl p Ar unit
Print slice sizes and offsets in
.Ar unit
instead of sectors.
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes) and g(igabytes).
For operations other than displaying a slice the
.Ql %
(percent of total) and
.Ql &
(percent of free) units are also accepted.
.It Fl R
Restore a disk label that was formatted in a prior operation and
saved in an
.Tn ASCII
file.
.It Fl r
Causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk without kernel
support for a label, such as when labels are first installed on a
system.
This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk.
Its use is discouraged.
.It Fl s
On machines with a two-level bootstrap
.Pq such as i386-based systems ,
specify the secondary boot program.
.It Fl t
Format the label as a
.Xr disktab 5
entry.
.It Fl v
Print additional information during operation
.Pq verbose mode .
.It Fl W
Allow writing of the pack label area on the selected disk.
.It Fl w
Write a standard label on the designated drive.
.It Ar disk
Specify the
.Ar disk
to operate on.
It can be specified either by its full pathname or an abbreviated disk form.
In its abbreviated form, the path to the device, the
.Sq r
denoting
.Qq raw device ,
and the slice, can all be omitted.
For example, the first IDE disk can be specified as either
.Pa /dev/rwd0c ,
.Pa /dev/wd0c ,
or
.Ar wd0 .
.It Ar disktype
Specify a
.Ar disktype
entry from the
.Xr disktab 5
database.
.It Ar packid
Specify a pack identification string for the device
.Pq see below .
.It Ar protofile
Used with the restore option
.Pq Fl R
to specify a file to read an ASCII label from.
.El
.Pp
The first form of the command
.Pq read
is used to examine the label on the named disk drive.
It will display all of the parameters associated with the drive
and its slice layout.
Unless the
.Fl r
flag is given, the kernel's in-core copy of the label is displayed; if
the disk has no label, or the slice types on the disk are
incorrect, the kernel may have constructed or modified the label.
.Pp
The second form of the command
.Pq write
is used to write a standard label on the designated drive.
The drive parameters and slices are taken from that file.
If different disks of the same physical type are
to have different slices, it will be necessary to have separate
disktab entries describing each, or to edit the label after
installation as described below.
The optional argument is a pack
identification string, up to 16 characters long.
The pack ID must be quoted if it contains blanks.
If the
.Fl r
flag is given, the disk sectors containing the label and bootstrap
will be written directly.
A side-effect of this is that any existing
bootstrap code will be overwritten and the disk rendered unbootable.
If
.Fl r
is not specified, the existing label will be updated via the in-core
copy and any bootstrap code will be unaffected.
If the disk does not already have a label, the
.Fl r
flag must be used.
In either case, the kernel's in-core label is replaced.
.Pp
In the third form of the command
.Pq edit ,
the label is read from the in-core kernel copy, or directly from the disk if the
.Fl r
flag is also given.
The label is formatted and then supplied to an editor for changes.
If no editor is specified in an
.Ev EDITOR
environment variable,
.Xr vi 1
is used.
When the editor terminates, the formatted label is reread and
used to rewrite the disk label.
Existing bootstrap code is unchanged regardless of whether
.Fl r
was specified.
.Pp
The initial label editor mode
.Pq fourth form
is only intended for new disks as it will move slices around as necessary
to maintain a contiguous pool of free blocks.
Some commands or prompts take an optional unit.
Available units are
.Sq b
for bytes,
.Sq c
for cylinders,
.Sq k
for kilobytes,
.Sq m
for megabytes,
and
.Sq g
for gigabytes.
Quantities will be rounded to the nearest
cylinder when units are specified for sizes
.Pq or offsets .
Commands may be aborted by entering
.Ql ^D
.Pq Control-D .
Entering
.Ql ^D
at the main
.Ql >
prompt will exit the editor.
At prompts that request a size,
.Ql *
may be entered to indicate the rest of the available space.
The editor commands are as follows:
.Bl -tag -width "p [unit] "
.It Cm \&? Op Ar command
Display help message with all available commands.
A
.Em command
may be specified to get more detailed help.
There is also
.Pq simple
context-sensitive help available at most prompts.
.It Cm a Op Ar part
Add new slice.
This option adds a new BSD slice.
If no letter is specified
.Pq a\-p ,
the user will be prompted for one.
.It Cm b
Set
.Mx
disk boundaries.
This option tells
.Nm
which parts of the disk it is allowed to modify.
This option is probably only useful for ports with
.Xr fdisk 8
partition tables where the ending sector in the MBR is incorrect.
The user may enter
.Ql *
at the
.Dq Size
prompt to indicate the entire size of the disk
.Pq minus the starting sector .
This is useful for disks larger than 8 gigabytes where the
fdisk partition table is incapable of storing the real size.
.It Cm c Op Ar part
Change the size of an existing slice.
If no slice is specified, the user will be prompted for one.
The new size may be
in terms of the aforementioned units and may also be prefixed with
.Ql +
or
.Ql -
to change the size by a relative amount.
.It Cm D
Sets the disk label to the default values as reported by the kernel.
This simulates the case where there is no disk label.
.It Cm d Op Ar part
Delete an existing slice (or
.Ql *
to delete all slices).
If no slice is specified, the user will be prompted for one.
The
.Ql c
slice cannot be deleted.
.It Cm e
Edit drive parameters.
This option is used to set the following parameters:
disk type, a descriptive label string, sectors/track,
tracks/cylinder, sectors/cylinder, number of cylinders,
total sectors, rpm, and interleave.
.It Xo
.Cm g
.Sm off
.Op Ar b | d | u
.Sm on
.Xc
Set disk geometry based on what the
.Em BIOS ,
.Em disk ,
or
.Em user
thinks (the
.Em user
geometry is simply what the label said before
.Nm
made any changes).
.It Cm M
Display this manual page.
.It Cm m Op Ar part
Modify parameters for an existing slice.
If no slice is specified, the user will be prompted for one.
This option allows
the user to change the filesystem type, starting offset, size,
and mount point for the specified slice.
If expert mode is enabled (see
.Cm X
below), then block fragment size, block size, and cylinders per group
can also be modified.
Note that not all parameters are configurable for non-BSD slices.
.It Cm n Op Ar part
Name the mount point for an existing slice.
If no slice is specified, the user will be prompted for one.
This option is only valid if
.Nm
was invoked with the
.Fl f
flag.
.It Cm p Op Ar unit
Print the current disk label.
If a
.Em unit
is given, the size and offsets are displayed in terms of the
specified unit.
.It Cm q
Quit the editor.
If any changes have been made, the user will be
asked whether or not to save the changes to the on-disk label.
.It Cm r
Recalculate free space.
This option should really not be necessary under normal circumstances.
.It Cm s Op Ar path
Save the label to a file in
.Tn ASCII
format (suitable for loading via the
.Fl R
option).
If no path is specified, the user will be prompted for one.
.It Cm u
Undo
.Pq or redo
last change.
Entering
.Em u
once will undo the last change.
Entering it again will restore the change.
.It Cm w
Write the label to disk.
This option will commit any changes to the on-disk label.
.It Cm X
Toggle
.Dq expert mode .
By default, some settings are reserved for experts only
(such as the block and fragment size on ffs filesystems).
.It Cm x
Exit the editor without saving any changes to the label.
.It Cm z
Zeroes out the existing disklabel, leaving only the
.Sq c
slice.
The drive parameters are not changed.
.El
.Pp
In the restore form of the command
.Pq fifth form ,
the prototype file used to create the label should be in the same format
as that produced when reading or editing a label.
Comments are delimited by
.Ar #
and newline.
As with
.Fl w ,
any existing bootstrap code will be clobbered if
.Fl r
is specified and will be unaffected otherwise.
.Pp
The sixth form of the command
.Pq protect
is used to control write access to the label area of a disk
so that the label cannot be inadvertently overwritten.
The
.Fl N
and
.Fl W
options are only available on architectures that support this feature,
such as vax, hp300 and some sparc models.
.Pp
The final three forms of
.Nm
are used to install bootstrap code on machines where the bootstrap is
part of the label.
The bootstrap code is comprised of one or two boot programs,
depending on the machine.
.Pp
When installing bootstrap code with the
.Fl B
flag, if the names are not explicitly given, standard boot programs
will be used.
The boot programs are located in
.Pa /usr/mdec .
The names of the programs are taken from the
.Dq b0
and
.Dq b1
parameters of the
.Xr disktab 5
entry for the disk if
.Ar disktype
was given and its disktab entry exists and includes those parameters.
Otherwise, boot program names are derived from the name of the
disk.
These names are of the form
.Pa basename Ns boot
for the primary
.Pq or only
bootstrap, and
.Pf boot Pa basename
for the secondary bootstrap; for example,
.Pa /usr/mdec/sdboot
and
.Pa /usr/mdec/bootsd
if the disk device is
.Em sd0 .
.Pp
The first of the three boot-installation forms is used to install
bootstrap code without changing the existing label.
It is essentially a read command with respect to the disk label itself
and all options are related to the specification of the boot program
as described previously.
The final two forms are analogous to the basic write and restore versions
except that they will install bootstrap code in addition to a new label.
.Pp
Note that when a disk has no real BSD disklabel, the kernel creates a
default label so that the disk can be used.
This default label will include other slices found on the disk if
they are supported on your architecture.
For example, on systems that support
.Xr fdisk 8
partitions the default label will also include DOS and Linux partitions.
However, these entries are not dynamic, they are fixed at the time
.Nm
is run.
That means that subsequent changes that affect non-MirBSD
slices will not be present in the default label,
though they may be updated by hand.
To see the default label, run
.Nm
with the
.Fl d
flag.
.Nm
can then be run with the
.Fl e
flag and any entries pasted as desired from the default label into the real one.
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disklabels
Directory for backup labels.
.It Pa /etc/disktab
Disk description file.
.It Pa /usr/mdec/ Ns Em xx Ns boot
Primary bootstrap.
.It Pa /usr/mdec/boot Ns Em xx
Secondary bootstrap.
.El
.Sh EXAMPLES
Display the in-core label for sd0 as obtained via
.Pa /dev/rsd0c :
.Pp
.Dl # disklabel sd0
.Pp
Create a label for sd0 based on information for
.Dq sd2212
found in
.Pa /etc/disktab .
Any existing bootstrap code will be clobbered.
(Normally you do not want to use the
.Fl r
flag though.)
.Pp
.Dl # disklabel -w -r /dev/rsd0c sd2212 foo
.Pp
Read the on-disk label for sd0, edit it and reinstall in-core as
well as on-disk.
(Normally you do not want to use the
.Fl r
flag
though.)
Existing bootstrap code is unaffected.
.Pp
.Dl # disklabel -e -r sd0
.Pp
Restore the on-disk and in-core label for sd0 from information in
.Pa mylabel .
Existing bootstrap code is unaffected.
.Pp
.Dl # disklabel -R sd0 mylabel
.Pp
Install a new bootstrap on sd0.
The boot code comes from
.Pa /usr/mdec/sdboot
and possibly
.Pa /usr/mdec/bootsd .
On-disk and in-core labels are unchanged, but on some systems other
information may be destroyed.
Use with care.
.Pp
.Dl # disklabel -B sd0
.Pp
Install a new label and bootstrap.
The label is derived from disktab information for
.Dq sd2212
and installed both in-core and
on-disk.
The bootstrap code comes from the file
.Pa /usr/mdec/newboot .
.Pp
.Dl # disklabel -w -B /dev/rsd0c -b newboot sd2212
.Sh DIAGNOSTICS
The kernel device drivers will not allow the size of a disk slice
to be decreased or the offset of a slice to be changed while
it is open.
Some device drivers create a label containing only a
single large slice if a disk is unlabeled; thus, the label must
be written to the
.Sq a
slice of the disk while it is open.
This sometimes requires the desired label to be set in two steps,
the first one creating at least one other slice, and the second
setting the label on the new slice while shrinking the
.Sq a
slice.
.Pp
On some machines the bootstrap code may not fit entirely in the
area allocated for it by some filesystems.
As a result, it may
not be possible to have filesystems on some slices of a
.Dq bootable
disk.
When installing bootstrap code,
.Nm
checks for these cases.
If the installed boot code would overlap a slice of type
.Dv FS_UNUSED
it is marked as type
.Dv FS_BOOT .
The
.Xr newfs 8
utility will disallow creation of filesystems on
.Dv FS_BOOT
slices.
Conversely, if a slice has a type other than
.Dv FS_UNUSED
or
.Dv FS_BOOT ,
.Nm
will not install bootstrap code that overlaps it.
.Sh SEE ALSO
.Xr disklabel 5 ,
.Xr disktab 5 ,
.Xr scan_ffs 8
.Sh CAVEATS
On i386 machines,
.Xr installboot 8
is normally used to install boot code.
The
.Fl B
option to
.Nm
can still be used to install old style boot code,
but this usage is deprecated.
.Pp
On some machines, such as the sparc, disklabels
may not exhibit the full functionality that is described above.
.Pp
.Nm
only supports up to a maximum of 15 slices,
.Sq a
through
.Sq p ,
excluding
.Sq c .
The
.Sq c
slice is reserved for the entire physical disk.
By convention, the
.Sq a
slice of the boot disk is the root filesystem, and the
.Sq b
slice of the boot disk is the swap partition,
but all other letters can be used in any order for any other
slices as desired.
.Sh BUGS
When a disk name is given without a full pathname, the constructed
device name uses the
.Sq c
slice.
In
.Fl E
mode,
.Nm
is far too quick to shuffle slices around; it should keep a
free block list and only move slices around with the user's
permission.
@


1.8
log
@it appears to work, moving out the partition with the disklabel
into an extended partition.

snippets from dmesg, fdisk and disklabel:

MirBSD#7u96 3.4-20040103 (GENERIC) #330: Sat Jan  3 18:04:27 UTC 2004
	tg@@odem.66h.42h.de:/usr/src/sys/arch/i386/compile/GENERIC
[...]
Searching for raid components...
debug: found partition 0: type 0F ofs 1 (0x1h) size 1 (0x1), chaining...
debug: found partition 3: type 27 ofs 15200640 (0xE7F180h) size 23869440 (0x16C3800).
warning: broken MBR signature
warning: broken MBR signature
dkcsum: wd0 matched BIOS disk 80



Disk: wd0	geometry: 38760/16/63 [39070080 Sectors]
Offset: 0	Signature: 0xAA55
         Starting       Ending       LBA Info:
 #: id    C   H  S -    C   H  S [       start:      size   ]
------------------------------------------------------------------------
 0: 0F    0   0  2 -    0   0  2 [           1:           1 ] Extended LBA
 1: DB  510   0  1 - 15079  15 63 [      514080:    14686560 ] CPM/C.DOS/C*
 2: 06    0   0  3 -  509  15 63 [           2:      514078 ] DOS > 32MB
*3: DB 15080   0  1 - 38759  15 63 [    15200640:    23869440 ] CPM/C.DOS/C*
Offset: 1	Signature: 0xAA55
         Starting       Ending       LBA Info:
 #: id    C   H  S -    C   H  S [       start:      size   ]
------------------------------------------------------------------------
 0: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
 1: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
 2: 00    0   0  0 -    0   0  0 [           0:           0 ] unused
*3: 27 15080   0  1 - 38759  15 63 [    15200640:    23869440 ] MirBSD



# found partition 0: type 0F ofs 1 (0x1h) size 1 (0x1), chaining...
# found partition 3: type 27 ofs 15200640 (0xE7F180h) size 23869440 (0x16C3800).
# /dev/rwd0c:
type: ESDI
disk: ESDI/IDE disk
label: IC25N020ATCS04-0
flags:
bytes/sector: 512
sectors/track: 63
tracks/cylinder: 16
sectors/cylinder: 1008
cylinders: 16383
total sectors: 39070080
rpm: 3600
interleave: 1
trackskew: 0
cylinderskew: 0
headswitch: 0		# microseconds
track-to-track seek: 0	# microseconds
drivedata: 0

16 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  a: 17053344 22016736    4.2BSD     2048 16384   328 	# (Cyl. 21842 - 38759)
  b:   524160 15200640      swap                      	# (Cyl. 15080 - 15599)
  c: 39070080        0    unused        0     0       	# (Cyl.    0 - 38759)
  d:  6291936 15724800    4.2BSD     2048 16384   328 	# (Cyl. 15600 - 21841)
  e: 14686560   514080    4.2BSD     2048 16384   328 	# (Cyl.  510 - 15079)
  m:   514078        2     MSDOS                      	# (Cyl.    0*- 509)
  p:        2        0   unknown                      	# (Cyl.    0 - 0*)
@
text
@d1 2
a2 2
.\"	$MirBSD: disklabel.8,v 1.7 2004/01/03 00:37:53 tg Exp $
.\"	$OpenBSD: disklabel.8,v 1.57 2003/12/30 10:54:33 jmc Exp $
d213 1
a213 1
donating
@


1.7
log
@merge OpenBSD, fix mdoc error
@
text
@d1 1
a1 1
.\"	$MirBSD: disklabel.8,v 1.6 2003/12/27 00:30:37 tg Exp $
d23 1
a23 1
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
d131 1
a131 1
.Ox
d332 3
a334 3
Add new partition.
This option adds a new BSD partition.
If no partition letter is specified
d339 1
a339 1
.Ox
d357 1
a357 1
If no partition is specified, the user will be prompted for one.
d409 1
a409 1
Note that not all parameters are configurable for non-BSD partitions.
d542 1
a542 1
That means that subsequent changes that affect non-OpenBSD
d672 1
a672 1
On some machines, such as the sparc, slice tables
d676 1
a676 1
only supports up to a maximum of 15 partitions,
d684 1
a684 1
partition is reserved for the entire physical disk.
d687 1
a687 1
partition of the boot disk is the root partition, and the
d689 1
a689 1
partition of the boot disk is the swap partition,
d691 1
a691 1
partitions as desired.
a694 2
.Sq a
slice on the tahoe, the
d696 1
a696 1
slice on all others.
a703 5
Also, in
.Fl E
mode, slices outside the
.Mx
portion of the disk should be changeable.
@


1.6
log
@finish merging and sync a bit; bump version etc.
@
text
@d1 2
a2 2
.\"	$MirBSD: disklabel.8,v 1.5 2003/09/25 20:59:49 tg Exp $
.\"	$OpenBSD: disklabel.8,v 1.55 2003/12/20 09:29:27 jmc Exp $
d172 5
d323 1
a323 1
.It Cm ?\& Op Ar command
d479 1
a479 1
so that the label cannot be inadvertantly overwritten.
@


1.5
log
@Merge OpenBSD-current
@
text
@d1 2
a2 2
.\"	$MirBSD: disklabel.8,v 1.4 2003/06/29 19:48:40 tg Exp $
.\"	$OpenBSD: disklabel.8,v 1.54 2003/09/02 18:30:27 jmc Exp $
d45 2
a46 2
.Op Fl n
.Op Fl cd Li \&| Fl r
a47 2
.Op Fl t
.Op Fl v
d51 2
a52 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d57 2
a58 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d62 2
a64 3
.Op Fl n
.Op Fl cd Li \&| Fl r
.Op Fl v
d68 1
a68 3
.Op Fl r
.Op Fl n
.Op Fl v
d71 2
a72 3
.Op Fl NW
.Op Fl n
.Op Fl v
d76 3
a78 5
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a79 1
.Oc
d83 3
a85 6
.Fl w
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a86 1
.Oc
d88 1
a88 1
.Oo Ar packid Oc
d90 3
a92 6
.Fl R
.Fl B
.Op Fl n
.Op Fl v
.Oo
.Fl b Ar boot1
a93 1
.Oc
d95 1
a95 1
.Oo Ar disktype Oc
d101 3
a103 3
The disk label contains information about disk characteristics (size,
type, etc.) and the slice layout, stored on the disk
itself.
a108 14
.It Fl n
Make no permanent changes to the disklabel (useful for debugging
purposes).
.It Fl v
Print additional information during operation (verbose mode).
.It Fl r
Causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk without kernel
support for a label, such as when labels are first installed on a
system.
This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk.
Its use is discouraged.
d118 8
a125 4
depending on the system boot architecture (single or two-level).
.It Fl s
On machines with a two-level bootstrap (such as i386-based systems),
specify the secondary boot program.
d138 9
a146 6
.It Fl c
Clear the system's in-core copy of the label and update it based on
the on-disk label.
May not be used in conjunction with the
.Fl r
flag.
d162 5
d171 1
a171 17
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes) and
g(igabytes).
.It Fl t
Format the label as a
.Xr disktab 5
entry.
.It Fl w
Write a standard label on the designated drive.
.It Fl e
Edit an existing disk label using the editor specified in the
.Ev EDITOR
environment variable, or
.Xr vi 1
if none is specified.
.It Fl E
Use a simple initial label editor, using the command-driven built-in
editor described below.
d177 20
a196 2
.It Fl N
Disallow writing of the pack label area on the selected disk.
d199 30
d231 3
a233 3
The first form of the command (read) is used to examine the label on
the named disk drive (e.g., sd0 or
.Pa /dev/rsd0c ) .
d242 3
a244 2
The second form of the command (write) is used to write a standard
label on the designated drive.
d268 3
a270 2
In the third form of the command (edit), the label is read from the
in-core kernel copy, or directly from the disk if the
d285 4
a288 3
The initial label editor mode is only intended for new disks as it
will move slices around as necessary to maintain a contiguous pool
of free blocks.
d303 2
a304 1
cylinder when units are specified for sizes (or offsets).
d307 1
a307 1
(Control-D).
d318 1
a318 1
.It \&? Op command
d320 1
a320 1
You may specify a
d322 11
a332 23
for which to get more detailed help.
There is also (simple) context-sensitive help available at most prompts.
.It M
Display this manual page.
.It u
Undo (or redo) last change.
Entering
.Em u
once will undo your last change.
Entering it again will restore the change.
.It p Op unit
Print the current disk label.
If a
.Em unit
is given, the size and offsets are displayed in terms of the
specified unit.
.It e
Edit drive parameters.
This option is used to set the following
parameters: sectors/track, tracks/cylinder, sectors/cylinder,
number of cylinders on the disk, total sectors on the disk, rpm,
interleave, disk type, and a descriptive label string.
.It b
d339 3
a341 3
This option is
probably only useful for ports with fdisk partition tables where the
ending sector in the MBR is incorrect.
d346 5
a350 14
prompt to indicate the entire size of the disk (minus
the starting sector).
This is useful for disks larger than 8
gigabytes where the fdisk partition table is incapable of storing
the real size.
.It r
Recalculate free space.
This option should really not be necessary under normal circumstances.
.It a Op part
Add new slice.
This option adds a new BSD slice.
If no slice letter is specified (a-p), the user will be prompted for
one.
.It c Op part
d352 1
a352 1
If no slice is specified, the user will be prompted for one.
d359 4
a362 1
.It d Op part
d367 1
a367 1
You may not delete the
d369 13
a381 2
slice.
.It g Op d|b|u
d383 1
a384 1
.Em BIOS ,
d392 3
a394 4
.It D
Sets the disk label to the default values as reported by the kernel.
This simulates the case where there is no disk label.
.It m Op part
d398 8
a405 5
the user to change the filesystem type, starting offset, slice
size, block fragment size, block size, and cylinders per group for
the specified slice (not all parameters are configurable for
non-BSD slices).
.It n Op part
d413 14
a426 1
.It s Op path
d429 1
a429 2
format (suitable for loading via
the
d433 9
a441 1
.It w
d444 1
a444 7
.It q
Quit the editor.
If any changes have been made, the user will be
asked whether or not to save the changes to the on-disk label.
.It x
Exit the editor without saving any changes to the label.
.It X
d447 7
a453 5
By default, some settings are reserved for experts only (such as the
block and fragment size on ffs slices).
.It z
Zeroes out the existing slice table, leaving only the
.Dq c
d458 4
a461 3
In the restore form of the command, the prototype file used to create
the label should be in the same format as that produced when reading
or editing a label.
d463 1
a463 1
.Ar \&#
d471 11
d486 2
a487 2
The bootstrap code is comprised of one or two boot
programs depending on the machine.
d508 3
a510 1
for the primary (or only) bootstrap, and
d521 5
a525 7
It is essentially
a read command with respect to the disk label itself and all options
are related to the specification of the boot program as described
previously.
The final two forms are analogous to the basic write and
restore versions except that they will install bootstrap code in
addition to a new label.
d527 1
a527 1
Note that when a disk has no real BSD disklabel the kernel creates a
d538 2
a539 2
slices will not be present in the default label, though you
may update them by hand.
a544 1
You can then run
d546 1
a546 1
with the
d548 1
a548 2
flag and paste any entries you want from the default label into the real
one.
d551 2
d554 1
d556 1
d558 1
a560 2
.Li # disklabel sd0
.Pp
d562 1
a562 1
.Pa /dev/rsd0c .
d564 1
a564 1
.Li # disklabel -w -r /dev/rsd0c sd2212 foo
d575 1
a575 1
.Li # disklabel -e -r sd0
d585 1
a585 1
.Li # disklabel -R sd0 mylabel
d591 1
a591 1
.Li # disklabel -B sd0
d602 1
a602 1
.Li # disklabel -w -B /dev/rsd0c -b newboot sd2212
d611 2
d656 1
a656 1
.Sh NOTES
d669 1
a669 1
.Sh CAVEATS
d704 1
a704 1
.Ox
@


1.4
log
@merge the import
amd (automount dæmon) bites the dust
rewrite fake-NLS emulation, copyright to me
foobar! fnord!
@
text
@d1 2
a2 2
.\"	$MirBSD: disklabel.8,v 1.3 2003/06/06 18:28:27 tg Exp $
.\"	$OpenBSD: disklabel.8,v 1.53 2003/06/21 23:14:23 jmc Exp $
d303 1
a303 1
.It ? Op command
@


1.3
log
@Merge OpenBSD-current
@
text
@d1 2
a2 2
.\"	$MirBSD: disklabel.8,v 1.2 2003/05/20 20:00:57 tg Exp $
.\"	$OpenBSD: disklabel.8,v 1.52 2003/06/03 13:16:08 jmc Exp $
d628 18
@


1.2
log
@employ our own idea of a MirBSD disklabel and partition type:
 0xA6 OpenBSD is used as fall-back
 0x27 MirBSD disklabel is the new type
reason: addition of FS_* constants in sys/sys/disklabel.h
might get us outta sync with OpenBSD laters (NTFS here)

talk about "slices" in disklabel
remove trailing newlines etc. in fdisk
@
text
@d1 2
a2 2
.\"	$MirBSD$
.\"	$OpenBSD: disklabel.8,v 1.50 2003/03/12 20:12:36 deraadt Exp $
d19 1
a19 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
d222 1
a222 1
.Pa /dev/rsd0c Ns ).
d513 6
a571 10
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disktab
.It Pa /usr/mdec/ Ns Em xx Ns boot
.It Pa /usr/mdec/boot Ns Em xx
.El
.Sh SEE ALSO
.Xr disklabel 5 ,
.Xr disktab 5 ,
.Xr scan_ffs 8
d611 4
@


1.1
log
@Initial revision
@
text
@d1 1
d125 1
a125 1
type, etc.) and the partition layout, stored on the disk
d165 1
a165 1
partitions on the disk.
d182 1
a182 1
format for any partitions for which mount point information has been
d193 1
a193 1
Print partition sizes and offsets in
d228 1
a228 1
and its partition layout.
d232 1
a232 1
the disk has no label, or the partition types on the disk are
d237 1
a237 1
The drive parameters and partitions are taken from that file.
d239 1
a239 1
to have different partitions, it will be necessary to have separate
d277 1
a277 1
will move partitions around as necessary to maintain a contiguous pool
d356 3
a358 3
Add new partition.
This option adds a new BSD partition.
If no partition letter is specified (a-p), the user will be prompted for
d361 2
a362 2
Change the size of an existing partition.
If no partition is specified, the user will be prompted for one.
d370 1
a370 1
Delete an existing partition (or
d372 2
a373 2
to delete all partitions).
If no partition is specified, the user will be prompted for one.
d376 1
a376 1
partition.
d392 2
a393 2
Modify parameters for an existing partition.
If no partition is specified, the user will be prompted for one.
d395 1
a395 1
the user to change the filesystem type, starting offset, partition
d397 2
a398 2
the specified partition (not all parameters are configurable for
non-BSD partitions).
d400 2
a401 2
Name the mount point for an existing partition.
If no partition is specified, the user will be prompted for one.
d428 1
a428 1
block and fragment size on ffs partitions).
d430 1
a430 1
Zeroes out the existing partition table, leaving only the
d432 1
a432 1
partition.
d495 1
a495 1
This default label will include other partitions found on the disk if
d504 1
a504 1
partitions will not be present in the default label, though you
d581 2
a582 2
The kernel device drivers will not allow the size of a disk partition
to be decreased or the offset of a partition to be changed while
d585 1
a585 1
single large partition if a disk is unlabeled; thus, the label must
d588 1
a588 1
partition of the disk while it is open.
d590 2
a591 2
the first one creating at least one other partition, and the second
setting the label on the new partition while shrinking the
d593 1
a593 1
partition.
d598 1
a598 1
not be possible to have filesystems on some partitions of a
d604 1
a604 1
If the installed boot code would overlap a partition of type
d612 2
a613 2
partitions.
Conversely, if a partition has a type other than
d630 1
a630 1
On some machines, such as the sparc, partition tables
d636 1
a636 1
partition on the tahoe, the
d638 1
a638 1
partition on all others.
d643 2
a644 2
is far too quick to shuffle partitions around; it should keep a
free block list and only move partitions around with the user's
d648 1
a648 1
mode, partitions outside the
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import latest OpenBSD CVS tree by CTM in order
to sync the base system and ports tree with Them.

This includes the recent licence changes as well - by
importing the changed base and re-applying the diffs
(with cvs up -j -j) they are inherited, and we're not
bound to the removed clauses any longer.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.52 2003/06/03 13:16:08 jmc Exp $
d18 5
a22 1
.\" 3. Neither the name of the University nor the names of its contributors
d225 1
a225 1
.Pa /dev/rsd0c ) .
a515 6
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa /etc/disktab
.It Pa /usr/mdec/ Ns Em xx Ns boot
.It Pa /usr/mdec/boot Ns Em xx
.El
d569 10
a617 4
.Sh SEE ALSO
.Xr disklabel 5 ,
.Xr disktab 5 ,
.Xr scan_ffs 8
@


1.1.1.3
log
@the previous cvs import did not finish due to 'memory fault'
sync with OpenBSD-cvs
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.53 2003/06/21 23:14:23 jmc Exp $
a626 18
.Sh CAVEATS
.Nm
only supports up to a maximum of 15 partitions,
.Sq a
through
.Sq p ,
excluding
.Sq c .
The
.Sq c
partition is reserved for the entire physical disk.
By convention, the
.Sq a
partition of the boot disk is the root partition, and the
.Sq b
partition of the boot disk is the swap partition,
but all other letters can be used in any order for any other
partitions as desired.
@


1.1.1.4
log
@Release Time. Synchronize with OpenBSD 3.4-current (base system).
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.54 2003/09/02 18:30:27 jmc Exp $
d302 1
a302 1
.It \&? Op command
@


1.1.1.5
log
@Time to import OpenBSD once again. Expect breakage.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.55 2003/12/20 09:29:27 jmc Exp $
d44 4
a47 1
.Op Fl c | d | r | t
a48 1
.Op Fl p Ar unit
d52 3
a54 2
.Op Fl c | d | r
.Op Fl nv
d59 3
a61 2
.Op Fl c | d | r
.Op Fl nv
a64 2
.Op Fl c | d | r
.Op Fl nv
d66 3
d72 3
a74 1
.Op Fl nrv
d77 3
a79 2
.Fl N | W
.Op Fl nv
d83 5
a87 3
.Fl B\ \&
.Op Fl nv
.Op Fl b Ar boot1
d89 1
d93 6
a98 3
.Fl Bw
.Op Fl nv
.Op Fl b Ar boot1
d100 1
d102 1
a102 1
.Op Ar packid
d104 6
a109 3
.Fl BR
.Op Fl nv
.Op Fl b Ar boot1
d111 1
d113 1
a113 1
.Op Ar disktype
d119 3
a121 3
The disk label contains information about disk characteristics
.Pq size, type, etc.
and the partition layout, stored on the disk itself.
d127 14
d150 4
a153 8
depending on the system boot architecture
.Pq single or two-level .
.It Fl c
Clear the system's in-core copy of the label and update it based on
the on-disk label.
May not be used in conjunction with the
.Fl r
flag.
d166 6
a171 9
.It Fl E
Use a simple initial label editor, using the command-driven built-in
editor described below.
.It Fl e
Edit an existing disk label using the editor specified in the
.Ev EDITOR
environment variable, or
.Xr vi 1
if none is specified.
a186 5
.It Fl N
Disallow writing of the pack label area on the selected disk.
.It Fl n
Make no permanent changes to the disklabel
.Pq useful for debugging purposes .
d191 17
a207 1
Valid units are b(ytes), c(ylinders), k(ilobytes), m(egabytes) and g(igabytes).
d213 2
a214 20
.It Fl r
Causes the label to be read from or written to the disk directly,
rather than going through the system's in-core copy of the label.
This option may allow a label to be installed on a disk without kernel
support for a label, such as when labels are first installed on a
system.
This flag does not work on a number of architectures, thus it is
not considered the right way to put a new label on a disk.
Its use is discouraged.
.It Fl s
On machines with a two-level bootstrap
.Pq such as i386-based systems ,
specify the secondary boot program.
.It Fl t
Format the label as a
.Xr disktab 5
entry.
.It Fl v
Print additional information during operation
.Pq verbose mode .
a216 30
.It Fl w
Write a standard label on the designated drive.
.It Ar disk
Specify the
.Ar disk
to operate on.
It can be specified either by its full pathname or an abbreviated disk form.
In its abbreviated form, the path to the device, the
.Sq r
donating
.Qq raw device ,
and the slice, can all be omitted.
For example, the first IDE disk can be specified as either
.Pa /dev/rwd0c ,
.Pa /dev/wd0c ,
or
.Ar wd0 .
.It Ar disktype
Specify a
.Ar disktype
entry from the
.Xr disktab 5
database.
.It Ar packid
Specify a pack identification string for the device
.Pq see below .
.It Ar protofile
Used with the restore option
.Pq Fl R
to specify a file to read an ASCII label from.
d219 3
a221 3
The first form of the command
.Pq read
is used to examine the label on the named disk drive.
d230 2
a231 3
The second form of the command
.Pq write
is used to write a standard label on the designated drive.
d255 2
a256 3
In the third form of the command
.Pq edit ,
the label is read from the in-core kernel copy, or directly from the disk if the
d271 3
a273 4
The initial label editor mode
.Pq fourth form
is only intended for new disks as it will move partitions around as necessary
to maintain a contiguous pool of free blocks.
d288 1
a288 2
cylinder when units are specified for sizes
.Pq or offsets .
d291 1
a291 1
.Pq Control-D .
d302 1
a302 1
.It Cm ?\& Op Ar command
d304 1
a304 1
A
d306 23
a328 11
may be specified to get more detailed help.
There is also
.Pq simple
context-sensitive help available at most prompts.
.It Cm a Op Ar part
Add new partition.
This option adds a new BSD partition.
If no partition letter is specified
.Pq a\-p ,
the user will be prompted for one.
.It Cm b
d335 3
a337 3
This option is probably only useful for ports with
.Xr fdisk 8
partition tables where the ending sector in the MBR is incorrect.
d342 14
a355 5
prompt to indicate the entire size of the disk
.Pq minus the starting sector .
This is useful for disks larger than 8 gigabytes where the
fdisk partition table is incapable of storing the real size.
.It Cm c Op Ar part
d364 1
a364 4
.It Cm D
Sets the disk label to the default values as reported by the kernel.
This simulates the case where there is no disk label.
.It Cm d Op Ar part
d369 1
a369 1
The
d371 2
a372 13
partition cannot be deleted.
.It Cm e
Edit drive parameters.
This option is used to set the following parameters:
disk type, a descriptive label string, sectors/track,
tracks/cylinder, sectors/cylinder, number of cylinders,
total sectors, rpm, and interleave.
.It Xo
.Cm g
.Sm off
.Op Ar b | d | u
.Sm on
.Xc
d374 1
a375 1
.Em disk ,
d383 4
a386 3
.It Cm M
Display this manual page.
.It Cm m Op Ar part
d390 5
a394 8
the user to change the filesystem type, starting offset, partition size,
and mount point for the specified partition.
If expert mode is enabled (see
.Cm X
below), then block fragment size, block size, and cylinders per group
can also be modified.
Note that not all parameters are configurable for non-BSD partitions.
.It Cm n Op Ar part
d402 1
a402 14
.It Cm p Op Ar unit
Print the current disk label.
If a
.Em unit
is given, the size and offsets are displayed in terms of the
specified unit.
.It Cm q
Quit the editor.
If any changes have been made, the user will be
asked whether or not to save the changes to the on-disk label.
.It Cm r
Recalculate free space.
This option should really not be necessary under normal circumstances.
.It Cm s Op Ar path
d405 2
a406 1
format (suitable for loading via the
d410 1
a410 9
.It Cm u
Undo
.Pq or redo
last change.
Entering
.Em u
once will undo the last change.
Entering it again will restore the change.
.It Cm w
d413 7
a419 1
.It Cm X
d422 3
a424 5
By default, some settings are reserved for experts only
(such as the block and fragment size on ffs partitions).
.It Cm x
Exit the editor without saving any changes to the label.
.It Cm z
d426 1
a426 1
.Sq c
d431 3
a433 4
In the restore form of the command
.Pq fifth form ,
the prototype file used to create the label should be in the same format
as that produced when reading or editing a label.
d435 1
a435 1
.Ar #
a442 11
The sixth form of the command
.Pq protect
is used to control write access to the label area of a disk
so that the label cannot be inadvertantly overwritten.
The
.Fl N
and
.Fl W
options are only available on architectures that support this feature,
such as vax, hp300 and some sparc models.
.Pp
d447 2
a448 2
The bootstrap code is comprised of one or two boot programs,
depending on the machine.
d469 1
a469 3
for the primary
.Pq or only
bootstrap, and
d480 7
a486 5
It is essentially a read command with respect to the disk label itself
and all options are related to the specification of the boot program
as described previously.
The final two forms are analogous to the basic write and restore versions
except that they will install bootstrap code in addition to a new label.
d488 1
a488 1
Note that when a disk has no real BSD disklabel, the kernel creates a
d499 2
a500 2
partitions will not be present in the default label,
though they may be updated by hand.
d506 1
d508 1
a508 1
can then be run with the
d510 2
a511 1
flag and any entries pasted as desired from the default label into the real one.
a513 2
.It Pa /etc/disklabels
Directory for backup labels.
a514 1
Disk description file.
a515 1
Primary bootstrap.
a516 1
Secondary bootstrap.
d519 2
d522 1
a522 1
.Pa /dev/rsd0c :
d524 1
a524 1
.Dl # disklabel sd0
d535 1
a535 1
.Dl # disklabel -w -r /dev/rsd0c sd2212 foo
d545 1
a545 1
.Dl # disklabel -e -r sd0
d551 1
a551 1
.Dl # disklabel -R sd0 mylabel
d562 1
a562 1
.Dl # disklabel -B sd0
a570 2
.Pp
.Dl # disklabel -w -B /dev/rsd0c -b newboot sd2212
d614 1
a614 1
.Sh CAVEATS
d627 1
a627 1
.Pp
@


1.1.1.6
log
@Import OpenBSD again, for various reasons.
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.57 2003/12/30 10:54:33 jmc Exp $
a170 5
For operations other than displaying a partition the
.Ql %
(percent of total) and
.Ql &
(percent of free) units are also accepted.
d473 1
a473 1
so that the label cannot be inadvertently overwritten.
@


1.1.1.7
log
@some more updates/fixes
@
text
@d1 1
a1 1
.\"	$OpenBSD: disklabel.8,v 1.58 2004/10/25 08:14:46 otto Exp $
d212 1
a212 1
denoting
@


