head	1.15;
access;
symbols
	tg-mergetmp-mirosx-1:1.15
	tg-mergefixes-1-branch:1.15.0.4
	tg-mergefixes-1-base:1.15
	MIROS_X:1.15.0.2
	MIROS_X_BASE:1.15
	tg-mergetmp-3:1.15
	MIRBSD_XP_MIRPPC:1.14.0.4
	MIRBSD_XP_SPARC_BASE:1.14
	MIRBSD_XP_SPARC:1.14.0.2
	MIRBSD_7quater:1.9
	cvs-200405160640:1.1.1.13
	cvs-200401271800:1.1.1.12
	cvs-200401261630:1.1.1.12
	cvs-200401021645:1.1.1.11
	MIRBSD_7_ALPHA:1.9.0.6
	MIRBSD_7:1.9.0.4
	cvs-200312222040:1.1.1.10
	MIRBSD_7ter:1.9
	MIRBSD_7_DEV:1.9.0.2
	cvs-200310020700:1.1.1.9
	cvs-200309271030:1.1.1.9
	cvs-200309251530:1.1.1.9
	cvs-200308302005:1.1.1.8
	cvs-200308171200:1.1.1.7
	ctm-3496:1.1.1.7
	ctm-3449:1.1.1.6
	ctm-3437:1.1.1.6
	cvs-200307191805:1.1.1.6
	ctm-3425:1.1.1.6
	cvs-200307091500:1.1.1.5
	ctm-3389:1.1.1.5
	cvs-200306291430:1.1.1.5
	ctm-3341:1.1.1.5
	MIRBSD_5:1.4
	cvs-200306082100:1.1.1.4
	ctm-3316:1.1.1.4
	ctm-3272:1.1.1.4
	ctm-3264:1.1.1.4
	cvs-200305071630:1.1.1.3
	MIRBSD_4:1.2
	ctm-3203:1.1.1.2
	cvs-20030410-1130:1.1.1.2
	ctm-3155:1.1.1.2
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@.\" @;


1.15
date	2004.10.24.15.11.20;	author tg;	state Exp;
branches;
next	1.14;

1.14
date	2004.05.21.20.08.43;	author tg;	state Stab;
branches;
next	1.13;

1.13
date	2004.01.27.17.43.07;	author tg;	state Exp;
branches;
next	1.12;

1.12
date	2004.01.03.04.51.45;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.12.27.00.31.55;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.10.29.19.44.16;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.09.25.21.00.25;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.08.31.20.55.40;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.08.16.15.27.29;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.07.18.15.46.51;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.19.16.45.18;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.05.12.22.23.44;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.07.20.55.00;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.29.23.03.00;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.17.55.46;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.17.55.46;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.03.29.19.53.18;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.05.07.17.57.30;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.05.12.16.33.14;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.06.19.12.57.24;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.07.18.13.59.37;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2003.08.11.18.55.25;	author tg;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2003.08.30.23.57.55;	author tg;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2003.09.25.16.46.00;	author tg;	state Exp;
branches;
next	1.1.1.10;

1.1.1.10
date	2003.12.22.21.19.30;	author tg;	state Exp;
branches;
next	1.1.1.11;

1.1.1.11
date	2004.01.02.18.11.26;	author tg;	state Exp;
branches;
next	1.1.1.12;

1.1.1.12
date	2004.01.26.19.12.35;	author tg;	state Exp;
branches;
next	1.1.1.13;

1.1.1.13
date	2004.05.16.07.23.33;	author tg;	state Exp;
branches;
next	;


desc
@@


1.15
log
@sync, after make b-r w/o X
@
text
@.\" $OpenBSD: openssl.1,v 1.42 2004/04/19 12:25:41 jmc Exp $
.\" ====================================================================
.\" Copyright (c) 1998-2002 The OpenSSL Project.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\"
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\"
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in
.\"    the documentation and/or other materials provided with the
.\"    distribution.
.\"
.\" 3. All advertising materials mentioning features or use of this
.\"    software must display the following acknowledgment:
.\"    "This product includes software developed by the OpenSSL Project
.\"    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"
.\"
.\" 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
.\"    endorse or promote products derived from this software without
.\"    prior written permission. For written permission, please contact
.\"    openssl-core@@openssl.org.
.\"
.\" 5. Products derived from this software may not be called "OpenSSL"
.\"    nor may "OpenSSL" appear in their names without prior written
.\"    permission of the OpenSSL Project.
.\"
.\" 6. Redistributions of any form whatsoever must retain the following
.\"    acknowledgment:
.\"    "This product includes software developed by the OpenSSL Project
.\"    for use in the OpenSSL Toolkit (http://www.openssl.org/)"
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
.\" EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
.\" PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
.\" ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
.\" SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
.\" LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
.\" STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
.\" ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
.\" OF THE POSSIBILITY OF SUCH DAMAGE.
.\" ====================================================================
.\"
.\" This product includes cryptographic software written by Eric Young
.\" (eay@@cryptsoft.com).  This product includes software written by Tim
.\" Hudson (tjh@@cryptsoft.com).
.\"
.\"
.\" Copyright (C) 1995-1998 Eric Young (eay@@cryptsoft.com)
.\" All rights reserved.
.\"
.\" This package is an SSL implementation written
.\" by Eric Young (eay@@cryptsoft.com).
.\" The implementation was written so as to conform with Netscapes SSL.
.\"
.\" This library is free for commercial and non-commercial use as long as
.\" the following conditions are aheared to.  The following conditions
.\" apply to all code found in this distribution, be it the RC4, RSA,
.\" lhash, DES, etc., code; not just the SSL code.  The SSL documentation
.\" included with this distribution is covered by the same copyright terms
.\" except that the holder is Tim Hudson (tjh@@cryptsoft.com).
.\"
.\" Copyright remains Eric Young's, and as such any Copyright notices in
.\" the code are not to be removed.
.\" If this package is used in a product, Eric Young should be given attribution
.\" as the author of the parts of the library used.
.\" This can be in the form of a textual message at program startup or
.\" in documentation (online or textual) provided with the package.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"    "This product includes cryptographic software written by
.\"     Eric Young (eay@@cryptsoft.com)"
.\"    The word 'cryptographic' can be left out if the rouines from the library
.\"    being used are not cryptographic related :-).
.\" 4. If you include any Windows specific code (or a derivative thereof) from
.\"    the apps directory (application code) you must include an
.\"    acknowledgement:
.\"    "This product includes software written by Tim Hudson
.\"     (tjh@@cryptsoft.com)"
.\"
.\" THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" The licence and distribution terms for any publically available version or
.\" derivative of this code cannot be changed.  i.e. this code cannot simply be
.\" copied and put under another distribution licence
.\" [including the GNU Public Licence.]
.\"
.\" OPENSSL
.\"
.Dd February 28, 2003
.Dt OPENSSL 1
.Os
.Sh NAME
.Nm openssl
.Nd OpenSSL command line tool
.Sh SYNOPSIS
.Nm
.Cm command
.Op Ar command_opts
.Op Ar command_args
.Pp
.Nm
.Oo Cm list-standard-commands No |\ \&
.Cm list-message-digest-commands |
.Cm list-cipher-commands
.Oc
.Pp
.Nm
.Cm no- Ns Ar XXX
.Op Ar arbitrary options
.Sh DESCRIPTION
.Nm OpenSSL
is a cryptography toolkit implementing the Secure Sockets Layer
.Pq SSL v2/v3
and Transport Layer Security
.Pq TLS v1
network protocols and related cryptography standards required by them.
.Pp
The
.Nm
program is a command line tool for using the various
cryptography functions of
.Nm OpenSSL Ns Li 's
.Em crypto
library from the shell.
It can be used for
.Pp
.Bl -bullet -offset indent -compact
.It
Creation of RSA, DH and DSA key parameters
.It
Creation of X.509 certificates, CSRs and CRLs
.It
Calculation of Message Digests
.It
Encryption and Decryption with Ciphers
.It
SSL/TLS Client and Server Tests
.It
Handling of S/MIME signed or encrypted mail
.El
.Pp
The
.Nm
program has actually two manual pages under
.Mx .
This one,
.Xr openssl 1 ,
is actually static and not updated automatically.
The
.Xr openssltool 1
manual page may look not so good, but provides a good and always
up-to date description of the
.Nm
synopsis, subcommands and options.
.Sh COMMAND SUMMARY
The
.Nm
program provides a rich variety of commands
.Pf ( Cm command
in the
.Sx SYNOPSIS
above),
each of which often has a wealth of options and arguments
.Pf ( Ar command_opts
and
.Ar command_args
in the
.Sx SYNOPSIS ) .
.Pp
The pseudo-commands
.Cm list-standard-commands , list-message-digest-commands ,
and
.Cm list-cipher-commands
output a list
.Pq one entry per line
of the names of all standard commands, message digest commands,
or cipher commands, respectively, that are available in the present
.Nm
utility.
.Pp
The pseudo-command
.Cm no- Ns Ar XXX
tests whether a command of the
specified name is available.
If no command named
.Ar XXX
exists,
it returns 0
.Pq success
and prints
.Cm no- Ns Ar XXX ;
otherwise it returns 1 and prints
.Ar XXX .
In both cases, the output goes to
.Em stdout
and nothing is printed to
.Em stderr .
Additional command line arguments are always ignored.
Since for each cipher there is a command of the same name,
this provides an easy way for shell scripts to test for the
availability of ciphers in the
.Nm
program.
.Pp
.Sy Note :
.Cm no- Ns Ar XXX
is not able to detect pseudo-commands such as
.Cm quit ,
.Cm list- Ns Ar ... Ns Cm -commands ,
or
.Cm no- Ns Ar XXX
itself.
.Sh STANDARD COMMANDS
.Bl -tag -width "asn1parse"
.It Cm asn1parse
Parse an ASN.1 sequence.
.It Cm ca
Certificate Authority
.Pq CA
Management.
.It Cm ciphers
Cipher Suite Description Determination.
.It Cm crl
Certificate Revocation List
.Pq CRL
Management.
.It Cm crl2pkcs7
CRL to PKCS#7 Conversion.
.It Cm dgst
Message Digest Calculation.
.It Cm dh
Diffie-Hellman Parameter Management.
Obsoleted by
.Cm dhparam .
.It Cm dhparam
Generation and Management of Diffie-Hellman Parameters.
.It Cm dsa
DSA Data Management.
.It Cm dsaparam
DSA Parameter Generation.
.It Cm enc
Encoding with Ciphers.
.It Cm errstr
Error Number to Error String Conversion.
.It Cm gendh
Generation of Diffie-Hellman Parameters.
Obsoleted by
.Cm dhparam .
.It Cm gendsa
Generation of DSA Parameters.
.It Cm genrsa
Generation of RSA Parameters.
.It Cm nseq
Create or examine a Netscape certificate sequence.
.It Cm ocsp
Online Certificate Status Protocol utility.
.It Cm passwd
Generation of hashed passwords.
.It Cm pkcs7
PKCS#7 Data Management.
.It Cm pkcs8
PKCS#8 Data Management.
.It Cm pkcs12
PKCS#12 Data Management.
.It Cm rand
Generate pseudo-random bytes.
.It Cm req
X.509 Certificate Signing Request
.Pq CSR
Management.
.It Cm rsa
RSA Data Management.
.It Cm rsautl
RSA utility for signing, verification, encryption, and decryption.
.It Cm s_client
This implements a generic SSL/TLS client which can establish a transparent
connection to a remote server speaking SSL/TLS.
It's intended for testing purposes only and provides only rudimentary
interface functionality but internally uses mostly all functionality of the
.Nm OpenSSL
.Em ssl
library.
.It Cm s_server
This implements a generic SSL/TLS server which accepts connections from remote
clients speaking SSL/TLS.
It's intended for testing purposes only and provides only rudimentary
interface functionality but internally uses mostly all functionality of the
.Nm OpenSSL
.Em ssl
library.
It provides both an own command line oriented protocol for testing
SSL functions and a simple HTTP response
facility to emulate an SSL/TLS-aware webserver.
.It Cm s_time
SSL Connection Timer.
.It Cm sess_id
SSL Session Data Management.
.It Cm smime
S/MIME mail processing.
.It Cm speed
Algorithm Speed Measurement.
.It Cm spkac
SPKAC printing and generating utility.
.It Cm verify
X.509 Certificate Verification.
.It Cm version
.Nm OpenSSL
Version Information.
.It Cm x509
X.509 Certificate Data Management.
.El
.Sh MESSAGE DIGEST COMMANDS
.Bl -tag -width "asn1parse"
.It Cm md2
MD2 Digest.
.It Cm md4
MD4 Digest.
.It Cm md5
MD5 Digest.
.It Cm ripemd160
RIPEMD-160 Digest.
.It Cm sha
SHA Digest.
.It Cm sha1
SHA-1 Digest.
.El
.Sh ENCODING AND CIPHER COMMANDS
.Bl -tag -width Ds -compact
.It Cm aes-128-cbc | aes-128-ecb | aes-192-cbc | aes-192-ecb |
.It Cm aes-256-cbc | aes-256-ecb
AES Cipher.
.Pp
.It Cm base64
Base64 Encoding.
.Pp
.It Xo
.Cm bf | bf-cbc | bf-cfb |
.Cm bf-ecb | bf-ofb
.Xc
Blowfish Cipher.
.Pp
.It Cm cast | cast-cbc
CAST Cipher.
.Pp
.It Cm cast5-cbc | cast5-cfb | cast5-ecb | cast5-ofb
CAST5 Cipher.
.Pp
.It Xo
.Cm des | des-cbc | des-cfb | des-ecb |
.Cm des-ede | des-ede-cbc
.Xc
.It Cm des-ede-cfb | des-ede-ofb | des-ofb
DES Cipher.
.Pp
.It Xo
.Cm des3 | desx | des-ede3 |
.Cm des-ede3-cbc | des-ede3-cfb | des-ede3-ofb
.Xc
Triple DES Cipher.
.Pp
.It Xo
.Cm rc2 | rc2-40-cbc | rc2-64-cbc | rc2-cbc |
.Cm rc2-cfb | rc2-ecb | rc2-ofb
.Xc
RC2 Cipher.
.Pp
.It Cm rc4 | rc4-40
RC4 Cipher.
.El
.Sh PASS PHRASE ARGUMENTS
Several commands accept password arguments, typically using
.Fl passin
and
.Fl passout
for input and output passwords, respectively.
These allow the password to be obtained from a variety of sources.
Both of these options take a single argument whose format is described below.
If no password argument is given and a password is required,
then the user is prompted to enter one:
this will typically be read from the current terminal with echoing turned off.
.Bl -tag -width "fd:number"
.It Ar pass : Ns Ar password
The actual password is
.Ar password .
Since the password is visible to utilities
(like
.Xr ps 1
under
.Ux )
this form should only be used where security is not important.
.It Ar env : Ns Ar var
Obtain the password from the environment variable
.Ar var .
Since the environment of other processes is visible on certain platforms
(e.g.\&
.Xr ps 1
under certain
.Ux
OSes) this option should be used with caution.
.It Ar file : Ns Ar path
The first line of
.Ar path
is the password.
If the same
.Ar path
argument is supplied to
.Fl passin
and
.Fl passout ,
then the first line will be used for the input password and the next line
for the output password.
.Ar path
need not refer to a regular file:
it could, for example, refer to a device or named pipe.
.It Ar fd : Ns Ar number
Read the password from the file descriptor
.Ar number .
This can be used to send the data via a pipe for example.
.It Ar stdin
Read the password from standard input.
.El
.\"
.\" ASN1PARSE
.\"
.Sh ASN1PARSE
.Nm openssl asn1parse
.Bk -words
.Op Fl dump
.Op Fl i
.Op Fl noout
.Op Fl dlimit Ar number
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM | TXT
.Op Fl length Ar number
.Op Fl offset Ar number
.Op Fl oid Ar file
.Op Fl out Ar file
.Op Fl strparse Ar offset
.Ek
.Pp
The
.Nm asn1parse
command is a diagnostic utility that can parse ASN.1 structures.
It can also be used to extract data from ASN.1 formatted data.
.Pp
The options are as follows:
.Bl -tag -width "-noout"
.It Fl dlimit Ar number
Dump the first
.Ar number
bytes of unknown data in hex form.
.It Fl dump
Dump unknown data in hex form.
.It Fl i
Indents the output according to the
.Qq depth
of the structures.
.It Fl in Ar file
The input file; default is standard input.
.It Fl inform Ar DER | PEM | TXT
The input format.
.Ar DER
.Pq Distinguished Encoding Rules
is binary format and
.Ar PEM
.Pq Privacy Enhanced Mail ,
the default, is base64-encoded.
.Ar TXT
is plain text.
.It Fl length Ar number
Number of bytes to parse; default is until end of file.
.It Fl noout
Don't output the parsed version of the input file.
.It Fl offset Ar number
Starting offset to begin parsing; default is start of file.
.It Fl oid Ar file
A file containing additional object identifiers
.Pq OIDs .
The format of this file is described in the
.Sx ASN1PARSE NOTES
section below.
.It Fl out Ar file
Output file to place the DER-encoded data into.
If this option is not present, no encoded data will be output.
This is most useful when combined with the
.Fl strparse
option.
.It Fl strparse Ar offset
Parse the content octets of the ASN.1 object starting at
.Ar offset .
This option can be used multiple times to
.Qq drill down
into a nested structure.
.El
.Sh ASN1PARSE OUTPUT
The output will typically contain lines like this:
.Bd -literal -offset 2n
0:d=0  hl=4 l= 681 cons: SEQUENCE

\&.....

229:d=3  hl=3 l= 141 prim: BIT STRING
373:d=2  hl=3 l= 162 cons: cont [ 3 ]
376:d=3  hl=3 l= 159 cons: SEQUENCE
379:d=4  hl=2 l=  29 cons: SEQUENCE
381:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Subject Key Identifier
386:d=5  hl=2 l=  22 prim: OCTET STRING
410:d=4  hl=2 l= 112 cons: SEQUENCE
412:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Authority Key Identifier
417:d=5  hl=2 l= 105 prim: OCTET STRING
524:d=4  hl=2 l=  12 cons: SEQUENCE

\&.....
.Ed
.Pp
This example is part of a self-signed certificate.
Each line starts with the offset in decimal.
.Cm d=XX
specifies the current depth.
The depth is increased within the scope of any SET or SEQUENCE.
.Cm hl=XX
gives the header length
.Pq tag and length octets
of the current type.
.Cm l=XX
gives the length of the content octets.
.Pp
The
.Fl i
option can be used to make the output more readable.
.Pp
Some knowledge of the ASN.1 structure is needed to interpret the output.
.Pp
In this example, the BIT STRING at offset 229 is the certificate public key.
The content octets of this will contain the public key information.
This can be examined using the option
.Fl strparse Cm 229
to yield:
.Bd -literal
    0:d=0  hl=3 l= 137 cons: SEQUENCE
    3:d=1  hl=3 l= 129 prim: INTEGER           :E5D21E1F5C8D208EA7A2166C7FA
F9F6BDF2059669C60876DDB70840F1A5AAFA59699FE471F379F1DD6A487E7D5409AB6A88D4A
9746E24B91D8CF55DB3521015460C8EDE44EE8A4189F7A7BE77D6CD3A9AF2696F486855CF58
BF0EDF2B4068058C7A947F52548DDF7E15E96B385F86422BEA9064A3EE9
  135:d=1  hl=2 l=   3 prim: INTEGER           :010001
.Ed
.Sh ASN1PARSE NOTES
If an OID
.Pq object identifier
is not part of
.Nm OpenSSL Ns Li 's
internal table it will be represented in
numerical form
.Pq for example 1.2.3.4 .
The file passed to the
.Fl oid
option allows additional OIDs to be included.
Each line consists of three columns:
the first column is the OID in numerical format and should be followed by
whitespace.
The second column is the
.Qq short name
which is a single word followed by whitespace.
The final column is the rest of the line and is the
.Qq long name .
.Nm asn1parse
displays the long name.
Example:
.Pp
.Dl \&"1.2.3.4	shortname	A long name\&"
.Sh ASN1PARSE BUGS
There should be options to change the format of input lines.
The output of some ASN.1 types is not well handled
.Pq if at all .
.\"
.\" ca
.\"
.Sh CA
.Nm openssl ca
.Bk -words
.Op Fl batch
.Op Fl gencrl
.Op Fl infiles
.Op Fl msie_hack
.Op Fl noemailDN
.Op Fl notext
.Op Fl preserveDN
.Op Fl updatedb
.Op Fl verbose
.Op Fl cert Ar file
.Op Fl config Ar file
.Op Fl crl_CA_compromise Ar time
.Op Fl crl_compromise Ar time
.Op Fl crl_hold Ar instruction
.Op Fl crl_reason Ar reason
.Op Fl crldays Ar days
.Op Fl crlexts Ar section
.Op Fl crlhours Ar hours
.Op Fl days Ar arg
.Op Fl enddate Ar date
.Op Fl engine Ar id
.Op Fl extensions Ar section
.Op Fl extfile Ar section
.Op Fl in Ar file
.Op Fl key Ar keyfile
.Op Fl keyfile Ar arg
.Op Fl keyform Ar PEM | ENGINE
.Op Fl md Ar arg
.Op Fl name Ar section
.Op Fl out Ar file
.Op Fl outdir Ar dir
.Op Fl passin Ar arg
.Op Fl policy Ar arg
.Op Fl revoke Ar file
.Op Fl spkac Ar file
.Op Fl ss_cert Ar file
.Op Fl startdate Ar date
.Op Fl status Ar serial
.Op Fl subj Ar arg
.Ek
.Pp
The
.Nm ca
command is a minimal CA application.
It can be used to sign certificate requests in a variety of forms
and generate CRLs.
It also maintains a text database of issued certificates and their status.
.Pp
The options descriptions will be divided into each purpose.
.Sh CA OPTIONS
.Bl -tag -width "XXXX"
.It Fl batch
This sets the batch mode.
In this mode no questions will be asked
and all certificates will be certified automatically.
.It Fl cert Ar file
The CA certificate file.
.It Fl config Ar file
Specifies the configuration file to use.
.It Fl days Ar arg
The number of days to certify the certificate for.
.It Fl enddate Ar date
This allows the expiry date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm ca
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl extensions Ar section
The section of the configuration file containing certificate extensions
to be added when a certificate is issued (defaults to
.Em x509_extensions
unless the
.Fl extfile
option is used).
If no extension section is present, a V1 certificate is created.
If the extension section is present
.Pq even if it is empty ,
then a V3 certificate is created.
.It Fl extfile Ar file
An additional configuration
.Ar file
to read certificate extensions from
(using the default section unless the
.Fl extensions
option is also used).
.It Fl in Ar file
An input
.Ar file
containing a single certificate request to be signed by the CA.
.It Fl infiles
If present, this should be the last option; all subsequent arguments
are assumed to be the names of files containing certificate requests.
.It Fl key Ar keyfile
The password used to encrypt the private key.
Since on some systems the command line arguments are visible
(e.g.\&
.Ux
with the
.Xr ps 1
utility) this option should be used with caution.
.It Fl keyfile Ar file
The private key to sign requests with.
.It Fl keyform Ar PEM | ENGINE
Private key file format.
.It Fl md Ar alg
The message digest to use.
Possible values include
.Ar md5
and
.Ar sha1 .
This option also applies to CRLs.
.It Fl msie_hack
This is a legacy option to make
.Nm ca
work with very old versions of the IE certificate enrollment control
.Qq certenr3 .
It used UniversalStrings for almost everything.
Since the old control has various security bugs,
its use is strongly discouraged.
The newer control
.Qq Xenroll
does not need this option.
.It Fl name Ar section
Specifies the configuration file
.Ar section
to use (overrides
.Cm default_ca
in the
.Cm ca
section).
.It Fl noemailDN
The DN of a certificate can contain the EMAIL field if present in the
request DN, however it is good policy just having the e-mail set into
the
.Em altName
extension of the certificate.
When this option is set, the EMAIL field is removed from the certificate's
subject and set only in the, eventually present, extensions.
The
.Ar email_in_dn
keyword can be used in the configuration file to enable this behaviour.
.It Fl notext
Don't output the text form of a certificate to the output file.
.It Fl out Ar file
The output file to output certificates to.
The default is standard output.
The certificate details will also be printed out to this file.
.It Fl outdir Ar directory
The
.Ar directory
to output certificates to.
The certificate will be written to a file consisting of the
serial number in hex with
.Qq .pem
appended.
.It Fl passin Ar arg
The key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl policy Ar arg
This option defines the CA
.Qq policy
to use.
This is a section in the configuration file which decides which fields
should be mandatory or match the CA certificate.
Check out the
.Sx CA POLICY FORMAT
section for more information.
.It Fl preserveDN
Normally, the DN order of a certificate is the same as the order of the
fields in the relevant policy section.
When this option is set, the order is the same as the request.
This is largely for compatibility with the older IE enrollment control
which would only accept certificates if their DNs matched the order of the
request.
This is not needed for Xenroll.
.It Fl spkac Ar file
A file containing a single Netscape signed public key and challenge,
and additional field values to be signed by the CA.
See the
.Sx SPKAC FORMAT
section for information on the required format.
.It Fl ss_cert Ar file
A single self-signed certificate to be signed by the CA.
.It Fl startdate Ar date
This allows the start date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
.It Fl status Ar serial
Show status of certificate with serial number
.Ar serial .
.It Fl updatedb
Update database for expired certificates.
.It Fl verbose
This prints extra details about the operations being performed.
.El
.Sh CRL OPTIONS
.Bl -tag -width "XXXX"
.It Fl crl_CA_compromise Ar time
This is the same as
.Fl crl_compromise ,
except the revocation reason is set to CACompromise.
.It Fl crl_compromise Ar time
This sets the revocation reason to keyCompromise and the compromise time to
.Ar time .
.Ar time
should be in GeneralizedTime format, i.e. YYYYMMDDHHMMSSZ.
.It Fl crl_hold Ar instruction
This sets the CRL revocation reason code to certificateHold and the hold
instruction to
.Ar instruction
which must be an OID.
Although any OID can be used, only holdInstructionNone
(the use of which is discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.
.It Fl crl_reason Ar reason
Revocation reason, where
.Ar reason
is one of:
unspecified, keyCompromise, CACompromise, affiliationChanged, superseded,
cessationOfOperation, certificateHold or removeFromCRL.
The matching of
.Ar reason
is case insensitive.
Setting any revocation reason will make the CRL v2.
In practice, removeFromCRL is not particularly useful because it is only used
in delta CRLs which are not currently implemented.
.It Fl crldays Ar num
The number of days before the next CRL is due.
This is the days from now to place in the CRL
.Em nextUpdate
field.
.It Fl crlexts Ar section
The
.Ar section
of the configuration file containing CRL extensions to include.
If no CRL extension section is present then a V1 CRL is created;
if the CRL extension section is present
.Pq even if it is empty
then a V2 CRL is created.
The CRL extensions specified are CRL extensions and
.Em not
CRL entry extensions.
It should be noted that some software
.Pq for example Netscape
can't handle V2 CRLs.
.It Fl crlhours Ar num
The number of hours before the next CRL is due.
.It Fl gencrl
This option generates a CRL based on information in the index file.
.It Fl revoke Ar file
A
.Ar file
containing a certificate to revoke.
.It Fl subj Ar arg
Supersedes the subject name given in the request.
The
.Ar arg
must be formatted as
.Ar /type0=value0/type1=value1/type2=... ;
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
.El
.Sh CA CONFIGURATION FILE OPTIONS
The section of the configuration file containing options for
.Nm ca
is found as follows:
If the
.Fl name
command line option is used, then it names the section to be used.
Otherwise the section to be used must be named in the
.Em default_ca
option of the
.Em ca
section of the configuration file (or in the default section of the
configuration file).
Besides
.Em default_ca ,
the following options are read directly from the
.Em ca
section:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It RANDFILE
.It preserve
.It msie_hack
.El
.Pp
With the exception of RANDFILE, this is probably a bug and may
change in future releases.
.Pp
Many of the configuration file options are identical to command line
options.
Where the option is present in the configuration file and the command line,
the command line value is used.
Where an option is described as mandatory, then it must be present in
the configuration file or the command line equivalent
.Pq if any
used.
.Bl -tag -width "XXXX"
.It Ar certificate
The same as
.Fl cert .
It gives the file containing the CA certificate.
Mandatory.
.It Ar copy_extensions
Determines how extensions in certificate requests should be handled.
If set to
.Ar none
or this option is not present, then extensions are
ignored and not copied to the certificate.
If set to
.Ar copy ,
then any extensions present in the request that are not already present
are copied to the certificate.
If set to
.Ar copyall ,
then all extensions in the request are copied to the certificate:
if the extension is already present in the certificate it is deleted first.
See the
.Sx CA WARNINGS
section before using this option.
.Pp
The main use of this option is to allow a certificate request to supply
values for certain extensions such as
.Em subjectAltName .
.It Ar crl_extensions
The same as
.Fl crlexts .
.It Ar database
The text database file to use.
Mandatory.
This file must be present, though initially it will be empty.
.It Ar default_crl_hours , default_crl_days
The same as the
.Fl crlhours
and
.Fl crldays
options.
These will only be used if neither command line option is present.
At least one of these must be present to generate a CRL.
.It Ar default_days
The same as the
.Fl days
option.
The number of days to certify a certificate for.
.It Ar default_enddate
The same as the
.Fl enddate
option.
Either this option or
.Ar default_days
.Pq or the command line equivalents
must be present.
.It Ar default_md
The same as the
.Fl md
option.
The message digest to use.
Mandatory.
.It Ar default_startdate
The same as the
.Fl startdate
option.
The start date to certify a certificate for.
If not set, the current time is used.
.It Ar email_in_dn
The same as
.Fl noemailDN .
If the EMAIL field is to be removed from the DN of the certificate,
simply set this to
.Qq no .
If not present, the default is to allow for the EMAIL field in the
certificate's DN.
.It Ar msie_hack
The same as
.Fl msie_hack .
.It Ar nameopt , certopt
These options allow the format used to display the certificate details
when asking the user to confirm signing.
All the options supported by the
.Nm x509
utilities'
.Fl nameopt
and
.Fl certopt
switches can be used here, except that
.Ar no_signame
and
.Ar no_sigdump
are permanently set and cannot be disabled
(this is because the certificate signature cannot be displayed because
the certificate has not been signed at this point).
.Pp
For convenience, the value
.Em ca_default
is accepted by both to produce a reasonable output.
.Pp
If neither option is present, the format used in earlier versions of
.Nm OpenSSL
is used.
Use of the old format is
.Em strongly
discouraged because it only displays fields mentioned in the
.Ar policy
section,
mishandles multicharacter string types and does not display extensions.
.It Ar new_certs_dir
The same as the
.Fl outdir
command line option.
It specifies the directory where new certificates will be placed.
Mandatory.
.It Ar oid_file
This specifies a file containing additional object identifiers.
Each line of the file should consist of the numerical form of the
object identifier followed by whitespace, then the short name followed
by whitespace and finally the long name.
.It Ar oid_section
This specifies a section in the configuration file containing extra
object identifiers.
Each line should consist of the short name of the object identifier
followed by
.Sq =
and the numerical form.
The short and long names are the same when this option is used.
.It Ar policy
The same as
.Fl policy .
Mandatory.
See the
.Sx CA POLICY FORMAT
section for more information.
.It Ar preserve
The same as
.Fl preserveDN .
.It Ar private_key
Same as the
.Fl keyfile
option.
The file containing the CA private key.
Mandatory.
.It Ar RANDFILE
A file used to read and write random number seed information,
or an EGD socket (see
.Xr RAND_egd 3 ) .
.It Ar serial
A text file containing the next serial number to use in hex.
Mandatory.
This file must be present and contain a valid serial number.
.It Ar x509_extensions
The same as
.Fl extensions .
.El
.Sh CA POLICY FORMAT
The policy section consists of a set of variables corresponding to
certificate DN fields.
If the value is
.Qq match ,
then the field value must match the same field in the CA certificate.
If the value is
.Qq supplied ,
then it must be present.
If the value is
.Qq optional ,
then it may be present.
Any fields not mentioned in the policy section
are silently deleted, unless the
.Fl preserveDN
option is set,
but this can be regarded more of a quirk than intended behaviour.
.Sh SPKAC FORMAT
The input to the
.Fl spkac
command line option is a Netscape signed public key and challenge.
This will usually come from the
.Em KEYGEN
tag in an HTML form to create a new private key.
It is, however, possible to create SPKACs using the
.Nm spkac
utility.
.Pp
The file should contain the variable SPKAC set to the value of
the SPKAC and also the required DN components as name value pairs.
If it's necessary to include the same component twice,
then it can be preceded by a number and a
.Sq \&. .
.Sh CA EXAMPLES
.Sy Note :
these examples assume that the
.Nm ca
directory structure is already set up and the relevant files already exist.
This usually involves creating a CA certificate and private key with
.Cm req ,
a serial number file and an empty index file and placing them in
the relevant directories.
.Pp
To use the sample configuration file below, the directories
.Pa demoCA ,
.Pa demoCA/private
and
.Pa demoCA/newcerts
would be created.
The CA certificate would be copied to
.Pa demoCA/cacert.pem
and its private key to
.Pa demoCA/private/cakey.pem .
A file
.Pa demoCA/serial
would be created containing, for example,
.Qq 01
and the empty index file
.Pa demoCA/index.txt .
.Pp
Sign a certificate request:
.Pp
.Dl $ openssl ca -in req.pem -out newcert.pem
.Pp
Sign a certificate request, using CA extensions:
.Pp
.Dl $ openssl ca -in req.pem -extensions v3_ca -out newcert.pem
.Pp
Generate a CRL:
.Pp
.Dl $ openssl ca -gencrl -out crl.pem
.Pp
Sign several requests:
.Pp
.Dl $ openssl ca -infiles req1.pem req2.pem req3.pem
.Pp
Certify a Netscape SPKAC:
.Pp
.Dl $ openssl ca -spkac spkac.txt
.Pp
A sample SPKAC file
.Pq the SPKAC line has been truncated for clarity :
.Bd -literal -offset indent
SPKAC=MIG0MGAwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAn7PDhCeV/xIxUg8V70YRxK
CN=Steve Test
emailAddress=steve@@openssl.org
0.OU=OpenSSL Group
1.OU=Another Group
.Ed
.Pp
A sample configuration file with the relevant sections for
.Nm ca :
.Bd -literal
\& [ ca ]
\& default_ca      = CA_default            # The default ca section

\& [ CA_default ]

\& dir            = ./demoCA              # top dir
\& database       = $dir/index.txt        # index file
\& new_certs_dir  = $dir/newcerts         # new certs dir

\& certificate    = $dir/cacert.pem       # The CA cert
\& serial         = $dir/serial           # serial no file
\& private_key    = $dir/private/cakey.pem# CA private key
\& RANDFILE       = $dir/private/.rand    # random number file

\& default_days   = 365                   # how long to certify for
\& default_crl_days= 30                   # how long before next CRL
\& default_md     = md5                   # md to use

\& policy         = policy_any            # default policy
\& email_in_dn    = no                    # Don't add the email into cert DN

\& nameopt        = ca_default            # Subject name display option
\& certopt        = ca_default            # Certificate display option
\& copy_extensions = none                 #Don't copy extensions from request

\& [ policy_any ]
\& countryName            = supplied
\& stateOrProvinceName    = optional
\& organizationName       = optional
\& organizationalUnitName = optional
\& commonName             = supplied
\& emailAddress           = optional
.Ed
.Sh CA FILES
.Sy Note :
the location of all files can change either by compile time options,
configuration file entries, environment variables, or command line options.
The values below reflect the default values.
.Bd -literal -offset indent
/etc/ssl/openssl.cnf           - master configuration file
\&./demoCA                       - main CA directory
\&./demoCA/cacert.pem            - CA certificate
\&./demoCA/private/cakey.pem     - CA private key
\&./demoCA/serial                - CA serial number file
\&./demoCA/serial.old            - CA serial number backup file
\&./demoCA/index.txt             - CA text database file
\&./demoCA/index.txt.old         - CA text database backup file
\&./demoCA/certs                 - certificate output file
\&./demoCA/.rnd                  - CA random seed information
.Ed
.Sh CA ENVIRONMENT VARIABLES
.Ev OPENSSL_CONF
reflects the location of the master configuration file;
it can be overridden by the
.Fl config
command line option.
.Sh CA RESTRICTIONS
The text database index file is a critical part of the process,
and if corrupted it can be difficult to fix.
It is theoretically possible to rebuild the index file from all the
issued certificates and a current CRL; however there is no option to do this.
.Pp
V2 CRL features like delta CRL support and CRL numbers are not currently
supported.
.Pp
Although several requests can be input and handled at once, it is only
possible to include one SPKAC or self-signed certificate.
.Sh CA BUGS
The use of an in-memory text database can cause problems when large
numbers of certificates are present because, as the name implies,
the database has to be kept in memory.
.Pp
It is not possible to certify two certificates with the same DN; this
is a side effect of how the text database is indexed and it cannot easily
be fixed without introducing other problems.
Some S/MIME clients can use two certificates with the same DN for separate
signing and encryption keys.
.Pp
The
.Nm ca
command really needs rewriting or the required functionality
exposed at either a command or interface level so a more friendly utility
.Pq perl script or GUI
can handle things properly.
The scripts
.Nm CA.sh
and
.Nm CA.pl
help a little but not very much.
.Pp
Any fields in a request that are not present in a policy are silently
deleted.
This does not happen if the
.Fl preserveDN
option is used.
To enforce the absence of the EMAIL field within the DN, as suggested
by RFCs, regardless of the contents of the request's subject the
.Fl noemailDN
option can be used.
The behaviour should be more friendly and configurable.
.Pp
Cancelling some commands by refusing to certify a certificate can
create an empty file.
.Sh CA WARNINGS
The
.Nm ca
command is quirky and at times downright unfriendly.
.Pp
The
.Nm ca
utility was originally meant as an example of how to do things in a CA.
It was not supposed to be used as a full blown CA itself:
nevertheless some people are using it for this purpose.
.Pp
The
.Nm ca
command is effectively a single user command: no locking is done on the
various files, and attempts to run more than one
.Nm ca
command on the same database can have unpredictable results.
.Pp
The
.Ar copy_extensions
option should be used with caution.
If care is not taken, it can be a security risk.
For example, if a certificate request contains a
.Em basicConstraints
extension with CA:TRUE and the
.Ar copy_extensions
value is set to
.Ar copyall
and the user does not spot
this when the certificate is displayed, then this will hand the requestor
a valid CA certificate.
.Pp
This situation can be avoided by setting
.Ar copy_extensions
to
.Ar copy
and including
.Em basicConstraints
with CA:FALSE in the configuration file.
Then if the request contains a
.Em basicConstraints
extension, it will be ignored.
.Pp
It is advisable to also include values for other extensions such
as
.Ar keyUsage
to prevent a request supplying its own values.
.Pp
Additional restrictions can be placed on the CA certificate itself.
For example if the CA certificate has:
.Pp
.D1 basicConstraints = CA:TRUE, pathlen:0
.Pp
then even if a certificate is issued with CA:TRUE it will not be valid.
.\"
.\" CIPHERS
.\"
.Sh CIPHERS
.Nm openssl ciphers
.Op Fl h
.Op Fl ssl2 | ssl3 | tls1
.Op Fl v
.Op Ar cipherlist
.Pp
The
.Nm ciphers
command converts
.Nm OpenSSL
cipher lists into ordered SSL cipher preference lists.
It can be used as a test tool to determine the appropriate cipherlist.
.Pp
The options are as follows:
.Bl -tag -width "XXXXXX"
.It Fl h , \&?
Print a brief usage message.
.It Fl ssl2
Only include SSL v2 ciphers.
.It Fl ssl3
Only include SSL v3 ciphers.
.It Fl tls1
Only include TLS v1 ciphers.
.It Fl v
Verbose option.
List ciphers with a complete description of protocol version
.Pq SSLv2 or SSLv3; the latter includes TLS ,
key exchange, authentication, encryption and mac algorithms used along with
any key size restrictions and whether the algorithm is classed as an
.Em export
cipher.
Note that without the
.Fl v
option, ciphers may seem to appear twice in a cipher list;
this is when similar ciphers are available for
SSL v2 and for SSL v3/TLS v1.
.It Ar cipherlist
A cipher list to convert to a cipher preference list.
If it is not included, the default cipher list will be used.
The format is described below.
.El
.Sh CIPHERS LIST FORMAT
The cipher list consists of one or more
.Em cipher strings
separated by colons.
Commas or spaces are also acceptable separators, but colons are normally used.
.Pp
The actual
.Em cipher string
can take several different forms:
.Pp
It can consist of a single cipher suite such as
.Em RC4-SHA .
.Pp
It can represent a list of cipher suites containing a certain algorithm,
or cipher suites of a certain type.
For example
.Em SHA1
represents all cipher suites using the digest algorithm SHA1, and
.Em SSLv3
represents all SSL v3 algorithms.
.Pp
Lists of cipher suites can be combined in a single
.Em cipher string
using the
.Sq +
character.
This is used as a logical
.Em and
operation.
For example,
.Em SHA1+DES
represents all cipher suites containing the SHA1 and the DES algorithms.
.Pp
Each cipher string can be optionally preceded by the characters
.Sq \&! ,
.Sq - ,
or
.Sq + .
.Pp
If
.Sq \&!\&
is used, then the ciphers are permanently deleted from the list.
The ciphers deleted can never reappear in the list even if they are
explicitly stated.
.Pp
If
.Sq -
is used, then the ciphers are deleted from the list, but some or
all of the ciphers can be added again by later options.
.Pp
If
.Sq +
is used, then the ciphers are moved to the end of the list.
This option doesn't add any new ciphers, it just moves matching existing ones.
.Pp
If none of these characters is present, the string is just interpreted
as a list of ciphers to be appended to the current preference list.
If the list includes any ciphers already present, they will be ignored;
that is, they will not be moved to the end of the list.
.Pp
Additionally, the cipher string
.Em @@STRENGTH
can be used at any point to sort the current cipher list in order of
encryption algorithm key length.
.Sh CIPHERS STRINGS
The following is a list of all permitted cipher strings and their meanings.
.Bl -tag -width "XXXX"
.It Ar DEFAULT
The default cipher list.
This is determined at compile time and is normally
.Ar ALL:!ADH:RC4+RSA:+SSLv2:@@STRENGTH .
This must be the first
.Ar cipher string
specified.
.It Ar COMPLEMENTOFDEFAULT
The ciphers included in
.Ar ALL ,
but not enabled by default.
Currently this is
.Ar ADH .
Note that this rule does not cover
.Ar eNULL ,
which is not included by
.Ar ALL
(use
.Ar COMPLEMENTOFALL
if necessary).
.It Ar ALL
All cipher suites except the
.Ar eNULL
ciphers which must be explicitly enabled.
.It Ar COMPLEMENTOFALL
The cipher suites not enabled by
.Ar ALL ,
currently being
.Ar eNULL .
.It Ar HIGH
.Qq High
encryption cipher suites.
This currently means those with key lengths larger than 128 bits.
.It Ar MEDIUM
.Qq Medium
encryption cipher suites, currently those using 128-bit encryption.
.It Ar LOW
.Qq Low
encryption cipher suites, currently those using 64- or 56-bit encryption
algorithms, but excluding export cipher suites.
.It Ar EXP , EXPORT
Export encryption algorithms.
Including 40- and 56-bit algorithms.
.It Ar EXPORT40
40-bit export encryption algorithms.
.It Ar EXPORT56
56-bit export encryption algorithms.
.It Ar eNULL , NULL
The
.Qq NULL
ciphers; that is, those offering no encryption.
Because these offer no encryption at all and are a security risk,
they are disabled unless explicitly included.
.It Ar aNULL
The cipher suites offering no authentication.
This is currently the anonymous DH algorithms.
These cipher suites are vulnerable to a
.Qq man in the middle
attack, so their use is normally discouraged.
.It Ar kRSA , RSA
Cipher suites using RSA key exchange.
.It Ar kEDH
Cipher suites using ephemeral DH key agreement.
.It Ar kDHr , kDHd
Cipher suites using DH key agreement and DH certificates signed by
CAs with RSA and DSS keys respectively.
Not implemented.
.It Ar aRSA
Cipher suites using RSA authentication, i.e. the certificates carry RSA keys.
.It Ar aDSS , DSS
Cipher suites using DSS authentication, i.e. the certificates carry DSS keys.
.It Ar aDH
Cipher suites effectively using DH authentication, i.e. the certificates carry
DH keys.
Not implemented.
.It Ar kFZA , aFZA , eFZA , FZA
Cipher suites using FORTEZZA key exchange, authentication, encryption
or all FORTEZZA algorithms.
Not implemented.
.It Ar TLSv1 , SSLv3 , SSLv2
TLS v1.0, SSL v3.0 or SSL v2.0 cipher suites, respectively.
.It Ar DH
Cipher suites using DH, including anonymous DH.
.It Ar ADH
Anonymous DH cipher suites.
.It Ar AES
Cipher suites using AES.
.It Ar 3DES
Cipher suites using triple DES.
.It Ar DES
Cipher suites using DES
.Pq not triple DES .
.It Ar RC4
Cipher suites using RC4.
.It Ar RC2
Cipher suites using RC2.
.It Ar MD5
Cipher suites using MD5.
.It Ar SHA1 , SHA
Cipher suites using SHA1.
.El
.Sh CIPHERS SUITE NAMES
The following lists give the SSL or TLS cipher suites names from the
relevant specification and their
.Nm OpenSSL
equivalents.
It should be noted that several cipher suite names do not include the
authentication used, e.g. DES-CBC3-SHA.
In these cases, RSA authentication is used.
.Ss SSL v3.0 cipher suites
.Bd -unfilled -offset indent
SSL_RSA_WITH_NULL_MD5                   NULL-MD5
SSL_RSA_WITH_NULL_SHA                   NULL-SHA
SSL_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
SSL_RSA_WITH_RC4_128_MD5                RC4-MD5
SSL_RSA_WITH_RC4_128_SHA                RC4-SHA
SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
SSL_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
SSL_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
SSL_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
SSL_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA

SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
SSL_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
SSL_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
SSL_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
SSL_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA

SSL_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
SSL_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
SSL_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
SSL_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA

SSL_FORTEZZA_KEA_WITH_NULL_SHA          Not implemented.
SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA  Not implemented.
SSL_FORTEZZA_KEA_WITH_RC4_128_SHA       Not implemented.
.Ed
.Ss TLS v1.0 cipher suites
.Bd -unfilled -offset indent
TLS_RSA_WITH_NULL_MD5                   NULL-MD5
TLS_RSA_WITH_NULL_SHA                   NULL-SHA
TLS_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
TLS_RSA_WITH_RC4_128_MD5                RC4-MD5
TLS_RSA_WITH_RC4_128_SHA                RC4-SHA
TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
TLS_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
TLS_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
TLS_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
TLS_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA

TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
TLS_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
TLS_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
TLS_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
TLS_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA

TLS_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
TLS_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
TLS_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
TLS_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
.Ed
.Ss AES ciphersuites from RFC 3268, extending TLS v1.0
.Bd -unfilled -offset indent
TLS_RSA_WITH_AES_128_CBC_SHA            AES128-SHA
TLS_RSA_WITH_AES_256_CBC_SHA            AES256-SHA

TLS_DH_DSS_WITH_AES_128_CBC_SHA         DH-DSS-AES128-SHA
TLS_DH_DSS_WITH_AES_256_CBC_SHA         DH-DSS-AES256-SHA
TLS_DH_RSA_WITH_AES_128_CBC_SHA         DH-RSA-AES128-SHA
TLS_DH_RSA_WITH_AES_256_CBC_SHA         DH-RSA-AES256-SHA

TLS_DHE_DSS_WITH_AES_128_CBC_SHA        DHE-DSS-AES128-SHA
TLS_DHE_DSS_WITH_AES_256_CBC_SHA        DHE-DSS-AES256-SHA
TLS_DHE_RSA_WITH_AES_128_CBC_SHA        DHE-RSA-AES128-SHA
TLS_DHE_RSA_WITH_AES_256_CBC_SHA        DHE-RSA-AES256-SHA

TLS_DH_anon_WITH_AES_128_CBC_SHA        ADH-AES128-SHA
TLS_DH_anon_WITH_AES_256_CBC_SHA        ADH-AES256-SHA
.Ed
.Ss Additional Export 1024 and other cipher suites
.Sy Note :
These ciphers can also be used in SSL v3.
.Bd -unfilled -offset indent
TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA     EXP1024-DES-CBC-SHA
TLS_RSA_EXPORT1024_WITH_RC4_56_SHA      EXP1024-RC4-SHA
TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA EXP1024-DHE-DSS-DES-CBC-SHA
TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA  EXP1024-DHE-DSS-RC4-SHA
TLS_DHE_DSS_WITH_RC4_128_SHA            DHE-DSS-RC4-SHA
.Ed
.Ss SSL v2.0 cipher suites
.Bd -unfilled -offset indent
SSL_CK_RC4_128_WITH_MD5                 RC4-MD5
SSL_CK_RC4_128_EXPORT40_WITH_MD5        EXP-RC4-MD5
SSL_CK_RC2_128_CBC_WITH_MD5             RC2-MD5
SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5    EXP-RC2-MD5
SSL_CK_IDEA_128_CBC_WITH_MD5            IDEA-CBC-MD5
SSL_CK_DES_64_CBC_WITH_MD5              DES-CBC-MD5
SSL_CK_DES_192_EDE3_CBC_WITH_MD5        DES-CBC3-MD5
.Ed
.Sh CIPHERS NOTES
The non-ephemeral DH modes are currently unimplemented in
.Nm OpenSSL
because there is no support for DH certificates.
.Pp
Some compiled versions of
.Nm OpenSSL
may not include all the ciphers
listed here because some ciphers were excluded at compile time.
.Sh CIPHERS EXAMPLES
Verbose listing of all
.Nm OpenSSL
ciphers including NULL ciphers:
.Pp
.Dl $ openssl ciphers -v 'ALL:eNULL'
.Pp
Include all ciphers except NULL and anonymous DH then sort by
strength:
.Pp
.Dl $ openssl ciphers -v 'ALL:!ADH:@@STRENGTH'
.Pp
Include only 3DES ciphers and then place RSA ciphers last:
.Pp
.Dl $ openssl ciphers -v '3DES:+RSA'
.Pp
Include all RC4 ciphers but leave out those without authentication:
.Pp
.Dl $ openssl ciphers -v 'RC4:!COMPLEMENTOFDEFAULT'
.Pp
Include all ciphers with RSA authentication but leave out ciphers without
encryption:
.Pp
.Dl $ openssl ciphers -v 'RSA:!COMPLEMENTOFALL'
.Sh CIPHERS HISTORY
The
.Ar COMPLEMENTOFALL
and
.Ar COMPLEMENTOFDEFAULT
selection options were added in version 0.9.7.
.\"
.\" crl
.\"
.Sh CRL
.Nm openssl crl
.Bk -words
.Op Fl fingerprint
.Op Fl hash
.Op Fl issuer
.Op Fl lastupdate
.Op Fl nextupdate
.Op Fl noout
.Op Fl text
.Op Cm CAfile Ar file
.Op Cm CApath Ar dir
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Ek
.Pp
The
.Nm crl
command processes CRL files in DER or PEM format.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl CAfile Ar file
Verify the signature on a CRL by looking up the issuing certificate in
.Ar file .
.It Fl CApath Ar directory
Verify the signature on a CRL by looking up the issuing certificate in
.Ar dir .
This directory must be a standard certificate directory,
i.e. a hash of each subject name (using
.Cm x509 Fl hash )
should be linked to each certificate.
.It Fl fingerprint
Print the CRL fingerprint.
.It Fl hash
Output a hash of the issuer name.
This can be used to look up CRLs in a directory by issuer name.
.It Fl in Ar file
This specifies the input file to read from, or standard input if this
option is not specified.
.It Fl inform Ar DER | PEM
This specifies the input format.
.Ar DER
format is a DER-encoded CRL structure.
.Ar PEM
.Pq the default
is a base64-encoded version of the DER form with header and footer lines.
.It Fl issuer
Output the issuer name.
.It Fl lastupdate
Output the
.Ar lastUpdate
field.
.It Fl nextupdate
Output the
.Ar nextUpdate
field.
.It Fl noout
Don't output the encoded version of the CRL.
.It Fl out Ar file
Specifies the output file to write to, or standard output by
default.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl text
Print out the CRL in text form.
.El
.Sh CRL NOTES
The PEM CRL format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN X509 CRL-----
-----END X509 CRL-----
.Ed
.Sh CRL EXAMPLES
Convert a CRL file from PEM to DER:
.Pp
.Dl $ openssl crl -in crl.pem -outform DER -out crl.der
.Pp
Output the text form of a DER-encoded certificate:
.Pp
.Dl $ openssl crl -in crl.der -inform DER -text -noout
.Sh CRL BUGS
Ideally, it should be possible to create a CRL using appropriate options
and files too.
.\"
.\" CRL2PKCS7
.\"
.Sh CRL2PKCS7
.Nm openssl crl2pkcs7
.Bk -words
.Op Fl nocrl
.Op Fl certfile Ar file
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Ek
.Pp
The
.Nm crl2pkcs7
command takes an optional CRL and one or more
certificates and converts them into a PKCS#7 degenerate
.Qq certificates only
structure.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl certfile Ar file
Specifies a
.Ar file
containing one or more certificates in PEM format.
All certificates in the file will be added to the PKCS#7 structure.
This option can be used more than once to read certificates from multiple
files.
.It Fl in Ar file
This specifies the input
.Ar file
to read a CRL from, or standard input if this option is not specified.
.It Fl inform Ar DER | PEM
This specifies the CRL input format.
.Ar DER
format is a DER-encoded CRL structure.
.Ar PEM
.Pq the default
is a base64-encoded version of the DER form with header and footer lines.
.It Fl nocrl
Normally, a CRL is included in the output file.
With this option, no CRL is
included in the output file and a CRL is not read from the input file.
.It Fl out Ar file
Specifies the output
.Ar file
to write the PKCS#7 structure to, or standard output by default.
.It Fl outform Ar DER | PEM
This specifies the PKCS#7 structure output format.
.Ar DER
format is a DER-encoded PKCS#7 structure.
.Ar PEM
.Pq the default
is a base64-encoded version of the DER form with header and footer lines.
.El
.Sh CRL2PKCS7 EXAMPLES
Create a PKCS#7 structure from a certificate and CRL:
.Pp
.Dl $ openssl crl2pkcs7 -in crl.pem -certfile cert.pem -out p7.pem
.Pp
Create a PKCS#7 structure in DER format with no CRL from several
different certificates:
.Bd -literal -offset indent
$ openssl crl2pkcs7 -nocrl -certfile newcert.pem \e
	-certfile demoCA/cacert.pem -outform DER -out p7.der
.Ed
.Sh CRL2PKCS7 NOTES
The output file is a PKCS#7 signed data structure containing no signers and
just certificates and an optional CRL.
.Pp
This utility can be used to send certificates and CAs to Netscape as part of
the certificate enrollment process.
This involves sending the DER-encoded output
as MIME type
.Em application/x-x509-user-cert .
.Pp
The PEM-encoded form with the header and footer lines removed can be used to
install user certificates and CAs in MSIE using the Xenroll control.
.\"
.\" DGST
.\"
.Sh DGST
.Nm openssl dgst
.Bk -words
.Oo
.Fl dss1 | md2 | md4 | md5 |
.Fl ripemd160 | sha | sha1
.Oc
.Op Fl binary
.Op Fl c
.Op Fl d
.Op Fl hex
.Op Fl engine Ar id
.Op Fl keyform Ar PEM | ENGINE
.Op Fl out Ar file
.Op Fl prverify Ar file
.Op Fl rand Ar file ...
.Op Fl sign Ar file
.Op Fl signature Ar file
.Op Fl verify Ar file
.Op Ar file ...
.Ek
.Pp
.Nm openssl
.Xo
.Cm md2 | md4 | md5 |
.Cm ripemd160 | sha | sha1
.Xc
.Op Fl c
.Op Fl d
.Op Ar file ...
.Pp
The digest functions output the message digest of a supplied
.Ar file
or
.Ar files
in hexadecimal form.
They can also be used for digital signing and verification.
.Pp
The options are as follows:
.Bl -tag -width "-binary"
.It Fl binary
Output the digest or signature in binary form.
.It Fl c
Print out the digest in two-digit groups separated by colons; only relevant if
.Em hex
format output is used.
.It Fl d
Print out BIO debugging information.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dgst
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl hex
Digest is to be output as a hex dump.
This is the default case for a
.Qq normal
digest as opposed to a digital signature.
.It Fl keyform Ar PEM | ENGINE
Key file format.
.It Fl out Ar file
file to output to, or standard output by default.
.It Fl prverify Ar file
Verify the signature using the private key in
.Ar file .
The output is either
.Qq Verification OK
or
.Qq Verification Failure .
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl sign Ar file
Digitally sign the digest using the private key in
.Ar file .
.It Fl signature Ar file
The actual signature to verify.
.It Fl verify Ar file
Verify the signature using the public key in
.Ar file .
The output is either
.Qq Verification OK
or
.Qq Verification Failure .
.It Ar file ...
File or files to digest.
If no files are specified then standard input is used.
.El
.Sh DGST NOTES
The digest of choice for all new applications is SHA1.
Other digests are, however, still widely used.
.Pp
If you wish to sign or verify data using the DSA algorithm, the dss1
digest must be used.
.Pp
A source of random numbers is required for certain signing algorithms, in
particular DSA.
.Pp
The signing and verify options should only be used if a single file is
being signed or verified.
.\"
.\" DH
.\"
.Sh DH
Diffie-Hellman Parameter Management.
The
.Nm dh
command has been replaced by
.Nm dhparam .
See
.Sx DHPARAM
below.
.\"
.\" DHPARAM
.\"
.Sh DHPARAM
.Nm openssl dhparam
.Bk -words
.Op Fl 2 | 5
.Op Fl C
.Op Fl check
.Op Fl dsaparam
.Op Fl noout
.Op Fl text
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl rand Ar file ...
.Op Ar numbits
.Ek
.Pp
The
.Nm dhparam
command is used to manipulate DH parameter files.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl 2 , 5
The generator to use, either 2 or 5.
2 is the default.
If present, the input file is ignored and parameters are generated instead.
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dh Ns Ar numbits Ns Li ()
function.
.It Fl check
Check the DH parameters.
.It Fl dsaparam
If this option is used, DSA rather than DH parameters are read or created;
they are converted to DH format.
Otherwise,
.Qq strong
primes
.Pq such that (p-1)/2 is also prime
will be used for DH parameter generation.
.Pp
DH parameter generation with the
.Fl dsaparam
option is much faster,
and the recommended exponent length is shorter,
which makes DH key exchange more efficient.
Beware that with such DSA-style DH parameters,
a fresh DH key should be created for each use to
avoid small-subgroup attacks that may be possible otherwise.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dhparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read parameters from, or standard input if this option is not specified.
.It Fl inform Ar DER | PEM
This specifies the input format.
The argument
.Ar DER
uses an ASN1 DER-encoded form compatible with the PKCS#3 DHparameter
structure.
The
.Ar PEM
form is the default format:
it consists of the DER format base64-encoded with
additional header and footer lines.
.It Fl noout
This option inhibits the output of the encoded version of the parameters.
.It Ar numbits
This argument specifies that a parameter set should be generated of size
.Ar numbits .
It must be the last option.
If not present, a value of 512 is used.
If this value is present, the input file is ignored and
parameters are generated instead.
.It Fl out Ar file
This specifies the output
.Ar file
to write parameters to.
Standard output is used if this option is not present.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified, separated by a
.Sq \&: .
.It Fl text
This option prints out the DH parameters in human readable form.
.El
.Sh DHPARAM WARNINGS
The program
.Nm dhparam
combines the functionality of the programs
.Nm dh
and
.Nm gendh
in previous versions of
.Nm OpenSSL
and
.Nm SSLeay .
The
.Nm dh
and
.Nm gendh
programs are retained for now, but may have different purposes in future
versions of
.Nm OpenSSL .
.Sh DHPARAM NOTES
PEM format DH parameters use the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN DH PARAMETERS-----
-----END DH PARAMETERS-----
.Ed
.Pp
.Nm OpenSSL
currently only supports the older PKCS#3 DH,
not the newer X9.42 DH.
.Pp
This program manipulates DH parameters not keys.
.Sh DHPARAM BUGS
There should be a way to generate and manipulate DH keys.
.Sh DHPARAM HISTORY
The
.Nm dhparam
command was added in
.Nm OpenSSL
0.9.5.
The
.Fl dsaparam
option was added in
.Nm OpenSSL
0.9.6.
.\"
.\" DSA
.\"
.Sh DSA
.Nm openssl dsa
.Bk -words
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl modulus
.Op Fl noout
.Op Fl pubin
.Op Fl pubout
.Op Fl text
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Ek
.Pp
The
.Nm dsa
command processes DSA keys.
They can be converted between various forms and their components printed out.
.Pp
.Sy Note :
This command uses the traditional
.Nm SSLeay
compatible format for private key encryption:
newer applications should use the more secure PKCS#8 format using the
.Nm pkcs8
command.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES, or the triple DES
ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified, the key is written in plain text.
This means that using the
.Nm dsa
utility to read in an encrypted key with no encryption option can be used to
remove the pass phrase from a key,
or by setting the encryption options it can be use to add or change
the pass phrase.
These options can only be used with PEM format output files.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from, or standard input if this option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument with a private key uses an ASN1 DER-encoded form of an ASN.1
SEQUENCE consisting of the values of version
.Pq currently zero ,
P, Q, G,
and the public and private key components, respectively, as ASN.1 INTEGERs.
When used with a public key it uses a
.Em SubjectPublicKeyInfo
structure: it is an error if the key is not DSA.
.Pp
The
.Ar PEM
form is the default format:
it consists of the DER format base64-encoded with additional header and footer
lines.
In the case of a private key, PKCS#8 format is also accepted.
.It Fl modulus
This option prints out the value of the public key component of the key.
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output if not specified.
If any encryption options are set then a pass phrase will be
prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl pubin
By default, a private key is read from the input file.
With this option a public key is read instead.
.It Fl pubout
By default, a private key is output.
With this option a public key will be output instead.
This option is automatically set if the input is a public key.
.It Fl text
Prints out the public/private key components and parameters.
.El
.Sh DSA NOTES
The PEM private key format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN DSA PRIVATE KEY-----
-----END DSA PRIVATE KEY-----
.Ed
.Pp
The PEM public key format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN PUBLIC KEY-----
-----END PUBLIC KEY-----
.Ed
.Sh DSA EXAMPLES
To remove the pass phrase on a DSA private key:
.Pp
.Dl $ openssl dsa -in key.pem -out keyout.pem
.Pp
To encrypt a private key using triple DES:
.Pp
.Dl $ openssl dsa -in key.pem -des3 -out keyout.pem
.Pp
To convert a private key from PEM to DER format:
.Pp
.Dl $ openssl dsa -in key.pem -outform DER -out keyout.der
.Pp
To print out the components of a private key to standard output:
.Pp
.Dl $ openssl dsa -in key.pem -text -noout
.Pp
To just output the public part of a private key:
.Pp
.Dl $ openssl dsa -in key.pem -pubout -out pubkey.pem
.\"
.\" DSAPARAM
.\"
.Sh DSAPARAM
.Nm openssl dsaparam
.Bk -words
.Op Fl C
.Op Fl genkey
.Op Fl noout
.Op Fl text
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl rand Ar file ...
.Op Ar numbits
.Ek
.Pp
The
.Nm dsaparam
command is used to manipulate or generate DSA parameter files.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dsa Ns Ar XXX Ns Li ()
function.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsaparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl genkey
This option will generate a DSA either using the specified or generated
parameters.
.It Fl in Ar file
This specifies the input
.Ar file
to read parameters from, or standard input if this option is not specified.
If the
.Ar numbits
parameter is included, then this option will be ignored.
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument uses an ASN1 DER-encoded form compatible with RFC 2459
.Pq PKIX
DSS-Parms that is a SEQUENCE consisting of p, q and g, respectively.
The
.Ar PEM
form is the default format:
it consists of the DER format base64-encoded with additional header
and footer lines.
.It Fl noout
This option inhibits the output of the encoded version of the parameters.
.It Ar numbits
This option specifies that a parameter set should be generated of size
.Ar numbits .
If this option is included, the input file
.Pq if any
is ignored.
.It Fl out Ar file
This specifies the output
.Ar file
to write parameters to.
Standard output is used if this option is not present.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified, separated by a
.Sq \&: .
.It Fl text
This option prints out the DSA parameters in human readable form.
.El
.Sh DSAPARAM NOTES
PEM format DSA parameters use the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN DSA PARAMETERS-----
-----END DSA PARAMETERS-----
.Ed
.Pp
DSA parameter generation is a slow process and as a result the same set of
DSA parameters is often used to generate several distinct keys.
.\"
.\" ENC
.\"
.Sh ENC
.Nm openssl enc
.Bk -words
.Fl ciphername
.Op Fl AadePp
.Op Fl debug
.Op Fl engine Ar id
.Op Fl nopad
.Op Fl nosalt
.Op Fl salt
.Op Fl bufsize Ar number
.Op Fl in Ar file
.Op Fl iv Ar IV
.Op Fl K Ar key
.Op Fl k Ar password
.Op Fl kfile Ar file
.Op Fl out Ar file
.Op Fl pass Ar arg
.Op Fl S Ar salt
.Ek
.Pp
The symmetric cipher commands allow data to be encrypted or decrypted
using various block and stream ciphers using keys based on passwords
or explicitly provided.
Base64 encoding or decoding can also be performed either by itself
or in addition to the encryption or decryption.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl A
If the
.Fl a
option is set, then base64 process the data on one line.
.It Fl a
Base64 process the data.
This means that if encryption is taking place, the data is base64-encoded
after encryption.
If decryption is set, the input data is base64 decoded before
being decrypted.
.It Fl bufsize Ar number
Set the buffer size for I/O.
.It Fl d
Decrypt the input data.
.It Fl debug
Debug the BIOs used for I/O.
.It Fl e
Encrypt the input data: this is the default.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm enc
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
The input
.Ar file ;
standard input by default.
.It Fl iv Ar IV
The actual
.Ar IV
.Pq initialisation vector
to use:
this must be represented as a string comprised only of hex digits.
When only the
.Ar key
is specified using the
.Fl K
option, the
.Ar IV
must explicitly be defined.
When a password is being specified using one of the other options,
the
.Ar IV
is generated from this password.
.It Fl K Ar key
The actual
.Ar key
to use:
this must be represented as a string comprised only of hex digits.
If only the key is specified, the
.Ar IV
must be additionally specified using the
.Fl iv
option.
When both a
.Ar key
and a
.Ar password
are specified, the
.Ar key
given with the
.Fl K
option will be used and the
.Ar IV
generated from the password will be taken.
It probably does not make much sense to specify both
.Ar key
and
.Ar password .
.It Fl k Ar password
The
.Ar password
to derive the key from.
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl kfile Ar file
Read the password to derive the key from the first line of
.Ar file .
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl nopad
Disable standard block padding.
.It Fl nosalt
Don't use a
.Ar salt
in the key derivation routines.
This is the default for compatibility with previous versions of
.Nm OpenSSL
and
.Nm SSLeay .
.It Fl out Ar file
The output
.Ar file ,
standard output by default.
.It Fl P
Print out the
.Ar salt ,
.Ar key ,
and
.Ar IV
used, then immediately exit;
don't do any encryption or decryption.
.It Fl p
Print out the
.Ar salt ,
.Ar key ,
and
.Ar IV
used.
.It Fl pass Ar arg
The password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl S Ar salt
The actual
.Ar salt
to use:
this must be represented as a string comprised only of hex digits.
.It Fl salt
Use a
.Ar salt
in the key derivation routines.
This option should
.Em ALWAYS
be used unless compatibility with previous versions of
.Nm OpenSSL
or
.Nm SSLeay
is required.
This option is only present on
.Nm OpenSSL
versions 0.9.5 or above.
.El
.Sh ENC NOTES
The program can be called either as
.Nm openssl ciphername
or
.Nm openssl enc -ciphername .
.Pp
A password will be prompted for to derive the
.Ar key
and
.Ar IV
if necessary.
.Pp
The
.Fl salt
option should
.Em ALWAYS
be used if the key is being derived from a password unless compatibility
with previous versions of
.Nm OpenSSL
and
.Nm SSLeay
is necessary.
.Pp
Without the
.Fl salt
option it is possible to perform efficient dictionary
attacks on the password and to attack stream cipher encrypted data.
The reason for this is that without the
.Ar salt
the same password always generates the same encryption key.
When the
.Ar salt
is being used the first eight bytes of the encrypted data are reserved
for the
.Ar salt :
it is generated at random when encrypting a file and read from the
encrypted file when it is decrypted.
.Pp
Some of the ciphers do not have large keys and others have security
implications if not used correctly.
A beginner is advised to just use a strong block cipher in CBC mode
such as bf or des3.
.Pp
All the block ciphers normally use PKCS#5 padding also known as standard block
padding:
this allows a rudimentary integrity or password check to be performed.
However, since the chance of random data passing the test is
better than 1 in 256, it isn't a very good test.
.Pp
If padding is disabled, the input data must be a multiple of the cipher
block length.
.Pp
All RC2 ciphers have the same key and effective key length.
.Pp
Blowfish and RC5 algorithms use a 128-bit key.
.Sh ENC SUPPORTED CIPHERS
.Bd -unfilled -offset indent
aes-128-cbc        128-bit AES in CBC mode
aes128             Alias for aes-128-cbc
aes-128-cfb        128-bit AES in CFB mode
aes-128-ecb        128-bit AES in ECB mode
aes-128-ofb        128-bit AES in OFB mode

aes-192-cbc        192-bit AES in CBC mode
aes192             Alias for aes-192-cbc
aes-192-cfb        192-bit AES in CFB mode
aes-192-ecb        192-bit AES in ECB mode
aes-192-ofb        192-bit AES in OFB mode

aes-256-cbc        256-bit AES in CBC mode
aes256             Alias for aes-256-cbc
aes-256-cfb        256-bit AES in CFB mode
aes-256-ecb        256-bit AES in ECB mode
aes-256-ofb        256-bit AES in OFB mode

base64             Base 64

bf-cbc             Blowfish in CBC mode
bf                 Alias for bf-cbc
blowfish           Alias for bf-cbc
bf-cfb             Blowfish in CFB mode
bf-ecb             Blowfish in ECB mode
bf-ofb             Blowfish in OFB mode

cast-cbc           CAST in CBC mode
cast               Alias for cast-cbc
cast5-cbc          CAST5 in CBC mode
cast5-cfb          CAST5 in CFB mode
cast5-ecb          CAST5 in ECB mode
cast5-ofb          CAST5 in OFB mode

des-cbc            DES in CBC mode
des                Alias for des-cbc
des-cfb            DES in CBC mode
des-ecb            DES in ECB mode
des-ofb            DES in OFB mode

des-ede-cbc        Two key triple DES EDE in CBC mode
des-ede            Alias for des-ede
des-ede-cfb        Two key triple DES EDE in CFB mode
des-ede-ofb        Two key triple DES EDE in OFB mode

des-ede3-cbc       Three key triple DES EDE in CBC mode
des-ede3           Alias for des-ede3-cbc
des3               Alias for des-ede3-cbc
des-ede3-cfb       Three key triple DES EDE CFB mode
des-ede3-ofb       Three key triple DES EDE in OFB mode

desx-cbc           DESX algorithm
desx               Alias for desx-cbc

rc2-cbc            128-bit RC2 in CBC mode
rc2                Alias for rc2-cbc
rc2-cfb            128-bit RC2 in CBC mode
rc2-ecb            128-bit RC2 in CBC mode
rc2-ofb            128-bit RC2 in CBC mode
rc2-64-cbc         64-bit RC2 in CBC mode
rc2-40-cbc         40-bit RC2 in CBC mode

rc4                128-bit RC4
rc4-40             40-bit RC4
.Ed
.Sh ENC EXAMPLES
Just base64 encode a binary file:
.Pp
.Dl $ openssl base64 -in file.bin -out file.b64
.Pp
Decode the same file:
.Pp
.Dl $ openssl base64 -d -in file.b64 -out file.bin
.Pp
Encrypt a file using triple DES in CBC mode using a prompted password:
.Pp
.Dl $ openssl des3 -salt -in file.txt -out file.des3
.Pp
Decrypt a file using a supplied password:
.Pp
.Dl "$ openssl des3 -d -in file.des3 -out file.txt -k mypassword"
.Pp
Encrypt a file then base64 encode it
(so it can be sent via mail for example)
using Blowfish in CBC mode:
.Pp
.Dl $ openssl bf -a -salt -in file.txt -out file.bf
.Pp
Base64 decode a file then decrypt it:
.Pp
.Dl "$ openssl bf -d -a -in file.bf -out file.txt"
.Sh ENC BUGS
The
.Fl A
option when used with large files doesn't work properly.
.Pp
There should be an option to allow an iteration count to be included.
.Pp
The
.Nm enc
program only supports a fixed number of algorithms with certain parameters.
Therefore it is not possible to use RC2 with a 76-bit key
or RC4 with an 84-bit key with this program.
.\"
.\" ERRSTR
.\"
.Sh ERRSTR
.Nm openssl errstr
.Op Fl stats
.Ar errno ...
.Pp
The
.Nm errstr
command performs error number to error string conversion,
generating a human-readable string representing the error code
.Ar errno .
The string is obtained through the
.Xr ERR_error_string_n 3
function and has the following format:
.Pp
.Dl error:[error code]:[library name]:[function name]:[reason string]
.Pp
.Bq error code
is an 8-digit hexadecimal number.
The remaining fields
.Bq library name ,
.Bq function name ,
and
.Bq reason string
are all ASCII text.
.Pp
The options are as follows:
.Bl -tag -width "-stats"
.It Fl stats
Print debugging statistics about various aspects of the hash table.
.El
.\"
.\" GENDH
.\"
.Sh GENDH
Generation of Diffie-Hellman Parameters.
Replaced by
.Nm dhparam .
See
.Sx DHPARAM
above.
.\"
.\" GENDSA
.\"
.Sh GENDSA
.Nm openssl gendsa
.Bk -words
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl engine Ar id
.Op Fl out Ar file
.Op Fl rand Ar file ...
.Op Ar paramfile
.Ek
.Pp
The
.Nm gendsa
command generates a DSA private key from a DSA parameter file
(which will typically be generated by the
.Nm openssl dsaparam
command).
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options are specified, no encryption is used.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm gendsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl out Ar file
The output
.Ar file .
If this argument is not specified, standard output is used.
.It Ar paramfile
This option specifies the DSA parameter file to use.
The parameters in this file determine the size of the private key.
DSA parameters can be generated and examined using the
.Nm openssl dsaparam
command.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.El
.Sh GENDSA NOTES
DSA key generation is little more than random number generation so it is
much quicker than RSA key generation, for example.
.\"
.\" GENRSA
.\"
.Sh GENRSA
.Nm openssl genrsa
.Bk -words
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl engine Ar id
.Op Fl 3 | f4
.Op Fl out Ar file
.Op Fl passout Ar arg
.Op Fl rand Ar file ...
.Op Ar numbits
.Ek
.Pp
The
.Nm genrsa
command generates an RSA private key.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
If none of these options are specified, no encryption is used.
If encryption is used, a pass phrase is prompted for,
if it is not supplied via the
.Fl passout
option.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm genrsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl 3 | f4
The public exponent to use, either 3 or 65537.
The default is 65537.
.It Ar numbits
The size of the private key to generate in bits.
This must be the last option specified.
The default is 512.
.It Fl out Ar file
The output
.Ar file .
If this argument is not specified, standard output is used.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl rand Ar file ...
A file or files
containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.El
.Sh GENRSA NOTES
RSA private key generation essentially involves the generation of two prime
numbers.
When generating a private key, various symbols will be output to
indicate the progress of the generation.
A
.Sq \&.
represents each number which has passed an initial sieve test;
.Sq +
means a number has passed a single round of the Miller-Rabin primality test.
A newline means that the number has passed all the prime tests
.Pq the actual number depends on the key size .
.Pp
Because key generation is a random process,
the time taken to generate a key may vary somewhat.
.Sh GENRSA BUGS
A quirk of the prime generation algorithm is that it cannot generate small
primes.
Therefore the number of bits should not be less that 64.
For typical private keys this will not matter because for security reasons
they will be much larger
.Pq typically 1024 bits .
.\"
.\" NSEQ
.\"
.Sh NSEQ
.Nm openssl nseq
.Op Fl toseq
.Op Fl in Ar file
.Op Fl out Ar file
.Pp
The
.Nm nseq
command takes a file containing a Netscape certificate
sequence and prints out the certificates contained in it or takes a
file of certificates and converts it into a Netscape certificate
sequence.
.Pp
The options are as follows:
.Bl -tag -width "-toseq"
.It Fl in Ar file
This specifies the input
.Ar file
to read, or standard input if this option is not specified.
.It Fl out Ar file
Specifies the output
.Ar file ,
or standard output by default.
.It Fl toseq
Normally, a Netscape certificate sequence will be input and the output
is the certificates contained in it.
With the
.Fl toseq
option the situation is reversed:
a Netscape certificate sequence is created from a file of certificates.
.El
.Sh NSEQ EXAMPLES
Output the certificates in a Netscape certificate sequence:
.Bd -literal
.Dl $ openssl nseq -in nseq.pem -out certs.pem
.Ed
.Pp
Create a Netscape certificate sequence:
.Bd -literal
.Dl $ openssl nseq -in certs.pem -toseq -out nseq.pem
.Ed
.Sh NSEQ NOTES
The PEM-encoded form uses the same headers and footers as a certificate:
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
.Ed
.Pp
A Netscape certificate sequence is a Netscape specific form that can be sent
to browsers as an alternative to the standard PKCS#7 format when several
certificates are sent to the browser:
for example during certificate enrollment.
It is used by the Netscape certificate server, for example.
.Sh NSEQ BUGS
This program needs a few more options,
like allowing DER or PEM input and output files
and allowing multiple certificate files to be used.
.\"
.\" OCSP
.\"
.Sh OCSP
.Nm openssl ocsp
.Bk -words
.Op Fl no_cert_checks
.Op Fl no_cert_verify
.Op Fl no_certs
.Op Fl no_chain
.Op Fl no_intern
.Op Fl no_nonce
.Op Fl no_signature_verify
.Op Fl nonce
.Op Fl noverify
.Op Fl req_text
.Op Fl resp_key_id
.Op Fl resp_no_certs
.Op Fl resp_text
.Op Fl text
.Op Fl trust_other
.Op Fl CA Ar file
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Oo
.Fl host
.Ar hostname : Ns Ar port
.Oc
.Op Fl index Ar indexfile
.Op Fl issuer Ar file
.Op Fl ndays Ar days
.Op Fl nmin Ar minutes
.Op Fl nrequest Ar number
.Op Fl out Ar file
.Op Fl path Ar path
.Op Fl port Ar portnum
.Op Fl reqin Ar file
.Op Fl reqout Ar file
.Op Fl respin Ar file
.Op Fl respout Ar file
.Op Fl rkey Ar file
.Op Fl rother Ar file
.Op Fl rsigner Ar file
.Op Fl serial Ar number
.Op Fl sign_other Ar file
.Op Fl signer Ar file
.Op Fl signkey Ar file
.Op Fl status_age Ar age
.Op Fl url Ar responder_url
.Op Fl VAfile Ar file
.Op Fl validity_period Ar nsec
.Op Fl verify_other Ar file
.Ek
.Pp
The Online Certificate Status Protocol
.Pq OCSP
enables applications to determine the
.Pq revocation
state of an identified certificate
.Pq RFC 2560 .
.Pp
The
.Nm ocsp
command performs many common OCSP tasks.
It can be used to print out requests and responses,
create requests and send queries to an OCSP responder,
and behave like a mini OCSP server itself.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl CAfile Ar file , Fl CApath Ar directory
.Ar file
or
.Ar path
containing trusted CA certificates.
These are used to verify the signature on the OCSP response.
.It Fl cert Ar file
Add the certificate
.Ar file
to the request.
The issuer certificate is taken from the previous
.Fl issuer
option, or an error occurs if no issuer certificate is specified.
.It Xo
.Fl host Ar hostname : Ns Ar port ,
.Fl path Ar path
.Xc
If the
.Fl host
option is present, then the OCSP request is sent to the host
.Ar hostname
on port
.Ar port .
.Fl path
specifies the HTTP path name to use, or
.Sq /
by default.
.It Fl issuer Ar file
This specifies the current issuer certificate.
This option can be used multiple times.
The certificate specified in
.Ar file
must be in PEM format.
.It Fl no_cert_checks
Don't perform any additional checks on the OCSP response signer's certificate.
That is, do not make any checks to see if the signer's certificate is
authorised to provide the necessary status information:
as a result this option should only be used for testing purposes.
.It Fl no_cert_verify
Don't verify the OCSP response signer's certificate at all.
Since this option allows the OCSP response to be signed by any certificate,
it should only be used for testing purposes.
.It Fl no_certs
Don't include any certificates in signed request.
.It Fl no_chain
Do not use certificates in the response as additional untrusted CA
certificates.
.It Fl no_intern
Ignore certificates contained in the OCSP response
when searching for the signer's certificate.
With this option, the signer's certificate must be specified with either the
.Fl verify_certs
or
.Fl VAfile
options.
.It Fl no_signature_verify
Don't check the signature on the OCSP response.
Since this option tolerates invalid signatures on OCSP responses,
it will normally only be used for testing purposes.
.It Fl nonce , no_nonce
Add an OCSP
.Em nonce
extension to a request or disable an OCSP
.Em nonce
addition.
Normally, if an OCSP request is input using the
.Fl respin
option no
.Em nonce
is added:
using the
.Fl nonce
option will force addition of a
.Em nonce .
If an OCSP request is being created (using the
.Fl cert
and
.Fl serial
options)
a
.Em nonce
is automatically added; specifying
.Fl no_nonce
overrides this.
.It Fl noverify
Don't attempt to verify the OCSP response signature or the
.Em nonce
values.
This option will normally only be used for debugging
since it disables all verification of the responder's certificate.
.It Fl out Ar file
Specify output
.Ar file ;
default is standard output.
.It Fl req_text , resp_text , text
Print out the text form of the OCSP request, response, or both, respectively.
.It Fl reqin Ar file , Fl respin Ar file
Read an OCSP request or response file from
.Ar file .
These option are ignored
if an OCSP request or response creation is implied by other options
(for example with the
.Fl serial , cert ,
and
.Fl host
options).
.It Fl reqout Ar file , Fl respout Ar file
Write out the DER-encoded certificate request or response to
.Ar file .
.It Fl serial Ar num
Same as the
.Fl cert
option except the certificate with serial number
.Ar num
is added to the request.
The serial number is interpreted as a decimal integer unless preceded by
.Sq 0x .
Negative integers can also be specified by preceding the value with a
.Sq -
sign.
.It Fl sign_other Ar file
Additional certificates to include in the signed request.
.It Fl signer Ar file , Fl signkey Ar file
Sign the OCSP request using the certificate specified in the
.Fl signer
option and the private key specified by the
.Fl signkey
option.
If the
.Fl signkey
option is not present, then the private key is read from the same file
as the certificate.
If neither option is specified, the OCSP request is not signed.
.It Fl trust_other
The certificates specified by the
.Fl verify_certs
option should be explicitly trusted and no additional checks will be
performed on them.
This is useful when the complete responder certificate chain is not available
or trusting a root CA is not appropriate.
.It Fl url Ar responder_url
Specify the responder URL.
Both HTTP and HTTPS
.Pq SSL/TLS
URLs can be specified.
.It Fl VAfile Ar file
.Ar file
containing explicitly trusted responder certificates.
Equivalent to the
.Fl verify_certs
and
.Fl trust_other
options.
.It Fl validity_period Ar nsec , Fl status_age Ar age
These options specify the range of times, in seconds, which will be tolerated
in an OCSP response.
Each certificate status response includes a
.Em notBefore
time and an optional
.Em notAfter
time.
The current time should fall between these two values,
but the interval between the two times may be only a few seconds.
In practice the OCSP responder and clients' clocks may not be precisely
synchronised and so such a check may fail.
To avoid this the
.Fl validity_period
option can be used to specify an acceptable error range in seconds,
the default value is 5 minutes.
.Pp
If the
.Em notAfter
time is omitted from a response, then this means that new status
information is immediately available.
In this case the age of the
.Em notBefore
field is checked to see it is not older than
.Ar age
seconds old.
By default, this additional check is not performed.
.It Fl verify_other Ar file
.Ar file
containing additional certificates to search when attempting to locate
the OCSP response signing certificate.
Some responders omit the actual signer's certificate from the response;
this option can be used to supply the necessary certificate in such cases.
.El
.Sh OCSP SERVER OPTIONS
.Bl -tag -width "XXXX"
.It Fl CA Ar file
CA certificate corresponding to the revocation information in
.Ar indexfile .
.It Fl index Ar indexfile
.Ar indexfile
is a text index file in
.Nm ca
format containing certificate revocation information.
.Pp
If the
.Fl index
option is specified, the
.Nm ocsp
utility is in
.Em responder
mode, otherwise it is in
.Em client
mode.
The request(s) the responder processes can be either specified on
the command line (using the
.Fl issuer
and
.Fl serial
options), supplied in a file (using the
.Fl respin
option) or via external OCSP clients (if
.Ar port
or
.Ar url
is specified).
.Pp
If the
.Fl index
option is present, then the
.Fl CA
and
.Fl rsigner
options must also be present.
.It Fl nmin Ar minutes , Fl ndays Ar days
Number of
.Ar minutes
or
.Ar days
when fresh revocation information is available: used in the
.Ar nextUpdate
field.
If neither option is present, the
.Em nextUpdate
field is omitted, meaning fresh revocation information is immediately available.
.It Fl nrequest Ar number
The OCSP server will exit after receiving
.Ar number
requests, default unlimited.
.It Fl port Ar portnum
Port to listen for OCSP requests on.
The port may also be specified using the
.Fl url
option.
.It Fl resp_key_id
Identify the signer certificate using the key ID;
default is to use the subject name.
.It Fl resp_no_certs
Don't include any certificates in the OCSP response.
.It Fl rkey Ar file
The private key to sign OCSP responses with;
if not present, the file specified in the
.Fl rsigner
option is used.
.It Fl rother Ar file
Additional certificates to include in the OCSP response.
.It Fl rsigner Ar file
The certificate to sign OCSP responses with.
.El
.Sh OCSP RESPONSE VERIFICATION
OCSP Response follows the rules specified in RFC 2560.
.Pp
Initially the OCSP responder certificate is located and the signature on
the OCSP request checked using the responder certificate's public key.
.Pp
Then a normal certificate verify is performed on the OCSP responder certificate
building up a certificate chain in the process.
The locations of the trusted certificates used to build the chain can be
specified by the
.Fl CAfile
and
.Fl CApath
options or they will be looked for in the standard
.Nm OpenSSL
certificates
directory.
.Pp
If the initial verify fails, the OCSP verify process halts with an
error.
.Pp
Otherwise the issuing CA certificate in the request is compared to the OCSP
responder certificate: if there is a match then the OCSP verify succeeds.
.Pp
Otherwise the OCSP responder certificate's CA is checked against the issuing
CA certificate in the request.
If there is a match and the OCSPSigning extended key usage is present
in the OCSP responder certificate, then the OCSP verify succeeds.
.Pp
Otherwise the root CA of the OCSP responder's CA is checked to see if it
is trusted for OCSP signing.
If it is, the OCSP verify succeeds.
.Pp
If none of these checks is successful, the OCSP verify fails.
.Pp
What this effectively means is that if the OCSP responder certificate is
authorised directly by the CA it is issuing revocation information about
.Pq and it is correctly configured ,
then verification will succeed.
.Pp
If the OCSP responder is a
.Em global responder
which can give details about multiple CAs and has its own separate
certificate chain, then its root CA can be trusted for OCSP signing.
For example:
.Bd -literal -offset indent
$ openssl x509 -in ocspCA.pem -addtrust OCSPSigning \e
	-out trustedCA.pem
.Ed
.Pp
Alternatively, the responder certificate itself can be explicitly trusted
with the
.Fl VAfile
option.
.Sh OCSP NOTES
As noted, most of the verify options are for testing or debugging purposes.
Normally, only the
.Fl CApath , CAfile
and
.Pq if the responder is a `global VA'
.Fl VAfile
options need to be used.
.Pp
The OCSP server is only useful for test and demonstration purposes:
it is not really usable as a full OCSP responder.
It contains only a very simple HTTP request handling and can only handle
the POST form of OCSP queries.
It also handles requests serially, meaning it cannot respond to
new requests until it has processed the current one.
The text index file format of revocation is also inefficient for large
quantities of revocation data.
.Pp
It is possible to run the
.Nm ocsp
application in
.Em responder
mode via a CGI script using the
.Fl respin
and
.Fl respout
options.
.Sh OCSP EXAMPLES
Create an OCSP request and write it to a file:
.Bd -literal -offset indent
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \e
	-reqout req.der
.Ed
.Pp
Send a query to an OCSP responder with URL
.Pa http://ocsp.myhost.com/ ,
save the response to a file and print it out in text form:
.Bd -literal -offset indent
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \e
	-url http://ocsp.myhost.com/ -resp_text -respout resp.der
.Ed
.Pp
Read in an OCSP response and print out in text form:
.Pp
.Dl $ openssl ocsp -respin resp.der -text
.Pp
OCSP server on port 8888 using a standard
.Nm ca
configuration, and a separate responder certificate.
All requests and responses are printed to a file:
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \e
	rcert.pem -CA demoCA/cacert.pem -text -out log.txt
.Ed
.Pp
As above, but exit after processing one request:
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \e
	rcert.pem -CA demoCA/cacert.pem -nrequest 1
.Ed
.Pp
Query status information using internally generated request:
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
	demoCA/cacert.pem -issuer demoCA/cacert.pem -serial 1
.Ed
.Pp
Query status information using request read from a file and write
the response to a second file:
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
	demoCA/cacert.pem -reqin req.der -respout resp.der
.Ed
.\"
.\" PASSWD
.\"
.Sh PASSWD
.Nm openssl passwd
.Op Fl 1 | apr1 | crypt
.Op Fl noverify
.Op Fl quiet
.Op Fl reverse
.Op Fl stdin
.Op Fl table
.Op Fl in Ar file
.Op Fl salt Ar string
.Op Ar password
.Pp
The
.Nm passwd
command computes the hash of a password typed at run-time
or the hash of each password in a list.
The password list is taken from the named
.Ar file
for option
.Fl in ,
from stdin for option
.Fl stdin ,
or from the command line, or from the terminal otherwise.
The
.Ux
standard algorithm
.Em crypt
and the MD5-based
.Bx
password algorithm
.Em 1
and its Apache variant
.Em apr1
are available.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl 1
Use the MD5 based
.Bx
password algorithm
.Em 1 .
.It Fl apr1
Use the
.Em apr1
algorithm
.Pq Apache variant of the
.Bx
algorithm.
.It Fl crypt
Use the
.Em crypt
algorithm
.Pq default .
.It Fl in Ar file
Read passwords from
.Ar file .
.It Fl noverify
Don't verify when reading a password from the terminal.
.It Fl quiet
Don't output warnings when passwords given on the command line are truncated.
.It Fl reverse
Switch table columns.
This only makes sense in conjunction with the
.Fl table
option.
.It Fl salt Ar string
Use the specified
.Ar salt .
When reading a password from the terminal, this implies
.Fl noverify .
.It Fl stdin
Read passwords from
.Em stdin .
.It Fl table
In the output list, prepend the cleartext password and a TAB character
to each password hash.
.El
.Sh PASSWD EXAMPLES
.Dl $ openssl passwd -crypt -salt xx password
prints
.Qq xxj31ZMTZzkVA .
.Pp
.Dl $ openssl passwd -1 -salt xxxxxxxx password
prints
.Qq $1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a. .
.Pp
.Dl $ openssl passwd -apr1 -salt xxxxxxxx password
prints
.Qq $apr1$xxxxxxxx$dxHfLAsjHkDRmG83UXe8K0 .
.\"
.\" PKCS7
.\"
.Sh PKCS7
.Nm openssl pkcs7
.Bk -words
.Op Fl noout
.Op Fl print_certs
.Op Fl text
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Ek
.Pp
The
.Nm pkcs7
command processes PKCS#7 files in DER or PEM format.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs7
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read from, or standard input if this option is not specified.
.It Fl inform Ar DER | PEM
This specifies the input format.
.Ar DER
format is a DER-encoded PKCS#7 v1.5 structure.
.Ar PEM
.Pq the default
is a base64-encoded version of the DER form with header and footer lines.
.It Fl noout
Don't output the encoded version of the PKCS#7 structure
(or certificates if
.Fl print_certs
is set).
.It Fl out Ar file
Specifies the output
.Ar file
to write to, or standard output by default.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl print_certs
Prints out any certificates or CRLs contained in the file.
They are preceded by their subject and issuer names in a one-line format.
.It Fl text
Prints out certificate details in full rather than just subject and
issuer names.
.El
.Sh PKCS7 EXAMPLES
Convert a PKCS#7 file from PEM to DER:
.Pp
.Dl $ openssl pkcs7 -in file.pem -outform DER -out file.der
.Pp
Output all certificates in a file:
.Pp
.Dl $ openssl pkcs7 -in file.pem -print_certs -out certs.pem
.Sh PKCS7 NOTES
The PEM PKCS#7 format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN PKCS7-----
-----END PKCS7-----
.Ed
.Pp
For compatibility with some CAs it will also accept:
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
.Ed
.Sh PKCS7 RESTRICTIONS
There is no option to print out all the fields of a PKCS#7 file.
.Pp
The PKCS#7 routines only understand PKCS#7 v 1.5 as specified in RFC 2315.
They cannot currently parse, for example, the new CMS as described in RFC 2630.
.\"
.\" PKCS8
.\"
.Sh PKCS8
.Nm openssl pkcs8
.Bk -words
.Op Fl embed
.Op Fl nocrypt
.Op Fl noiter
.Op Fl nooct
.Op Fl nsdb
.Op Fl topk8
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Op Fl v1 Ar alg
.Op Fl v2 Ar alg
.Ek
.Pp
The
.Nm pkcs8
command processes private keys in PKCS#8 format.
It can handle both unencrypted PKCS#8 PrivateKeyInfo format
and EncryptedPrivateKeyInfo format with a variety of PKCS#5
.Pq v1.5 and v2.0
and PKCS#12 algorithms.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl embed
This option generates DSA keys in a broken format.
The DSA parameters are embedded inside the
.Em PrivateKey
structure.
In this form the OCTET STRING contains an ASN1 SEQUENCE consisting of
two structures:
a SEQUENCE containing the parameters and an ASN1 INTEGER containing
the private key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs8
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from, or standard input if this option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
.It Fl inform Ar DER | PEM
This specifies the input format.
If a PKCS#8 format key is expected on input,
then either a
DER- or PEM-encoded version of a PKCS#8 key will be expected.
Otherwise the DER or PEM format of the traditional format private key is used.
.It Fl nocrypt
PKCS#8 keys generated or input are normally PKCS#8
.Em EncryptedPrivateKeyInfo
structures using an appropriate password-based encryption algorithm.
With this option, an unencrypted
.Em PrivateKeyInfo
structure is expected or output.
This option does not encrypt private keys at all and should only be used
when absolutely necessary.
Certain software such as some versions of Java code signing software use
unencrypted private keys.
.It Fl noiter
Use an iteration count of 1.
See the
.Sx PKCS12
section below for a detailed explanation of this option.
.It Fl nooct
This option generates RSA private keys in a broken format that some software
uses.
Specifically the private key should be enclosed in an OCTET STRING,
but some software just includes the structure itself without the
surrounding OCTET STRING.
.It Fl nsdb
This option generates DSA keys in a broken format compatible with Netscape
private key databases.
The
.Em PrivateKey
contains a SEQUENCE consisting of the public and private keys, respectively.
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output by default.
If any encryption options are set, a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl topk8
Normally, a PKCS#8 private key is expected on input and a traditional format
private key will be written.
With the
.Fl topk8
option the situation is reversed:
it reads a traditional format private key and writes a PKCS#8 format key.
.It Fl v1 Ar alg
This option specifies a PKCS#5 v1.5 or PKCS#12 algorithm to use.
A complete list of possible algorithms is included below.
.It Fl v2 Ar alg
This option enables the use of PKCS#5 v2.0 algorithms.
Normally, PKCS#8 private keys are encrypted with the password-based
encryption algorithm called
.Em pbeWithMD5AndDES-CBC ;
this uses 56-bit DES encryption but it was the strongest encryption
algorithm supported in PKCS#5 v1.5.
Using the
.Fl v2
option PKCS#5 v2.0 algorithms are used which can use any
encryption algorithm such as 168-bit triple DES or 128-bit RC2, however
not many implementations support PKCS#5 v2.0 yet.
If using private keys with
.Nm OpenSSL
then this doesn't matter.
.Pp
The
.Ar alg
argument is the encryption algorithm to use; valid values include
.Ar des , des3 ,
and
.Ar rc2 .
It is recommended that
.Ar des3
is used.
.El
.Sh PKCS8 NOTES
The encrypted form of a PEM-encoded PKCS#8 file uses the following
headers and footers:
.Bd -unfilled -offset indent
-----BEGIN ENCRYPTED PRIVATE KEY-----
-----END ENCRYPTED PRIVATE KEY-----
.Ed
.Pp
The unencrypted form uses:
.Bd -unfilled -offset indent
-----BEGIN PRIVATE KEY-----
-----END PRIVATE KEY-----
.Ed
.Pp
Private keys encrypted using PKCS#5 v2.0 algorithms and high iteration
counts are more secure than those encrypted using the traditional
.Nm SSLeay
compatible formats.
So if additional security is considered important, the keys should be converted.
.Pp
The default encryption is only 56 bits because this is the encryption
that most current implementations of PKCS#8 support.
.Pp
Some software may use PKCS#12 password-based encryption algorithms
with PKCS#8 format private keys: these are handled automatically
but there is no option to produce them.
.Pp
It is possible to write out
DER-encoded encrypted private keys in PKCS#8 format because the encryption
details are included at an ASN1
level whereas the traditional format includes them at a PEM level.
.Sh PKCS#5 V1.5 AND PKCS#12 ALGORITHMS
Various algorithms can be used with the
.Fl v1
command line option, including PKCS#5 v1.5 and PKCS#12.
These are described in more detail below.
.Pp
.Bl -tag -width "XXXX" -compact
.It Ar PBE-MD2-DES | PBE-MD5-DES
These algorithms were included in the original PKCS#5 v1.5 specification.
They only offer 56 bits of protection since they both use DES.
.Pp
.It Ar PBE-SHA1-RC2-64 | PBE-MD2-RC2-64 | PBE-MD5-RC2-64 | PBE-SHA1-DES
These algorithms are not mentioned in the original PKCS#5 v1.5 specification
but they use the same key derivation algorithm and are supported by some
software.
They are mentioned in PKCS#5 v2.0.
They use either 64-bit RC2 or 56-bit DES.
.Pp
.It Ar PBE-SHA1-RC4-128 | PBE-SHA1-RC4-40 | PBE-SHA1-3DES | PBE-SHA1-2DES
.It Ar PBE-SHA1-RC2-128 | PBE-SHA1-RC2-40
These algorithms use the PKCS#12 password-based encryption algorithm and
allow strong encryption algorithms like triple DES or 128-bit RC2 to be used.
.El
.Sh PKCS8 EXAMPLES
Convert a private key from traditional to PKCS#5 v2.0 format using triple DES:
.Pp
.Dl "$ openssl pkcs8 -in key.pem -topk8 -v2 des3 -out enckey.pem"
.Pp
Convert a private key to PKCS#8 using a PKCS#5 1.5 compatible algorithm
.Pq DES :
.Pp
.Dl $ openssl pkcs8 -in key.pem -topk8 -out enckey.pem
.Pp
Convert a private key to PKCS#8 using a PKCS#12 compatible algorithm
.Pq 3DES :
.Bd -literal -offset indent
$ openssl pkcs8 -in key.pem -topk8 -out enckey.pem \e
	-v1 PBE-SHA1-3DES
.Ed
.Pp
Read a DER-unencrypted PKCS#8 format private key:
.Pp
.Dl "$ openssl pkcs8 -inform DER -nocrypt -in key.der -out key.pem"
.Pp
Convert a private key from any PKCS#8 format to traditional format:
.Pp
.Dl $ openssl pkcs8 -in pk8.pem -out key.pem
.Sh PKCS8 STANDARDS
Test vectors from this PKCS#5 v2.0 implementation were posted to the
pkcs-tng mailing list using triple DES, DES and RC2 with high iteration counts;
several people confirmed that they could decrypt the private
keys produced and therefore it can be assumed that the PKCS#5 v2.0
implementation is reasonably accurate at least as far as these
algorithms are concerned.
.Pp
The format of PKCS#8 DSA
.Pq and other
private keys is not well documented:
it is hidden away in PKCS#11 v2.01, section 11.9;
.Nm OpenSSL Ns Li 's
default DSA PKCS#8 private key format complies with this standard.
.Sh PKCS8 BUGS
There should be an option that prints out the encryption algorithm
in use and other details such as the iteration count.
.Pp
PKCS#8 using triple DES and PKCS#5 v2.0 should be the default private
key format; for
.Nm OpenSSL
compatibility, several of the utilities use the old format at present.
.\"
.\" PKCS12
.\"
.Sh PKCS12
.Nm "openssl pkcs12"
.Bk -words
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl cacerts
.Op Fl chain
.Op Fl clcerts
.Op Fl descert
.Op Fl export
.Op Fl info
.Op Fl keyex
.Op Fl keysig
.Op Fl maciter
.Op Fl nocerts
.Op Fl nodes
.Op Fl noiter
.Op Fl nokeys
.Op Fl nomaciter
.Op Fl nomacver
.Op Fl noout
.Op Fl twopass
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl caname Ar name
.Op Fl certfile Ar file
.Op Fl certpbe Ar alg
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inkey Ar file
.Op Fl keypbe Ar alg
.Op Fl name Ar name
.Op Fl out Ar file
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Op Fl rand Ar file ...
.Ek
.Pp
The
.Nm pkcs12
command allows PKCS#12 files
.Pq sometimes referred to as PFX files
to be created and parsed.
PKCS#12 files are used by several programs including Netscape, MSIE
and MS Outlook.
.Pp
There are a lot of options; the meaning of some depends on whether a
PKCS#12 file is being created or parsed.
By default, a PKCS#12 file is parsed;
a PKCS#12 file can be created by using the
.Fl export
option
.Pq see below .
.Sh PKCS12 PARSING OPTIONS
.Bl -tag -width "XXXX"
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
Use AES, DES, or triple DES, respectively,
to encrypt private keys before outputting.
The default is triple DES.
.It Fl cacerts
Only output CA certificates
.Pq not client certificates .
.It Fl clcerts
Only output client certificates
.Pq not CA certificates .
.It Fl in Ar file
This specifies the
.Ar file
of the PKCS#12 file to be parsed.
Standard input is used by default.
.It Fl info
Output additional information about the PKCS#12 file structure,
algorithms used, and iteration counts.
.It Fl nocerts
No certificates at all will be output.
.It Fl nodes
Don't encrypt the private keys at all.
.It Fl nokeys
No private keys will be output.
.It Fl nomacver
Don't attempt to verify the integrity MAC before reading the file.
.It Fl noout
This option inhibits output of the keys and certificates to the output file
version of the PKCS#12 file.
.It Fl out Ar file
The
.Ar file
to write certificates and private keys to, standard output by default.
They are all written in PEM format.
.It Fl passin Ar arg
The PKCS#12 file
.Pq i.e. input file
password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
Pass phrase source to encrypt any outputed private keys with.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl twopass
Prompt for separate integrity and encryption passwords: most software
always assumes these are the same so this option will render such
PKCS#12 files unreadable.
.El
.Sh PKCS12 FILE CREATION OPTIONS
.Bl -tag -width "XXXX"
.It Fl CAfile Ar file
File of CAs
.Pq PEM format .
.It Fl CApath Ar directory
Directory of CAs
.Pq PEM format .
.It Fl caname Ar name
This specifies the
.Qq friendly name
for other certificates.
This option may be used multiple times to specify names for all certificates
in the order they appear.
Netscape ignores friendly names on other certificates,
whereas MSIE displays them.
.It Fl certfile Ar file
A file to read additional certificates from.
.It Fl certpbe Ar alg , Fl keypbe Ar alg
These options allow the algorithm used to encrypt the private key and
certificates to be selected.
Although any PKCS#5 v1.5 or PKCS#12 algorithms can be selected,
it is advisable to only use PKCS#12 algorithms.
See the list in the
.Sx PKCS12 NOTES
section for more information.
.It Fl chain
If this option is present, an attempt is made to include the entire
certificate chain of the user certificate.
The standard CA store is used for this search.
If the search fails, it is considered a fatal error.
.It Fl descert
Encrypt the certificate using triple DES; this may render the PKCS#12
file unreadable by some
.Qq export grade
software.
By default, the private key is encrypted using triple DES and the
certificate using 40-bit RC2.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs12
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl export
This option specifies that a PKCS#12 file will be created rather than
parsed.
.It Fl in Ar file
The
.Ar file
to read certificates and private keys from, standard input by default.
They must all be in PEM format.
The order doesn't matter but one private key and its corresponding
certificate should be present.
If additional certificates are present, they will also be included
in the PKCS#12 file.
.It Fl inkey Ar file
File to read private key from.
If not present, a private key must be present in the input file.
.It Fl keyex | keysig
Specifies that the private key is to be used for key exchange or just signing.
This option is only interpreted by MSIE and similar MS software.
Normally,
.Qq export grade
software will only allow 512-bit RSA keys to be
used for encryption purposes, but arbitrary length keys for signing.
The
.Fl keysig
option marks the key for signing only.
Signing only keys can be used for S/MIME signing, authenticode
.Pq ActiveX control signing
and SSL client authentication;
however, due to a bug only MSIE 5.0 and later support
the use of signing only keys for SSL client authentication.
.It Fl maciter
This option is included for compatibility with previous versions; it used
to be needed to use MAC iterations counts but they are now used by default.
.It Fl name Ar name
This specifies the
.Qq friendly name
for the certificate and private key.
This name is typically displayed in list boxes by software importing the file.
.It Fl nomaciter , noiter
These options affect the iteration counts on the MAC and key algorithms.
Unless you wish to produce files compatible with MSIE 4.0, you should leave
these options alone.
.Pp
To discourage attacks by using large dictionaries of common passwords,
the algorithm that derives keys from passwords can have an iteration count
applied to it: this causes a certain part of the algorithm to be repeated
and slows it down.
The MAC is used to check the file integrity but since it will normally
have the same password as the keys and certificates it could also be attacked.
By default, both MAC and encryption iteration counts are set to 2048;
using these options the MAC and encryption iteration counts can be set to 1.
Since this reduces the file security you should not use these options
unless you really have to.
Most software supports both MAC and key iteration counts.
MSIE 4.0 doesn't support MAC iteration counts, so it needs the
.Fl nomaciter
option.
.It Fl out Ar file
This specifies
.Ar file
to write the PKCS#12 file to.
Standard output is used by default.
.It Fl passin Ar arg
Pass phrase source to decrypt any input private keys with.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The PKCS#12 file
.Pq i.e. output file
password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl rand Ar file ...
A file or files
containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.El
.Sh PKCS12 NOTES
Although there are a large number of options,
most of them are very rarely used.
For PKCS#12 file parsing, only
.Fl in
and
.Fl out
need to be used for PKCS#12 file creation.
.Fl export
and
.Fl name
are also used.
.Pp
If none of the
.Fl clcerts , cacerts ,
or
.Fl nocerts
options are present, then all certificates will be output in the order
they appear in the input PKCS#12 files.
There is no guarantee that the first certificate present is
the one corresponding to the private key.
Certain software which requires a private key and certificate and assumes
the first certificate in the file is the one corresponding to the private key:
this may not always be the case.
Using the
.Fl clcerts
option will solve this problem by only outputting the certificate
corresponding to the private key.
If the CA certificates are required, they can be output to a separate
file using the
.Fl nokeys
and
.Fl cacerts
options to just output CA certificates.
.Pp
The
.Fl keypbe
and
.Fl certpbe
algorithms allow the precise encryption algorithms for private keys
and certificates to be specified.
Normally, the defaults are fine but occasionally software can't handle
triple DES encrypted private keys;
then the option
.Fl keypbe Ar PBE-SHA1-RC2-40
can be used to reduce the private key encryption to 40-bit RC2.
A complete description of all algorithms is contained in the
.Sx PKCS8
section above.
.Sh PKCS12 EXAMPLES
Parse a PKCS#12 file and output it to a file:
.Pp
.Dl $ openssl pkcs12 -in file.p12 -out file.pem
.Pp
Output only client certificates to a file:
.Pp
.Dl $ openssl pkcs12 -in file.p12 -clcerts -out file.pem
.Pp
Don't encrypt the private key:
.Pp
.Dl $ openssl pkcs12 -in file.p12 -out file.pem -nodes
.Pp
Print some info about a PKCS#12 file:
.Pp
.Dl $ openssl pkcs12 -in file.p12 -info -noout
.Pp
Create a PKCS#12 file:
.Bd -literal -offset indent
$ openssl pkcs12 -export -in file.pem -out file.p12 \e
	-name "My Certificate"
.Ed
.Pp
Include some extra certificates:
.Bd -literal -offset indent
$ openssl pkcs12 -export -in file.pem -out file.p12 \e
	-name "My Certificate" -certfile othercerts.pem
.Ed
.Sh PKCS12 BUGS
Some would argue that the PKCS#12 standard is one big bug :\-)
.Pp
Versions of
.Nm OpenSSL
before 0.9.6a had a bug in the PKCS#12 key generation routines.
Under rare circumstances this could produce a PKCS#12 file encrypted
with an invalid key.
As a result some PKCS#12 files which triggered this bug
from other implementations
.Pq MSIE or Netscape
could not be decrypted by
.Nm OpenSSL
and similarly
.Nm OpenSSL
could produce PKCS#12 files which could not be decrypted by other
implementations.
The chances of producing such a file are relatively small: less than 1 in 256.
.Pp
A side effect of fixing this bug is that any old invalidly encrypted PKCS#12
files can no longer be parsed by the fixed version.
Under such circumstances the
.Nm pkcs12
utility will report that the MAC is OK but fail with a decryption
error when extracting private keys.
.Pp
This problem can be resolved by extracting the private keys and certificates
from the PKCS#12 file using an older version of
.Nm OpenSSL
and recreating
the PKCS#12 file from the keys and certificates using a newer version of
.Nm OpenSSL .
For example:
.Bd -literal -offset indent
$ old-openssl -in bad.p12 -out keycerts.pem
$ openssl -in keycerts.pem -export -name "My PKCS#12 file" \e
	-out fixed.p12
.Ed
.\"
.\" RAND
.\"
.Sh RAND
.Cm openssl rand
.Op Fl base64
.Op Fl engine Ar id
.Op Fl out Ar file
.Op Fl rand Ar file ...
.Ar num
.Pp
The
.Nm rand
command outputs
.Ar num
pseudo-random bytes after seeding
the random number generator once.
As in other
.Nm openssl
command line tools, PRNG seeding uses the file
.Pa $HOME/.rnd
or
.Pa .rnd
in addition to the files given in the
.Fl rand
option.
A new
.Pa $HOME/.rnd
or
.Pa .rnd
file will be written back if enough
seeding was obtained from these sources.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl base64
Perform
.Em base64
encoding on the output.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rand
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl out Ar file
Write to
.Ar file
instead of standard output.
.It Fl rand Ar file ...
Use specified file or files, or EGD socket (see
.Xr RAND_egd 3 )
for seeding the random number generator.
Multiple files can be specified separated by a
.Sq \&: .
.El
.\"
.\" REQ
.\"
.Sh REQ
.Nm openssl req
.Bk -words
.Op Fl asn1-kludge
.Op Fl batch
.Op Fl md2 | md4 | md5 | sha1
.Op Fl modulus
.Op Fl new
.Op Fl newhdr
.Op Fl nodes
.Op Fl noout
.Op Fl pubkey
.Op Fl subject
.Op Fl text
.Op Fl utf8
.Op Fl verbose
.Op Fl verify
.Op Fl x509
.Op Fl config Ar file
.Op Fl days Ar n
.Op Fl engine Ar id
.Op Fl extensions Ar section
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl key Ar keyfile
.Op Fl keyform Ar DER | PEM
.Op Fl keyout Ar file
.Op Fl nameopt Ar option
.Oo Xo
.Fl newkey
.Ar dsa : Ns Ar file
.Xc
.Oc
.Oo Xo
.Fl newkey
.Ar rsa : Ns Ar bits
.Xc
.Oc
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Op Fl rand Ar file ...
.Op Fl reqexts Ar section
.Op Fl reqopt Ar option
.Op Fl set_serial Ar n
.Op Fl subj Ar arg
.Ek
.Pp
The
.Nm req
command primarily creates and processes certificate requests
in PKCS#10 format.
It can additionally create self-signed certificates,
for use as root CAs, for example.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl asn1-kludge
By default, the
.Nm req
command outputs certificate requests containing
no attributes in the correct PKCS#10 format.
However certain CAs will only
accept requests containing no attributes in an invalid form: this
option produces this invalid format.
.Pp
More precisely, the
.Em Attributes
in a PKCS#10 certificate request are defined as a SET OF Attribute.
They are
.Em not
optional, so if no attributes are present then they should be encoded as an
empty SET OF.
The invalid form does not include the empty
SET OF, whereas the correct form does.
.Pp
It should be noted that very few CAs still require the use of this option.
.It Fl batch
Non-interactive mode.
.It Fl config Ar file
This allows an alternative configuration file to be specified;
this overrides the compile time filename or any specified in
the
.Ev OPENSSL_CONF
environment variable.
.It Fl days Ar n
When the
.Fl x509
option is being used, this specifies the number of
days to certify the certificate for.
The default is 30 days.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl extensions Ar section , Fl reqexts Ar section
These options specify alternative sections to include certificate
extensions (if the
.Fl x509
option is present) or certificate request extensions.
This allows several different sections to
be used in the same configuration file to specify requests for
a variety of purposes.
.It Fl in Ar file
This specifies the input
.Ar file
to read a request from, or standard input
if this option is not specified.
A request is only read if the creation options
.Fl new
and
.Fl newkey
are not specified.
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument uses an ASN1 DER-encoded form compatible with the PKCS#10.
The
.Ar PEM
form is the default format:
it consists of the DER format base64-encoded with additional header and
footer lines.
.It Fl key Ar keyfile
This specifies the file to read the private key from.
It also accepts PKCS#8 format private keys for PEM format files.
.It Fl keyform Ar DER | PEM
The format of the private key file specified in the
.Fl key
argument.
.Ar PEM
is the default.
.It Fl keyout Ar file
This gives the
.Ar file
to write the newly created private key to.
If this option is not specified, the filename present in the
configuration file is used.
.It Fl md2 | md4 | md5 | sha1
This specifies the message digest to sign the request with.
This overrides the digest algorithm specified in the configuration file.
This option is ignored for DSA requests: they always use SHA1.
.It Fl modulus
This option prints out the value of the modulus of the public key
contained in the request.
.It Fl nameopt Ar option , Fl reqopt Ar option
These options determine how the subject or issuer names are displayed.
The
.Ar option
argument can be a single option or multiple options separated by commas.
Alternatively, these options may be used more than once to set multiple options.
See the
.Sx X509
section below for details.
.It Fl new
This option generates a new certificate request.
It will prompt the user for the relevant field values.
The actual fields prompted for and their maximum and minimum sizes
are specified in the configuration file and any requested extensions.
.Pp
If the
.Fl key
option is not used, it will generate a new RSA private
key using information specified in the configuration file.
.It Fl newhdr
Adds the word NEW to the PEM file header and footer lines
on the outputed request.
Some software
.Pq Netscape certificate server
and some CAs need this.
.It Fl newkey Ar arg
This option creates a new certificate request and a new private key.
The argument takes one of two forms:
.Ar rsa : Ns Ar nbits ,
where
.Ar nbits
is the number of bits, generates an RSA key
.Ar nbits
in size.
.Ar dsa : Ns Ar file
generates a DSA key using the parameters in the file
.Ar file .
.It Fl nodes
If this option is specified and a private key is created, it
will not be encrypted.
.It Fl noout
This option prevents output of the encoded version of the request.
.It Fl out Ar file
This specifies the output
.Ar file
to write to, or standard output by default.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl pubkey
Outputs the public key.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl set_serial Ar n
Serial number to use when outputting a self-signed certificate.
This may be specified as a decimal value or a hex value if preceded by
.Sq 0x .
It is possible to use negative serial numbers but this is not recommended.
.It Fl subj Ar arg
Sets subject name for new request or supersedes the subject name
when processing a request.
The arg must be formatted as
.Em /type0=value0/type1=value1/type2=... ;
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
.It Fl subject
Output the request's subject.
.It Fl text
Prints out the certificate request in text form.
.It Fl utf8
This option causes field values to be interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
.It Fl verbose
Print extra details about the operations being performed.
.It Fl verify
Verifies the signature on the request.
.It Fl x509
This option outputs a self-signed certificate instead of a certificate
request.
This is typically used to generate a test certificate or
a self-signed root CA.
The extensions added to the certificate
.Pq if any
are specified in the configuration file.
Unless specified using the
.Fl set_serial
option, 0 will be used for the serial number.
.El
.Sh REQ CONFIGURATION FILE FORMAT
The configuration options are specified in the
.Em req
section of the configuration file.
As with all configuration files, if no value is specified in the specific
section (i.e.\&
.Em req )
then the initial unnamed or
.Em default
section is searched too.
.Pp
The options available are described in detail below.
.Bl -tag -width "XXXX"
.It Ar attributes
This specifies the section containing any request attributes: its format
is the same as
.Ar distinguished_name .
Typically these may contain the
.Em challengePassword
or
.Em unstructuredName
types.
They are currently ignored by
.Nm OpenSSL Ns Li 's
request signing utilities, but some CAs might want them.
.It Ar default_bits
This specifies the default key size in bits.
If not specified, 512 is used.
It is used if the
.Fl new
option is used.
It can be overridden by using the
.Fl newkey
option.
.It Ar default_keyfile
This is the default file to write a private key to.
If not specified, the key is written to standard output.
This can be overridden by the
.Fl keyout
option.
.It Ar default_md
This option specifies the digest algorithm to use.
Possible values include
.Ar md5
and
.Ar sha1 .
If not present, MD5 is used.
This option can be overridden on the command line.
.It Ar distinguished_name
This specifies the section containing the distinguished name fields to
prompt for when generating a certificate or certificate request.
The format is described in the next section.
.It Ar encrypt_key
If this is set to
.Em no
and a private key is generated, it is
.Em not
encrypted.
This is equivalent to the
.Fl nodes
command line option.
For compatibility,
.Ar encrypt_rsa_key
is an equivalent option.
.It Ar input_password | output_password
The passwords for the input private key file
.Pq if present
and the output private key file
.Pq if one will be created .
The command line options
.Fl passin
and
.Fl passout
override the configuration file values.
.It Ar oid_file
This specifies a file containing additional OBJECT IDENTIFIERS.
Each line of the file should consist of the numerical form of the
object identifier, followed by whitespace, then the short name followed
by whitespace and finally the long name.
.It Ar oid_section
This specifies a section in the configuration file containing extra
object identifiers.
Each line should consist of the short name of the
object identifier followed by
.Sq =
and the numerical form.
The short and long names are the same when this option is used.
.It Ar prompt
If set to the value
.Em no ,
this disables prompting of certificate fields
and just takes values from the config file directly.
It also changes the expected format of the
.Em distinguished_name
and
.Em attributes
sections.
.It Ar RANDFILE
This specifies a file in which random number seed information is
placed and read from, or an EGD socket (see
.Xr RAND_egd 3 ) .
It is used for private key generation.
.It Ar req_extensions
This specifies the configuration file section containing a list of
extensions to add to the certificate request.
It can be overridden by the
.Fl reqexts
command line switch.
.It Ar string_mask
This option masks out the use of certain string types in certain
fields.
Most users will not need to change this option.
.Pp
It can be set to several values:
.Ar default ,
which is also the default option, uses
.Em PrintableStrings , T61Strings
and
.Em BMPStrings ;
if the
.Ar pkix
value is used, then only
.Em PrintableStrings
and
.Em BMPStrings
will be used.
This follows the PKIX recommendation in RFC 2459.
If the
.Fl utf8only
option is used, then only
.Em UTF8Strings
will be used: this is the PKIX recommendation in RFC 2459 after 2003.
Finally, the
.Ar nombstr
option just uses
.Em PrintableStrings
and
.Em T61Strings :
certain software has problems with
.Em BMPStrings
and
.Em UTF8Strings :
in particular Netscape.
.It Ar utf8
If set to the value
.Em yes ,
then field values are interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
.It Ar x509_extensions
This specifies the configuration file section containing a list of
extensions to add to a certificate generated when the
.Fl x509
switch is used.
It can be overridden by the
.Fl extensions
command line switch.
.El
.Sh REQ DISTINGUISHED NAME AND ATTRIBUTE SECTION FORMAT
There are two separate formats for the distinguished name and attribute
sections.
If the
.Fl prompt
option is set to
.Em no ,
then these sections just consist of field names and values: for example,
.Bd -unfilled -offset indent
CN=My Name
OU=My Organization
emailAddress=someone@@somewhere.org
.Ed
.Pp
This allows external programs
.Pq e.g. GUI based
to generate a template file with all the field names and values
and just pass it to
.Nm req .
An example of this kind of configuration file is contained in the
.Sx REQ EXAMPLES
section.
.Pp
Alternatively if the
.Fl prompt
option is absent or not set to
.Em no ,
then the file contains field prompting information.
It consists of lines of the form:
.Bd -unfilled -offset indent
fieldName="prompt"
fieldName_default="default field value"
fieldName_min= 2
fieldName_max= 4
.Ed
.Pp
.Qq fieldName
is the field name being used, for example
.Em commonName
.Pq or CN .
The
.Qq prompt
string is used to ask the user to enter the relevant details.
If the user enters nothing, the default value is used;
if no default value is present, the field is omitted.
A field can still be omitted if a default value is present,
if the user just enters the
.Sq \&.
character.
.Pp
The number of characters entered must be between the
.Em fieldName_min
and
.Em fieldName_max
limits:
there may be additional restrictions based on the field being used
(for example
.Em countryName
can only ever be two characters long and must fit in a
.Em PrintableString ) .
.Pp
Some fields (such as
.Em organizationName )
can be used more than once in a DN.
This presents a problem because configuration files will
not recognize the same name occurring twice.
To avoid this problem, if the
.Em fieldName
contains some characters followed by a full stop, they will be ignored.
So, for example, a second
.Em organizationName
can be input by calling it
.Qq 1.organizationName .
.Pp
The actual permitted field names are any object identifier short or
long names.
These are compiled into
.Nm OpenSSL
and include the usual values such as
.Em commonName , countryName , localityName , organizationName ,
.Em organizationUnitName , stateOrProvinceName .
Additionally,
.Em emailAddress
is included as well as
.Em name , surname , givenName initials
and
.Em dnQualifier .
.Pp
Additional object identifiers can be defined with the
.Ar oid_file
or
.Ar oid_section
options in the configuration file.
Any additional fields will be treated as though they were a
.Em DirectoryString .
.Sh REQ EXAMPLES
Examine and verify a certificate request:
.Pp
.Dl $ openssl req -in req.pem -text -verify -noout
.Pp
Create a private key and then generate a certificate request from it:
.Bd -literal -offset indent
$ openssl genrsa -out key.pem 1024
$ openssl req -new -key key.pem -out req.pem
.Ed
.Pp
The same but just using req:
.Pp
.Dl $ openssl req -newkey rsa:1024 -keyout key.pem -out req.pem
.Pp
Generate a self-signed root certificate:
.Pp
.Dl "$ openssl req -x509 -newkey rsa:1024 -keyout key.pem -out req.pem"
.Pp
Example of a file pointed to by the
.Ar oid_file
option:
.Bd -unfilled -offset indent
1.2.3.4        shortName       A longer Name
1.2.3.6        otherName       Other longer Name
.Ed
.Pp
Example of a section pointed to by
.Ar oid_section
making use of variable expansion:
.Bd -unfilled -offset indent
testoid1=1.2.3.5
testoid2=${testoid1}.6
.Ed
.Pp
Sample configuration file prompting for field values:
.Bd -literal
\& [ req ]
\& default_bits           = 1024
\& default_keyfile        = privkey.pem
\& distinguished_name     = req_distinguished_name
\& attributes             = req_attributes
\& x509_extensions        = v3_ca

\& dirstring_type = nobmp

\& [ req_distinguished_name ]
\& countryName                    = Country Name (2 letter code)
\& countryName_default            = AU
\& countryName_min                = 2
\& countryName_max                = 2

\& localityName                   = Locality Name (eg, city)

\& organizationalUnitName         = Organizational Unit Name (eg, section)

\& commonName                     = Common Name (eg, YOUR name)
\& commonName_max                 = 64

\& emailAddress                   = Email Address
\& emailAddress_max               = 40

\& [ req_attributes ]
\& challengePassword              = A challenge password
\& challengePassword_min          = 4
\& challengePassword_max          = 20

\& [ v3_ca ]

\& subjectKeyIdentifier=hash
\& authorityKeyIdentifier=keyid:always,issuer:always
\& basicConstraints = CA:true
.Ed
.Pp
Sample configuration containing all field values:
.Bd -literal
\& RANDFILE               = $ENV::HOME/.rnd

\& [ req ]
\& default_bits           = 1024
\& default_keyfile        = keyfile.pem
\& distinguished_name     = req_distinguished_name
\& attributes             = req_attributes
\& prompt                 = no
\& output_password        = mypass

\& [ req_distinguished_name ]
\& C                      = GB
\& ST                     = Test State or Province
\& L                      = Test Locality
\& O                      = Organization Name
\& OU                     = Organizational Unit Name
\& CN                     = Common Name
\& emailAddress           = test@@email.address

\& [ req_attributes ]
\& challengePassword              = A challenge password
.Ed
.Sh REQ NOTES
The header and footer lines in the PEM format are normally:
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE REQUEST-----
-----END CERTIFICATE REQUEST-----
.Ed
.Pp
Some software
.Pq some versions of Netscape certificate server
instead needs:
.Bd -unfilled -offset indent
-----BEGIN NEW CERTIFICATE REQUEST-----
-----END NEW CERTIFICATE REQUEST-----
.Ed
.Pp
which is produced with the
.Fl newhdr
option but is otherwise compatible.
Either form is accepted transparently on input.
.Pp
The certificate requests generated by Xenroll with MSIE have extensions added.
It includes the
.Em keyUsage
extension which determines the type of key
.Pq signature only or general purpose
and any additional OIDs entered by the script in an
.Em extendedKeyUsage
extension.
.Sh REQ DIAGNOSTICS
The following messages are frequently asked about:
.Bd -unfilled -offset indent
Using configuration from /some/path/openssl.cnf
Unable to load config info
.Ed
.Pp
This is followed some time later by...
.Bd -unfilled -offset indent
unable to find 'distinguished_name' in config
problems making Certificate Request
.Ed
.Pp
The first error message is the clue: it can't find the configuration
file!
Certain operations
.Pq like examining a certificate request
don't need a configuration file so its use isn't enforced.
Generation of certificates or requests, however, do need a configuration file.
This could be regarded as a bug.
.Pp
Another puzzling message is this:
.Bd -unfilled -offset indent
Attributes:
    a0:00
.Ed
.Pp
This is displayed when no attributes are present and the request includes
the correct empty SET OF structure
.Pq the DER encoding of which is 0xa0 0x00 .
If you just see:
.Pp
.D1 Attributes:
.Pp
then the SET OF is missing and the encoding is technically invalid
.Pq but it is tolerated .
See the description of the command line option
.Fl asn1-kludge
for more information.
.Sh REQ ENVIRONMENT VARIABLES
The variable
.Ev OPENSSL_CONF ,
if defined, allows an alternative configuration
file location to be specified; it will be overridden by the
.Fl config
command line switch if it is present.
For compatibility reasons the
.Ev SSLEAY_CONF
environment variable serves the same purpose but its use is discouraged.
.Sh REQ BUGS
.Nm OpenSSL Ns Li 's
handling of T61Strings
.Pq aka TeletexStrings
is broken: it effectively treats them as ISO-8859-1
.Pq Latin 1 ;
Netscape and MSIE have similar behaviour.
This can cause problems if you need characters that aren't available in
.Em PrintableStrings
and you don't want to or can't use
.Em BMPStrings .
.Pp
As a consequence of the T61String handling, the only correct way to represent
accented characters in
.Nm OpenSSL
is to use a
.Em BMPString :
unfortunately Netscape currently chokes on these.
If you have to use accented characters with Netscape
and MSIE then you currently need to use the invalid T61String form.
.Pp
The current prompting is not very friendly.
It doesn't allow you to confirm what you've just entered.
Other things, like extensions in certificate requests, are
statically defined in the configuration file.
Some of these, like an email address in
.Em subjectAltName ,
should be input by the user.
.\"
.\" RSA
.\"
.Sh RSA
.Cm openssl rsa
.Bk -words
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl check
.Op Fl modulus
.Op Fl noout
.Op Fl pubin
.Op Fl pubout
.Op Fl sgckey
.Op Fl text
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inform Ar DER | NET | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | NET | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Ek
.Pp
The
.Nm rsa
command processes RSA keys.
They can be converted between various forms and their components printed out.
.Pp
.Sy Note :
this command uses the traditional
.Nm SSLeay
compatible format for private key encryption:
newer applications should use the more secure PKCS#8 format using the
.Nm pkcs8
utility.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified the key is written in plain text.
This means that using the
.Nm rsa
utility to read in an encrypted key with no encryption option can be used
to remove the pass phrase from a key, or by setting the encryption options
it can be used to add or change the pass phrase.
These options can only be used with PEM format output files.
.It Fl check
This option checks the consistency of an RSA private key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from, or standard input if this
option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
.It Fl inform Ar DER | NET | PEM
This specifies the input format.
The
.Ar DER
argument
uses an ASN1 DER-encoded form compatible with the PKCS#1
RSAPrivateKey or SubjectPublicKeyInfo format.
The
.Ar PEM
form is the default format: it consists of the DER format base64-encoded with
additional header and footer lines.
On input PKCS#8 format private keys are also accepted.
The
.Ar NET
form is a format described in the
.Sx RSA NOTES
section.
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl modulus
This option prints out the value of the modulus of the key.
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output if this option is not specified.
If any encryption options are set, a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | NET | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl pubin
By default, a private key is read from the input file; with this
option a public key is read instead.
.It Fl pubout
By default, a private key is output;
with this option a public key will be output instead.
This option is automatically set if the input is a public key.
.It Fl sgckey
Use the modified
.Em NET
algorithm used with some versions of Microsoft IIS and SGC keys.
.It Fl text
Prints out the various public or private key components in
plain text, in addition to the encoded version.
.El
.Sh RSA NOTES
The PEM private key format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN RSA PRIVATE KEY-----
-----END RSA PRIVATE KEY-----
.Ed
.Pp
The PEM public key format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN PUBLIC KEY-----
-----END PUBLIC KEY-----
.Ed
.Pp
The
.Em NET
form is a format compatible with older Netscape servers
and Microsoft IIS .key files; this uses unsalted RC4 for its encryption.
It is not very secure and so should only be used when necessary.
.Pp
Some newer version of IIS have additional data in the exported .key files.
To use these with the
.Nm rsa
utility, view the file with a binary editor
and look for the string
.Qq private-key ,
then trace back to the byte sequence 0x30, 0x82
.Pq this is an ASN1 SEQUENCE .
Copy all the data from this point onwards to another file and use that as
the input to the
.Nm rsa
utility with the
.Fl inform Ar NET
option.
If there is an error after entering the password, try the
.Fl sgckey
option.
.Sh RSA EXAMPLES
To remove the pass phrase on an RSA private key:
.Pp
.Dl $ openssl rsa -in key.pem -out keyout.pem
.Pp
To encrypt a private key using triple DES:
.Pp
.Dl $ openssl rsa -in key.pem -des3 -out keyout.pem
.Pp
To convert a private key from PEM to DER format:
.Pp
.Dl $ openssl rsa -in key.pem -outform DER -out keyout.der
.Pp
To print out the components of a private key to standard output:
.Pp
.Dl $ openssl rsa -in key.pem -text -noout
.Pp
To just output the public part of a private key:
.Pp
.Dl $ openssl rsa -in key.pem -pubout -out pubkey.pem
.Sh RSA BUGS
The command line password arguments don't currently work with
.Em NET
format.
.Pp
There should be an option that automatically handles .key files,
without having to manually edit them.
.\"
.\" RSAUTL
.\"
.Sh RSAUTL
.Nm openssl rsautl
.Bk -words
.Op Fl asn1parse
.Op Fl certin
.Op Fl decrypt
.Op Fl encrypt
.Op Fl hexdump
.Op Fl oaep | pkcs | raw | ssl
.Op Fl pubin
.Op Fl sign
.Op Fl verify
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inkey Ar file
.Op Fl keyform Ar DER | PEM
.Op Fl out Ar file
.Ek
.Pp
The
.Nm rsautl
command can be used to sign, verify, encrypt and decrypt
data using the RSA algorithm.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl asn1parse
Asn1parse the output data; this is useful when combined with the
.Fl verify
option.
.It Fl certin
The input is a certificate containing an RSA public key.
.It Fl decrypt
Decrypt the input data using an RSA private key.
.It Fl encrypt
Encrypt the input data using an RSA public key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsautl
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl hexdump
Hex dump the output data.
.It Fl in Ar file
This specifies the input
.Ar file
to read data from, or standard input
if this option is not specified.
.It Fl inkey Ar file
The input key file, by default it should be an RSA private key.
.It Fl keyform Ar DER | PEM
Private ket format.
Default is
.Ar PEM .
.It Fl oaep | pkcs | raw | ssl
The padding to use:
PKCS#1 OAEP, PKCS#1 v1.5
.Pq the default ,
no padding,
or special padding used in SSL v2 backwards compatible handshakes, respectively.
For signatures, only
.Fl pkcs
and
.Fl raw
can be used.
.It Fl out Ar file
Specifies the output
.Ar file
to write to, or standard output by
default.
.It Fl pubin
The input file is an RSA public key.
.It Fl sign
Sign the input data and output the signed result.
This requires an RSA private key.
.It Fl verify
Verify the input data and output the recovered data.
.El
.Sh RSAUTL NOTES
.Nm rsautl ,
because it uses the RSA algorithm directly, can only be
used to sign or verify small pieces of data.
.Sh RSAUTL EXAMPLES
Sign some data using a private key:
.Pp
.Dl "$ openssl rsautl -sign -in file -inkey key.pem -out sig"
.Pp
Recover the signed data:
.Pp
.Dl $ openssl rsautl -verify -in sig -inkey key.pem
.Pp
Examine the raw signed data:
.Pp
.Li "\ \&$ openssl rsautl -verify -in file -inkey key.pem -raw -hexdump"
.Bd -unfilled
\& 0000 - 00 01 ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0010 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0020 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0030 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0040 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0050 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0060 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................
\& 0070 - ff ff ff ff 00 68 65 6c-6c 6f 20 77 6f 72 6c 64   .....hello world
.Ed
.Pp
The PKCS#1 block formatting is evident from this.
If this was done using encrypt and decrypt, the block would have been of type 2
.Pq the second byte
and random padding data visible instead of the 0xff bytes.
.Pp
It is possible to analyse the signature of certificates using this
utility in conjunction with
.Nm asn1parse .
Consider the self-signed example in
.Pa certs/pca-cert.pem :
running
.Nm asn1parse
as follows yields:
.Pp
.Li "\ \&$ openssl asn1parse -in pca-cert.pem"
.Bd -unfilled
\&    0:d=0  hl=4 l= 742 cons: SEQUENCE
\&    4:d=1  hl=4 l= 591 cons:  SEQUENCE
\&    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
\&   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
\&   13:d=2  hl=2 l=   1 prim:   INTEGER           :00
\&   16:d=2  hl=2 l=  13 cons:   SEQUENCE
\&   18:d=3  hl=2 l=   9 prim:    OBJECT            :md5WithRSAEncryption
\&   29:d=3  hl=2 l=   0 prim:    NULL
\&   31:d=2  hl=2 l=  92 cons:   SEQUENCE
\&   33:d=3  hl=2 l=  11 cons:    SET
\&   35:d=4  hl=2 l=   9 cons:     SEQUENCE
\&   37:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
\&   42:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :AU
\&  ....
\&  599:d=1  hl=2 l=  13 cons:  SEQUENCE
\&  601:d=2  hl=2 l=   9 prim:   OBJECT            :md5WithRSAEncryption
\&  612:d=2  hl=2 l=   0 prim:   NULL
\&  614:d=1  hl=3 l= 129 prim:  BIT STRING
.Ed
.Pp
The final BIT STRING contains the actual signature.
It can be extracted with:
.Pp
.Dl "$ openssl asn1parse -in pca-cert.pem -out sig -noout -strparse 614"
.Pp
The certificate public key can be extracted with:
.Pp
.Dl $ openssl x509 -in test/testx509.pem -pubkey -noout \*(Gtpubkey.pem
.Pp
The signature can be analysed with:
.Pp
.Li "\ \&$ openssl rsautl -in sig -verify -asn1parse -inkey pubkey.pem -pubin"
.Bd -unfilled
\&    0:d=0  hl=2 l=  32 cons: SEQUENCE
\&    2:d=1  hl=2 l=  12 cons:  SEQUENCE
\&    4:d=2  hl=2 l=   8 prim:   OBJECT            :md5
\&   14:d=2  hl=2 l=   0 prim:   NULL
\&   16:d=1  hl=2 l=  16 prim:  OCTET STRING
\&   0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5  .F...Js.7...H%..
.Ed
.Pp
This is the parsed version of an ASN1
.Em DigestInfo
structure.
It can be seen that the digest used was MD5.
The actual part of the certificate that was signed can be extracted with:
.Pp
.Dl "$ openssl asn1parse -in pca-cert.pem -out tbs -noout -strparse 4"
.Pp
and its digest computed with:
.Pp
.Dl $ openssl md5 -c tbs
.D1 MD5(tbs)= f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5
.Pp
which it can be seen agrees with the recovered value above.
.\"
.\" S_CLIENT
.\"
.Sh S_CLIENT
.Nm openssl s_client
.Bk -words
.Op Fl 4 | 6
.Op Fl bugs
.Op Fl crlf
.Op Fl debug
.Op Fl ign_eof
.Op Fl msg
.Op Fl nbio
.Op Fl nbio_test
.Op Fl no_ssl2
.Op Fl no_ssl3
.Op Fl no_tls1
.Op Fl pause
.Op Fl prexit
.Op Fl quiet
.Op Fl reconnect
.Op Fl serverpref
.Op Fl showcerts
.Op Fl ssl2
.Op Fl ssl3
.Op Fl state
.Op Fl tls1
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Op Fl cipher Ar cipherlist
.Oo
.Fl connect Ar host : Ns Ar port |
.Ar host Ns / Ns Ar port
.Oc
.Op Fl engine Ar id
.Op Fl key Ar keyfile
.Op Fl rand Ar file ...
.Op Fl starttls Ar protocol
.Op Fl verify Ar depth
.Ek
.Pp
The
.Nm s_client
command implements a generic SSL/TLS client which connects
to a remote host using SSL/TLS.
It is a
.Em very
useful diagnostic tool for SSL servers.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl 4
Specify that
.Nm s_client
should attempt connections using IPv4 only.
.It Fl 6
Specify that
.Nm s_client
should attempt connections using IPv6 only.
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A
.Ar file
containing trusted certificates to use during server authentication
and to use when attempting to build the client certificate chain.
.It Fl CApath Ar directory
The
.Ar directory
to use for server certificate verification.
This directory must be in
.Qq hash format ;
see
.Fl verify
for more information.
These are also used when building the client certificate chain.
.It Fl cert Ar file
The certificate to use, if one is requested by the server.
The default is not to use a certificate.
.It Fl cipher Ar cipherlist
This allows the cipher list sent by the client to be modified.
Although the server determines which cipher suite is used, it should take
the first supported cipher in the list sent by the client.
See the
.Sx CIPHERS
section above for more information.
.It Xo
.Fl connect Ar host : Ns Ar port |
.Ar host Ns / Ns Ar port
.Xc
This specifies the
.Ar host
and optional
.Ar port
to connect to.
If not specified, an attempt is made to connect to the local host
on port 4433.
Alternatively, the host and port pair may be separated using a forward-slash
character.
This form is useful for numeric IPv6 addresses.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF as required
by some servers.
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_client
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl ign_eof
Inhibit shutting down the connection when end of file is reached in the
input.
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl nbio_test
Tests non-blocking I/O.
.It Xo
.Fl no_ssl2 | no_ssl3 | no_tls1 |
.Fl ssl2 | ssl3 | tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2, or TLS as appropriate.
.Pp
Unfortunately there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.
Some servers only work if TLS is turned off with the
.Fl no_tls
option, others will only support SSL v2 and may need the
.Fl ssl2
option.
.It Fl pause
Pauses 1 second between each read and write call.
.It Fl prexit
Print session information when the program exits.
This will always attempt
to print out information even if the connection fails.
Normally, information will only be printed out once if the connection succeeds.
This option is useful because the cipher in use may be renegotiated
or the connection may fail because a client certificate is required or is
requested only after an attempt is made to access a certain URL.
.Sy Note :
the output produced by this option is not always accurate because a
connection might never have been established.
.It Fl quiet
Inhibit printing of session and certificate information.
This implicitly turns on
.Fl ign_eof
as well.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl reconnect
Reconnects to the same server 5 times using the same session ID; this can
be used as a test that session caching is working.
.It Fl serverpref
Use server's cipher preferences
.Pq SSLv2 only .
.It Fl showcerts
Display the whole server certificate chain: normally only the server
certificate itself is displayed.
.It Fl starttls Ar protocol
Send the protocol-specific message(s) to switch to TLS for communication.
.Ar protocol
is a keyword for the intended protocol.
Currently, the only supported keywords are
.Qq esmtp ,
.Qq smtp
and
.Qq pop3 .
The
.Qq esmtp
sends an EHLO before attempting to start TLS.
.It Fl state
Prints out the SSL session states.
.It Fl verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the
server certificate chain and turns on server certificate verification.
Currently the verify operation continues after errors so all the problems
with a certificate chain can be seen.
As a side effect the connection will never fail due to a server
certificate verify failure.
.El
.Sh S_CLIENT CONNECTED COMMANDS
If a connection is established with an SSL server, any data received
from the server is displayed and any key presses will be sent to the
server.
When used interactively (which means neither
.Fl quiet
nor
.Fl ign_eof
have been given), the session will be renegotiated if the line begins with an
.Em R ;
if the line begins with a
.Em Q
or if end of file is reached, the connection will be closed down.
.Sh S_CLIENT NOTES
.Nm s_client
can be used to debug SSL servers.
To connect to an SSL HTTP server the command:
.Pp
.Dl $ openssl s_client -connect servername:443
.Pp
would typically be used
.Pq HTTPS uses port 443 .
If the connection succeeds, an HTTP command can be given such as
.Qq GET
to retrieve a web page.
.Pp
If the handshake fails, there are several possible causes; if it is
nothing obvious like no client certificate, then the
.Fl bugs , ssl2 , ssl3 , tls1 ,
.Fl no_ssl2 , no_ssl3 ,
and
.Fl no_tls1
options can be tried in case it is a buggy server.
In particular these options should be tried
.Em before
submitting a bug report to an
.Nm OpenSSL
mailing list.
.Pp
A frequent problem when attempting to get client certificates working
is that a web client complains it has no certificates or gives an empty
list to choose from.
This is normally because the server is not sending the client's certificate
authority in its
.Qq acceptable CA list
when it requests a certificate.
By using
.Nm s_client
the CA list can be viewed and checked.
However some servers only request client authentication
after a specific URL is requested.
To obtain the list in this case it is necessary to use the
.Fl prexit
option and send an HTTP request for an appropriate page.
.Pp
If a certificate is specified on the command line using the
.Fl cert
option, it will not be used unless the server specifically requests
a client certificate.
Therefore merely including a client certificate
on the command line is no guarantee that the certificate works.
.Pp
If there are problems verifying a server certificate, the
.Fl showcerts
option can be used to show the whole chain.
.Sh S_CLIENT BUGS
Because this program has a lot of options and also because some of
the techniques used are rather old, the C source of
.Nm s_client
is rather hard to read and not a model of how things should be done.
A typical SSL client program would be much simpler.
.Pp
The
.Fl verify
option should really exit if the server verification fails.
.Pp
The
.Fl prexit
option is a bit of a hack.
We should really report information whenever a session is renegotiated.
.\"
.\" S_SERVER
.\"
.Sh S_SERVER
.Nm openssl s_server
.Bk -words
.Op Fl bugs
.Op Fl crlf
.Op Fl debug
.Op Fl hack
.Op Fl HTTP
.Op Fl msg
.Op Fl nbio
.Op Fl nbio_test
.Op Fl no_dhe
.Op Fl no_ssl2
.Op Fl no_ssl3
.Op Fl no_tls1
.Op Fl no_tmp_rsa
.Op Fl nocert
.Op Fl quiet
.Op Fl serverpref
.Op Fl ssl2
.Op Fl ssl3
.Op Fl state
.Op Fl tls1
.Op Fl WWW
.Op Fl www
.Op Fl accept Ar port
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Op Fl cipher Ar cipherlist
.Op Fl context Ar id
.Op Fl dcert Ar file
.Op Fl dhparam Ar file
.Op Fl dkey Ar file
.Op Fl engine Ar id
.Op Fl id_prefix Ar arg
.Op Fl key Ar keyfile
.Op Fl rand Ar file ...
.Op Fl Verify Ar depth
.Op Fl verify Ar depth
.Ek
.Pp
The
.Nm s_server
command implements a generic SSL/TLS server which listens
for connections on a given port using SSL/TLS.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl accept Ar port
The TCP
.Ar port
to listen on for connections.
If not specified, 4433 is used.
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A file containing trusted certificates to use during client authentication
and to use when attempting to build the server certificate chain.
The list is also used in the list of acceptable client CAs passed to the
client when a certificate is requested.
.It Fl CApath Ar directory
The
.Ar directory
to use for client certificate verification.
This directory must be in
.Qq hash format ;
see
.Fl verify
for more information.
These are also used when building the server certificate chain.
.It Fl cert Ar file
The certificate to use; most server's cipher suites require the use of a
certificate and some require a certificate with a certain public key type:
for example the DSS cipher suites require a certificate containing a DSS
.Pq DSA
key.
If not specified, the file
.Pa server.pem
will be used.
.It Fl cipher Ar cipherlist
This allows the cipher list used by the server to be modified.
When the client sends a list of supported ciphers, the first client cipher
also included in the server list is used.
Because the client specifies the preference order, the order of the server
cipherlist is irrelevant.
See the
.Sx CIPHERS
section for more information.
.It Fl context Ar id
Sets the SSL context ID.
It can be given any string value.
If this option is not present, a default value will be used.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF.
.It Fl dcert Ar file , Fl dkey Ar file
Specify an additional certificate and private key; these behave in the
same manner as the
.Fl cert
and
.Fl key
options except there is no default if they are not specified
.Pq no additional certificate or key is used .
As noted above some cipher suites require a certificate containing a key of
a certain type.
Some cipher suites need a certificate carrying an RSA key
and some a DSS
.Pq DSA
key.
By using RSA and DSS certificates and keys,
a server can support clients which only support RSA or DSS cipher suites
by using an appropriate certificate.
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
.It Fl dhparam Ar file
The DH parameter file to use.
The ephemeral DH cipher suites generate keys
using a set of DH parameters.
If not specified, an attempt is made to
load the parameters from the server certificate file.
If this fails, a static set of parameters hard coded into the
.Nm s_server
program will be used.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_server
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl hack
This option enables a further workaround for some early Netscape
SSL code
.Pq \&? .
.It Fl HTTP
Emulates a simple web server.
Pages will be resolved relative to the current directory;
for example if the URL
.Pa https://myhost/page.html
is requested, the file
.Pa ./page.html
will be loaded.
The files loaded are assumed to contain a complete and correct HTTP
response (lines that are part of the HTTP response line and headers
must end with CRLF).
.It Fl id_prefix Ar arg
Generate SSL/TLS session IDs prefixed by
.Ar arg .
This is mostly useful for testing any SSL/TLS code
.Pq e.g. proxies
that wish to deal with multiple servers, when each of which might be
generating a unique range of session IDs
.Pq e.g. with a certain prefix .
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl nbio_test
Tests non-blocking I/O.
.It Fl no_dhe
If this option is set, no DH parameters will be loaded, effectively
disabling the ephemeral DH cipher suites.
.It Xo
.Fl no_ssl2 | no_ssl3 | no_tls1 |
.Fl ssl2 | ssl3 | tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2, or TLS as appropriate.
.It Fl no_tmp_rsa
Certain export cipher suites sometimes use a temporary RSA key; this option
disables temporary RSA key generation.
.It Fl nocert
If this option is set, no certificate is used.
This restricts the cipher suites available to the anonymous ones
.Pq currently just anonymous DH .
.It Fl quiet
Inhibit printing of session and certificate information.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl serverpref
Use server's cipher preferences.
.It Fl state
Prints out the SSL session states.
.It Fl WWW
Emulates a simple web server.
Pages will be resolved relative to the current directory;
for example if the URL
.Pa https://myhost/page.html
is requested, the file
.Pa ./page.html
will be loaded.
.It Fl www
Sends a status message back to the client when it connects.
This includes lots of information about the ciphers used and various
session parameters.
The output is in HTML format so this option will normally be used with a
web browser.
.It Fl Verify Ar depth , Fl verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the client certificate chain
and makes the server request a certificate from the client.
With the
.Fl Verify
option, the client must supply a certificate or an error occurs.
With the
.Fl verify
option, a certificate is requested but the client does not have to send one.
.El
.Sh S_SERVER CONNECTED COMMANDS
If a connection request is established with an SSL client and neither the
.Fl www
nor the
.Fl WWW
option has been used, then normally any data received
from the client is displayed and any key presses will be sent to the client.
.Pp
Certain single letter commands are also recognized which perform special
operations: these are listed below.
.Bl -tag -width "XXXX"
.It Ar P
Send some plain text down the underlying TCP connection: this should
cause the client to disconnect due to a protocol violation.
.It Ar Q
End the current SSL connection and exit.
.It Ar q
End the current SSL connection, but still accept new connections.
.It Ar R
Renegotiate the SSL session and request a client certificate.
.It Ar r
Renegotiate the SSL session.
.It Ar S
Print out some session cache status information.
.El
.Sh S_SERVER NOTES
.Nm s_server
can be used to debug SSL clients.
To accept connections from a web browser the command:
.Pp
.Dl $ openssl s_server -accept 443 -www
.Pp
can be used, for example.
.Pp
Most web browsers
.Pq in particular Netscape and MSIE
only support RSA cipher suites, so they cannot connect to servers
which don't use a certificate carrying an RSA key or a version of
.Nm OpenSSL
with RSA disabled.
.Pp
Although specifying an empty list of CAs when requesting a client certificate
is strictly speaking a protocol violation, some SSL
clients interpret this to mean any CA is acceptable.
This is useful for debugging purposes.
.Pp
The session parameters can printed out using the
.Nm sess_id
program.
.Sh S_SERVER BUGS
Because this program has a lot of options and also because some of
the techniques used are rather old, the C source of
.Nm s_server
is rather hard to read and not a model of how things should be done.
A typical SSL server program would be much simpler.
.Pp
The output of common ciphers is wrong: it just gives the list of ciphers that
.Nm OpenSSL
recognizes and the client supports.
.Pp
There should be a way for the
.Nm s_server
program to print out details of any
unknown cipher suites a client says it supports.
.\"
.\" S_TIME
.\"
.Sh S_TIME
.Nm openssl s_time
.Bk -words
.Op Fl bugs
.Op Fl nbio
.Op Fl new
.Op Fl reuse
.Op Fl ssl2
.Op Fl ssl3
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Op Fl cipher Ar cipherlist
.Op Fl connect Ar host : Ns Ar port
.Op Fl key Ar keyfile
.Op Fl time Ar seconds
.Op Fl verify Ar depth
.Op Fl www Ar page
.Ek
.Pp
The
.Nm s_client
command implements a generic SSL/TLS client which connects to a
remote host using SSL/TLS.
It can request a page from the server and includes
the time to transfer the payload data in its timing measurements.
It measures the number of connections within a given timeframe,
the amount of data transferred
.Pq if any ,
and calculates the average time spent for one connection.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A file containing trusted certificates to use during server authentication
and to use when attempting to build the client certificate chain.
.It Fl CApath Ar directory
The directory to use for server certificate verification.
This directory must be in
.Qq hash format ;
see
.Nm verify
for more information.
These are also used when building the client certificate chain.
.It Fl cert Ar file
The certificate to use, if one is requested by the server.
The default is not to use a certificate.
The file is in PEM format.
.It Fl cipher Ar cipherlist
This allows the cipher list sent by the client to be modified.
Although the server determines which cipher suite is used,
it should take the first supported cipher in the list sent by the client.
See the
.Nm ciphers
command for more information.
.It Fl connect Ar host : Ns Ar port
This specifies the host and optional port to connect to.
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
The file is in PEM format.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl new
Performs the timing test using a new session ID for each connection.
If neither
.Fl new
nor
.Fl reuse
are specified,
they are both on by default and executed in sequence.
.It Fl reuse
Performs the timing test using the same session ID;
this can be used as a test that session caching is working.
If neither
.Fl new
nor
.Fl reuse
are specified,
they are both on by default and executed in sequence.
.It Fl ssl2 | ssl3
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method
which should be compatible with all servers and permit them to use
SSL v3, SSL v2, or TLS as appropriate.
The timing program is not as rich in options to turn protocols on and off as
the
.Nm s_client
program and may not connect to all servers.
.Pp
Unfortunately there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.
Some servers only work if TLS is turned off with the
.Fl ssl3
option;
others will only support SSL v2 and may need the
.Fl ssl2
option.
.It Fl time Ar seconds
Specifies how long
.Pq in seconds
.Nm s_time
should establish connections and
optionally transfer payload data from a server.
The default is 30 seconds.
Server and client performance and the link speed
determine how many connections
.Nm s_time
can establish.
.It Fl verify Ar depth
The verify depth to use.
This specifies the maximum length of the server certificate chain
and turns on server certificate verification.
Currently the verify operation continues after errors, so all the problems
with a certificate chain can be seen.
As a side effect,
the connection will never fail due to a server certificate verify failure.
.It Fl www Ar page
This specifies the page to GET from the server.
A value of
.Sq /
gets the index.htm[l] page.
If this parameter is not specified,
.Nm s_time
will only perform the handshake to establish SSL connections
but not transfer any payload data.
.El
.Sh S_TIME NOTES
.Nm s_client
can be used to measure the performance of an SSL connection.
To connect to an SSL HTTP server and get the default page the command
.Bd -literal -offset indent
$ openssl s_time -connect servername:443 -www / -CApath yourdir \e
	-CAfile yourfile.pem -cipher commoncipher [-ssl3]
.Ed
.Pp
would typically be used
.Pq HTTPS uses port 443 .
.Dq commoncipher
is a cipher to which both client and server can agree;
see the
.Nm ciphers
command for details.
.Pp
If the handshake fails, there are several possible causes:
if it is nothing obvious like no client certificate, the
.Fl bugs , ssl2 ,
and
.Fl ssl3
options can be tried in case it is a buggy server.
In particular you should play with these options
.Em before
submitting a bug report to an OpenSSL mailing list.
.Pp
A frequent problem when attempting to get client certificates working
is that a web client complains it has no certificates or gives an empty
list to choose from.
This is normally because the server is not sending
the clients certificate authority in its
.Qq acceptable CA list
when it requests a certificate.
By using
.Nm s_client ,
the CA list can be viewed and checked.
However some servers only request client authentication
after a specific URL is requested.
To obtain the list in this case, it is necessary to use the
.Fl prexit
option of
.Nm s_client
and send an HTTP request for an appropriate page.
.Pp
If a certificate is specified on the command line using the
.Fl cert
option,
it will not be used unless the server specifically requests
a client certificate.
Therefore merely including a client certificate
on the command line is no guarantee that the certificate works.
.Sh S_TIME BUGS
Because this program does not have all the options of the
.Nm s_client
program to turn protocols on and off,
you may not be able to measure the performance
of all protocols with all servers.
.Pp
The
.Fl verify
option should really exit if the server verification fails.
.\"
.\" SESS_ID
.\"
.Sh SESS_ID
.Nm openssl sess_id
.Bk -words
.Op Fl cert
.Op Fl noout
.Op Fl text
.Op Fl context Ar ID
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Ek
.Pp
The
.Nm sess_id
program processes the encoded version of the SSL session structure and
optionally prints out SSL session details
.Pq for example the SSL session master key
in human readable format.
Since this is a diagnostic tool that needs some knowledge of the SSL
protocol to use properly, most users will not need to use it.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl cert
If a certificate is present in the session,
it will be output using this option;
if the
.Fl text
option is also present, then it will be printed out in text form.
.It Fl context Ar ID
This option can set the session ID so the output session information uses the
supplied
.Ar ID .
The
.Ar ID
can be any string of characters.
This option won't normally be used.
.It Fl in Ar file
This specifies the input
.Ar file
to read session information from, or standard input by default.
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument uses an ASN1 DER-encoded
format containing session details.
The precise format can vary from one version to the next.
The
.Ar PEM
form is the default format: it consists of the DER
format base64-encoded with additional header and footer lines.
.It Fl noout
This option prevents output of the encoded version of the session.
.It Fl out Ar file
This specifies the output
.Ar file
to write session information to, or standard
output if this option is not specified.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl text
Prints out the various public or private key components in
plain text in addition to the encoded version.
.El
.Sh SESS_ID OUTPUT
Typical output:
.Bd -literal
SSL-Session:
    Protocol  : TLSv1
    Cipher    : 0016
    Session-ID: 871E62626C554CE95488823752CBD5F3673A3EF3DCE9C67BD916C809914B40ED
    Session-ID-ctx: 01000000
    Master-Key: A7CEFC571974BE02CAC305269DC59F76EA9F0B180CB6642697A68251F2D2BB57E51DBBB4C7885573192AE9AEE220FACD
    Key-Arg   : None
    Start Time: 948459261
    Timeout   : 300 (sec)
    Verify return code 0 (ok)
.Ed
.Pp
These are described below in more detail.
.Pp
.Bl -tag -width "Verify return code " -compact
.It Ar Protocol
This is the protocol in use: TLSv1, SSLv3, or SSLv2.
.It Ar Cipher
The cipher used is the actual raw SSL or TLS cipher code;
see the SSL or TLS specifications for more information.
.It Ar Session-ID
The SSL session ID in hex format.
.It Ar Session-ID-ctx
The session ID context in hex format.
.It Ar Master-Key
This is the SSL session master key.
.It Ar Key-Arg
The key argument; this is only used in SSL v2.
.It Ar Start Time
This is the session start time, represented as an integer in standard
.Ux
format.
.It Ar Timeout
The timeout in seconds.
.It Ar Verify return code
This is the return code when an SSL client certificate is verified.
.El
.Sh SESS_ID NOTES
The PEM-encoded session format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN SSL SESSION PARAMETERS-----
-----END SSL SESSION PARAMETERS-----
.Ed
.Pp
Since the SSL session output contains the master key, it is possible to read
the contents of an encrypted session using this information.
Therefore appropriate security precautions
should be taken if the information is being output by a
.Qq real
application.
This is, however, strongly discouraged and should only be used for
debugging purposes.
.Sh SESS_ID BUGS
The cipher and start time should be printed out in human readable form.
.\"
.\" SMIME
.\"
.Sh SMIME
.Nm openssl smime
.Bk -words
.Op Fl encrypt
.Op Fl decrypt
.Op Fl sign
.Op Fl verify
.Op Fl pk7out
.Oo Xo
.Fl des | des3 | rc2-40 | rc2-64 |
.Fl rc2-128 | aes128 | aes192 | aes256
.Xc
.Oc
.Op Fl nointern
.Op Fl noverify
.Op Fl nochain
.Op Fl nosigs
.Op Fl nocerts
.Op Fl noattr
.Op Fl binary
.Op Fl nodetach
.Op Fl in Ar file
.Op Fl certfile Ar file
.Op Fl signer Ar file
.Op Fl recip Ar file
.Op Fl inform Ar SMIME | DER | PEM
.Op Fl passin Ar arg
.Op Fl inkey Ar file
.Op Fl keyform Ar PEM | ENGINE
.Op Fl out Ar file
.Op Fl outform Ar SMIME | DER | PEM
.Op Fl content Ar file
.Op Fl to Ar addr
.Op Fl from Ar addr
.Op Fl subject Ar s
.Op Fl text
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl crl_check
.Op Fl crl_check_all
.Op Fl engine Ar id
.Op Fl rand Ar file ...
.Op Ar cert.pem ...
.Ek
.Pp
The
.Nm smime
command handles
.Em S/MIME
mail.
It can encrypt, decrypt, sign and verify
.Em S/MIME
messages.
.Pp
There are five operation options that set the type of operation to be performed.
The meaning of the other options varies according to the operation type.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl encrypt
Encrypt mail for the given recipient certificates.
Input file is the message to be encrypted.
The output file is the encrypted mail in
.Em MIME
format.
.It Fl decrypt
Decrypt mail using the supplied certificate and private key.
Expects an encrypted mail message in
.Em MIME
format for the input file.
The decrypted mail is written to the output file.
.It Fl sign
Sign mail using the supplied certificate and private key.
Input file is the message to be signed.
The signed message in
.Em MIME
format is written to the output file.
.It Fl verify
Verify signed mail.
Expects a signed mail message on input and outputs the signed data.
Both clear text and opaque signing is supported.
.It Fl pk7out
Takes an input message and writes out a PEM-encoded PKCS#7 structure.
.It Fl in Ar file
The input message to be encrypted or signed or the
.Em MIME
message to
be decrypted or verified.
.It Fl inform Ar SMIME | DER | PEM
This specifies the input format for the PKCS#7 structure.
The default is
.Em SMIME
which reads an
.Em S/MIME
format message.
.Ar PEM
and
.Ar DER
format change this to expect PEM and DER format PKCS#7 structures
instead.
This currently only affects the input format of the PKCS#7
structure; if no PKCS#7 structure is being input (for example with
.Fl encrypt
or
.Fl sign ) ,
this option has no effect.
.It Fl out Ar file
The message text that has been decrypted or verified, or the output
.Em MIME
format message that has been signed or verified.
.It Fl outform Ar SMIME | DER | PEM
This specifies the output format for the PKCS#7 structure.
The default is
.Em SMIME
which writes an
.Em S/MIME
format message.
.Ar PEM
and
.Ar DER
format change this to write PEM and DER format PKCS#7 structures
instead.
This currently only affects the output format of the PKCS#7
structure; if no PKCS#7 structure is being output (for example with
.Fl verify
or
.Fl decrypt )
this option has no effect.
.It Fl content Ar file
This specifies a file containing the detached content.
This is only useful with the
.Fl verify
command.
This is only usable if the PKCS#7 structure is using the detached
signature form where the content is not included.
This option will override any content if the input format is
.Em S/MIME
and it uses the multipart/signed
.Em MIME
content type.
.It Fl text
This option adds plain text
.Pq text/plain
.Em MIME
headers to the supplied message if encrypting or signing.
If decrypting or verifying it strips off text headers:
if the decrypted or verified message is not of
.Em MIME
type text/plain then an error occurs.
.It Fl CAfile Ar file
A
.Ar file
containing trusted CA certificates; only used with
.Fl verify .
.It Fl CApath Ar directory
A
.Ar directory
containing trusted CA certificates; only used with
.Fl verify .
This directory must be a standard certificate directory;
that is, a hash of each subject name (using
.Nm x509 -hash )
should be linked to each certificate.
.It Xo
.Fl des | des3 | rc2-40 | rc2-64 |
.Fl rc2-128 | aes128 | aes192 | aes256
.Xc
The encryption algorithm to use.
DES
.Pq 56 bits ,
triple DES
.Pq 168 bits ,
40-, 64-, or 128-bit RC2, or 128-, 192-, or 256-bit AES, respectively;
if not specified, 40-bit RC2 is
used.
Only used with
.Fl encrypt .
.It Fl nointern
When verifying a message, normally certificates
.Pq if any
included in the message are searched for the signing certificate.
With this option, only the certificates specified in the
.Fl certfile
option are used.
The supplied certificates can still be used as untrusted CAs however.
.It Fl noverify
Do not verify the signer's certificate of a signed message.
.It Fl nochain
Do not do chain verification of signers' certificates: that is,
don't use the certificates in the signed message as untrusted CAs.
.It Fl nosigs
Don't try to verify the signatures on the message.
.It Fl nocerts
When signing a message, the signer's certificate is normally included;
with this option it is excluded.
This will reduce the size of the signed message but the verifier must
have a copy of the signer's certificate available locally (passed using the
.Fl certfile
option, for example).
.It Fl noattr
Normally, when a message is signed a set of attributes are included which
include the signing time and supported symmetric algorithms.
With this option they are not included.
.It Fl binary
Normally, the input message is converted to
.Qq canonical
format which is effectively using CR and LF as end of line: as required by the
.Em S/MIME
specification.
When this option is present no translation occurs.
This is useful when handling binary data which may not be in
.Em MIME
format.
.It Fl nodetach
When signing a message use opaque signing: this form is more resistant
to translation by mail relays but it cannot be read by mail agents that
do not support
.Em S/MIME .
Without this option cleartext signing with the
.Em MIME
type multipart/signed is used.
.It Fl certfile Ar file
Allows additional certificates to be specified.
When signing these will be included with the message.
When verifying these will be searched for the signers' certificates.
The certificates should be in PEM format.
.It Fl signer Ar file
The signer's certificate when signing a message.
If a message is being verified, the signer's certificates will be
written to this file if the verification was successful.
.It Fl recip Ar file
The recipients certificate when decrypting a message.
This certificate
must match one of the recipients of the message or an error occurs.
.It Fl inkey Ar file
The private key to use when signing or decrypting.
This must match the corresponding certificate.
If this option is not specified, the private key must be included
in the certificate file specified with
the
.Fl recip
or
.Fl signer
file.
.It Fl keyform Ar PEM | ENGINE
Input private key format.
.It Fl passin Ar arg
The private key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl crl_check
Check revocation status of signer's certificate using CRLs.
.It Fl crl_check_all
Check revocation status of signer's certificate chain using CRLs.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm smime
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default
for all available algorithms.
.It Fl rand Ar file ...
A file or files
containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Ar cert.pem ...
One or more certificates of message recipients: used when encrypting
a message.
.It Fl to , from , subject
The relevant mail headers.
These are included outside the signed
portion of a message so they may be included manually.
When signing, many
.Em S/MIME
mail clients check the signer's certificate email
address matches that specified in the From: address.
.El
.Sh SMIME NOTES
The
.Em MIME
message must be sent without any blank lines between the
headers and the output.
Some mail programs will automatically add a blank line.
Piping the mail directly to sendmail is one way to
achieve the correct format.
.Pp
The supplied message to be signed or encrypted must include the
necessary
.Em MIME
headers or many
.Em S/MIME
clients won't display it properly
.Pq if at all .
You can use the
.Fl text
option to automatically add plain text headers.
.Pp
A
.Qq signed and encrypted
message is one where a signed message is then encrypted.
This can be produced by encrypting an already signed message:
see the
.Sx SMIME EXAMPLES
section.
.Pp
This version of the program only allows one signer per message, but it
will verify multiple signers on received messages.
Some
.Em S/MIME
clients choke if a message contains multiple signers.
It is possible to sign messages
.Qq in parallel
by signing an already signed message.
.Pp
The options
.Fl encrypt
and
.Fl decrypt
reflect common usage in
.Em S/MIME
clients.
Strictly speaking these process PKCS#7 enveloped data: PKCS#7
encrypted data is used for other purposes.
.Sh SMIME EXIT CODES
.Bl -tag -width "XXXX"
.It Ar 0
The operation was completely successful.
.It Ar 1
An error occurred parsing the command options.
.It Ar 2
One of the input files could not be read.
.It Ar 3
An error occurred creating the PKCS#7 file or when reading the
.Em MIME
message.
.It Ar 4
An error occurred decrypting or verifying the message.
.It Ar 5
The message was verified correctly, but an error occurred writing out
the signer's certificates.
.El
.Sh SMIME EXAMPLES
Create a cleartext signed message:
.Bd -literal -offset indent
$ openssl smime -sign -in message.txt -text -out mail.msg \e
	-signer mycert.pem
.Ed
.Pp
Create an opaque signed message:
.Bd -literal -offset indent
$ openssl smime -sign -in message.txt -text -out mail.msg \e
	-nodetach -signer mycert.pem
.Ed
.Pp
Create a signed message, include some additional certificates and
read the private key from another file:
.Bd -literal -offset indent
$ openssl smime -sign -in in.txt -text -out mail.msg \e
	-signer mycert.pem -inkey mykey.pem -certfile mycerts.pem
.Ed
.Pp
Send a signed message under
.Ux
directly to
.Xr sendmail 8 ,
including headers:
.Bd -literal -offset indent
$ openssl smime -sign -in in.txt -text -signer mycert.pem \e
	-from steve@@openssl.org -to someone@@somewhere \e
	-subject "Signed message" | sendmail someone@@somewhere
.Ed
.Pp
Verify a message and extract the signer's certificate if successful:
.Bd -literal -offset indent
$ openssl smime -verify -in mail.msg -signer user.pem \e
	-out signedtext.txt
.Ed
.Pp
Send encrypted mail using triple DES:
.Bd -literal -offset indent
$ openssl smime -encrypt -in in.txt -from steve@@openssl.org \e
	-to someone@@somewhere -subject "Encrypted message" \e
	-des3 user.pem -out mail.msg
.Ed
.Pp
Sign and encrypt mail:
.Bd -literal -offset indent
$ openssl smime -sign -in ml.txt -signer my.pem -text | \e
	openssl smime -encrypt -out mail.msg \e
	-from steve@@openssl.org -to someone@@somewhere \e
	-subject "Signed and Encrypted message" -des3 user.pem
.Ed
.Pp
.Sy Note :
The encryption command does not include the
.Fl text
option because the message being encrypted already has
.Em MIME
headers.
.Pp
Decrypt mail:
.Bd -literal -offset indent
$ openssl smime -decrypt -in mail.msg -recip mycert.pem \e
	-inkey key.pem"
.Ed
.Pp
The output from Netscape form signing is a PKCS#7 structure with the
detached signature format.
You can use this program to verify the signature by line wrapping the
base64-encoded structure and surrounding it with:
.Bd -unfilled -offset indent
-----BEGIN PKCS7-----
-----END PKCS7-----
.Ed
.Pp
and using the command:
.Bd -literal -offset indent
$ openssl smime -verify -inform PEM -in signature.pem \e
	-content content.txt
.Ed
.Pp
Alternatively, you can base64 decode the signature and use:
.Bd -literal -offset indent
$ openssl smime -verify -inform DER -in signature.der \e
	-content content.txt
.Ed
.Sh SMIME BUGS
The
.Em MIME
parser isn't very clever: it seems to handle most messages that I've thrown
at it, but it may choke on others.
.Pp
The code currently will only write out the signer's certificate to a file:
if the signer has a separate encryption certificate this must be manually
extracted.
There should be some heuristic that determines the correct encryption
certificate.
.Pp
Ideally, a database should be maintained of a certificate for each email
address.
.Pp
The code doesn't currently take note of the permitted symmetric encryption
algorithms as supplied in the
.Em SMIMECapabilities
signed attribute.
This means the user has to manually include the correct encryption algorithm.
It should store the list of permitted ciphers in a database and only use those.
.Pp
No revocation checking is done on the signer's certificate.
.Pp
The current code can only handle
.Em S/MIME
v2 messages; the more complex
.Em S/MIME
v3 structures may cause parsing errors.
.\"
.\" SPEED
.\"
.Sh SPEED
.Nm openssl speed
.Bk -words
.Op Cm aes
.Op Cm aes-128-cbc
.Op Cm aes-192-cbc
.Op Cm aes-256-cbc
.Op Cm blowfish
.Op Cm bf-cbc
.Op Cm des
.Op Cm des-cbc
.Op Cm des-ede3
.Op Cm dsa512
.Op Cm dsa1024
.Op Cm dsa2048
.Op Cm hmac
.Op Cm md2
.Op Cm md4
.Op Cm md5
.Op Cm rc2
.Op Cm rc2-cbc
.Op Cm rc4
.Op Cm rmd160
.Op Cm rsa
.Op Cm rsa512
.Op Cm rsa1024
.Op Cm rsa2048
.Op Cm rsa4096
.Op Cm sha1
.Op Fl elapsed
.Op Fl evp Ar e
.Op Fl decrypt
.Op Fl mr
.Op Fl multi Ar number
.Op Fl engine Ar id
.Ek
.Pp
The
.Nm speed
command is used to test the performance of cryptographic algorithms.
.Bl -tag -width "XXXX"
.It Bq Cm zero or more test algorithms
If any options are given,
.Nm speed
tests those algorithms, otherwise all of the above are tested.
.It Fl elapsed
Measure time in real time instead of CPU user time.
.It Fl evp Ar e
Use EVP
.Ar e .
.It Fl decrypt
Time decryption instead of encryption
.Pq only EVP .
.It Fl mr
Produce machine readable output.
.It Fl multi Ar number
Run
.Ar number
benchmarks in parallel.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm speed
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default
for all available algorithms.
.El
.\"
.\" SPKAC
.\"
.Sh SPKAC
.Nm openssl spkac
.Op Fl in Ar file
.Op Fl out Ar file
.Op Fl key Ar keyfile
.Op Fl passin Ar arg
.Op Fl challenge Ar string
.Op Fl pubkey
.Op Fl spkac Ar spkacname
.Op Fl spksect Ar section
.Op Fl noout
.Op Fl verify
.Op Fl engine Ar id
.Pp
The
.Nm spkac
command processes Netscape signed public key and challenge
.Pq SPKAC
files.
It can print out their contents, verify the signature and
produce its own SPKACs from a supplied private key.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl in Ar file
This specifies the input
.Ar file
to read from, or standard input if this option is not specified.
Ignored if the
.Fl key
option is used.
.It Fl out Ar file
Specifies the output
.Ar file
to write to, or standard output by default.
.It Fl key Ar keyfile
Create an SPKAC file using the private key in
.Ar keyfile .
The
.Fl in , noout , spksect
and
.Fl verify
options are ignored if present.
.It Fl passin Ar password
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl challenge Ar string
Specifies the challenge string if an SPKAC is being created.
.It Fl spkac Ar spkacname
Allows an alternative name for the variable containing the SPKAC.
The default is "SPKAC".
This option affects both generated and input SPKAC files.
.It Fl spksect Ar section
Allows an alternative name for the
.Ar section
containing the SPKAC.
The default is the default section.
.It Fl noout
Don't output the text version of the SPKAC
.Pq not used if an SPKAC is being created .
.It Fl pubkey
Output the public key of an SPKAC
.Pq not used if an SPKAC is being created .
.It Fl verify
Verifies the digital signature on the supplied SPKAC.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm spkac
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.El
.Sh SPKAC EXAMPLES
Print out the contents of an SPKAC:
.Pp
.Dl $ openssl spkac -in spkac.cnf
.Pp
Verify the signature of an SPKAC:
.Pp
.Dl $ openssl spkac -in spkac.cnf -noout -verify
.Pp
Create an SPKAC using the challenge string
.Qq hello :
.Pp
.Dl $ openssl spkac -key key.pem -challenge hello -out spkac.cnf
.Pp
Example of an SPKAC,
.Pq long lines split up for clarity :
.Bd -unfilled -offset indent
SPKAC=MIG5MGUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA1cCoq2Wa3Ixs47uI7F\e
PVwHVIPDx5yso105Y6zpozam135a8R0CpoRvkkigIyXfcCjiVi5oWk+6FfPaD03u\e
PFoQIDAQABFgVoZWxsbzANBgkqhkiG9w0BAQQFAANBAFpQtY/FojdwkJh1bEIYuc\e
2EeM2KHTWPEepWYeawvHD0gQ3DngSC75YCWnnDdq+NQ3F+X4deMx9AaEglZtULwV\e
4=
.Ed
.Sh SPKAC NOTES
A created SPKAC with suitable DN components appended can be fed into
the
.Nm ca
utility.
.Pp
SPKACs are typically generated by Netscape when a form is submitted
containing the
.Em KEYGEN
tag as part of the certificate enrollment process.
.Pp
The challenge string permits a primitive form of proof of possession
of private key.
By checking the SPKAC signature and a random challenge
string, some guarantee is given that the user knows the private key
corresponding to the public key being certified.
This is important in some applications.
Without this it is possible for a previous SPKAC
to be used in a
.Qq replay attack .
.\"
.\" VERIFY
.\"
.Sh VERIFY
.Nm openssl verify
.Op Fl CApath Ar directory
.Op Fl CAfile Ar file
.Op Fl purpose Ar purpose
.Op Fl untrusted Ar file
.Op Fl help
.Op Fl issuer_checks
.Op Fl verbose
.Op Fl crl_check
.Op Fl engine Ar id
.Op Fl
.Op Ar certificates
.Pp
The
.Nm verify
command verifies certificate chains.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl CApath directory
A
.Ar directory
of trusted certificates.
The certificates should have names of the form
.Em hash.0 ,
or have symbolic links to them of this form
("hash" is the hashed certificate subject name: see the
.Fl hash
option of the
.Nm x509
utility).
Under
.Ux ,
the
.Nm c_rehash
script will automatically create symbolic links to a directory of certificates.
.It Fl CAfile Ar file
A
.Ar file
of trusted certificates.
The
.Ar file
should contain multiple certificates in PEM format, concatenated together.
.It Fl untrusted Ar file
A
.Ar file
of untrusted certificates.
The
.Ar file
should contain multiple certificates.
.It Fl purpose Ar purpose
The intended use for the certificate.
Without this option no chain verification will be done.
Currently accepted uses are
.Ar sslclient , sslserver ,
.Ar nssslserver , smimesign ,
and
.Ar smimeencrypt .
See the
.Sx VERIFY OPERATION
section for more information.
.It Fl help
Prints out a usage message.
.It Fl verbose
Print extra information about the operations being performed.
.It Fl issuer_checks
Print out diagnostics relating to searches for the issuer certificate
of the current certificate.
This shows why each candidate issuer certificate was rejected.
However the presence of rejection messages
does not itself imply that anything is wrong: during the normal
verify process several rejections may take place.
.It Fl crl_check
Check revocation status of signer's certificate using CRLs.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm verify
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl
Marks the last option.
All arguments following this are assumed to be certificate files.
This is useful if the first certificate filename begins with a
.Sq - .
.It Ar certificates
One or more
.Ar certificates
to verify.
If no certificate files are included, an attempt is made to read
a certificate from standard input.
They should all be in PEM format.
.El
.Sh VERIFY OPERATION
The
.Nm verify
program uses the same functions as the internal SSL and S/MIME verification,
therefore this description applies to these verify operations too.
.Pp
There is one crucial difference between the verify operations performed
by the
.Nm verify
program: wherever possible an attempt is made to continue
after an error, whereas normally the verify operation would halt on the
first error.
This allows all the problems with a certificate chain to be determined.
.Pp
The verify operation consists of a number of separate steps.
.Pp
Firstly a certificate chain is built up starting from the supplied certificate
and ending in the root CA.
It is an error if the whole chain cannot be built up.
The chain is built up by looking up the issuers certificate of the current
certificate.
If a certificate is found which is its own issuer, it is assumed
to be the root CA.
.Pp
The process of
.Qq looking up the issuers certificate
itself involves a number of steps.
In versions of
.Nm OpenSSL
before 0.9.5a the first certificate whose subject name matched the issuer
of the current certificate was assumed to be the issuers certificate.
In
.Nm OpenSSL
0.9.6 and later all certificates whose subject name matches the issuer name
of the current certificate are subject to further tests.
The relevant authority key identifier components of the current certificate
.Pq if present
must match the subject key identifier
.Pq if present
and issuer and serial number of the candidate issuer; in addition the
.Em keyUsage
extension of the candidate issuer
.Pq if present
must permit certificate signing.
.Pp
The lookup first looks in the list of untrusted certificates and if no match
is found the remaining lookups are from the trusted certificates.
The root CA is always looked up in the trusted certificate list: if the
certificate to verify is a root certificate, then an exact match must be
found in the trusted list.
.Pp
The second operation is to check every untrusted certificate's extensions for
consistency with the supplied purpose.
If the
.Fl purpose
option is not included, then no checks are done.
The supplied or
.Qq leaf
certificate must have extensions compatible with the supplied purpose
and all other certificates must also be valid CA certificates.
The precise extensions required are described in more detail in
the
.Sx X509 CERTIFICATE EXTENSIONS
section below.
.Pp
The third operation is to check the trust settings on the root CA.
The root CA should be trusted for the supplied purpose.
For compatibility with previous versions of
.Nm SSLeay
and
.Nm OpenSSL ,
a certificate with no trust settings is considered to be valid for
all purposes.
.Pp
The final operation is to check the validity of the certificate chain.
The validity period is checked against the current system time and the
.Em notBefore
and
.Em notAfter
dates in the certificate.
The certificate signatures are also checked at this point.
.Pp
If all operations complete successfully, the certificate is considered
valid.
If any operation fails then the certificate is not valid.
.Sh VERIFY DIAGNOSTICS
When a verify operation fails, the output messages can be somewhat cryptic.
The general form of the error message is:
.Bd -unfilled
\& server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024-bit)
\& error 24 at 1 depth lookup:invalid CA certificate
.Ed
.Pp
The first line contains the name of the certificate being verified, followed by
the subject name of the certificate.
The second line contains the error number and the depth.
The depth is the number of the certificate being verified when a
problem was detected starting with zero for the certificate being verified
itself, then 1 for the CA that signed the certificate and so on.
Finally a text version of the error number is presented.
.Pp
An exhaustive list of the error codes and messages is shown below; this also
includes the name of the error code as defined in the header file
.Aq Pa x509_vfy.h .
Some of the error codes are defined but never returned: these are described
as
.Qq unused .
.Bl -tag -width "XXXX"
.It Ar "0 X509_V_OK: ok"
The operation was successful.
.It Ar 2 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get issuer certificate
The issuer certificate could not be found: this occurs if the issuer certificate
of an untrusted certificate cannot be found.
.It Ar 3 X509_V_ERR_UNABLE_TO_GET_CRL: unable to get certificate CRL
The CRL of a certificate could not be found.
Unused.
.It Ar 4 X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to decrypt certificate's signature
The certificate signature could not be decrypted.
This means that the actual signature value could not be determined rather
than it not matching the expected value.
This is only meaningful for RSA keys.
.It Ar 5 X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to decrypt CRL's signature
The CRL signature could not be decrypted: this means that the actual
signature value could not be determined rather than it not matching the
expected value.
Unused.
.It Ar 6 X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable to decode issuer public key
The public key in the certificate
.Em SubjectPublicKeyInfo
could not be read.
.It Ar 7 X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate signature failure
The signature of the certificate is invalid.
.It Ar 8 X509_V_ERR_CRL_SIGNATURE_FAILURE: CRL signature failure
The signature of the certificate is invalid.
Unused.
.It Ar 9 X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet valid
The certificate is not yet valid: the
.Em notBefore
date is after the current time.
.It Ar 10 X509_V_ERR_CERT_HAS_EXPIRED: certificate has expired
The certificate has expired; that is, the
.Em notAfter
date is before the current time.
.It Ar 11 X509_V_ERR_CRL_NOT_YET_VALID: CRL is not yet valid
The CRL is not yet valid.
Unused.
.It Ar 12 X509_V_ERR_CRL_HAS_EXPIRED: CRL has expired
The CRL has expired.
Unused.
.It Ar 13 X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format error in certificate's notBefore field
The certificate
.Em notBefore
field contains an invalid time.
.It Ar 14 X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format error in certificate's notAfter field
The certificate
.Em notAfter
field contains an invalid time.
.It Ar 15 X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format error in CRL's lastUpdate field
The CRL
.Em lastUpdate
field contains an invalid time.
Unused.
.It Ar 16 X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format error in CRL's nextUpdate field
The CRL
.Em nextUpdate
field contains an invalid time.
Unused.
.It Ar 17 X509_V_ERR_OUT_OF_MEM: out of memory
An error occurred trying to allocate memory.
This should never happen.
.It Ar 18 X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed certificate
The passed certificate is self-signed and the same certificate cannot be
found in the list of trusted certificates.
.It Ar 19 X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed certificate in certificate chain
The certificate chain could be built up using the untrusted certificates but
the root could not be found locally.
.It Ar 20 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable to get local issuer certificate
The issuer certificate of a locally looked up certificate could not be found.
This normally means the list of trusted certificates is not complete.
.It Ar 21 X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to verify the first certificate
No signatures could be verified because the chain contains only one
certificate and it is not self-signed.
.It Ar 22 X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too long
The certificate chain length is greater than the supplied maximum depth.
Unused.
.It Ar 23 X509_V_ERR_CERT_REVOKED: certificate revoked
The certificate has been revoked.
Unused.
.It Ar 24 X509_V_ERR_INVALID_CA: invalid CA certificate
A CA certificate is invalid.
Either it is not a CA or its extensions are not consistent
with the supplied purpose.
.It Ar 25 X509_V_ERR_PATH_LENGTH_EXCEEDED: path length constraint exceeded
The
.Em basicConstraints
pathlength parameter has been exceeded.
.It Ar 26 X509_V_ERR_INVALID_PURPOSE: unsupported certificate purpose
The supplied certificate cannot be used for the specified purpose.
.It Ar 27 X509_V_ERR_CERT_UNTRUSTED: certificate not trusted
The root CA is not marked as trusted for the specified purpose.
.It Ar 28 X509_V_ERR_CERT_REJECTED: certificate rejected
The root CA is marked to reject the specified purpose.
.It Ar 29 X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer mismatch
The current candidate issuer certificate was rejected because its subject name
did not match the issuer name of the current certificate.
Only displayed when the
.Fl issuer_checks
option is set.
.It Ar 30 X509_V_ERR_AKID_SKID_MISMATCH: authority and subject key identifier mismatch
The current candidate issuer certificate was rejected because its subject key
identifier was present and did not match the authority key identifier current
certificate.
Only displayed when the
.Fl issuer_checks
option is set.
.It Ar 31 X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and issuer serial number mismatch
The current candidate issuer certificate was rejected because its issuer name
and serial number were present and did not match the authority key identifier
of the current certificate.
Only displayed when the
.Fl issuer_checks
option is set.
.It Ar 32 X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not include certificate signing
The current candidate issuer certificate was rejected because its
.Em keyUsage
extension does not permit certificate signing.
.It Ar 50 X509_V_ERR_APPLICATION_VERIFICATION: application verification failure
An application specific error.
Unused.
.El
.Sh VERIFY BUGS
Although the issuer checks are a considerable improvement over the old
technique, they still suffer from limitations in the underlying
X509_LOOKUP API.
One consequence of this is that trusted certificates with matching subject
name must either appear in a file (as specified by the
.Fl CAfile
option) or a directory (as specified by
.Fl CApath ) .
If they occur in both, only the certificates in the file will
be recognised.
.Pp
Previous versions of
.Nm OpenSSL
assume certificates with matching subject name are identical and
mishandled them.
.\"
.\" VERSION
.\"
.Sh VERSION
.Nm openssl version
.Op Fl abdfopv
.Pp
The
.Nm version
command is used to print out version information about
.Nm OpenSSL .
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl a
All information: this is the same as setting all the other flags.
.It Fl b
The date the current version of
.Nm OpenSSL
was built.
.It Fl d
.Ev OPENSSLDIR
setting.
.It Fl f
Compilation flags.
.It Fl o
Option information: various options set when the library was built.
.It Fl p
Platform setting.
.It Fl v
The current
.Nm OpenSSL
version.
.El
.Sh VERSION NOTES
The output of
.Nm openssl version -a
would typically be used when sending in a bug report.
.Sh VERSION HISTORY
The
.Fl d
option was added in
.Nm OpenSSL
0.9.7.
.\"
.\" X509
.\"
.Sh X509
.Nm openssl x509
.Bk -words
.Op Fl inform Ar DER | PEM | NET
.Op Fl outform Ar DER | PEM | NET
.Op Fl keyform Ar DER | PEM
.Op Fl CAform Ar DER | PEM
.Op Fl CAkeyform Ar DER | PEM
.Op Fl in Ar file
.Op Fl out Ar file
.Op Fl passin Ar arg
.Op Fl serial
.Op Fl hash
.Op Fl subject
.Op Fl issuer
.Op Fl nameopt Ar option
.Op Fl email
.Op Fl startdate
.Op Fl enddate
.Op Fl purpose
.Op Fl dates
.Op Fl modulus
.Op Fl pubkey
.Op Fl fingerprint
.Op Fl alias
.Op Fl noout
.Op Fl ocspid
.Op Fl trustout
.Op Fl clrtrust
.Op Fl clrreject
.Op Fl addtrust Ar arg
.Op Fl addreject Ar arg
.Op Fl setalias Ar arg
.Op Fl days Ar arg
.Op Fl checkend Ar arg
.Op Fl set_serial Ar n
.Op Fl signkey Ar file
.Op Fl x509toreq
.Op Fl req
.Op Fl CA Ar file
.Op Fl CAkey Ar file
.Op Fl CAcreateserial
.Op Fl CAserial Ar file
.Op Fl text
.Op Fl C
.Op Fl md2 | md5 | sha1
.Op Fl clrext
.Op Fl extfile Ar file
.Op Fl extensions Ar section
.Op Fl engine Ar id
.Ek
.Pp
The
.Nm x509
command is a multi-purpose certificate utility.
It can be used to display certificate information, convert certificates to
various forms, sign certificate requests like a
.Qq mini CA ,
or edit certificate trust settings.
.Pp
Since there are a large number of options, they are split up into
various sections.
.Sh X509 INPUT, OUTPUT, AND GENERAL PURPOSE OPTIONS
.Bl -tag -width "XXXX"
.It Fl inform Ar DER | PEM | NET
This specifies the input format.
Normally, the command will expect an X509 certificate,
but this can change if other options such as
.Fl req
are present.
The
.Ar DER
format is the DER encoding of the certificate and
.Ar PEM
is the base64 encoding of the DER encoding with header and footer lines added.
The
.Ar NET
option is an obscure Netscape server format that is now
obsolete.
.It Fl outform Ar DER | PEM | NET
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar file
This specifies the input
.Ar file
to read a certificate from, or standard input if this option is not specified.
.It Fl out Ar file
This specifies the output
.Ar file
to write to, or standard output by default.
.It Fl passin Ar arg
The key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl md2 | md5 | sha1
The digest to use.
This affects any signing or display option that uses a message digest,
such as the
.Fl fingerprint , signkey ,
and
.Fl CA
options.
If not specified, MD5 is used.
If the key being used to sign with is a DSA key,
this option has no effect: SHA1 is always used with DSA keys.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm x509
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.El
.Sh X509 DISPLAY OPTIONS
.Sy Note :
The
.Fl alias
and
.Fl purpose
options are also display options but are described in the
.Sx X509 TRUST SETTINGS
section.
.Bl -tag -width "XXXX"
.It Fl text
Prints out the certificate in text form.
Full details are output including the public key, signature algorithms,
issuer and subject names, serial number, any extensions present and any
trust settings.
.It Fl certopt Ar option
Customise the output format used with
.Fl text .
The
.Ar option
argument can be a single option or multiple options separated by commas.
The
.Fl certopt
switch may also be used more than once to set multiple options.
See the
.Sx X509 TEXT OPTIONS
section for more information.
.It Fl noout
This option prevents output of the encoded version of the request.
.It Fl ocspid
Print OCSP hash values for the subject name and public key.
.It Fl modulus
This option prints out the value of the modulus of the public key
contained in the certificate.
.It Fl pubkey
Output the public key.
.It Fl serial
Outputs the certificate serial number.
.It Fl hash
Outputs the
.Qq hash
of the certificate subject name.
This is used in
.Nm OpenSSL
to form an index to allow certificates in a directory to be looked up
by subject name.
.It Fl subject
Outputs the subject name.
.It Fl issuer
Outputs the issuer name.
.It Fl nameopt Ar option
Option which determines how the subject or issuer names are displayed.
The
.Ar option
argument can be a single option or multiple options separated by commas.
Alternatively, the
.Fl nameopt
switch may be used more than once to set multiple options.
See the
.Sx X509 NAME OPTIONS
section for more information.
.It Fl email
Outputs the email address(es) if any.
.It Fl startdate
Prints out the start date of the certificate; that is, the
.Em notBefore
date.
.It Fl enddate
Prints out the expiry date of the certificate; that is, the
.Em notAfter
date.
.It Fl dates
Prints out the start and expiry dates of a certificate.
.It Fl fingerprint
Prints out the digest of the DER-encoded version of the whole certificate
(see
.Sx DIGEST OPTIONS ) .
.It Fl C
This outputs the certificate in the form of a C source file.
.El
.Sh X509 TRUST SETTINGS
Please note these options are currently experimental and may well change.
.Pp
A
.Em trusted certificate
is an ordinary certificate which has several
additional pieces of information attached to it such as the permitted
and prohibited uses of the certificate and an
.Qq alias .
.Pp
Normally, when a certificate is being verified at least one certificate
must be
.Qq trusted .
By default, a trusted certificate must be stored
locally and must be a root CA: any certificate chain ending in this CA
is then usable for any purpose.
.Pp
Trust settings currently are only used with a root CA.
They allow a finer control over the purposes the root CA can be used for.
For example, a CA may be trusted for an SSL client but not for
SSL server use.
.Pp
See the description of the
.Nm verify
utility for more information on the meaning of trust settings.
.Pp
Future versions of
.Nm OpenSSL
will recognize trust settings on any certificate: not just root CAs.
.Bl -tag -width "XXXX"
.It Fl trustout
This causes
.Nm x509
to output a
.Em trusted certificate .
An ordinary or trusted certificate can be input, but by default an ordinary
certificate is output and any trust settings are discarded.
With the
.Fl trustout
option a trusted certificate is output.
A trusted certificate is automatically output if any trust settings
are modified.
.It Fl setalias Ar arg
Sets the alias of the certificate.
This will allow the certificate to be referred to using a nickname,
for example
.Qq Steve's Certificate .
.It Fl alias
Outputs the certificate alias, if any.
.It Fl clrtrust
Clears all the permitted or trusted uses of the certificate.
.It Fl clrreject
Clears all the prohibited or rejected uses of the certificate.
.It Fl addtrust Ar arg
Adds a trusted certificate use.
Any object name can be used here, but currently only
.Ar clientAuth
.Pq SSL client use ,
.Ar serverAuth
.Pq SSL server use ,
and
.Ar emailProtection
.Pq S/MIME email
are used.
Other
.Nm OpenSSL
applications may define additional uses.
.It Fl addreject Ar arg
Adds a prohibited use.
It accepts the same values as the
.Fl addtrust
option.
.It Fl purpose
This option performs tests on the certificate extensions and outputs
the results.
For a more complete description, see the
.Sx X509 CERTIFICATE EXTENSIONS
section.
.El
.Sh X509 SIGNING OPTIONS
The
.Nm x509
utility can be used to sign certificates and requests: it
can thus behave like a
.Qq mini CA .
.Bl -tag -width "XXXX"
.It Fl signkey Ar file
This option causes the input file to be self-signed using the supplied
private key.
.Pp
If the input file is a certificate, it sets the issuer name to the
subject name
.Pq i.e. makes it self-signed ,
changes the public key to the supplied value
and changes the start and end dates.
The start date is set to the current time and the end date is set to
a value determined by the
.Fl days
option.
Any certificate extensions are retained unless the
.Fl clrext
option is supplied.
.Pp
If the input is a certificate request, a self-signed certificate
is created using the supplied private key using the subject name in
the request.
.It Fl clrext
Delete any extensions from a certificate.
This option is used when a certificate is being created from another
certificate (for example with the
.Fl signkey
or the
.Fl CA
options).
Normally, all extensions are retained.
.It Fl keyform Ar DER | PEM
Specifies the format
.Pq DER or PEM
of the private key file used in the
.Fl signkey
option.
.It Fl days Ar arg
Specifies the number of days to make a certificate valid for.
The default is 30 days.
.It Fl checkend Ar arg
Check whether the certificate expires in the next
.Ar arg
seconds.
If so, exit with return value 1;
otherwise exit with return value 0.
.It Fl x509toreq
Converts a certificate into a certificate request.
The
.Fl signkey
option is used to pass the required private key.
.It Fl req
By default, a certificate is expected on input.
With this option a certificate request is expected instead.
.It Fl set_serial Ar n
Specifies the serial number to use.
This option can be used with either the
.Fl signkey
or
.Fl CA
options.
If used in conjunction with the
.Fl CA
option, the serial number file (as specified by the
.Fl CAserial
or
.Fl CAcreateserial
options) is not used.
.Pp
The serial number can be decimal or hex (if preceded by
.Sq 0x ) .
Negative serial numbers can also be specified but their use is not recommended.
.It Fl CA Ar file
Specifies the CA certificate to be used for signing.
When this option is present,
.Nm x509
behaves like a
.Qq mini CA .
The input file is signed by the CA using this option;
that is, its issuer name is set to the subject name of the CA and it is
digitally signed using the CA's private key.
.Pp
This option is normally combined with the
.Fl req
option.
Without the
.Fl req
option, the input is a certificate which must be self-signed.
.It Fl CAkey Ar file
Sets the CA private key to sign a certificate with.
If this option is not specified, it is assumed that the CA private key
is present in the CA certificate file.
.It Fl CAserial Ar file
Sets the CA serial number file to use.
.Pp
When the
.Fl CA
option is used to sign a certificate it uses a serial
number specified in a file.
This file consist of one line containing an even number of hex digits
with the serial number to use.
After each use the serial number is incremented and written out
to the file again.
.Pp
The default filename consists of the CA certificate file base name with
.Pa .srl
appended.
For example, if the CA certificate file is called
.Pa mycacert.pem ,
it expects to find a serial number file called
.Pa mycacert.srl .
.It Fl CAcreateserial
With this option the CA serial number file is created if it does not exist:
it will contain the serial number
.Sq 02
and the certificate being signed will have
.Sq 1
as its serial number.
Normally, if the
.Fl CA
option is specified and the serial number file does not exist, it is an error.
.It Fl extfile Ar file
File containing certificate extensions to use.
If not specified, no extensions are added to the certificate.
.It Fl extensions Ar section
The section to add certificate extensions from.
If this option is not specified, the extensions should either be
contained in the unnamed
.Pq default
section or the default section should contain a variable called
.Qq extensions
which contains the section to use.
.El
.Sh X509 NAME OPTIONS
The
.Fl nameopt
command line switch determines how the subject and issuer
names are displayed.
If no
.Fl nameopt
switch is present, the default
.Qq oneline
format is used which is compatible with previous versions of
.Nm OpenSSL .
Each option is described in detail below; all options can be preceded by a
.Sq -
to turn the option off.
Only the first four will normally be used.
.Bl -tag -width "XXXX"
.It Ar compat
Use the old format.
This is equivalent to specifying no name options at all.
.It Ar RFC2253
Displays names compatible with RFC 2253; equivalent to
.Ar esc_2253 , esc_ctrl ,
.Ar esc_msb , utf8 , dump_nostr , dump_unknown ,
.Ar dump_der , sep_comma_plus , dn_rev and sname .
.It Ar oneline
A oneline format which is more readable than RFC2253.
It is equivalent to specifying the
.Ar esc_2253 , esc_ctrl , esc_msb , utf8 ,
.Ar dump_nostr , dump_der , use_quote , sep_comma_plus_spc ,
.Ar spc_eq
and
.Ar sname
options.
.It Ar multiline
A multiline format.
It is equivalent to
.Ar esc_ctrl , esc_msb , sep_multiline ,
.Ar spc_eq , lname
and
.Ar align .
.It Ar esc_2253
Escape the
.Qq special
characters required by RFC 2253 in a field that is
.Dq \&\ \&,+"\*(Lt\*(Gt\&; .
Additionally,
.Sq #
is escaped at the beginning of a string
and a space character at the beginning or end of a string.
.It Ar esc_ctrl
Escape control characters.
That is, those with ASCII values less than 0x20
.Pq space
and the delete
.Pq 0x7f
character.
They are escaped using the RFC 2253 \eXX notation (where XX are two hex
digits representing the character value).
.It Ar esc_msb
Escape characters with the MSB set; that is, with ASCII values larger than
127.
.It Ar use_quote
Escapes some characters by surrounding the whole string with
.Sq \&"
characters.
Without the option, all escaping is done with the
.Sq \e
character.
.It Ar utf8
Convert all strings to UTF8 format first.
This is required by RFC 2253.
If you are lucky enough to have a UTF8 compatible terminal,
the use of this option (and
.Em not
setting
.Ar esc_msb )
may result in the correct display of multibyte
.Pq international
characters.
If this option is not present, multibyte characters larger than 0xff
will be represented using the format \eUXXXX for 16 bits and \eWXXXXXXXX
for 32 bits.
Also, if this option is off, any UTF8Strings will be converted to their
character form first.
.It Ar no_type
This option does not attempt to interpret multibyte characters in any
way.
That is, their content octets are merely dumped as though one octet
represents each character.
This is useful for diagnostic purposes but will result in rather odd
looking output.
.It Ar show_type
Show the type of the ASN1 character string.
The type precedes the field contents.
For example
.Qq BMPSTRING: Hello World .
.It Ar dump_der
When this option is set, any fields that need to be hexdumped will
be dumped using the DER encoding of the field.
Otherwise just the content octets will be displayed.
Both options use the RFC 2253 #XXXX... format.
.It Ar dump_nostr
Dump non-character string types
.Pq for example OCTET STRING ;
if this option is not set, non-character string types will be displayed
as though each content octet represents a single character.
.It Ar dump_all
Dump all fields.
This option, when used with
.Ar dump_der ,
allows the DER encoding of the structure to be unambiguously determined.
.It Ar dump_unknown
Dump any field whose OID is not recognised by
.Nm OpenSSL .
.It Ar sep_comma_plus , sep_comma_plus_space , sep_semi_plus_space , sep_multiline
These options determine the field separators.
The first character is between RDNs and the second between multiple AVAs
(multiple AVAs are very rare and their use is discouraged).
The options ending in
.Qq space
additionally place a space after the separator to make it more readable.
The
.Ar sep_multiline
uses a linefeed character for the RDN separator and a spaced
.Sq +
for the AVA separator.
It also indents the fields by four characters.
.It Ar dn_rev
Reverse the fields of the DN.
This is required by RFC 2253.
As a side effect, this also reverses the order of multiple AVAs but this is
permissible.
.It Ar nofname , sname , lname , oid
These options alter how the field name is displayed.
.Ar nofname
does not display the field at all.
.Ar sname
uses the
.Qq short name
form (CN for
.Ar commonName ,
for example).
.Ar lname
uses the long form.
.Ar oid
represents the OID in numerical form and is useful for diagnostic purpose.
.It Ar align
Align field values for a more readable output.
Only usable with
.Ar sep_multiline .
.It Ar spc_eq
Places spaces round the
.Sq =
character which follows the field name.
.El
.Sh X509 TEXT OPTIONS
As well as customising the name output format, it is also possible to
customise the actual fields printed using the
.Fl certopt
options when the
.Fl text
option is present.
The default behaviour is to print all fields.
.Bl -tag -width "XXXX"
.It Ar compatible
Use the old format.
This is equivalent to specifying no output options at all.
.It Ar no_header
Don't print header information: that is, the lines saying
.Qq Certificate
and
.Qq Data .
.It Ar no_version
Don't print out the version number.
.It Ar no_serial
Don't print out the serial number.
.It Ar no_signame
Don't print out the signature algorithm used.
.It Ar no_validity
Don't print the validity; that is, the
.Em notBefore
and
.Em notAfter
fields.
.It Ar no_subject
Don't print out the subject name.
.It Ar no_issuer
Don't print out the issuer name.
.It Ar no_pubkey
Don't print out the public key.
.It Ar no_sigdump
Don't give a hexadecimal dump of the certificate signature.
.It Ar no_aux
Don't print out certificate trust information.
.It Ar no_extensions
Don't print out any X509V3 extensions.
.It Ar ext_default
Retain default extension behaviour: attempt to print out unsupported
certificate extensions.
.It Ar ext_error
Print an error message for unsupported certificate extensions.
.It Ar ext_parse
ASN1 parse unsupported extensions.
.It Ar ext_dump
Hex dump unsupported extensions.
.It Ar ca_default
The value used by the
.Nm ca
utility, equivalent to
.Ar no_issuer , no_pubkey , no_header ,
.Ar no_version , no_sigdump
and
.Ar no_signame .
.El
.Sh X509 EXAMPLES
.Sy Note :
In these examples the
.Sq \e
means the example should be all on one line.
.Pp
Display the contents of a certificate:
.Pp
.Dl $ openssl x509 -in cert.pem -noout -text
.Pp
Display the certificate serial number:
.Pp
.Dl $ openssl x509 -in cert.pem -noout -serial
.Pp
Display the certificate subject name:
.Pp
.Dl $ openssl x509 -in cert.pem -noout -subject
.Pp
Display the certificate subject name in RFC 2253 form:
.Pp
.Dl $ openssl x509 -in cert.pem -noout -subject -nameopt RFC2253
.Pp
Display the certificate subject name in oneline form on a terminal
supporting UTF8:
.Bd -literal -offset indent
$ openssl x509 -in cert.pem -noout -subject \e
	-nameopt oneline,-escmsb
.Ed
.Pp
Display the certificate MD5 fingerprint:
.Pp
.Dl $ openssl x509 -in cert.pem -noout -fingerprint
.Pp
Display the certificate SHA1 fingerprint:
.Pp
.Dl $ openssl x509 -sha1 -in cert.pem -noout -fingerprint
.Pp
Convert a certificate from PEM to DER format:
.Pp
.Dl "$ openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER"
.Pp
Convert a certificate to a certificate request:
.Bd -literal -offset indent
$ openssl x509 -x509toreq -in cert.pem -out req.pem \e
	-signkey key.pem
.Ed
.Pp
Convert a certificate request into a self-signed certificate using
extensions for a CA:
.Bd -literal -offset indent
$ openssl x509 -req -in careq.pem -extfile openssl.cnf -extensions \e
	v3_ca -signkey key.pem -out cacert.pem
.Ed
.Pp
Sign a certificate request using the CA certificate above and add user
certificate extensions:
.Bd -literal -offset indent
$ openssl x509 -req -in req.pem -extfile openssl.cnf -extensions \e
	v3_usr -CA cacert.pem -CAkey key.pem -CAcreateserial
.Ed
.Pp
Set a certificate to be trusted for SSL
client use and set its alias to
.Qq Steve's Class 1 CA :
.Bd -literal -offset indent
$ openssl x509 -in cert.pem -addtrust clientAuth \e
	-setalias "Steve's Class 1 CA" -out trust.pem
.Ed
.Sh X509 NOTES
The PEM format uses the header and footer lines:
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
.Ed
.Pp
It will also handle files containing:
.Bd -unfilled -offset indent
-----BEGIN X509 CERTIFICATE-----
-----END X509 CERTIFICATE-----
.Ed
.Pp
Trusted certificates have the lines:
.Bd -unfilled -offset indent
-----BEGIN TRUSTED CERTIFICATE-----
-----END TRUSTED CERTIFICATE-----
.Ed
.Pp
The conversion to UTF8 format used with the name options assumes that
T61Strings use the ISO8859-1 character set.
This is wrong, but Netscape and MSIE do this, as do many certificates.
So although this is incorrect
it is more likely to display the majority of certificates correctly.
.Pp
The
.Fl fingerprint
option takes the digest of the DER-encoded certificate.
This is commonly called a
.Qq fingerprint .
Because of the nature of message digests, the fingerprint of a certificate
is unique to that certificate and two certificates with the same fingerprint
can be considered to be the same.
.Pp
The Netscape fingerprint uses MD5, whereas MSIE uses SHA1.
.Pp
The
.Fl email
option searches the subject name and the subject alternative
name extension.
Only unique email addresses will be printed out: it will
not print the same address more than once.
.Sh X509 CERTIFICATE EXTENSIONS
The
.Fl purpose
option checks the certificate extensions and determines
what the certificate can be used for.
The actual checks done are rather
complex and include various hacks and workarounds to handle broken
certificates and software.
.Pp
The same code is used when verifying untrusted certificates in chains,
so this section is useful if a chain is rejected by the verify code.
.Pp
The
.Em basicConstraints
extension CA flag is used to determine whether the
certificate can be used as a CA.
If the CA flag is true, it is a CA;
if the CA flag is false, it is not a CA.
.Em All
CAs should have the CA flag set to true.
.Pp
If the
.Em basicConstraints
extension is absent, then the certificate is
considered to be a
.Qq possible CA ;
other extensions are checked according to the intended use of the certificate.
A warning is given in this case because the certificate should really not
be regarded as a CA: however,
it is allowed to be a CA to work around some broken software.
.Pp
If the certificate is a V1 certificate
.Pq and thus has no extensions
and it is self-signed, it is also assumed to be a CA but a warning is again
given: this is to work around the problem of Verisign roots which are V1
self-signed certificates.
.Pp
If the
.Em keyUsage
extension is present, then additional restraints are
made on the uses of the certificate.
A CA certificate
.Em must
have the
.Em keyCertSign
bit set if the
.Em keyUsage
extension is present.
.Pp
The extended key usage extension places additional restrictions on the
certificate uses.
If this extension is present
.Pq whether critical or not ,
the key can only be used for the purposes specified.
.Pp
A complete description of each test is given below.
The comments about
.Em basicConstraints
and
.Em keyUsage
and V1 certificates above apply to
.Em all
CA certificates.
.Bl -tag -width "XXXX"
.It Ar SSL Client
The extended key usage extension must be absent or include the
.Qq web client authentication
OID.
.Ar keyUsage
must be absent or it must have the
.Em digitalSignature
bit set.
Netscape certificate type must be absent or it must have the SSL
client bit set.
.It Ar SSL Client CA
The extended key usage extension must be absent or include the
.Qq web client authentication
OID.
Netscape certificate type must be absent or it must have the SSL CA
bit set: this is used as a work around if the
.Em basicConstraints
extension is absent.
.It Ar SSL Server
The extended key usage extension must be absent or include the
.Qq web server authentication
and/or one of the SGC OIDs.
.Em keyUsage
must be absent or it must have the
.Em digitalSignature
set, the
.Em keyEncipherment
set, or both bits set.
Netscape certificate type must be absent or have the SSL server bit set.
.It Ar SSL Server CA
The extended key usage extension must be absent or include the
.Qq web server authentication
and/or one of the SGC OIDs.
Netscape certificate type must be absent or the SSL CA
bit must be set: this is used as a work around if the
.Em basicConstraints
extension is absent.
.It Ar Netscape SSL Server
For Netscape SSL clients to connect to an SSL server; it must have the
.Em keyEncipherment
bit set if the
.Em keyUsage
extension is present.
This isn't always valid because some cipher suites use the key for
digital signing.
Otherwise it is the same as a normal SSL server.
.It Ar Common S/MIME Client Tests
The extended key usage extension must be absent or include the
.Qq email protection
OID.
Netscape certificate type must be absent or should have the
.Em S/MIME
bit set.
If the
.Em S/MIME
bit is not set in Netscape certificate type, then the SSL
client bit is tolerated as an alternative but a warning is shown:
this is because some Verisign certificates don't set the
.Em S/MIME
bit.
.It Ar S/MIME Signing
In addition to the common
.Em S/MIME
client tests, the
.Em digitalSignature
bit must be set if the
.Em keyUsage
extension is present.
.It Ar S/MIME Encryption
In addition to the common
.Em S/MIME
tests, the
.Em keyEncipherment
bit must be set if the
.Em keyUsage
extension is present.
.It Ar S/MIME CA
The extended key usage extension must be absent or include the
.Qq email protection
OID.
Netscape certificate type must be absent or must have the
.Em S/MIME CA
bit set: this is used as a work around if the
.Em basicConstraints
extension is absent.
.It Ar CRL Signing
The
.Em keyUsage
extension must be absent or it must have the
.Em CRL
signing bit set.
.It Ar CRL Signing CA
The normal CA tests apply.
Except in this case the
.Em basicConstraints
extension must be present.
.El
.Sh X509 BUGS
Extensions in certificates are not transferred to certificate requests and
vice versa.
.Pp
It is possible to produce invalid certificates or requests by specifying the
wrong private key or using inconsistent options in some cases: these should
be checked.
.Pp
There should be options to explicitly set such things as start and end dates,
rather than an offset from the current time.
.Pp
The code to implement the verify behaviour described in the
.Sx X509 TRUST SETTINGS
is currently being developed.
It thus describes the intended behaviour rather than the current behaviour.
It is hoped that it will represent reality in
.Nm OpenSSL
0.9.5 and later.
.\"
.\" FILES
.\"
.Sh FILES
.Bl -tag -width "/etc/ssl/openssl.cnf" -compact
.It /etc/ssl/
Default config directory for
.Nm openssl .
.It /etc/ssl/lib/
Unused.
.It /etc/ssl/private/
Default private key directory.
.It /etc/ssl/openssl.cnf
Default configuration file for
.Nm openssl .
.It /etc/ssl/x509v3.cnf
Default configuration file for
.Nm x509
certificates.
.El
.\"
.\" SEE ALSO
.\"
.Sh SEE ALSO
.Xr blowfish 3 ,
.Xr crypto 3 ,
.Xr des_crypt 3 ,
.Xr dsa 3 ,
.Xr ERR_error_string_n 3 ,
.Xr HMAC 3 ,
.Xr md4 3 ,
.Xr md5 3 ,
.Xr RAND_egd 3 ,
.Xr rsa 3 ,
.Xr sha1 3 ,
.Xr ssl 3 ,
.Xr des_modes 7 ,
.Xr httpd 8 ,
.Xr sendmail 8 ,
.Xr ssl 8 ,
.Xr starttls 8
.Pp
.Rs
.%T The SSL Protocol
.%Q Netscape Communications Corp.
.%D February 9 1995
.Re
.Rs
.%T The SSL 3.0 Protocol
.%Q Netscape Communications Corp.
.%D November 18 1996
.Re
.Rs
.%R RFC 2246
.%T The TLS Protocol Version 1.0
.%D January 1999
.Re
.Rs
.%R RFC 2253
.%T "LDAPv3 Distinguished Names"
.%D December 1997
.Re
.Rs
.%R RFC 2315
.%T "PKCS #7: Cryptographic Message Syntax"
.%D March 1998
.Re
.Rs
.%R RFC 2459
.%T "X.509 Certificate and CRL Profile"
.%D January 1999
.Re
.Rs
.%R RFC 2560
.%T "Online Certificate Status Protocol \- OCSP"
.%D June 1999
.Re
.Rs
.%R RFC 2630
.%T "Cryptographic Message Syntax"
.%D June 1999
.Re
.Rs
.%R RFC 3268
.%T "Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security(TLS)"
.%D June 2002
.Re
.\"
.\" OPENSSL HISTORY
.\"
.Sh HISTORY
The
.Xr openssl 1
document appeared in
.Nm OpenSSL
0.9.2.
The
.Cm list- Ns Ar XXX Ns Cm -commands
pseudo-commands were added in
.Nm OpenSSL
0.9.3;
the
.Cm no- Ns Ar XXX
pseudo-commands were added in
.Nm OpenSSL
0.9.5a.
.Pp
The
.Xr openssl 1
manual page appeared in
.Ox 3.3 ,
after that what is now the
.Xr openssltool 1
manual page got rejected - but eventually made its way into
.Mx .
@


1.14
log
@* merge OpenBSD 3.5-current
* re-sort entries in Makefile
  => not a bunch of adds any more; all alphabetic
  => remove obsolete SUBDIRS_ONLY_BSD for now
     (MirLinux won't come that soon due to a certain lawsuit,
      licence issues with unwillingly GNU fanatics, and my
      chronic unwillingness to do masochistic work)
* spacing, RCS IDs, etc.
* pkg gets folded into pkg_install, so we only have one dir
  to worry about
* pkg_add leaves the tree - nobody cared about this kind
  of package tools anyways, and they're not part of MirBSD
  (although still supported by MirPorts)
* mopd leaves - we don't have VAX support anyways
@
text
@d5572 1
d5576 3
@


1.13
log
@first part of mergeing OpenBSD and fixing whitespace and RCS IDs
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.31 2004/01/25 20:27:37 jmc Exp $
d113 1
a113 1
.\" ssl(1)
d493 1
a493 1
the default, is base64 encoded.
d509 2
a510 4
Output file to place the
.Em DER
encoded data into.
If this option is not present, then no encoded data will be output.
d631 1
a631 1
.Op Fl key Ar arg
d687 1
a687 1
If no extension section is present, then a V1 certificate is created.
d705 1
a705 1
.It Fl key Ar password
d1289 1
a1289 1
If care is not taken, then it can be a security risk.
d1364 1
a1364 1
If it is not included, then the default cipher list will be used.
d1422 1
a1422 1
If none of these characters is present, then the string is just interpreted
d1711 1
a1711 5
command processes CRL files in
.Ar DER
or
.Ar PEM
format.
d1718 1
a1718 1
.It Fl CApath Ar dir
d1736 1
a1736 1
format is a DER encoded CRL structure.
d1739 1
a1739 1
is a base64 encoded version of the DER form with header and footer lines.
d1769 1
a1769 4
Convert a CRL file from
.Ar PEM
to
.Ar DER :
d1773 1
a1773 3
Output the text form of a
.Ar DER
encoded certificate:
d1805 1
a1805 3
containing one or more certificates in
.Ar PEM
format.
d1812 1
a1812 1
to read a CRL from or standard input if this option is not specified.
d1816 1
a1816 1
format is a DER encoded CRL structure.
d1819 1
a1819 1
is a base64 encoded version of the DER form with header and footer lines.
d1827 1
a1827 1
to write the PKCS#7 structure to or standard output by default.
d1831 1
a1831 1
format is a DER encoded PKCS#7 structure.
d1834 1
a1834 1
is a base64 encoded version of the DER form with header and footer lines.
d1841 1
a1841 3
Create a PKCS#7 structure in
.Ar DER
format with no CRL from several
d1853 1
a1853 1
This involves sending the DER encoded output
d1857 1
a1857 3
The
.Ar PEM
encoded form with the header and footer lines removed can be used to
d1960 1
a1960 1
If you wish to sign or verify data using the DSA algorithm, then the dss1
d2010 1
a2010 1
If present, then the input file is ignored and parameters are generated instead.
d2046 1
a2046 1
to read parameters from or standard input if this option is not specified.
d2051 1
a2051 1
uses an ASN1 DER encoded form compatible with the PKCS#3 DHparameter
d2056 1
a2056 1
it consists of the DER format base64 encoded with
d2064 2
a2065 2
If not present, then a value of 512 is used.
If this value is present, then the input file is ignored and
d2107 1
a2107 2
.Ar PEM
format DH parameters use the header and footer lines:
d2184 1
a2184 3
These options can only be used with
.Ar PEM
format output files.
d2196 1
a2196 1
to read a key from or standard input if this option is not specified.
d2202 1
a2202 1
argument with a private key uses an ASN1 DER encoded form of an ASN.1
d2214 2
a2215 2
it consists of the DER format base64
encoded with additional header and footer lines.
d2259 1
a2259 3
The
.Ar PEM
private key format uses the header and footer lines:
d2265 1
a2265 3
The
.Ar PEM
public key format uses the header and footer lines:
d2342 1
a2342 1
argument uses an ASN1 DER encoded form compatible with RFC 2459
d2348 1
a2348 1
it consists of the DER format base64 encoded with additional header
d2355 1
a2355 2
It must be the last option.
If this option is included, then the input file
d2380 1
a2380 2
.Ar PEM
format DSA parameters use the header and footer lines:
d2426 1
a2426 1
This means that if encryption is taking place, the data is base64 encoded
d2428 1
a2428 1
If decryption is set, then the input data is base64 decoded before
d2614 1
a2614 1
If padding is disabled, then the input data must be a multiple of the cipher
d2941 1
a2941 1
to read or standard input if this option is not specified.
d2944 1
a2944 1
.Ar file
d2965 1
a2965 3
The
.Em PEM
encoded form uses the same headers and footers as a certificate:
d2977 3
a2979 6
This program needs a few more options:
like allowing
.Em DER
or
.Em PEM
input and output files and allowing multiple certificate files to be used.
d3003 1
a3003 1
.Op Fl CApath Ar path
d3051 1
a3051 1
.It Fl CAfile Ar file , Fl CApath Ar path
d3083 1
a3083 3
must be in
.Ar PEM
format.
d3158 1
a3158 3
Write out the
.Ar DER
encoded certificate request or response to
d3183 1
a3183 1
If neither option is specified, then the OCSP request is not signed.
d3286 1
a3286 1
If neither option is present, then the
d3331 1
a3331 1
If the initial verify fails, then the OCSP verify process halts with an
d3346 1
a3346 1
If none of these checks is successful, then the OCSP verify fails.
d3539 1
a3539 4
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
.Op Fl in Ar file
.Op Fl out Ar file
a3541 1
.Op Fl noout
d3543 4
d3551 1
a3551 5
command processes PKCS#7 files in
.Em DER
or
.Em PEM
format.
d3555 12
d3570 1
a3570 1
format is a DER encoded PKCS#7 v1.5 structure.
d3573 10
a3582 1
is a base64 encoded version of the DER form with header and footer lines.
a3586 8
.It Fl in Ar file
This specifies the input
.Ar file
to read from or standard input if this option is not specified.
.It Fl out Ar file
Specifies the output
.Ar file
to write to or standard output by default.
d3589 1
a3589 1
They are preceded by their subject and issuer names in one line format.
a3592 13
.It Fl noout
Don't output the encoded version of the PKCS#7 structure
(or certificates if
.Fl print_certs
is set).
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs7
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d3595 1
a3595 4
Convert a PKCS#7 file from
.Em PEM
to
.Em DER :
d3603 1
a3603 3
The
.Em PEM
PKCS#7 format uses the header and footer lines:
d3625 5
d3631 2
d3634 1
a3635 1
.Op Fl in Ar file
a3636 1
.Op Fl out Ar file
d3638 1
a3638 5
.Op Fl noiter
.Op Fl nocrypt
.Op Fl nooct
.Op Fl embed
.Op Fl nsdb
a3639 2
.Op Fl v1 Ar alg
.Op Fl engine Ar id
d3652 22
a3673 7
.It Fl topk8
Normally, a PKCS#8 private key is expected on input and a traditional format
private key will be written.
With the
.Fl topk8
option the situation is reversed:
it reads a traditional format private key and writes a PKCS#8 format key.
d3678 2
a3679 40
.Em DER
or
.Em PEM
encoded version of a PKCS#8 key will be expected.
Otherwise the
.Em DER
or
.Em PEM
format of the traditional format private key is used.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from or standard input if this option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to or standard output by default.
If any encryption options are set then a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
d3683 2
a3684 2
structures using an appropriate password based encryption algorithm.
With this option an unencrypted
d3689 1
a3689 1
Certain software such as some versions of Java code signing software used
d3691 5
a3701 9
.It Fl embed
This option generates DSA keys in a broken format.
The DSA parameters are embedded inside the
.Em PrivateKey
structure.
In this form the OCTET STRING contains an ASN1 SEQUENCE consisting of
two structures:
a SEQUENCE containing the parameters and an ASN1 INTEGER containing
the private key.
d3708 36
d3746 1
a3746 1
Normally, PKCS#8 private keys are encrypted with the password based
d3762 2
a3763 2
argument is the encryption algorithm to use, valid values include
.Ar des , des3
a3768 11
.It Fl v1 Ar alg
This option specifies a PKCS#5 v1.5 or PKCS#12 algorithm to use.
A complete list of possible algorithms is included below.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs8
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d3771 1
a3771 3
The encrypted form of a
.Em PEM
encoded PKCS#8 file uses the following
d3785 1
a3785 1
counts are more secure that those encrypted using the traditional
d3788 1
a3788 1
So if additional security is considered, important the keys should be converted.
d3791 1
a3791 1
that most current implementations of PKCS#8 will support.
d3793 1
a3793 1
Some software may use PKCS#12 password based encryption algorithms
d3798 1
a3798 2
.Em DER
encoded encrypted private keys in PKCS#8 format because the encryption
d3800 1
a3800 3
level whereas the traditional format includes them at a
.Em PEM
level.
d3821 1
a3821 1
These algorithms use the PKCS#12 password based encryption algorithm and
d3841 1
a3841 1
Read a DER unencrypted PKCS#8 format private key:
d3859 1
a3859 1
it is hidden away in PKCS#11 v2.01, section 11.9.;
d3876 5
a3880 1
.Op Fl export
a3881 11
.Op Fl inkey Ar file
.Op Fl certfile Ar file
.Op Fl CApath Ar directory
.Op Fl CAfile Ar file
.Op Fl name Ar name
.Op Fl caname Ar name
.Op Fl in Ar file
.Op Fl out Ar file
.Op Fl noout
.Op Fl nomacver
.Op Fl nocerts
d3883 2
a3884 2
.Op Fl cacerts
.Op Fl nokeys
d3886 4
a3889 4
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
d3892 4
a3895 1
.Op Fl maciter
d3897 11
a3907 6
.Op Fl descert
.Op Fl certpbe
.Op Fl keypbe
.Op Fl keyex
.Op Fl keysig
.Op Fl password Ar arg
a3910 1
.Op Fl engine Ar id
d3930 13
d3948 14
d3966 2
a3967 4
They are all written in
.Em PEM
format.
.It Fl pass Ar arg , Fl passin Ar arg
a3982 27
.It Fl noout
This option inhibits output of the keys and certificates to the output file
version of the PKCS#12 file.
.It Fl clcerts
Only output client certificates
.Pq not CA certificates .
.It Fl cacerts
Only output CA certificates
.Pq not client certificates .
.It Fl nocerts
No certificates at all will be output.
.It Fl nokeys
No private keys will be output.
.It Fl info
Output additional information about the PKCS#12 file structure,
algorithms used and iteration counts.
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
Use DES, triple DES, or AES, respectively,
to encrypt private keys before outputting.
The default is triple DES.
.It Fl nodes
Don't encrypt the private keys at all.
.It Fl nomacver
Don't attempt to verify the integrity MAC before reading the file.
d3990 3
a3992 29
.It Fl export
This option specifies that a PKCS#12 file will be created rather than
parsed.
.It Fl out Ar file
This specifies
.Ar file
to write the PKCS#12 file to.
Standard output is used by default.
.It Fl in Ar file
The
.Ar file
to read certificates and private keys from, standard input by default.
They must all be in
.Em PEM
format.
The order doesn't matter but one private key and its corresponding
certificate should be present.
If additional certificates are present, they will also be included
in the PKCS#12 file.
.It Fl inkey Ar file
File to read private key from.
If not present then a private key must be present in the input file.
.It Fl name Ar friendlyname
This specifies the
.Qq friendly name
for the certificate and private key.
This name is typically displayed in list boxes by software importing the file.
.It Fl certfile Ar file
A file to read additional certificates from.
d3996 1
a3996 4
.It Fl CAfile Ar file
File of CAs
.Pq PEM format .
.It Fl caname Ar friendlyname
d4004 10
a4013 16
.It Fl pass Ar arg , Fl passout Ar arg
The PKCS#12 file
.Pq i.e. output file
password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passin Ar password
Pass phrase source to decrypt any input private keys with.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
d4015 1
a4015 1
If this option is present, then an attempt is made to include the entire
d4026 23
a4048 8
.It Fl keypbe Ar alg , Fl certpbe Ar alg
These options allow the algorithm used to encrypt the private key and
certificates to be selected.
Although any PKCS#5 v1.5 or PKCS#12 algorithms can be selected,
it is advisable to only use PKCS#12 algorithms.
See the list in the
.Sx PKCS12 NOTES
section for more information.
d4064 8
d4091 21
a4111 3
.It Fl maciter
This option is included for compatibility with previous versions; it used
to be needed to use MAC iterations counts but they are now used by default.
a4118 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs12
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d4148 1
a4148 1
If the CA certificates are required, then they can be output to a separate
d4240 2
a4243 2
.Op Fl base64
.Op Fl engine Ar id
a4269 10
.It Fl out Ar file
Write to
.Ar file
instead of standard output.
.It Fl rand Ar file ...
Use specified file or files, or EGD socket (see
.Xr RAND_egd 3 )
for seeding the random number generator.
Multiple files can be specified separated by a
.Sq \&: .
d4282 10
d4299 10
a4308 6
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
.Op Fl in Ar file
.Op Fl passin Ar arg
.Op Fl out Ar file
.Op Fl passout Ar arg
d4310 2
a4311 2
.Op Fl pubkey
.Op Fl noout
d4313 11
a4323 3
.Op Fl modulus
.Op Fl new
.Op Fl rand Ar file ...
d4326 1
a4326 1
.Ar rsa : Ns Ar bits
d4331 1
a4331 1
.Ar dsa : Ns Ar file
d4334 8
a4341 7
.Op Fl nodes
.Op Fl subject
.Op Fl key Ar file
.Op Fl keyform Ar DER | PEM
.Op Fl keyout Ar file
.Op Fl md5 | sha1 | md2 | md4
.Op Fl config Ar file
d4343 7
a4349 19
.Op Fl x509
.Op Fl days Ar n
.Op Fl set_serial Ar n
.Op Fl asn1-kludge
.Op Fl newhdr
.Op Fl extensions Ar section
.Op Fl reqexts Ar section
.Op Fl utf8
.Op Fl nameopt
.Op Fl batch
.Op Fl verbose
.Op Fl engine Ar id
.Ek
.Pp
The
.Nm req
command primarily creates and processes certificate requests
in PKCS#10 format.
It can additionally create self-signed certificates,
d4354 50
a4403 15
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument uses an ASN1 DER encoded
form compatible with the PKCS#10.
The
.Ar PEM
form is the default format:
it consists of the DER format base64 encoded with additional header and
footer lines.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
d4414 21
a4434 9
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl out Ar file
This specifies the output
d4436 7
a4442 14
to write to, or standard output by default.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl text
Prints out the certificate request in text form.
.It Fl pubkey
Outputs the public key.
.It Fl noout
This option prevents output of the encoded version of the request.
d4446 9
a4454 2
.It Fl verify
Verifies the signature on the request.
d4465 6
a4470 6
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
a4482 17
.It Fl key Ar file
This specifies the file to read the private key from.
It also accepts PKCS#8 format private keys for
.Em PEM
format files.
.It Fl keyform Ar DER | PEM
The format of the private key file specified in the
.Fl key
argument.
.Ar PEM
is the default.
.It Fl keyout Ar file
This gives the
.Ar file
to write the newly created private key to.
If this option is not specified, then the filename present in the
configuration file is used.
d4486 37
a4522 12
.It Fl subject
Output the request's subject.
.It Fl md5 | sha1 | md2 | md4
This specifies the message digest to sign the request with.
This overrides the digest algorithm specified in the configuration file.
This option is ignored for DSA requests: they always use SHA1.
.It Fl config Ar file
This allows an alternative configuration file to be specified;
this overrides the compile time filename or any specified in
the
.Ev OPENSSL_CONF
environment variable.
d4532 13
a4555 74
.It Fl days Ar n
When the
.Fl x509
option is being used, this specifies the number of
days to certify the certificate for.
The default is 30 days.
.It Fl set_serial Ar n
Serial number to use when outputting a self-signed certificate.
This may be specified as a decimal value or a hex value if preceded by
.Sq 0x .
It is possible to use negative serial numbers but this is not recommended.
.It Fl extensions Ar section , Fl reqexts Ar section
These options specify alternative sections to include certificate
extensions (if the
.Fl x509
option is present) or certificate request extensions.
This allows several different sections to
be used in the same configuration file to specify requests for
a variety of purposes.
.It Fl utf8
This option causes field values to be interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
.It Fl nameopt Ar option
Option which determines how the subject or issuer names are displayed.
The
.Ar option
argument can be a single option or multiple options separated by commas.
Alternatively, the
.Fl nameopt
switch may be used more than once to set multiple options.
See the
.Sx X509
section below for details.
.It Fl asn1-kludge
By default, the
.Nm req
command outputs certificate requests containing
no attributes in the correct PKCS#10 format.
However certain CAs will only
accept requests containing no attributes in an invalid form: this
option produces this invalid format.
.Pp
More precisely, the
.Em Attributes
in a PKCS#10 certificate request are defined as a SET OF Attribute.
They are
.Em not
optional, so if no attributes are present then they should be encoded as an
empty SET OF.
The invalid form does not include the empty
SET OF, whereas the correct form does.
.Pp
It should be noted that very few CAs still require the use of this option.
.It Fl newhdr
Adds the word NEW to the
.Em PEM
file header and footer lines on the outputed request.
Some software
.Pq Netscape certificate server
and some CAs need this.
.It Fl batch
Non-interactive mode.
.It Fl verbose
Print extra details about the operations being performed.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d4570 12
a4581 10
.It Ar input_password | output_password
The passwords for the input private key file
.Pq if present
and the output private key file
.Pq if one will be created .
The command line options
.Fl passin
and
.Fl passout
override the configuration file values.
d4584 1
a4584 1
If not specified, then 512 is used.
d4597 34
d4644 10
d4659 6
a4664 20
.It Ar encrypt_key
If this is set to
.Em no
and a private key is generated, it is
.Em not
encrypted.
This is equivalent to the
.Fl nodes
command line option.
For compatibility,
.Ar encrypt_rsa_key
is an equivalent option.
.It Ar default_md
This option specifies the digest algorithm to use.
Possible values include
.Ar md5
and
.Ar sha1 .
If not present, then MD5 is used.
This option can be overridden on the command line.
d4700 7
a4706 6
.It Ar req_extensions
This specifies the configuration file section containing a list of
extensions to add to the certificate request.
It can be overridden by the
.Fl reqexts
command line switch.
a4714 33
.It Ar prompt
If set to the value
.Em no ,
this disables prompting of certificate fields
and just takes values from the config file directly.
It also changes the expected format of the
.Em distinguished_name
and
.Em attributes
sections.
.It Ar utf8
If set to the value
.Em yes ,
then field values are interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
.It Ar attributes
This specifies the section containing any request attributes: its format
is the same as
.Ar distinguished_name .
Typically these may contain the
.Em challengePassword
or
.Em unstructuredName
types.
They are currently ignored by
.Nm OpenSSL Ns Li 's
request signing utilities, but some CAs might want them.
.It Ar distinguished_name
This specifies the section containing the distinguished name fields to
prompt for when generating a certificate or certificate request.
The format is described in the next section.
d4759 2
a4760 2
If the user enters nothing, then the default value is used;
if no default value is present, then the field is omitted.
d4812 1
a4812 1
Examine and verify certificate request:
d4910 1
a4910 3
The header and footer lines in the
.Ar PEM
format are normally:
a5019 7
.Op Fl inform Ar DER | NET | PEM
.Op Fl outform Ar DER | NET | PEM
.Op Fl in Ar file
.Op Fl passin Ar arg
.Op Fl out Ar file
.Op Fl passout Ar arg
.Op Fl sgckey
d5021 2
a5022 2
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
d5024 2
a5025 1
.Op Fl text
a5026 2
.Op Fl modulus
.Op Fl check
d5029 2
d5032 6
d5055 30
d5090 1
a5090 1
uses an ASN1 DER encoded form compatible with the PKCS#1
d5094 2
a5095 2
form is the default format: it consists of the DER format base64
encoded with additional header and footer lines.
d5097 17
a5113 5
The
.Ar NET
form is a format described in the
.Sx RSA NOTES
section.
a5117 6
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from or standard input if this
option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
d5125 1
a5125 9
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output if this option is not specified.
If any encryption options are set then, a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl passout Ar password
d5132 7
a5142 16
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
These options encrypt the private key with the DES, triple DES, or the
AES ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified the key is written in plain text.
This means that using the
.Nm rsa
utility to read in an encrypted key with no encryption option can be used
to remove the pass phrase from a key, or by setting the encryption options
it can be used to add or change the pass phrase.
These options can only be used with
.Ar PEM
format output files.
a5145 21
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl modulus
This option prints out the value of the modulus of the key.
.It Fl check
This option checks the consistency of an RSA private key.
.It Fl pubin
By default, a private key is read from the input file: with this
option a public key is read instead.
.It Fl pubout
By default, a private key is output:
with this option a public key will be output instead.
This option is automatically set if the input is a public key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d5148 1
a5148 3
The
.Em PEM
private key format uses the header and footer lines:
d5154 1
a5154 3
The
.Em PEM
public key format uses the header and footer lines:
d5192 1
a5192 5
To convert a private key from
.Em PEM
to
.Em DER
format:
d5216 6
a5221 4
.Op Fl in Ar file
.Op Fl out Ar file
.Op Fl inkey Ar file
.Op Fl keyform Ar DER | PEM
a5222 1
.Op Fl certin
a5224 5
.Op Fl encrypt
.Op Fl decrypt
.Op Fl pkcs | oaep | ssl | raw
.Op Fl hexdump
.Op Fl asn1parse
d5226 4
d5239 20
d5262 1
a5262 1
to read data from or standard input
a5263 5
.It Fl out Ar file
Specifies the output
.Ar file
to write to or standard output by
default.
d5270 16
a5287 2
.It Fl certin
The input is a certificate containing an RSA public key.
a5292 28
.It Fl encrypt
Encrypt the input data using an RSA public key.
.It Fl decrypt
Decrypt the input data using an RSA private key.
.It Fl pkcs | oaep | ssl | raw
The padding to use: PKCS#1 v1.5
.Pq the default ,
PKCS#1 OAEP, special padding used in SSL v2 backwards compatible handshakes,
or no padding, respectively.
For signatures, only
.Fl pkcs
and
.Fl raw
can be used.
.It Fl hexdump
Hex dump the output data.
.It Fl asn1parse
Asn1parse the output data; this is useful when combined with the
.Fl verify
option.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsautl
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d5364 1
a5364 1
.Dl $ openssl x509 -in test/testx509.pem -pubout -noout >pubkey.pem
d5381 1
a5381 1
It can be seen that the digest used was md5.
d5398 3
a5400 12
.Oo
.Fl connect Ar host : Ns Ar port
.Oc
.Op Fl verify Ar depth
.Op Fl cert Ar file
.Op Fl key Ar file
.Op Fl CApath Ar directory
.Op Fl CAfile Ar file
.Op Fl reconnect
.Op Fl pause
.Op Fl showcerts
.Op Fl prexit
d5402 1
d5404 1
d5406 5
a5410 4
.Op Fl state
.Op Fl nbio
.Op Fl crlf
.Op Fl ign_eof
d5412 3
d5417 1
d5419 3
a5421 5
.Op Fl no_ssl2
.Op Fl no_ssl3
.Op Fl no_tls1
.Op Fl bugs
.Op Fl serverpref
d5423 4
a5426 1
.Op Fl starttls Ar protocol
d5428 1
d5430 2
d5444 36
d5481 2
a5482 1
.Fl connect Ar host : Ns Ar port
d5489 1
a5489 1
If not specified, then an attempt is made to connect to the local host
d5491 19
a5509 3
.It Fl cert Ar certname
The certificate to use, if one is requested by the server.
The default is not to use a certificate.
d5512 22
a5533 29
If not specified, then the certificate file will be used.
.It Fl verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the
server certificate chain and turns on server certificate verification.
Currently the verify operation continues after errors so all the problems
with a certificate chain can be seen.
As a side effect the connection will never fail due to a server
certificate verify failure.
.It Fl CApath Ar directory
The
.Ar directory
to use for server certificate verification.
This directory must be in
.Qq hash format ;
see
.Fl verify
for more information.
These are also used when building the client certificate chain.
.It Fl CAfile Ar file
A
.Ar file
containing trusted certificates to use during server authentication
and to use when attempting to build the client certificate chain.
.It Fl reconnect
Reconnects to the same server 5 times using the same session ID; this can
be used as a test that session caching is working.
a5535 3
.It Fl showcerts
Display the whole server certificate chain: normally only the server
certificate itself is displayed.
a5546 16
.It Fl state
Prints out the SSL session states.
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio_test
Tests non-blocking I/O.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF as required
by some servers.
.It Fl ign_eof
Inhibit shutting down the connection when end of file is reached in the
input.
d5552 9
a5560 18
.It Xo
.Fl ssl2 | ssl3 | tls1 |
.Fl no_ssl2 | no_ssl3 | no_tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2 or TLS as appropriate.
.Pp
Unfortunately there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.
Some servers only work if TLS is turned off with the
.Fl no_tls
option, others will only support SSL v2 and may need the
.Fl ssl2
option.
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
d5564 3
a5566 7
.It Fl cipher Ar cipherlist
This allows the cipher list sent by the client to be modified.
Although the server determines which cipher suite is used, it should take
the first supported cipher in the list sent by the client.
See the
.Sx CIPHERS
section above for more information.
d5575 12
a5586 14
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_client
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
d5589 1
a5589 1
If a connection is established with an SSL server, then any data received
d5610 1
a5610 1
If the connection succeeds, then an HTTP command can be given such as
d5614 1
a5614 1
If the handshake fails, then there are several possible causes; if it is
d5617 1
a5617 1
.Fl no_ssl2 , no_ssl3
d5641 1
a5641 1
command and send an HTTP request for an appropriate page.
d5650 1
a5650 1
If there are problems verifying a server certificate, then the
d5674 1
a5674 11
.Op Fl accept Ar port
.Op Fl context Ar id
.Op Fl verify Ar depth
.Op Fl Verify Ar depth
.Op Fl cert Ar file
.Op Fl key Ar keyfile
.Op Fl dcert Ar file
.Op Fl dkey Ar keyfile
.Op Fl dhparam Ar file
.Op Fl nbio
.Op Fl nbio_test
d5677 2
d5680 7
a5686 3
.Op Fl state
.Op Fl CApath Ar directory
.Op Fl CAfile Ar file
d5688 1
a5688 1
.Op Fl cipher Ar cipherlist
a5689 2
.Op Fl quiet
.Op Fl no_tmp_rsa
d5692 1
d5694 1
a5694 6
.Op Fl no_ssl2
.Op Fl no_ssl3
.Op Fl no_tls1
.Op Fl no_dhe
.Op Fl bugs
.Op Fl hack
d5696 9
a5704 2
.Op Fl WWW
.Op Fl HTTP
d5707 1
d5709 2
d5725 19
a5743 5
.It Fl context Ar id
Sets the SSL context id.
It can be given any string value.
If this option is not present, a default value will be used.
.It Fl cert Ar certname
d5749 1
a5749 1
If not specified, then the file
d5752 16
a5767 4
.It Fl key Ar keyfile
The private key to use.
If not specified, then the certificate file will be used.
.It Fl dcert Ar file , Fl dkey Ar keyname
d5774 1
a5774 1
.Pq no additional certificate and key is used .
d5781 1
a5781 1
By using RSA and DSS certificates and keys
d5784 2
a5785 4
.It Fl nocert
If this option is set, then no certificate is used.
This restricts the cipher suites available to the anonymous ones
.Pq currently just anonymous DH .
d5790 1
a5790 1
If not specified, then an attempt is made to
d5792 1
a5792 1
If this fails then a static set of parameters hard coded into the
d5795 8
a5802 57
.It Fl no_dhe
If this option is set, then no DH parameters will be loaded, effectively
disabling the ephemeral DH cipher suites.
.It Fl no_tmp_rsa
Certain export cipher suites sometimes use a temporary RSA key; this option
disables temporary RSA key generation.
.It Fl verify Ar depth , Fl Verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the client certificate chain
and makes the server request a certificate from the client.
With the
.Fl verify
option, a certificate is requested but the client does not have to send one.
With the
.Fl Verify
option, the client must supply a certificate or an error occurs.
.It Fl CApath Ar directory
The
.Ar directory
to use for client certificate verification.
This directory must be in
.Qq hash format ;
see
.Fl verify
for more information.
These are also used when building the server certificate chain.
.It Fl CAfile Ar file
A file containing trusted certificates to use during client authentication
and to use when attempting to build the server certificate chain.
The list is also used in the list of acceptable client CAs passed to the
client when a certificate is requested.
.It Fl state
Prints out the SSL session states.
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio_test
Tests non-blocking I/O.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF.
.It Fl quiet
Inhibit printing of session and certificate information.
.It Xo
.Fl ssl2 | ssl3 | tls1 |
.Fl no_ssl2 | no_ssl3 | no_tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2 or TLS as appropriate.
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
d5807 1
a5807 18
.It Fl cipher Ar cipherlist
This allows the cipher list used by the server to be modified.
When the client sends a list of supported ciphers, the first client cipher
also included in the server list is used.
Because the client specifies the preference order, the order of the server
cipherlist is irrelevant.
See the
.Sx CIPHERS
section for more information.
.It Fl serverpref
Use server's cipher preferences.
.It Fl www
Sends a status message back to the client when it connects.
This includes lots of information about the ciphers used and various
session parameters.
The output is in HTML format so this option will normally be used with a
web browser.
.It Fl WWW
a5814 8
.It Fl HTTP
Emulates a simple web server.
Pages will be resolved relative to the current directory;
for example if the URL
.Pa https://myhost/page.html
is requested the file
.Pa ./page.html
will be loaded.
a5817 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_server
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d5826 28
d5860 30
d5902 5
d5909 2
a5910 2
.It Ar Q
End the current SSL connection and exit.
a5912 5
.It Ar R
Renegotiate the SSL session and request a client certificate.
.It Ar P
Send some plain text down the underlying TCP connection: this should
cause the client to disconnect due to a protocol violation.
d5923 1
a5923 1
can be used for example.
d5959 19
d5979 105
d6085 65
a6149 1
utility is currently undocumented.
a6155 5
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
.Op Fl in Ar file
.Op Fl out Ar file
.Op Fl text
d6158 1
d6160 4
d6177 18
d6199 1
a6199 1
argument uses an ASN1 DER encoded
d6205 3
a6207 9
format base64 encoded with additional header and footer lines.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar file
This specifies the input
.Ar file
to read session information from, or standard input by default.
d6213 4
a6219 16
.It Fl cert
If a certificate is present in the session,
it will be output using this option;
if the
.Fl text
option is also present, then it will be printed out in text form.
.It Fl noout
This option prevents output of the encoded version of the session.
.It Fl context Ar ID
This option can set the session ID so the output session information uses the
supplied
.Ar ID .
The
.Ar ID
can be any string of characters.
This option won't normally be used.
d6223 11
a6233 11
.Bd -unfilled
\& SSL-Session:
\&     Protocol  : TLSv1
\&     Cipher    : 0016
\&     Session-ID: 871E62626C554CE95488823752CBD5F3673A3EF3DCE9C67BD916C809914B40ED
\&     Session-ID-ctx: 01000000
\&     Master-Key: A7CEFC571974BE02CAC305269DC59F76EA9F0B180CB6642697A68251F2D2BB57E51DBBB4C7885573192AE9AEE220FACD
\&     Key-Arg   : None
\&     Start Time: 948459261
\&     Timeout   : 300 (sec)
\&     Verify return code 0 (ok)
d6237 2
a6238 1
.Bl -tag -width "XXXX"
d6240 1
a6240 1
This is the protocol in use: TLSv1, SSLv3 or SSLv2.
d6262 1
a6262 3
The
.Em PEM
encoded session format uses the header and footer lines:
d6363 1
a6363 3
Takes an input message and writes out a
.Em PEM
encoded PKCS#7 structure.
d6376 1
a6376 1
.Em PEM
d6378 1
a6378 1
.Em DER
d6398 1
a6398 1
.Em PEM
d6400 1
a6400 1
.Em DER
d6435 1
a6435 1
.It Fl CApath Ar dir
d6506 1
a6506 3
The certificates should be in
.Em PEM
format.
d6509 1
a6509 1
If a message is being verified, then the signer's certificates will be
d6518 1
a6518 1
If this option is not specified, then the private key must be included
d6561 1
a6561 1
If signing, then many
d6698 1
a6698 1
base64 encoded structure and surrounding it with:
d6788 1
a6788 1
.It Cm [zero or more test algorithms]
d6846 1
a6846 1
to read from or standard input if this option is not specified.
d6853 1
a6853 1
to write to or standard output by default.
d6986 1
a6986 3
should contain multiple certificates in
.Em PEM
format concatenated together.
d7035 1
a7035 1
If no certificate files are included, then an attempt is made to read
d7037 1
a7037 3
They should all be in
.Em PEM
format.
d7121 1
a7121 1
If all operations complete successfully, then the certificate is considered
d7278 1
a7278 1
If they occur in both, then only the certificates in the file will
d7418 1
a7418 1
to read a certificate from or standard input if this option is not specified.
d7422 1
a7422 1
to write to or standard output by default.
d7438 2
a7439 2
If not specified, then MD5 is used.
If the key being used to sign with is a DSA key, then
d7524 1
a7524 1
Prints out the digest of the DER encoded version of the whole certificate
d7633 1
a7633 1
If the input is a certificate request, then a self-signed certificate
d7704 1
a7704 1
If this option is not specified, then it is assumed that the CA private key
d7737 1
a7737 1
If not specified, then no extensions are added to the certificate.
d7740 1
a7740 1
If this option is not specified, then the extensions should either be
d7791 1
a7791 1
.Dq \&\ \&,+"<>\&; .
d7818 2
a7819 2
If you are lucky enough to have a UTF8 compatible terminal, then the use
of this option (and
d7826 1
a7826 1
If this option is not present, then multibyte characters larger than 0xff
d7851 1
a7851 1
if this option is not set, then non-character string types will be displayed
d7998 1
a7998 5
Convert a certificate from
.Em PEM
to
.Em DER
format:
d8030 1
a8030 3
The
.Em PEM
format uses the header and footer lines:
d8056 1
a8056 1
option takes the digest of the DER encoded certificate.
d8087 2
a8088 2
If the CA flag is true, then it is a CA;
if the CA flag is false, then it is not a CA.
@


1.12
log
@remaining merges and bump patchlevel until after mbr/ext change
@
text
@d1 1
a1 2
.\" $MirBSD: openssl.1,v 1.11 2003/12/27 00:31:55 tg Exp $
.\" $OpenBSD: openssl.1,v 1.28 2003/12/29 13:44:43 jmc Exp $
d426 1
a426 1
.It Ar file : Ns Ar pathname
d428 1
a428 1
.Ar pathname
d431 1
a431 1
.Ar pathname
d438 1
a438 1
.Ar pathname
d458 1
a458 1
.Op Fl in Ar filename
d462 2
a463 2
.Op Fl oid Ar filename
.Op Fl out Ar filename
d484 1
a484 1
.It Fl in Ar filename
d502 1
a502 1
.It Fl oid Ar filename
d508 1
a508 1
.It Fl out Ar filename
d619 1
a619 1
.Op Fl config Ar filename
d666 1
a666 1
.It Fl config Ar filename
d700 1
a700 1
.It Fl in Ar filename
d702 1
a702 1
.Ar filename
d715 1
a715 1
.It Fl keyfile Ar filename
d758 1
a758 1
.It Fl out Ar filename
d766 1
a766 1
The certificate will be written to a filename consisting of the
d794 1
a794 1
.It Fl spkac Ar filename
d800 1
a800 1
.It Fl ss_cert Ar filename
d868 1
a868 1
.It Fl revoke Ar filename
d870 1
a870 1
.Ar filename
d1705 1
a1705 1
.Op Fl in Ar filename
d1707 1
a1707 1
.Op Fl out Ar filename
d1736 2
a1737 2
.It Fl in Ar filename
This specifies the input filename to read from, or standard input if this
d1758 2
a1759 2
.It Fl out Ar filename
Specifies the output filename to write to, or standard output by
d1797 2
a1798 2
.Op Fl certfile Ar filename
.Op Fl in Ar filename
d1800 1
a1800 1
.Op Fl out Ar filename
d1813 1
a1813 1
.It Fl certfile Ar filename
d1815 1
a1815 1
.Ar filename
d1822 1
a1822 1
.It Fl in Ar filename
d1824 1
a1824 1
.Ar filename
d1837 1
a1837 1
.It Fl out Ar filename
d1839 1
a1839 1
.Ar filename
d1892 2
a1893 2
.Op Fl out Ar filename
.Op Fl prverify Ar filename
d1895 3
a1897 3
.Op Fl sign Ar filename
.Op Fl signature Ar filename
.Op Fl verify Ar filename
d1942 3
a1944 3
.It Fl out Ar filename
Filename to output to, or standard output by default.
.It Fl prverify Ar filename
d1946 1
a1946 1
.Ar filename .
d1957 1
a1957 1
.It Fl sign Ar filename
d1959 2
a1960 2
.Ar filename .
.It Fl signature Ar filename
d1962 1
a1962 1
.It Fl verify Ar filename
d1964 1
a1964 1
.Ar filename .
d2010 1
a2010 1
.Op Fl in Ar filename
d2012 1
a2012 1
.Op Fl out Ar filename
d2060 1
a2060 1
.It Fl in Ar filename
d2062 1
a2062 1
.Ar filename
d2084 1
a2084 1
.It Fl out Ar filename
d2086 1
a2086 1
.Ar filename
d2165 1
a2165 1
.Op Fl in Ar filename
d2167 1
a2167 1
.Op Fl out Ar filename
d2213 1
a2213 1
.It Fl in Ar filename
d2215 1
a2215 1
.Ar filename
d2241 1
a2241 1
.It Fl out Ar filename
d2243 1
a2243 1
.Ar filename
d2325 1
a2325 1
.Op Fl in Ar filename
d2327 1
a2327 1
.Op Fl out Ar filename
d2355 1
a2355 1
.It Fl in Ar filename
d2357 1
a2357 1
.Ar filename
d2383 1
a2383 1
.It Fl out Ar filename
d2385 1
a2385 1
.Ar filename
d2428 1
a2428 1
.Op Fl in Ar filename
d2432 2
a2433 2
.Op Fl kfile Ar filename
.Op Fl out Ar filename
d2472 1
a2472 1
.It Fl in Ar filename
d2474 1
a2474 1
.Ar filename ;
d2527 1
a2527 1
.It Fl kfile Ar filename
d2529 1
a2529 1
.Ar filename .
d2545 1
a2545 1
.It Fl out Ar filename
d2547 1
a2547 1
.Ar filename ,
d2782 1
a2782 1
Print debugging statistics about various aspects of the hash table. 
d2805 1
a2805 1
.Op Fl out Ar filename
d2835 1
a2835 1
.It Fl out Ar filename
d2837 1
a2837 1
.Ar filename .
d2867 1
a2867 1
.Op Fl out Ar filename
d2905 1
a2905 1
.It Fl out Ar filename
d2907 1
a2907 1
.Ar filename .
a2950 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d2952 2
d2963 2
a2964 2
.Bl -tag -width "XXXX"
.It Fl in Ar filename
d2966 1
a2966 1
.Ar filename
d2968 1
a2968 1
.It Fl out Ar filename
d2970 1
a2970 1
.Ar filename
d3003 1
a3003 1
It is used by Netscape certificate server for example.
d3017 2
a3018 7
.Op Fl out Ar file
.Op Fl issuer Ar file
.Op Fl cert Ar file
.Op Fl serial Ar n
.Op Fl signer Ar file
.Op Fl signkey Ar file
.Op Fl sign_other Ar file
d3020 6
d3027 2
d3031 5
a3035 7
.Op Fl reqout Ar file
.Op Fl respout Ar file
.Op Fl reqin Ar file
.Op Fl respin Ar file
.Op Fl nonce
.Op Fl no_nonce
.Op Fl url Ar URL
d3040 21
a3060 3
.Op Fl path
.Op Fl CApath Ar dir
.Op Fl CAfile Ar file
d3062 1
a3062 3
.Op Fl validity_period Ar n
.Op Fl status_age Ar n
.Op Fl noverify
a3063 17
.Op Fl trust_other
.Op Fl no_intern
.Op Fl no_signature_verify
.Op Fl no_cert_verify
.Op Fl no_chain
.Op Fl no_cert_checks
.Op Fl port Ar num
.Op Fl index Ar file
.Op Fl CA Ar file
.Op Fl rsigner Ar file
.Op Fl rkey Ar file
.Op Fl rother Ar file
.Op Fl resp_no_certs
.Op Fl nmin Ar n
.Op Fl ndays Ar n
.Op Fl resp_key_id
.Op Fl nrequest Ar n
d3082 28
a3109 5
.It Fl out Ar filename
Specify output
.Ar filename ,
default is standard output.
.It Fl issuer Ar filename
d3113 1
a3113 1
.Ar filename
d3117 26
a3142 31
.It Fl cert Ar filename
Add the certificate
.Ar filename
to the request.
The issuer certificate is taken from the previous
.Fl issuer
option, or an error occurs if no issuer certificate is specified.
.It Fl serial Ar num
Same as the
.Fl cert
option except the certificate with serial number
.Ar num
is added to the request.
The serial number is interpreted as a decimal integer unless preceded by
.Sq 0x .
Negative integers can also be specified by preceding the value with a
.Sq -
sign.
.It Fl signer Ar filename , Fl signkey Ar filename
Sign the OCSP request using the certificate specified in the
.Fl signer
option and the private key specified by the
.Fl signkey
option.
If the
.Fl signkey
option is not present, then the private key is read from the same file
as the certificate.
If neither option is specified, then the OCSP request is not signed.
.It Fl sign_other Ar filename
Additional certificates to include in the signed request.
d3168 10
a3179 3
.It Fl reqout Ar file , Fl respout Ar file
Write out the DER encoded certificate request or response to
.Ar file .
d3186 1
a3186 1
.Fl serial , cert
d3190 24
a3213 9
.It Fl url Ar responder_url
Specify the responder URL.
Both HTTP and HTTPS
.Pq SSL/TLS
URLs can be specified.
.It Xo
.Fl host Ar hostname : Ns Ar port ,
.Fl path Ar pathname
.Xc
d3215 4
a3218 21
.Fl host
option is present, then the OCSP request is sent to the host
.Ar hostname
on port
.Ar port .
.Fl path
specifies the HTTP path name to use, or
.Sq /
by default.
.It Fl CAfile Ar file , Fl CApath Ar pathname
.Ar file
or
.Ar pathname
containing trusted CA certificates.
These are used to verify the signature on the OCSP response.
.It Fl verify_other Ar file
.Ar file
containing additional certificates to search when attempting to locate
the OCSP response signing certificate.
Some responders omit the actual signer's certificate from the response:
this option can be used to supply the necessary certificate in such cases.
d3226 5
a3238 30
.It Fl noverify
Don't attempt to verify the OCSP response signature or the
.Em nonce
values.
This option will normally only be used for debugging
since it disables all verification of the responders certificate.
.It Fl no_intern
Ignore certificates contained in the OCSP response
when searching for the signer's certificate.
With this option the signer's certificate must be specified with either the
.Fl verify_certs
or
.Fl VAfile
options.
.It Fl no_signature_verify
Don't check the signature on the OCSP response.
Since this option tolerates invalid signatures on OCSP responses,
it will normally only be used for testing purposes.
.It Fl no_cert_verify
Don't verify the OCSP response signer's certificate at all.
Since this option allows the OCSP response to be signed by any certificate,
it should only be used for testing purposes.
.It Fl no_chain
Do not use certificates in the response as additional untrusted CA
certificates.
.It Fl no_cert_checks
Don't perform any additional checks on the OCSP response signer's certificate.
That is, do not make any checks to see if the signer's certificate is
authorised to provide the necessary status information:
as a result this option should only be used for testing purposes.
d3266 6
d3275 3
a3312 26
.It Fl CA Ar file
CA certificate corresponding to the revocation information in
.Ar indexfile .
.It Fl rsigner Ar file
The certificate to sign OCSP responses with.
.It Fl rother Ar file
Additional certificates to include in the OCSP response.
.It Fl resp_no_certs
Don't include any certificates in the OCSP response.
.It Fl resp_key_id
Identify the signer certificate using the key ID,
default is to use the subject name.
.It Fl rkey Ar file
The private key to sign OCSP responses with;
if not present, the file specified in the
.Fl rsigner
option is used.
.It Fl port Ar portnum
Port to listen for OCSP requests on.
The port may also be specified using the
.Fl url
option.
.It Fl nrequest Ar number
The OCSP server will exit after receiving
.Ar number
requests, default unlimited.
d3324 23
d3444 1
a3444 1
Read in an OCSP response and print out text form:
d3469 2
a3470 2
Query status information using request read from a file, write response to a
second file:
d3480 1
a3480 6
.Op Fl crypt
.Op Fl 1
.Op Fl apr1
.Op Fl salt Ar string
.Op Fl in Ar file
.Op Fl stdin
d3483 2
d3486 2
a3487 1
.Op Fl reverse
a3514 5
.It Fl crypt
Use the
.Em crypt
algorithm
.Pq default .
d3527 17
a3548 3
.It Fl in Ar file
Read passwords from
.Ar file .
a3551 4
.It Fl noverify
Don't verify when reading a password from the terminal.
.It Fl quiet
Don't output warnings when passwords given on the command line are truncated.
a3554 2
.It Fl reverse
Switch table columns.
d3576 2
a3577 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d3605 1
a3605 1
.It Fl in Ar filename
d3607 1
a3607 1
.Ar filename
d3609 1
a3609 1
.It Fl out Ar filename
d3611 1
a3611 1
.Ar filename
d3672 1
a3672 1
.Op Fl in Ar filename
d3674 1
a3674 1
.Op Fl out Ar filename
d3720 1
a3720 1
.It Fl in Ar filename
d3722 1
a3722 1
.Ar filename
d3732 1
a3732 1
.It Fl out Ar filename
d3734 1
a3734 1
.Ar filename
d3929 2
a3930 2
.Op Fl inkey Ar filename
.Op Fl certfile Ar filename
d3932 1
a3932 1
.Op Fl CAfile Ar filename
d3935 2
a3936 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d3981 1
a3981 1
.It Fl in Ar filename
d3983 1
a3983 1
.Ar filename
d3986 1
a3986 1
.It Fl out Ar filename
d3988 1
a3988 1
.Ar filename
d4046 1
a4046 1
.It Fl out Ar filename
d4048 1
a4048 1
.Ar filename
d4051 1
a4051 1
.It Fl in Ar filename
d4053 1
a4053 1
.Ar filename
d4062 1
a4062 1
.It Fl inkey Ar filename
d4070 2
a4071 2
.It Fl certfile Ar filename
A filename to read additional certificates from.
d4075 1
a4075 1
.It Fl CAfile Ar filename
d4356 1
a4356 1
.Op Fl in Ar filename
d4358 1
a4358 1
.Op Fl out Ar filename
d4379 1
a4379 1
.Op Fl key Ar filename
d4381 1
a4381 1
.Op Fl keyout Ar filename
d4383 1
a4383 1
.Op Fl config Ar filename
d4423 1
a4423 1
.It Fl in Ar filename
d4425 1
a4425 1
.Ar filename
d4440 1
a4440 1
.It Fl out Ar filename
d4442 1
a4442 1
.Ar filename
d4487 1
a4487 1
.Ar dsa : Ns Ar filename
d4489 2
a4490 2
.Ar filename .
.It Fl key Ar filename
d4501 1
a4501 1
.It Fl keyout Ar filename
d4503 1
a4503 1
.Ar filename
d4516 1
a4516 1
.It Fl config Ar filename
d4650 1
a4650 1
This is the default filename to write a private key to.
d4669 1
a4669 1
This specifies a filename in which random number seed information is
d5084 1
a5084 1
.Op Fl in Ar filename
d5086 1
a5086 1
.Op Fl out Ar filename
d5138 1
a5138 1
.It Fl in Ar filename
d5140 1
a5140 1
.Ar filename
d5151 1
a5151 1
.It Fl out Ar filename
d5153 1
a5153 1
.Ar filename
d5311 1
a5311 1
.It Fl in Ar filename
d5313 1
a5313 1
.Ar filename
d5316 1
a5316 1
.It Fl out Ar filename
d5318 1
a5318 1
.Ar filename
d5473 2
a5474 2
.Op Fl cert Ar filename
.Op Fl key Ar filename
d5476 1
a5476 1
.Op Fl CAfile Ar filename
d5735 1
a5735 1
.Op Fl cert Ar filename
d5737 1
a5737 1
.Op Fl dcert Ar filename
d5739 1
a5739 1
.Op Fl dhparam Ar filename
d5747 1
a5747 1
.Op Fl CAfile Ar filename
d5792 1
a5792 1
If not specified, then the filename
d5798 1
a5798 1
.It Fl dcert Ar filename , Fl dkey Ar keyname
d5819 1
a5819 1
.It Fl dhparam Ar filename
d6027 2
a6028 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d6061 1
a6061 1
.It Fl in Ar filename
d6063 1
a6063 1
.Ar filename
d6065 1
a6065 1
.It Fl out Ar filename
d6067 1
a6067 1
.Ar filename
d6236 1
a6236 1
.It Fl in Ar filename
d6259 1
a6259 1
.It Fl out Ar filename
d6281 1
a6281 1
.It Fl content Ar filename
d6695 2
a6696 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d6717 1
a6717 1
.It Fl in Ar filename
d6719 1
a6719 1
.Ar filename
d6724 1
a6724 1
.It Fl out Ar filename
d6726 1
a6726 1
.Ar filename
d6911 1
a6911 1
If no certificate filenames are included, then an attempt is made to read
d7218 2
a7219 2
.Op Fl in Ar filename
.Op Fl out Ar filename
d7246 1
a7246 1
.Op Fl signkey Ar filename
d7249 2
a7250 2
.Op Fl CA Ar filename
.Op Fl CAkey Ar filename
d7252 1
a7252 1
.Op Fl CAserial Ar filename
d7257 1
a7257 1
.Op Fl extfile Ar filename
d7293 1
a7293 1
.It Fl in Ar filename
d7295 1
a7295 1
.Ar filename
d7297 1
a7297 1
.It Fl out Ar filename
d7299 1
a7299 1
.Ar filename
d7494 1
a7494 1
.It Fl signkey Ar filename
d7564 1
a7564 1
.It Fl CA Ar filename
d7580 1
a7580 1
.It Fl CAkey Ar filename
d7584 1
a7584 1
.It Fl CAserial Ar filename
d7613 1
a7613 1
.It Fl extfile Ar filename
@


1.11
log
@finish merging and sync a bit; bump version etc.
@
text
@d1 2
a2 2
.\" $MirBSD: openssl.1,v 1.10 2003/10/29 19:44:16 tg Exp $
.\" $OpenBSD: openssl.1,v 1.27 2003/12/21 15:00:41 jmc Exp $
d2801 5
a2807 5
.Op Fl engine Ar id
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
d2821 2
a2822 2
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
d2824 2
a2825 2
These options encrypt the private key with the DES, triple DES,
or the AES ciphers, respectively, before outputting it.
d2827 1
a2827 7
If none of these options is specified, no encryption is used.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
d2836 4
d2846 6
d2855 1
a2855 1
much quicker that RSA key generation for example.
d2863 2
a2864 2
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
d2866 2
a2869 1
.Op Fl f4 | 3
a2870 1
.Op Fl engine Ar id
d2880 26
d2909 1
a2909 1
If this argument is not specified then standard output is used.
a2916 14
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
These options encrypt the private key with the DES, triple DES, or the
AES ciphers, respectively, before outputting it.
If none of these options is specified, no encryption is used.
If encryption is used a pass phrase is prompted for,
if it is not supplied via the
.Fl passout
option.
.It Fl F4 | 3
The public exponent to use, either 65537 or 3.
The default is 65537.
a2923 12
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm genrsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Ar numbits
The size of the private key to generate in bits.
This must be the last option specified.
The default is 512.
d2938 2
a2939 2
Because key generation is a random process the time taken to generate a key
may vary somewhat.
@


1.10
log
@* update to OpenSSL 0.9.7c
* include RC5(TM?) and MDC-2 algorithm (patented only in USA)
* fix mdoc-error bogus space in man page
* make the whole shit actually compile
* bump version numbers (I'm not sure if I had need to increase
  the major, but I'd rather do it one time too much than...)
* the usual space cleanup
@
text
@d1 2
a2 2
.\" $MirBSD$
.\" $OpenBSD: openssl.1,v 1.15 2003/09/02 18:56:35 jmc Exp $
a128 1
.Bk -words
d131 1
a131 1
.Cm \	\&\ \&\ \&\ \&\ \&list-cipher-commands
a132 1
.Ek
d347 2
a348 2
.It Cm rmd160
RMD-160 Digest.
d405 3
a407 3
If no password argument is given and a password is required then the user is
prompted to enter one: this will typically be read from the current
terminal with echoing turned off.
d409 1
a409 1
.It Ar pass Ns : Ns Ar password
d418 1
a418 1
.It Ar env Ns : Ns Ar var
d427 1
a427 1
.It Ar file Ns : Ns Ar pathname
d442 1
a442 1
.It Ar fd Ns : Ns Ar number
d453 1
a453 1
.Nm "openssl asn1parse"
d455 5
d461 1
a461 3
.Op Fl in Ar filename
.Op Fl out Ar filename
.Op Fl noout
a462 4
.Op Fl length Ar number
.Op Fl i
.Op Fl dump
.Op Fl dlimit Ar number
d464 1
d474 13
a486 1
.Bl -tag -width "XXXX"
d490 1
d493 2
a494 2
.Pq the default
is base64 encoded.
d497 2
a498 10
.It Fl in Ar filename
The input file; default is standard input.
.It Fl out Ar filename
Output file to place the
.Em DER
encoded data into.
If this option is not present then no data will be output.
This is most useful when combined with the
.Fl strparse
option.
a502 12
.It Fl length Ar number
Number of bytes to parse; default is until end of file.
.It Fl i
Indents the output according to the
.Qq depth
of the structures.
.It Fl dump
Dump unknown data in hex form.
.It Fl dlimit Ar number
Dump the first
.Ar number
bytes of unknown data in hex form.
d504 1
a504 1
A file containing additional OBJECT IDENTIFIERs
d509 8
d518 1
a518 1
Parse the contents octets of the ASN.1 object starting at
d526 2
a527 2
.Bd -literal
  0:d=0  hl=4 l= 681 cons: SEQUENCE
d531 10
a540 10
  229:d=3  hl=3 l= 141 prim: BIT STRING
  373:d=2  hl=3 l= 162 cons: cont [ 3 ]
  376:d=3  hl=3 l= 159 cons: SEQUENCE
  379:d=4  hl=2 l=  29 cons: SEQUENCE
  381:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Subject Key Identifier
  386:d=5  hl=2 l=  22 prim: OCTET STRING
  410:d=4  hl=2 l= 112 cons: SEQUENCE
  412:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Authority Key Identifier
  417:d=5  hl=2 l= 105 prim: OCTET STRING
  524:d=4  hl=2 l=  12 cons: SEQUENCE
d555 1
a555 1
gives the length of the contents octets.
d563 2
a564 2
In this example the BIT STRING at offset 229 is the certificate public key.
The contents octets of this will contain the public key information.
d569 6
a574 3
\&    0:d=0  hl=3 l= 137 cons: SEQUENCE
\&    3:d=1  hl=3 l= 129 prim: INTEGER           :E5D21E1F5C8D208EA7A2166C7FAF9F6BDF2059669C60876DDB70840F1A5AAFA59699FE471F379F1DD6A487E7D5409AB6A88D4A9746E24B91D8CF55DB3521015460C8EDE44EE8A4189F7A7BE77D6CD3A9AF2696F486855CF58BF0EDF2B4068058C7A947F52548DDF7E15E96B385F86422BEA9064A3EE9E1158A56E4A6F47E5897
\&  135:d=1  hl=2 l=   3 prim: INTEGER           :010001
d577 3
a579 1
If an OID is not part of
d587 1
a587 1
Each line consists of three columns;
d599 1
a599 1
.Dl \&"1.2.3.4	shortName	A long name\&"
d610 8
d619 1
d621 3
a623 3
.Op Fl name Ar section
.Op Fl gencrl
.Op Fl revoke Ar file
a624 4
.Op Fl crl_hold Ar instruction
.Op Fl crl_compromise Ar time
.Op Fl crl_CA_compromise Ar time
.Op Fl subj Ar arg
d626 1
d628 1
a628 2
.Op Fl crlexts Ar section
.Op Fl startdate Ar date
d630 5
a634 3
.Op Fl days Ar arg
.Op Fl md Ar arg
.Op Fl policy Ar arg
d637 2
a638 4
.Op Fl key Ar arg
.Op Fl passin Ar arg
.Op Fl cert Ar file
.Op Fl in Ar file
a639 1
.Op Fl notext
d641 3
a643 1
.Op Fl infiles
d646 1
a646 6
.Op Fl preserveDN
.Op Fl noemailDN
.Op Fl batch
.Op Fl msie_hack
.Op Fl extensions Ar section
.Op Fl extfile Ar section
d648 1
a648 2
.Op Fl updatedb
.Op Fl engine Ar id
d661 6
d669 32
a700 8
.It Fl name Ar section
Specifies the configuration file
.Ar section
to use (overrides
.Cm default_ca
in the
.Cm ca
section).
a704 8
.It Fl ss_cert Ar filename
A single self-signed certificate to be signed by the CA.
.It Fl spkac Ar filename
A file containing a single Netscape signed public key and challenge,
and additional field values to be signed by the CA.
See the
.Sx SPKAC FORMAT
section for information on the required format.
a707 18
.It Fl out Ar filename
The output file to output certificates to.
The default is standard output.
The certificate details will also be printed out to this file.
.It Fl outdir Ar directory
The
.Ar directory
to output certificates to.
The certificate will be written to a filename consisting of the
serial number in hex with
.Qq .pem
appended.
.It Fl cert
The CA certificate file.
.It Fl keyfile Ar filename
The private key to sign requests with.
.It Fl keyform Ar PEM | ENGINE
Private key file format.
d716 4
a719 21
.It Fl passin Ar arg
The key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl verbose
This prints extra details about the operations being performed.
.It Fl notext
Don't output the text form of a certificate to the output file.
.It Fl startdate Ar date
This allows the start date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
.It Fl enddate Ar date
This allows the expiry date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
.It Fl days Ar arg
The number of days to certify the certificate for.
a726 9
.It Fl policy Ar arg
This option defines the CA
.Qq policy
to use.
This is a section in the configuration file which decides which fields
should be mandatory or match the CA certificate.
Check out the
.Sx CA POLICY FORMAT
section for more information.
d738 8
a745 8
.It Fl preserveDN
Normally, the DN order of a certificate is the same as the order of the
fields in the relevant policy section.
When this option is set, the order is the same as the request.
This is largely for compatibility with the older IE enrollment control
which would only accept certificates if their DNs matched the order of the
request.
This is not needed for Xenroll.
d757 50
a806 22
.It Fl batch
This sets the batch mode.
In this mode no questions will be asked
and all certificates will be certified automatically.
.It Fl extensions Ar section
The section of the configuration file containing certificate extensions
to be added when a certificate is issued (defaults to
.Em x509_extensions
unless the
.Fl extfile
option is used).
If no extension section is present, then a V1 certificate is created.
If the extension section is present
.Pq even if it is empty ,
then a V3 certificate is created.
.It Fl extfile Ar file
An additional configuration
.Ar file
to read certificate extensions from
(using the default section unless the
.Fl extensions
option is also used).
d812 2
a813 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm ca
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d817 17
a833 13
.It Fl gencrl
This option generates a CRL based on information in the index file.
.It Fl crldays Ar num
The number of days before the next CRL is due.
This is the days from now to place in the CRL
.Em nextUpdate
field.
.It Fl crlhours Ar num
The number of hours before the next CRL is due.
.It Fl revoke Ar filename
A
.Ar filename
containing a certificate to revoke.
d846 5
a850 27
.It Fl crl_hold Ar instruction
This sets the CRL revocation reason code to certificateHold and the hold
instruction to
.Ar instruction
which must be an OID.
Although any OID can be used, only holdInstructionNone
(the use of which is discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.
.It Fl crl_compromise Ar time
This sets the revocation reason to keyCompromise and the compromise time to
.Ar time .
.Ar time
should be in GeneralizedTime format, i.e. YYYYMMDDHHMMSSZ.
.It Fl crl_CA_compromise Ar time
This is the same as
.Fl crl_compromise ,
except the revocation reason is set to CACompromise.
.It Fl subj Ar arg
Supersedes the subject name given in the request.
The
.Ar arg
must be formatted as
.Ar /type0=value0/type1=value1/type2=... ;
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
d865 18
a920 19
.It Ar oid_file
This specifies a file containing additional OBJECT IDENTIFIERS.
Each line of the file should consist of the numerical form of the
object identifier followed by whitespace, then the short name followed
by whitespace and finally the long name.
.It Ar oid_section
This specifies a section in the configuration file containing extra
object identifiers.
Each line should consist of the short name of the object identifier
followed by
.Sq =
and the numerical form.
The short and long names are the same when this option is used.
.It Ar new_certs_dir
The same as the
.Fl outdir
command line option.
It specifies the directory where new certificates will be placed.
Mandatory.
d926 26
a951 5
.It Ar private_key
Same as the
.Fl keyfile
option.
The file containing the CA private key.
d953 9
a961 4
.It Ar RANDFILE
A file used to read and write random number seed information,
or an EGD socket (see
.Xr RAND_egd 3 ) .
a966 6
.It Ar default_startdate
The same as the
.Fl startdate
option.
The start date to certify a certificate for.
If not set, the current time is used.
a974 8
.It Ar default_crl_hours default_crl_days
The same as the
.Fl crlhours
and the
.Fl crldays
options.
These will only be used if neither command line option is present.
At least one of these must be present to generate a CRL.
d981 6
a986 17
.It Ar database
The text database file to use.
Mandatory.
This file must be present, though initially it will be empty.
.It Ar serialfile
A text file containing the next serial number to use in hex.
Mandatory.
This file must be present and contain a valid serial number.
.It Ar x509_extensions
The same as
.Fl extensions .
.It Ar crl_extensions
the same as
.Fl crlexts .
.It Ar preserve
The same as
.Fl preserveDN .
a997 7
.It Ar policy
The same as
.Fl policy .
Mandatory.
See the
.Sx CA POLICY FORMAT
section for more information.
d1016 1
a1016 1
.Em default_ca
d1028 46
a1073 21
.It Ar copy_extensions
Determines how extensions in certificate requests should be handled.
If set to
.Ar none
or this option is not present, then extensions are
ignored and not copied to the certificate.
If set to
.Ar copy ,
then any extensions present in the request that are not already present
are copied to the certificate.
If set to
.Ar copyall ,
then all extensions in the request are copied to the certificate:
if the extension is already present in the certificate it is deleted first.
See the
.Sx CA WARNINGS
section before using this option.
.Pp
The main use of this option is to allow a certificate request to supply
values for certain extensions such as
.Em subjectAltName .
d1189 2
a1190 2
\& nameopt        = default_ca            # Subject name display option
\& certopt        = default_ca            # Certificate display option
d1207 1
a1207 1
/usr/local/ssl/lib/openssl.cnf - master configuration file
d1330 2
a1332 1
.Op Fl ssl2 | ssl3 | tls1
d1336 1
a1336 1
.Nm cipherlist
d1343 9
a1351 1
.Bl -tag -width "XXXX"
a1364 8
.It Fl ssl2
Only include SSL v2 ciphers.
.It Fl ssl3
Only include SSL v3 ciphers.
.It Fl tls1
Only include TLS v1 ciphers.
.It Fl h , \&?
Print a brief usage message.
d1458 1
a1458 1
All ciphers suites except the
d1481 1
a1481 1
40-bit export encryption algorithms
d1487 1
a1487 1
ciphers; that is those offering no encryption.
d1687 1
a1687 1
.Ar COMPLENTOFALL
d1697 1
a1697 6
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
.Op Fl text
.Op Fl in Ar filename
.Op Fl out Ar filename
.Op Fl noout
a1698 1
.Op Fl fingerprint
d1702 2
d1706 4
d1722 18
a1746 19
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar filename
This specifies the input filename to read from or standard input if this
option is not specified.
.It Fl out Ar filename
Specifies the output filename to write to, or standard output by
default.
.It Fl text
Print out the CRL in text form.
.It Fl noout
Don't output the encoded version of the CRL.
.It Fl hash
Output a hash of the issuer name.
This can be used to lookup CRLs in a directory by issuer name.
.It Fl fingerprint
Print the CRL fingerprint.
d1757 11
a1767 10
.It Fl CAfile Ar file
Verify the signature on a CRL by looking up the issuing certificate in
.Ar file .
.It Fl CApath Ar dir
Verify the signature on a CRL by looking up the issuing certificate in
.Ar dir .
This directory must be a standard certificate directory,
i.e. a hash of each subject name (using
.Cm x509 Fl hash )
should be linked to each certificate.
d1787 1
a1787 1
.Dl $ openssl crl -in crl.der -text -noout
d1796 4
d1801 1
d1803 1
a1803 4
.Op Fl in Ar filename
.Op Fl out Ar filename
.Op Fl certfile Ar filename
.Op Fl nocrl
d1814 13
d1834 8
a1848 21
.It Fl in Ar filename
This specifies the input
.Ar filename
to read a CRL from or standard input if this option is not specified.
.It Fl out Ar filename
Specifies the output
.Ar filename
to write the PKCS#7 structure to or standard output by default.
.It Fl certfile Ar filename
Specifies a
.Ar filename
containing one or more certificates in
.Ar PEM
format.
All certificates in the file will be added to the PKCS#7 structure.
This option can be used more than once to read certificates from multiple
files.
.It Fl nocrl
Normally, a CRL is included in the output file.
With this option, no CRL is
included in the output file and a CRL is not read from the input file.
d1884 2
a1885 2
.Fl md5 | md4 | md2 | sha1 |
.Fl sha | ripemd160 | dss1
d1887 1
d1891 2
a1892 1
.Op Fl binary
a1893 2
.Op Fl sign Ar filename
.Op Fl verify Ar filename
d1896 1
d1898 1
a1898 2
.Op Fl engine Ar id
.Op Fl keyform Ar PEM | ENGINE
d1904 2
a1905 2
.Cm md5 | md4 | md2 | sha1 |
.Cm sha | ripemd160
d1919 3
a1921 1
.Bl -tag -width "XXXX"
d1928 8
d1941 2
a1942 2
.It Fl binary
Output the digest or signature in binary form.
d1945 2
a1946 5
.It Fl sign Ar filename
Digitally sign the digest using the private key in
.Ar filename .
.It Fl verify Ar filename
Verify the signature using the public key in
a1951 3
.It Fl prverify Ar filename
Verify the signature using the private key in
.Ar filename .
d1958 3
d1963 7
a1969 10
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dgst
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl keyform Ar PEM | ENGINE
Key file format.
d2004 3
a2006 4
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
.Op Fl in Ar filename
.Op Fl out Ar filename
d2010 5
a2014 2
.Op Fl C
.Op Fl 2 | 5
a2015 1
.Op Fl engine Ar id
d2017 40
a2056 3
.Ek
.Pp
The
d2058 7
a2064 4
command is used to manipulate DH parameter files.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
d2076 9
a2084 8
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read parameters from or standard input if this option is not specified.
d2093 4
a2096 21
.It Fl dsaparam
If this option is used, DSA rather than DH parameters are read or created;
they are converted to DH format.
Otherwise,
.Qq strong
primes
.Pq such that (p-1)/2 is also prime
will be used for DH parameter generation.
.Pp
DH parameter generation with the
.Fl dsaparam
option is much faster,
and the recommended exponent length is shorter,
which makes DH key exchange more efficient.
Beware that with such DSA-style DH parameters,
a fresh DH key should be created for each use to
avoid small-subgroup attacks that may be possible otherwise.
.It Fl 2 , 5
The generator to use, either 2 or 5.
2 is the default.
If present, then the input file is ignored and parameters are generated instead.
a2102 9
.It Ar numbits
This argument specifies that a parameter set should be generated of size
.Ar numbits .
It must be the last option.
If not present, then a value of 512 is used.
If this value is present, then the input file is ignored and
parameters are generated instead.
.It Fl noout
This option inhibits the output of the encoded version of the parameters.
a2104 13
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dh Ns Ar numbits Ns Li ()
function.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dhparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2156 11
d2168 1
a2169 1
.Op Fl in Ar filename
a2170 1
.Op Fl out Ar filename
a2171 10
.Op Fl pubin
.Op Fl pubout
.Oo
.Fl des | des3 | aes128 | aes192 |
.Fl aes256
.Oc
.Op Fl text
.Op Fl noout
.Op Fl modulus
.Op Fl engine Ar id
d2189 30
d2226 2
a2227 2
p, q, g,
the public and private key components, respectively, as ASN.1 INTEGERs.
d2235 1
a2235 1
It consists of the DER format base64
d2238 13
a2254 5
.It Fl in Ar filename
This specifies the input
.Ar filename
to read a key from or standard input if this option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
a2261 9
.It Fl out Ar filename
This specifies the output
.Ar filename
to write a key to, or standard output if not specified.
If any encryption options are set then a pass phrase will be
prompted for.
The output filename should
.Em not
be the same as the input filename.
a2268 23
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
These options encrypt the private key with the DES, triple DES, or the
AES ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified, the key is written in plain text.
This means that using the
.Nm dsa
utility to read in an encrypted key with no encryption option can be used to
remove the pass phrase from a key,
or by setting the encryption options it can be use to add or change
the pass phrase.
These options can only be used with
.Ar PEM
format output files.
.It Fl text
Prints out the public/private key components and parameters.
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl modulus
This option prints out the value of the public key component of the key.
d2276 2
a2277 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2321 6
d2328 1
a2329 5
.Op Fl in Ar filename
.Op Fl out Ar filename
.Op Fl noout
.Op Fl text
.Op Fl C
a2330 2
.Op Fl genkey
.Op Fl engine Ar id
d2340 23
a2374 19
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read parameters from, or standard input if this option is not specified.
If the
.Ar numbits
parameter is included, then this option will be ignored.
.It Fl out Ar filename
This specifies the output
.Ar filename
to write parameters to.
Standard output is used if this option is not present.
The output filename should
.Em not
be the same as the input filename.
a2376 16
.It Fl text
This option prints out the DSA parameters in human readable form.
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dsa Ns Ar XXX Ns Li ()
function.
.It Fl genkey
This option will generate a DSA either using the specified or generated
parameters.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified, separated by a
.Sq \&: .
d2384 20
a2403 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsaparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2422 7
d2430 4
a2435 8
.Op Fl salt
.Op Fl nosalt
.Op Fl e
.Op Fl d
.Op Fl a
.Op Fl A
.Op Fl k Ar password
.Op Fl kfile Ar filename
a2436 8
.Op Fl K Ar key
.Op Fl iv Ar IV
.Op Fl p
.Op Fl P
.Op Fl bufsize Ar number
.Op Fl nopad
.Op Fl debug
.Op Fl engine Ar id
d2447 4
a2450 41
.It Fl in Ar filename
The input
.Ar filename ,
standard input by default.
.It Fl out Ar filename
The output
.Ar filename ,
standard output by default.
.It Fl pass Ar arg
The password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl salt
Use a
.Ar salt
in the key derivation routines.
This option should
.Em ALWAYS
be used unless compatibility with previous versions of
.Nm OpenSSL
or
.Nm SSLeay
is required.
This option is only present on
.Nm OpenSSL
versions 0.9.5 or above.
.It Fl nosalt
Don't use a
.Ar salt
in the key derivation routines.
This is the default for compatibility with previous versions of
.Nm OpenSSL
and
.Nm SSLeay .
.It Fl e
Encrypt the input data: this is the default.
.It Fl d
Decrypt the input data.
d2457 21
a2477 22
.It Fl A
If the
.Fl a
option is set, then base64 process the data on one line.
.It Fl k Ar password
The
.Ar password
to derive the key from.
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl kfile Ar filename
Read the password to derive the key from the first line of
.Ar filename .
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl S Ar salt
d2479 2
a2480 1
.Ar salt
d2483 11
d2501 1
a2501 1
must additionally specified using the
d2519 36
a2554 2
.It Fl iv Ar IV
The actual
d2556 2
a2557 13
to use:
this must be represented as a string comprised only of hex digits.
When only the
.Ar key
is specified using the
.Fl K
option, the
.Ar IV
must explicitly be defined.
When a password is being specified using one of the other options,
the
.Ar IV
is generated from this password.
a2558 4
Print out the key and
.Ar IV
used.
.It Fl P
d2560 2
a2561 1
.Ar key
d2564 27
a2590 16
used then immediately exit:
don't do any encryption or decryption.
.It Fl bufsize Ar number
Set the buffer size for I/O.
.It Fl nopad
Disable standard block padding.
.It Fl debug
Debug the BIOs used for I/O.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm enc
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2686 1
a2687 1
des-ecb            DES in ECB mode
d2729 1
a2729 1
.Dl "$ openssl des3 -d -salt -in file.des3 -out file.txt -k mypassword"
d2739 1
a2739 5
.Dl "$ openssl bf -d -salt -a -in file.bf -out file.txt"
.Pp
Decrypt some data using a supplied 40-bit RC4 key:
.Pp
.Dl $ openssl rc4-40 -in file.rc4 -out file.txt -K 0102030405
d2756 4
d2762 23
a2784 1
utility is currently undocumented.
d3034 1
a3034 1
.Ar hostname Ns : Ns Ar port
d3168 1
a3168 1
.Fl host Ar hostname Ns : Ns Ar port ,
d4361 1
a4361 1
.Ar rsa Ns : Ns Ar bits
d4366 1
a4366 1
.Ar dsa Ns : Ns Ar file
d4473 1
a4473 1
.Ar rsa Ns : Ns Ar nbits ,
d4479 1
a4479 1
.Ar dsa Ns : Ns Ar filename
d5462 1
a5462 1
.Fl connect Ar host Ns : Ns Ar port
d5506 1
a5506 1
.Fl connect Ar host Ns : Ns Ar port
d5618 4
a5621 2
Currently, the only supported keyword is
.Qq smtp .
d5878 1
a5878 1
This option enables a further workaround for some some early Netscape
d6667 1
a6667 1
Produce machine readable ouput.
d7355 1
a7355 1
Ouput the public key.
d8154 1
@


1.9
log
@Merge OpenBSD-current
@
text
@d1 1
d173 2
a174 1
program has actually two manual pages.
d1405 1
a1405 1
.Sq !\&
d7623 1
a7623 1
.Dq \& ,+"<>; .
d8193 9
@


1.8
log
@Merge import of OpenBSD source, ports and XF4 tree.

While here,
o clean up differences where possible
o whitespace cleanup
o ifdef ./. if defined()
o '...' ./. "..."
o echo foo > bar ./. echo foo >bar
o `...` ./. $(...) ./. $$(...)
o `...' ./. '...'
o modernize "our" tree, e.g. WWW in ports
o fix some typos and brainos introduced when renaming OpenBSD to MirBSD
o use hardware 80387 by default
o migrate Apache 1.3.28 OpenBSD ./. MirBSD ./. KAME
o work around as many CVS bugs as possible (add back/delete files, ...)

Synchronize stuff, ready for ongoing changes.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.13 2003/08/30 17:37:44 jmc Exp $
d386 1
a386 1
Triple-DES Cipher.
d8086 86
@


1.7
log
@Merge OpenBSD
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.11 2003/08/08 10:13:33 jmc Exp $
d129 1
a129 1
.Oo Cm list-standard-commands Li |\ \&
d131 1
a131 1
.Cm \  \  \  \  list-cipher-commands
d141 4
a144 2
(SSL v2/v3) and Transport Layer Security (TLS v1) network protocols and
related cryptography standards required by them.
d155 1
a155 1
.Bl -bullet -compact
d186 1
a186 1
.Po Cm command\ \&
d189 1
a189 2
above
.Pc ,
d191 1
a191 1
.Po Ar command_opts\ \&
d195 1
a195 2
.Sx SYNOPSIS
.Pc .
d201 4
a204 3
output a list (one entry per line) of the names
of all standard commands, message digest commands, or cipher commands,
respectively, that are available in the present
d215 3
a217 1
it returns 0 (success) and prints
d245 3
a247 1
Certificate Authority (CA) Management.
d251 3
a253 1
Certificate Revocation List (CRL) Management.
d281 1
a281 1
Create or examine a netscape certificate sequence.
d295 3
a297 1
X.509 Certificate Signing Request (CSR) Management.
d343 2
a346 2
.It Cm mdc2
MDC2 Digest.
d355 5
a359 1
.Bl -tag -width "asn1parse"
d362 5
a366 1
.It Cm bf bf-cbc bf-cfb bf-ecb bf-ofb
d368 2
a369 1
.It Cm cast cast-cbc
d371 2
a372 1
.It Cm cast5-cbc cast5-cfb cast5-ecb cast5-ofb
d374 6
a379 2
.It Cm des des-cbc des-cfb des-ecb des-ede des-ede-cbc
.It Cm des-ede-cfb des-ede-ofb des-ofb
d381 5
a385 1
.It Cm des3 desx des-ede3 des-ede3-cbc des-ede3-cfb des-ede3-ofb
d387 5
a391 3
.It Cm idea idea-cbc idea-cfb idea-ecb idea-ofb
IDEA Cipher.
.It Cm rc2 rc2-cbc rc2-cfb rc2-ecb rc2-ofb
d393 2
a394 1
.It Cm rc4
a395 2
.It Cm rc5 rc5-cbc rc5-cfb rc5-ecb rc5-ofb
RC5 Cipher.
d409 1
a409 1
.It Ar pass:password
d415 4
a418 2
under Unix) this form should only be used where security is not important.
.It Ar env:var
d422 1
a422 1
(e.g.
d424 4
a427 2
under certain Unix OSes) this option should be used with caution.
.It Ar file:pathname
d436 1
a436 1
.Fl passout
d442 1
a442 1
.It Ar fd:number
d454 2
a455 1
.Op Fl inform Ar PEM|DER
d462 2
d466 1
d475 1
a475 1
.It Fl inform Ar DER|PEM
d480 4
a483 1
(the default) is base64 encoded.
d501 9
a509 1
Indents the output according to the "depth" of the structures.
d511 2
a512 1
A file containing additional OBJECT IDENTIFIERs (OIDs).
d519 3
a521 1
This option can be used multiple times to "drill down" into a nested structure.
d534 1
a534 1
  381:d=5  hl=2 l=   3 prim: OBJECT            :X509v3 Subject Key Identifier
d537 1
a537 1
  412:d=5  hl=2 l=   3 prim: OBJECT            :X509v3 Authority Key Identifier
d550 3
a552 1
gives the header length (tag and length octets) of the current type.
d576 2
a577 1
numerical form (for example 1.2.3.4).
d581 1
a581 1
Each line consists of three columns,
d584 5
a588 3
The second column is the "short name" which is a single word followed
by whitespace.
The final column is the rest of the line and is the "long name".
d593 1
a593 1
"1.2.3.4	shortName	A long name"
d596 2
a597 1
The output of some ASN.1 types is not well handled (if at all).
d623 1
d640 2
d689 3
a691 1
serial number in hex with ".pem" appended.
d696 2
d701 3
a703 1
(e.g. Unix with the
d709 1
a709 1
.Ar arg
d720 1
a720 1
(the same as an ASN1 UTCTime structure).
d724 1
a724 1
(the same as an ASN1 UTCTime structure).
d730 1
a730 1
.Ar md5 , sha1
d732 1
a732 1
.Ar mdc2 .
d735 3
a737 1
This option defines the CA "policy" to use.
d747 1
a747 1
"certenr3".
d751 3
a753 1
The newer control "Xenroll" does not need this option.
d755 1
a755 1
Normally the DN order of a certificate is the same as the order of the
d768 1
a768 1
When this option is set the EMAIL field is removed from the certificate's
d785 2
a786 1
If the extension section is present (even if it is empty),
d795 5
d804 1
a804 1
.Nm req
d834 1
a834 1
In practive removeFromCRL is not particularly useful because it is only used
d859 4
a862 1
characters may be escaped by \e (backslash), no spaces are skipped.
d868 2
a869 1
if the CRL extension section is present (even if it is empty)
d874 2
a875 1
It should be noted that some software (for example Netscape)
d897 5
a901 3
  RANDFILE
  preserve
  msie_hack
d911 3
a913 1
the configuration file or the command line equivalent (if any) used.
d925 1
a925 1
.Cm =
d966 2
a967 1
(or the command line equivalents) must be present.
d1003 3
a1005 2
simply set this to 'no'.
If not present the default is to allow for the EMAIL field in the
d1034 1
a1034 1
For convenience the values
d1036 1
a1036 1
are accepted by both to produce a reasonable output.
d1038 1
a1038 1
If neither option is present the format used in earlier versions of
d1054 1
a1054 1
.Ar copy
d1058 1
a1058 1
.Ar copyall
d1072 9
a1080 4
If the value is "match" then the field value
must match the same field in the CA certificate.
If the value is "supplied" then it must be present.
If the value is "optional" then it may be present.
d1099 3
a1101 2
If it's necessary to include the same component twice then it can be
preceded by a number and a '.'.
d1124 3
a1126 1
would be created containing, for example, "01" and the empty index file
d1131 1
a1131 1
\& $ openssl ca -in req.pem -out newcert.pem
d1135 1
a1135 1
\& $ openssl ca -in req.pem -extensions v3_ca -out newcert.pem
d1139 1
a1139 1
\& $ openssl ca -gencrl -out crl.pem
d1143 1
a1143 1
\& $ openssl ca -infiles req1.pem req2.pem req3.pem
d1147 1
a1147 1
\& $ openssl ca -spkac spkac.txt
d1149 8
a1156 7
A sample SPKAC file (the SPKAC line has been truncated for clarity):
.Bd -literal
\& SPKAC=MIG0MGAwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAn7PDhCeV/xIxUg8V70YRxK2A5
\& CN=Steve Test
\& emailAddress=steve@@openssl.org
\& 0.OU=OpenSSL Group
\& 1.OU=Another Group
d1164 1
a1164 1
.Pp
d1166 1
a1166 1
.Pp
d1170 1
a1170 1
.Pp
d1175 1
a1175 1
.Pp
d1179 1
a1179 1
.Pp
d1182 1
a1182 1
.Pp
d1185 2
a1186 2
\& copy_extensions = none                 # Don't copy extensions from request
.Pp
d1198 1
a1198 1
configuration file entries, environment variables or command line options.
d1200 1
a1200 1
.Bd -literal
d1213 1
a1213 1
.Em OPENSSL_CONF
d1244 2
a1245 1
(perl script or GUI) can handle things properly.
d1286 1
a1286 1
If care is not taken then it can be a security risk.
d1316 1
a1316 1
\& basicConstraints = CA:TRUE, pathlen:0
d1325 2
a1326 4
.Op Fl ssl2
.Op Fl ssl3
.Op Fl tls1
.Op Cm cipherlist
d1340 3
a1342 3
(SSLv2 or SSLv3; the latter includes TLS), key exchange,
authentication, encryption and mac algorithms used along with any key size
restrictions and whether the algorithm is classed as an
d1350 2
a1353 2
.It Fl ssl2
Only include SSL v2 ciphers.
d1356 1
a1356 1
.It Fl h , ?
d1358 1
a1358 1
.It Fl cipherlist
d1387 1
a1387 1
.Cm +
d1397 2
a1398 1
.Cm ! , -
d1400 1
a1400 1
.Cm + .
d1403 1
a1403 1
.Cm !
d1409 1
a1409 1
.Cm -
d1414 1
a1414 1
.Cm +
d1420 1
a1420 1
If the list includes any ciphers already present they will be ignored;
d1423 1
a1423 1
Additionally the cipher string
d1460 2
a1461 1
"High" encryption cipher suites.
d1464 2
a1465 1
"Medium" encryption cipher suites, currently those using 128 bit encryption.
d1467 2
a1468 1
"Low" encryption cipher suites, currently those using 64 or 56 bit encryption
d1472 1
a1472 1
Including 40 and 56 bits algorithms.
d1474 1
a1474 1
40 bit export encryption algorithms
d1476 1
a1476 1
56 bit export encryption algorithms.
d1478 4
a1481 2
The "NULL" ciphers; that is those offering no encryption.
Because these offer no encryption at all and are a security risk
d1486 3
a1488 2
These cipher suites are vulnerable to a "man in the middle"
attack and so their use is normally discouraged.
d1506 1
a1506 1
Ciphers suites using FORTEZZA key exchange, authentication, encryption
d1520 2
a1521 1
Cipher suites using DES (not triple DES).
a1525 2
.It Ar IDEA
Cipher suites using IDEA.
d1539 72
a1610 80
.Pp
.Sy "SSL v3.0 cipher suites"
.Bd -literal
 SSL_RSA_WITH_NULL_MD5                   NULL-MD5
 SSL_RSA_WITH_NULL_SHA                   NULL-SHA
 SSL_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
 SSL_RSA_WITH_RC4_128_MD5                RC4-MD5
 SSL_RSA_WITH_RC4_128_SHA                RC4-SHA
 SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
 SSL_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
 SSL_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
 SSL_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
 SSL_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
.Ed
.Bd -literal
 SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 SSL_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
 SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
 SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 SSL_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
 SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
 SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
 SSL_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
 SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
 SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
 SSL_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
 SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
.Ed
.Bd -literal
 SSL_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
 SSL_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
 SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
 SSL_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
 SSL_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
.Ed
.Bd -literal
 SSL_FORTEZZA_KEA_WITH_NULL_SHA          Not implemented.
 SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA  Not implemented.
 SSL_FORTEZZA_KEA_WITH_RC4_128_SHA       Not implemented.
.Ed
.Pp
.Sy "TLS v1.0 cipher suites"
.Bd -literal
 TLS_RSA_WITH_NULL_MD5                   NULL-MD5
 TLS_RSA_WITH_NULL_SHA                   NULL-SHA
 TLS_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
 TLS_RSA_WITH_RC4_128_MD5                RC4-MD5
 TLS_RSA_WITH_RC4_128_SHA                RC4-SHA
 TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
 TLS_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
 TLS_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
 TLS_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
 TLS_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
.Ed
.Bd -literal
 TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 TLS_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
 TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
 TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 TLS_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
 TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
 TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
 TLS_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
 TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
 TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
 TLS_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
 TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
.Ed
.Bd -literal
 TLS_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
 TLS_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
 TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
 TLS_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
 TLS_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
.Ed
.Pp
.Sy "AES ciphersuites from RFC 3268, extending TLS v1.0"
.Bd -literal
 TLS_RSA_WITH_AES_128_CBC_SHA            AES128-SHA
 TLS_RSA_WITH_AES_256_CBC_SHA            AES256-SHA
d1612 4
a1615 4
 TLS_DH_DSS_WITH_AES_128_CBC_SHA         DH-DSS-AES128-SHA
 TLS_DH_DSS_WITH_AES_256_CBC_SHA         DH-DSS-AES256-SHA
 TLS_DH_RSA_WITH_AES_128_CBC_SHA         DH-RSA-AES128-SHA
 TLS_DH_RSA_WITH_AES_256_CBC_SHA         DH-RSA-AES256-SHA
d1617 4
a1620 4
 TLS_DHE_DSS_WITH_AES_128_CBC_SHA        DHE-DSS-AES128-SHA
 TLS_DHE_DSS_WITH_AES_256_CBC_SHA        DHE-DSS-AES256-SHA
 TLS_DHE_RSA_WITH_AES_128_CBC_SHA        DHE-RSA-AES128-SHA
 TLS_DHE_RSA_WITH_AES_256_CBC_SHA        DHE-RSA-AES256-SHA
d1622 2
a1623 2
 TLS_DH_anon_WITH_AES_128_CBC_SHA        ADH-AES128-SHA
 TLS_DH_anon_WITH_AES_256_CBC_SHA        ADH-AES256-SHA
d1625 1
a1625 3
.Pp
.Sy "Additional Export 1024 and other cipher suites"
.Pp
d1628 16
a1643 17
.Bd -literal
 TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA     EXP1024-DES-CBC-SHA
 TLS_RSA_EXPORT1024_WITH_RC4_56_SHA      EXP1024-RC4-SHA
 TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA EXP1024-DHE-DSS-DES-CBC-SHA
 TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA  EXP1024-DHE-DSS-RC4-SHA
 TLS_DHE_DSS_WITH_RC4_128_SHA            DHE-DSS-RC4-SHA
.Ed
.Pp
.Sy "SSL v2.0 cipher suites"
.Bd -literal
 SSL_CK_RC4_128_WITH_MD5                 RC4-MD5
 SSL_CK_RC4_128_EXPORT40_WITH_MD5        EXP-RC4-MD5
 SSL_CK_RC2_128_CBC_WITH_MD5             RC2-MD5
 SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5    EXP-RC2-MD5
 SSL_CK_IDEA_128_CBC_WITH_MD5            IDEA-CBC-MD5
 SSL_CK_DES_64_CBC_WITH_MD5              DES-CBC-MD5
 SSL_CK_DES_192_EDE3_CBC_WITH_MD5        DES-CBC3-MD5
d1659 1
a1659 1
\& $ openssl ciphers -v 'ALL:eNULL'
d1664 1
a1664 1
\& $ openssl ciphers -v 'ALL:!ADH:@@STRENGTH'
d1668 1
a1668 1
\& $ openssl ciphers -v '3DES:+RSA'
d1672 1
a1672 1
\& $ openssl ciphers -v 'RC4:!COMPLEMENTOFDEFAULT'
d1677 1
a1677 1
\& $ openssl ciphers -v 'RSA:!COMPLEMENTOFALL'
d1689 3
a1691 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d1697 1
d1703 1
d1715 1
a1715 1
.It Fl inform Ar DER|PEM
d1718 1
a1718 1
format is DER encoded CRL structure.
d1720 3
a1722 3
(the default) is a base64 encoded version of the DER form with header
and footer lines.
.It Fl outform Ar DER|PEM
d1739 2
d1764 3
a1766 3
.Bd -literal
\& -----BEGIN X509 CRL-----
\& -----END X509 CRL-----
d1774 1
a1774 1
\& $ openssl crl -in crl.pem -outform DER -out crl.der
d1780 1
a1780 1
\& $ openssl crl -in crl.der -text -noout
d1782 1
a1782 1
Ideally it should be possible to create a CRL using appropriate options
d1789 2
a1790 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d1800 2
a1801 1
"certificates only" structure.
d1805 1
a1805 1
.It Fl inform Ar DER|PEM
d1808 1
a1808 1
format is DER encoded CRL structure.
d1810 3
a1812 3
(the default) is a base64 encoded version of the DER form with header
and footer lines.
.It Fl outform Ar DER|PEM
d1815 1
a1815 1
format is DER encoded PKCS#7 structure.
d1817 2
a1818 2
(the default) is a base64 encoded version of the DER form with header
and footer lines.
d1834 1
a1834 1
This option can be used more than once to read certificates form multiple
d1837 1
a1837 1
Normally a CRL is included in the output file.
d1844 1
a1844 1
\& $ openssl crl2pkcs7 -in crl.pem -certfile cert.pem -out p7.pem
d1846 1
a1846 1
Creates a PKCS#7 structure in
d1850 3
a1852 3
.Bd -literal
\& $ openssl crl2pkcs7 -nocrl -certfile newcert.pem
\&         -certfile demoCA/cacert.pem -outform DER -out p7.der
d1873 5
a1877 1
.Op Cm -md5|-md4|-md2|-sha1|-sha|-mdc2|-ripemd160|-dss1
d1888 2
d1891 1
d1893 5
a1897 1
.Cm md5|md4|md2|sha1|sha|mdc2|ripemd160
d1912 1
a1912 1
Print out the digest in two digit groups separated by colons, only relevant if
d1919 2
a1920 1
This is the default case for a "normal"
d1932 4
a1935 1
The output is either "Verification OK" or "Verification Failure".
d1940 1
a1940 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number
d1943 2
a1944 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d1947 10
d1965 1
a1965 1
If you wish to sign or verify data using the DSA algorithm then the dss1
d1977 2
a1978 1
Diffie-Hellman Parameter Management. The
d1991 2
a1992 2
.Op Fl inform Ar DER|PEM
.Op Fl outform Ar DER|PEM
d1999 1
a1999 2
.Op Fl 2
.Op Fl 5
d2011 1
a2011 1
.It Fl inform Ar DER|PEM
d2022 2
a2023 2
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d2041 4
a2044 1
Otherwise, "strong" primes (such that (p-1)/2 is also prime)
d2058 1
a2058 1
If present then the input file is ignored and parameters are generated instead.
d2060 1
a2060 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number generator,
d2063 2
a2064 8
Multiple files can be specified, separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d2070 1
a2070 1
If this value is present then the input file is ignored and
d2085 1
a2085 1
.Nm req
d2111 3
a2113 3
.Bd -literal
\& -----BEGIN DH PARAMETERS-----
\& -----END DH PARAMETERS-----
d2140 2
a2141 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d2146 6
a2151 3
.Op Fl des
.Op Fl des3
.Op Fl idea
a2154 2
.Op Fl pubin
.Op Fl pubout
d2173 1
a2173 1
.It Fl inform Ar DER|PEM
d2178 4
a2181 2
SEQUENCE consisting of the values of version (currently zero), p, q, g,
the public and private key components respectively as ASN.1 INTEGERs.
d2184 1
a2184 2
structure:
It is an error if the key is not DSA.
d2192 2
a2193 2
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d2200 1
a2200 1
If the key is encrypted a pass phrase will be prompted for.
d2204 1
a2204 1
.Ar arg
d2220 1
a2220 1
.Ar arg
d2224 4
a2227 1
.It Cm -des|-des3|-idea
d2229 1
a2229 1
IDEA ciphers, respectively, before outputting it.
d2242 1
a2242 1
Prints out the public, private key components and parameters.
d2248 1
a2248 1
By default a private key is read from the input file.
d2251 1
a2251 1
By default a private key is output.
d2258 1
a2258 1
.Nm req
d2267 3
a2269 3
.Bd -literal
\& -----BEGIN DSA PRIVATE KEY-----
\& -----END DSA PRIVATE KEY-----
d2275 3
a2277 3
.Bd -literal
\& -----BEGIN PUBLIC KEY-----
\& -----END PUBLIC KEY-----
d2282 1
a2282 1
\& $ openssl dsa -in key.pem -out keyout.pem
d2286 1
a2286 1
\& $ openssl dsa -in key.pem -des3 -out keyout.pem
d2290 1
a2290 1
\& $ openssl dsa -in key.pem -outform DER -out keyout.der
d2294 1
a2294 1
\& $ openssl dsa -in key.pem -text -noout
d2298 1
a2298 1
\& $ openssl dsa -in key.pem -pubout -out pubkey.pem
d2305 2
a2306 2
.Op Fl inform Ar DER|PEM
.Op Fl outform Ar DER|PEM
d2320 1
a2320 1
command is used to manipulate or generate \s-1DSA\s0 parameter files.
d2324 1
a2324 1
.It Fl inform Ar DER|PEM
d2328 2
a2329 1
argument uses an ASN1 DER encoded form compatible with RFC 2459 (PKIX)
d2336 1
a2336 1
.It Fl outform Ar DER|PEM
d2346 1
a2346 1
parameter is included then this option will be ignored.
d2368 1
a2368 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number
d2371 2
a2372 8
Multiple files can be specified, separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d2377 3
a2379 1
If this option is included, then the input file (if any) is ignored.
d2384 1
a2384 1
.Nm req
d2392 3
a2394 3
.Bd -literal
\& -----BEGIN DSA PARAMETERS-----
\& -----END DSA PARAMETERS-----
d2404 1
d2409 2
d2417 1
d2425 2
d2430 3
a2432 2
or explicitly provided. Base64 encoding or decoding can also be performed
either by itself or in addition to the encryption or decryption.
d2447 1
a2447 1
.Ar arg
d2567 8
d2625 1
a2625 1
If padding is disabled then the input data must be a multiple of the cipher
d2630 1
a2630 1
Blowfish and RC5 algorithms use a 128 bit key.
d2632 65
a2696 68
.Bd -literal
\& base64             Base 64
.Ed
.Bd -literal
\& bf-cbc             Blowfish in CBC mode
\& bf                 Alias for bf-cbc
\& bf-cfb             Blowfish in CFB mode
\& bf-ecb             Blowfish in ECB mode
\& bf-ofb             Blowfish in OFB mode
.Ed
.Bd -literal
\& cast-cbc           CAST in CBC mode
\& cast               Alias for cast-cbc
\& cast5-cbc          CAST5 in CBC mode
\& cast5-cfb          CAST5 in CFB mode
\& cast5-ecb          CAST5 in ECB mode
\& cast5-ofb          CAST5 in OFB mode
.Ed
.Bd -literal
\& des-cbc            DES in CBC mode
\& des                Alias for des-cbc
\& des-cfb            DES in CBC mode
\& des-ofb            DES in OFB mode
\& des-ecb            DES in ECB mode
.Ed
.Bd -literal
\& des-ede-cbc        Two key triple DES EDE in CBC mode
\& des-ede            Alias for des-ede
\& des-ede-cfb        Two key triple DES EDE in CFB mode
\& des-ede-ofb        Two key triple DES EDE in OFB mode
.Ed
.Bd -literal
\& des-ede3-cbc       Three key triple DES EDE in CBC mode
\& des-ede3           Alias for des-ede3-cbc
\& des3               Alias for des-ede3-cbc
\& des-ede3-cfb       Three key triple DES EDE CFB mode
\& des-ede3-ofb       Three key triple DES EDE in OFB mode
.Ed
.Bd -literal
\& desx               DESX algorithm.
.Ed
.Bd -literal
\& idea-cbc           IDEA algorithm in CBC mode
\& idea               same as idea-cbc
\& idea-cfb           IDEA in CFB mode
\& idea-ecb           IDEA in ECB mode
\& idea-ofb           IDEA in OFB mode
.Ed
.Bd -literal
\& rc2-cbc            128 bit RC2 in CBC mode
\& rc2                Alias for rc2-cbc
\& rc2-cfb            128 bit RC2 in CBC mode
\& rc2-ecb            128 bit RC2 in CBC mode
\& rc2-ofb            128 bit RC2 in CBC mode
\& rc2-64-cbc         64 bit RC2 in CBC mode
\& rc2-40-cbc         40 bit RC2 in CBC mode
.Ed
.Bd -literal
\& rc4                128 bit RC4
\& rc4-64             64 bit RC4
\& rc4-40             40 bit RC4
.Ed
.Bd -literal
\& rc5-cbc            RC5 cipher in CBC mode
\& rc5                Alias for rc5-cbc
\& rc5-cfb            RC5 cipher in CBC mode
\& rc5-ecb            RC5 cipher in CBC mode
\& rc5-ofb            RC5 cipher in CBC mode
d2701 1
a2701 1
\& $ openssl base64 -in file.bin -out file.b64
d2705 1
a2705 1
\& $ openssl base64 -d -in file.b64 -out file.bin
d2709 1
a2709 1
\& $ openssl des3 -salt -in file.txt -out file.des3
d2713 1
a2713 1
\& $ openssl des3 -d -salt -in file.des3 -out file.txt -k mypassword
d2715 2
a2716 1
Encrypt a file then base64 encode it (so it can be sent via mail for example)
d2719 1
a2719 1
\& $ openssl bf -a -salt -in file.txt -out file.bf
d2723 1
a2723 1
\& $ openssl bf -d -salt -a -in file.bf -out file.txt
d2725 1
a2725 1
Decrypt some data using a supplied 40 bit RC4 key:
d2727 1
a2727 1
\& $ openssl rc4-40 -in file.rc4 -out file.txt -K 0102030405
d2746 1
a2746 1
utility is undocumented.
d2751 2
a2752 1
Generation of Diffie-Hellman Parameters. Replaced by
d2762 1
a2763 3
.Op Fl des
.Op Fl des3
.Op Fl idea
d2766 4
d2771 1
d2776 1
a2776 1
(which will be typically generated by the
d2782 4
a2785 1
.It Cm -des|-des3|-idea
d2787 1
a2787 1
or the IDEA ciphers, respectively, before outputting it.
d2791 1
a2791 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number
d2794 2
a2795 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d2800 1
a2800 1
.Nm req
d2819 5
d2826 1
a2826 5
.Op Fl des
.Op Fl des3
.Op Fl idea
.Op Fl f4
.Op Fl 3
d2830 1
d2845 1
a2845 1
.Ar arg
d2849 4
a2852 1
.It Cm -des|-des3|-idea
d2854 1
a2854 1
IDEA ciphers, respectively, before outputting it.
d2860 1
a2860 1
.It Cm -F4|-3
d2864 1
a2864 4
A
.Ar file
or
.Ar file Ns Li s
d2868 2
a2869 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d2874 1
a2874 1
.Nm req
d2889 3
a2891 3
.Em \&.
represents each number which has passed an initial sieve test,
.Em \&+
d2894 1
a2894 1
(the actual number depends on the key size).
d2903 2
a2904 1
they will be much larger (typically 1024 bits).
d2932 1
a2932 1
Normally a Netscape certificate sequence will be input and the output
d2942 1
a2942 1
\& $ openssl nseq -in nseq.pem -out certs.pem
d2947 1
a2947 1
\& $ openssl nseq -in certs.pem -toseq -out nseq.pem
d2953 3
a2955 3
.Bd -literal
\& -----BEGIN CERTIFICATE-----
\& -----END CERTIFICATE-----
d2994 4
a2997 1
.Op Fl host Ar host:n
d3025 6
a3030 2
The Online Certificate Status Protocol (OCSP) enables applications to
determine the (revocation) state of an identified certificate (RFC 2560).
d3036 2
a3037 2
create requests and send queries to an OCSP responder and behave like
a mini OCSP server itself.
d3067 4
a3070 2
.Em 0x .
Negative integers can also be specified by preceding the value by a `-' sign.
d3079 1
a3079 1
option is not present then the private key is read from the same file
d3081 1
a3081 1
If neither option is specified then the OCSP request is not signed.
d3110 1
a3110 1
Print out the text form of the OCSP request, response or both, respectively.
d3126 7
a3132 2
Both HTTP and HTTPS (SSL/TLS) URLs can be specified.
.It Fl host Ar hostname:port , Fl path Ar pathname
d3140 3
a3142 1
specifies the HTTP path name to use, or "/" by default.
d3189 1
a3189 1
Don't verify the OCSP response signers certificate at all.
d3196 3
a3198 3
Don't perform any additional checks on the OCSP response signers certificate.
That is, do not make any checks to see if the signers certificate is authorised
to provide the necessary status information:
d3219 1
a3219 1
time is omitted from a response then this means that new status
d3226 1
a3226 1
By default this additional check is not performed.
d3279 1
a3279 1
if not present the file specified in the
d3299 1
a3299 1
If neither option is present then the
d3301 1
a3301 1
field is omitted meaning fresh revocation information is immediately available.
d3321 1
a3321 1
If the initial verify fails then the OCSP verify process halts with an
d3332 1
a3332 1
Otherwise the root CA of the OCSP responders CA is checked to see if it
d3336 1
a3336 1
If none of these checks is successful then the OCSP verify fails.
d3340 2
a3341 1
(and it is correctly configured) then verification will succeed.
d3348 3
a3350 2
.Bd -literal
\& $ openssl x509 -in ocspCA.pem -addtrust OCSPSigning -out trustedCA.pem
d3353 1
a3353 1
Alternatively the responder certificate itself can be explicitly trusted
d3359 1
a3359 1
Normally only the
d3361 2
a3362 1
and (if the responder is a 'global VA')
d3386 3
a3388 3
.Bd -literal
\& $ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem -reqout \e
	req.der
d3394 3
a3396 3
.Bd -literal
\& $ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \e
\&       -url http://ocsp.myhost.com/ -resp_text -respout resp.der
d3400 2
a3401 3
.Bd -literal
\& $ openssl ocsp -respin resp.der -text
.Ed
d3407 3
a3409 3
.Bd -literal
\& $ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner rcert.pem \e
	-CA demoCA/cacert.pem -text -out log.txt
d3413 3
a3415 3
.Bd -literal
\& $ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner rcert.pem \e
	-CA demoCA/cacert.pem -nrequest 1
d3419 2
a3420 2
.Bd -literal
\& $ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
d3426 2
a3427 2
.Bd -literal
\& $ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
d3444 1
d3458 3
a3460 1
The Unix standard algorithm
d3462 3
a3464 1
and the MD5-based BSD password algorithm
d3475 2
a3476 1
algorithm (default).
d3478 3
a3480 1
Use the MD5 based BSD password algorithm
d3485 4
a3488 1
algorithm (Apache variant of the BSD algorithm).
d3503 1
a3503 1
Don't output warnings when passwords given at the command line are truncated.
d3507 2
d3511 1
a3511 2
.Bl -tag -width "XXXX"
.It $ openssl passwd -crypt -salt xx password
d3513 3
a3515 2
.Em xxj31ZMTZzkVA .
.It $ openssl passwd -1 -salt xxxxxxxx password
d3517 3
a3519 2
.Em $1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a. .
.It $ openssl passwd -apr1 -salt xxxxxxxx password
d3521 1
a3521 2
.Em $apr1$xxxxxxxx$dxHfLAsjHkDRmG83UXe8K0 .
.El
d3528 2
a3529 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d3548 1
a3548 1
.It Fl inform Ar DER|PEM
d3551 1
a3551 1
format is DER encoded PKCS#7 v1.5 structure.
d3553 4
a3556 4
(the default) is a base64 encoded version of the DER form with header
and footer lines.
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d3582 1
a3582 1
.Nm req
d3593 1
a3593 1
\& $ openssl pkcs7 -in file.pem -outform DER -out file.der
d3597 1
a3597 1
\& $ openssl pkcs7 -in file.pem -print_certs -out certs.pem
d3602 3
a3604 3
.Bd -literal
\& -----BEGIN PKCS7-----
\& -----END PKCS7-----
d3608 3
a3610 3
.Bd -literal
\& -----BEGIN CERTIFICATE-----
\& -----END CERTIFICATE-----
d3624 2
a3625 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d3645 2
a3646 1
(v1.5 and v2.0) and PKCS#12 algorithms.
d3651 1
a3651 1
Normally a PKCS#8 private key is expected on input and a traditional format
d3657 1
a3657 1
.It Fl inform Ar DER|PEM
d3670 2
a3671 2
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d3678 1
a3678 1
If the key is encrypted a pass phrase will be prompted for.
d3682 1
a3682 1
.Ar arg
d3697 1
a3697 1
.Ar arg
d3735 1
a3735 1
Normally PKCS#8 private keys are encrypted with the password based
d3738 1
a3738 1
this uses 56 bit DES encryption but it was the strongest encryption
d3743 1
a3743 1
encryption algorithm such as 168 bit triple DES or 128 bit RC2, however
d3765 1
a3765 1
.Nm req
d3775 3
a3777 3
.Bd -literal
\& -----BEGIN ENCRYPTED PRIVATE KEY-----
\& -----END ENCRYPTED PRIVATE KEY-----
d3781 3
a3783 3
.Bd -literal
\& -----BEGIN PRIVATE KEY-----
\& -----END PRIVATE KEY-----
d3811 3
a3813 2
.Bl -tag -width "XXXX"
.It Ar PBE-MD2-DES PBE-MD5-DES
d3816 2
a3817 1
.It Ar PBE-SHA1-RC2-64 PBE-MD2-RC2-64 PBE-MD5-RC2-64 PBE-SHA1-DES
d3822 4
a3825 2
They use either 64 bit RC2 or 56 bit DES.
.It Ar PBE-SHA1-RC4-128 PBE-SHA1-RC4-40 PBE-SHA1-3DES PBE-SHA1-2DES PBE-SHA1-RC2-128 PBE-SHA1-RC2-40
d3827 1
a3827 1
allow strong encryption algorithms like triple DES or 128 bit RC2 to be used.
d3830 1
a3830 1
Convert a private from traditional to PKCS#5 v2.0 format using triple DES:
d3832 1
a3832 1
\& $ openssl pkcs8 -in key.pem -topk8 -v2 des3 -out enckey.pem
d3834 2
a3835 1
Convert a private key to PKCS#8 using a PKCS#5 1.5 compatible algorithm (DES):
d3837 1
a3837 1
\& $ openssl pkcs8 -in key.pem -topk8 -out enckey.pem
d3839 6
a3844 3
Convert a private key to PKCS#8 using a PKCS#12 compatible algorithm (3DES):
.Pp
\& $ openssl pkcs8 -in key.pem -topk8 -out enckey.pem -v1 PBE-SHA1-3DES
d3848 1
a3848 1
\& $ openssl pkcs8 -inform DER -nocrypt -in key.der -out key.pem
d3852 1
a3852 1
\& $ openssl pkcs8 -in pk8.pem -out key.pem
d3855 2
a3856 2
pkcs-tng mailing list using triple DES, DES and RC2 with high iteration
counts, several people confirmed that they could decrypt the private
d3861 3
a3863 1
The format of PKCS#8 DSA (and other) private keys is not well documented:
d3880 1
d3885 2
d3898 4
a3901 3
.Op Fl des
.Op Fl des3
.Op Fl idea
d3915 2
d3920 2
a3921 1
command allows PKCS#12 files (sometimes referred to as PFX files)
d3928 1
a3928 1
By default a PKCS#12 file is parsed;
d3931 2
a3932 1
option (see below).
d3948 3
a3950 1
The PKCS#12 file (i.e. input file) password source.
d3952 1
a3952 1
.Ar arg
d3959 1
a3959 1
.Ar arg
d3967 2
a3968 1
Only output client certificates (not CA certificates).
d3970 2
a3971 1
Only output CA certificates (not client certificates).
d3979 7
a3985 6
.It Fl des
Use DES to encrypt private keys before outputting.
.It Fl des3
Use triple DES to encrypt private keys before outputting, this is the default.
.It Fl idea
Use IDEA to encrypt private keys before outputting.
d4020 3
a4022 1
This specifies the "friendly name" for the certificate and private key.
d4026 6
d4033 3
a4035 1
This specifies the "friendly name" for other certificates.
d4041 3
a4043 1
The PKCS#12 file (i.e. output file) password source.
d4045 1
a4045 1
.Ar arg
d4052 1
a4052 1
.Ar arg
d4057 1
a4057 1
If this option is present then an attempt is made to include the entire
d4060 1
a4060 1
If the search fails it is considered a fatal error.
d4063 5
a4067 3
file unreadable by some "export grade" software.
By default the private key is encrypted using triple DES and the
certificate using 40 bit RC2.
d4072 1
a4072 1
it is advisable only to use PKCS#12 algorithms.
d4079 3
a4081 1
Normally "export grade" software will only allow 512 bit RSA keys to be
d4086 3
a4088 2
Signing only keys can be used for S/MIME signing,
authenticode (ActiveX control signing) and SSL client authentication;
d4093 1
a4093 1
Unless you wish to produce files compatible with MSIE 4.0 you should leave
d4096 4
a4099 4
To discourage attacks by using large dictionaries of common passwords the
algorithm that derives keys from passwords can have an iteration count applied
to it: this causes a certain part of the algorithm to be repeated and slows it
down.
d4102 1
a4102 1
By default both MAC and encryption iteration counts are set to 2048;
d4111 1
a4111 1
This option is included for compatibility with previous versions, it used
d4114 1
a4114 4
A
.Ar file
or
.Ar file Ns Li s
d4118 10
a4127 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d4132 1
a4132 1
For PKCS#12 file parsing only
d4143 1
a4143 1
.Fl clcerts , cacerts
d4146 1
a4146 1
options are present then all certificates will be output in the order
d4157 1
a4157 1
If the CA certificates are required then they can be output to a separate
d4170 1
a4170 1
Normally the defaults are fine but occasionally software can't handle
d4174 1
a4174 1
can be used to reduce the private key encryption to 40 bit RC2.
d4181 1
a4181 1
\& $ openssl pkcs12 -in file.p12 -out file.pem
d4185 1
a4185 1
\& $ openssl pkcs12 -in file.p12 -clcerts -out file.pem
d4189 1
a4189 1
\& $ openssl pkcs12 -in file.p12 -out file.pem -nodes
d4193 1
a4193 1
\& $ openssl pkcs12 -in file.p12 -info -noout
d4196 2
a4197 2
.Bd -literal
\& $ openssl pkcs12 -export -in file.pem -out file.p12 \e
d4202 2
a4203 2
.Bd -literal
\& $ openssl pkcs12 -export -in file.pem -out file.p12 \e
d4215 3
a4217 2
from other implementations (MSIE or Netscape) could not be decrypted
by
d4239 4
a4242 3
.Bd -literal
\& $ old-openssl -in bad.p12 -out keycerts.pem
\& $ openssl -in keycerts.pem -export -name "My PKCS#12 file" -out fixed.p12
d4250 1
a4250 1
.Op Fl rand Ar file
d4252 1
d4284 1
a4284 5
Use specified
.Ar file
or
.Ar file Ns Li s
or EGD socket (see
d4287 2
a4288 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d4293 8
d4308 2
a4309 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d4321 10
a4330 2
.Op Fl newkey Ar rsa:bits
.Op Fl newkey Ar dsa:file
d4332 1
d4334 1
a4334 1
.Op Fl keyform Ar PEM|DER
d4336 1
a4336 1
.Op Fl Op Cm md5|sha1|md2|mdc2
d4362 1
a4362 1
.It Fl inform Ar DER|PEM
d4373 2
a4374 2
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d4390 1
a4390 1
.Ar arg
d4401 1
a4401 1
.Ar arg
d4424 1
a4424 1
option is not used it will generate a new RSA private
d4427 1
a4427 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number generator,
d4430 2
a4431 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d4435 1
a4435 1
.Ar rsa:nbits ,
d4441 1
a4441 1
.Ar dsa:filename
d4449 1
a4449 1
.It Fl keyform Ar PEM|DER
d4453 1
a4453 1
.AR PEM
d4462 1
a4462 1
If this option is specified then if a private key is created it
d4464 3
a4466 1
.It Fl md5|sha1|md2|mdc2
d4474 1
a4474 1
.Em OPENSSL_CONF
d4480 5
a4484 2
.Em /type0=value0/type1=value1/type2=... ,
characters may be escaped by \e (backslash), no spaces are skipped.
d4491 2
a4492 1
(if any) are specified in the configuration file.
d4499 1
a4499 1
option is being used this specifies the number of
d4505 1
a4505 1
.Em 0x .
d4516 2
a4517 2
This option causes field values to be interpreted as UTF8 strings, by
default they are interpreted as ASCII.
d4532 1
a4532 1
By default the
d4540 1
a4540 1
More precisely the
d4555 3
a4557 1
Some software (Netscape certificate server) and some CAs need this.
d4576 1
a4576 1
section (i.e.
d4584 5
a4588 3
.It Ar input_password output_password
The passwords for the input private key file (if present) and
the output private key file (if one will be created).
d4619 1
a4619 1
.Cm =
d4630 1
a4630 1
then if a private key is generated it is
d4642 1
a4642 1
.Ar md5 , sha1
d4644 2
a4645 2
.Ar mdc2 .
If not present then MD5 is used.
d4660 1
a4660 1
value is used then only
d4668 1
a4668 1
option is used then only
d4736 1
a4736 1
.Em no
d4738 4
a4741 4
.Bd -literal
\& CN=My Name
\& OU=My Organization
\& emailAddress=someone@@somewhere.org
d4744 4
a4747 2
This allows external programs (e.g. GUI based) to generate a template file
with all the field names and values and just pass it to
d4759 5
a4763 5
.Bd -literal
\& fieldName="prompt"
\& fieldName_default="default field value"
\& fieldName_min= 2
\& fieldName_max= 4
d4766 2
a4767 1
"fieldName" is the field name being used, for example
d4769 4
a4772 2
(or CN).
The "prompt" string is used to ask the user to enter the relevant details.
d4774 1
a4774 1
if no default value is present then the field is omitted.
d4776 3
a4778 1
if the user just enters the '.' character.
d4796 1
a4796 1
To avoid this problem if the
d4798 1
a4798 1
contains some characters followed by a full stop they will be ignored.
d4801 2
a4802 1
can be input by calling it "1.organizationName".
d4811 1
a4811 1
Additionally
d4828 1
a4828 1
\& $ openssl req -in req.pem -text -verify -noout
d4831 3
a4833 3
.Bd -literal
\& $ openssl genrsa -out key.pem 1024
\& $ openssl req -new -key key.pem -out req.pem
d4838 1
a4838 1
\& $ openssl req -newkey rsa:1024 -keyout key.pem -out req.pem
d4842 1
a4842 1
\& $ openssl req -x509 -newkey rsa:1024 -keyout key.pem -out req.pem
d4847 3
a4849 3
.Bd -literal
\& 1.2.3.4        shortName       A longer Name
\& 1.2.3.6        otherName       Other longer Name
d4855 3
a4857 3
.Bd -literal
\& testoid1=1.2.3.5
\& testoid2=${testoid1}.6
d4868 1
a4868 1
.Pp
d4870 1
a4870 1
.Pp
d4876 1
a4876 1
.Pp
d4878 1
a4878 1
.Pp
d4880 1
a4880 1
.Pp
d4883 1
a4883 1
.Pp
d4886 1
a4886 1
.Pp
d4891 1
a4891 1
.Pp
d4893 1
a4893 1
.Pp
d4902 1
a4902 1
.Pp
d4910 1
a4910 1
.Pp
d4919 1
a4919 1
.Pp
d4927 3
a4929 3
.Bd -literal
\& -----BEGIN CERTIFICATE REQUEST-----
\& -----END CERTIFICATE REQUEST-----
d4932 6
a4937 4
Some software (some versions of Netscape certificate server) instead needs:
.Bd -literal
\& -----BEGIN NEW CERTIFICATE REQUEST-----
\& -----END NEW CERTIFICATE REQUEST-----
d4948 3
a4950 3
extension which determines the type of
key (signature only or general purpose) and any additional OIDs entered
by the script in an
d4955 3
a4957 3
.Bd -literal
\&        Using configuration from /some/path/openssl.cnf
\&        Unable to load config info
d4961 3
a4963 3
.Bd -literal
\&        unable to find 'distinguished_name' in config
\&        problems making Certificate Request
d4968 3
a4970 2
Certain operations (like examining a certificate request) don't
need a configuration file so its use isn't enforced.
d4975 3
a4977 3
.Bd -literal
\&        Attributes:
\&            a0:00
d4981 2
a4982 1
the correct empty SET OF structure (the DER encoding of which is 0xa0 0x00).
d4985 1
a4985 1
\&        Attributes:
d4987 2
a4988 2
then the SET OF is missing and the encoding is technically invalid (but
it is tolerated).
d4994 1
a4994 1
.Em OPENSSL_CONF ,
d5000 1
a5000 1
.Em SSLEAY_CONF
d5004 4
a5007 2
handling of T61Strings (aka TeletexStrings) is broken: it effectively
treats them as ISO-8859-1 (Latin 1);
d5014 1
a5014 1
As a consequence of the T61String handling the only correct way to represent
d5025 1
a5025 1
Other things like extensions in certificate requests are
d5028 1
a5028 1
.Em subjectAltName
d5036 2
a5037 2
.Op Fl inform Ar PEM|NET|DER
.Op Fl outform Ar PEM|NET|DER
d5043 4
a5046 3
.Op Fl des
.Op Fl des3
.Op Fl idea
d5071 1
a5071 1
.It Fl inform Ar DER|NET|PEM
d5088 2
a5089 2
.It Fl outform Ar DER|NET|PEM
This specifies the output format, the options have the same meaning as the
d5101 1
a5101 1
.Ar arg
d5109 1
a5109 1
If any encryption options are set then a pass phrase will be prompted for.
d5116 1
a5116 1
.Ar arg
d5124 4
a5127 1
.It Cm -des|-des3|-idea
d5129 1
a5129 1
IDEA ciphers, respectively, before outputting it.
d5150 1
a5150 1
By default a private key is read from the input file: with this
d5153 1
a5153 1
By default a private key is output:
d5160 1
a5160 1
.Nm req
d5169 3
a5171 3
.Bd -literal
\& -----BEGIN RSA PRIVATE KEY-----
\& -----END RSA PRIVATE KEY-----
d5177 3
a5179 3
.Bd -literal
\& -----BEGIN PUBLIC KEY-----
\& -----END PUBLIC KEY-----
d5192 4
a5195 2
and look for the string "private-key", then trace back to the byte
sequence 0x30, 0x82 (this is an ASN1 SEQUENCE).
d5208 1
a5208 1
\& $ openssl rsa -in key.pem -out keyout.pem
d5212 1
a5212 1
\& $ openssl rsa -in key.pem -des3 -out keyout.pem
d5220 1
a5220 1
\& $ openssl rsa -in key.pem -outform DER -out keyout.der
d5224 1
a5224 1
\& $ openssl rsa -in key.pem -text -noout
d5228 1
a5228 1
\& $ openssl rsa -in key.pem -pubout -out pubkey.pem
d5241 1
d5245 1
d5252 1
a5252 3
.Op Fl pkcs
.Op Fl ssl
.Op Fl raw
d5255 2
d5277 4
d5294 4
a5297 3
.It Fl pkcs , oaep , ssl , raw
The padding to use: PKCS#1 v1.5 (the default), PKCS#1 OAEP,
special padding used in SSL v2 backwards compatible handshakes,
d5307 1
a5307 1
Asn1parse the output data, this is useful when combined with the
d5310 8
d5326 1
a5326 1
\& $ openssl rsautl -sign -in file -inkey key.pem -out sig
d5330 1
a5330 1
\& $ openssl rsautl -verify -in sig -inkey key.pem
d5334 2
a5335 2
\& $ openssl rsautl -verify -in file -inkey key.pem -raw -hexdump
.Bd -literal
d5346 3
a5348 2
The PKCS#1 block formatting is evident from this. If this was done using
encrypt and decrypt the block would have been of type 2 (the second byte)
d5356 1
a5356 1
Running
d5360 2
a5361 2
\& $ openssl asn1parse -in pca-cert.pem
.Bd -literal
d5385 1
a5385 1
\& $ openssl asn1parse -in pca-cert.pem -out sig -noout -strparse 614
d5389 1
a5389 1
\& $ openssl x509 -in test/testx509.pem -pubout -noout >pubkey.pem
d5393 2
a5394 2
\& $ openssl rsautl -in sig -verify -asn1parse -inkey pubkey.pem -pubin
.Bd -literal
d5400 1
a5400 1
\&      0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5   .F...Js.7...H%..
d5409 1
a5409 1
\& $ openssl asn1parse -in pca-cert.pem -out tbs -noout -strparse 4
d5412 3
a5414 4
.Bd -literal
\& $ openssl md5 -c tbs
\&   MD5(tbs)= f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5
.Ed
d5423 3
a5425 1
.Op Fl connect Ar host:port>
d5434 1
d5450 1
a5452 1
.Op Fl starttls Ar protocol
d5467 3
a5469 1
.It Fl connect Ar host:port
d5475 1
a5475 1
If not specified then an attempt is made to connect to the local host
d5482 1
a5482 1
If not specified then the certificate file will be used.
d5497 3
a5499 1
This directory must be in "hash format", see
d5520 1
a5520 1
Normally information will only be printed out once if the connection succeeds.
d5548 4
a5551 2
.It Fl ssl2 , ssl3 , tls1 , no_ssl2 ,
.It Fl no_ssl3 , no_tls1
d5553 1
a5553 1
By default the initial handshake uses a method which should be compatible
d5566 3
d5571 1
a5571 1
Although the server determines which cipher suite is used it should take
d5580 2
a5581 1
Currently, the only supported keyword is "smtp".
d5591 1
a5591 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number generator,
d5594 2
a5595 9
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for
all others.
d5598 1
a5598 1
If a connection is established with an SSL server then any data received
d5606 2
a5607 2
.Em R ,
and if the line begins with a
d5615 1
a5615 1
\& $ openssl s_client -connect servername:443
d5617 5
a5621 3
would typically be used (https uses port 443).
If the connection succeeds then an HTTP command can be given such as
"GET" to retrieve a web page.
d5623 2
a5624 2
If the handshake fails then there are several possible causes; if it is
nothing obvious like no client certificate then the
d5639 4
a5642 3
This is normally because the server is not sending the clients certificate
authority in its "acceptable CA list" when it
requests a certificate.
d5654 1
a5654 1
option it will not be used unless the server specifically requests
d5659 1
a5659 1
If there are problems verifying a server certificate then the
d5702 1
d5739 1
a5739 1
The certificate to use; most servers cipher suites require the use of a
d5742 3
a5744 2
(DSA) key.
If not specified then the filename
d5749 1
a5749 1
If not specified then the certificate file will be used.
d5757 1
a5757 1
(no additional certificate and key is used).
d5761 3
a5763 1
and some a DSS (DSA) key.
d5768 1
a5768 1
If this option is set then no certificate is used.
d5770 1
a5770 1
(currently just anonymous DH).
d5794 1
a5794 1
option a certificate is requested but the client does not have to send one.
d5797 1
a5797 1
option the client must supply a certificate or an error occurs.
d5802 3
a5804 1
This directory must be in "hash format", see
d5820 1
a5820 1
Tests non blocking I/O.
d5822 1
a5822 1
Turns on non blocking I/O.
d5827 4
a5830 2
.It Fl ssl2 , ssl3 , tls1 , no_ssl2 ,
.It Fl no_ssl3 , no_tls1
d5839 2
a5840 1
SSL code (?).
d5846 1
a5846 1
cipherlist irrelevant.
d5850 2
d5888 5
a5892 3
This is mostly useful for testing any SSL/TLS code (e.g. proxies) that wish
to deal with multiple servers, when each of which might be generating a
unique range of session IDs (e.g. with a certain prefix).
d5894 1
a5894 5
A
.Ar file
or
.Ar file Ns Li s
containing random data used to seed the random number generator,
d5897 2
a5898 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d5930 1
a5930 1
\& $ openssl s_server -accept 443 -www
d5934 4
a5937 3
Most web browsers (in particular Netscape and MSIE) only support RSA cipher
suites, so they cannot connect to servers which don't use a certificate
carrying an RSA key or a version of
d5970 1
a5970 1
utility is undocumented.
d5977 2
a5978 2
.Op Fl inform Ar PEM|DER
.Op Fl outform Ar PEM|DER
d5982 1
d5989 4
a5992 4
program processes the encoded version of the SSL
session structure and optionally prints out SSL
session details (for example the SSL
session master key) in human readable format.
d5998 1
a5998 1
.It Fl inform Ar DER|PEM
d6009 2
a6010 2
.It Fl outform Ar DER|PEM
This specifies the output format, the options have the same meaning as the
d6026 2
a6027 1
If a certificate is present in the session it will be output using this option,
d6030 1
a6030 1
option is also present then it will be printed out in text form.
d6034 1
a6034 1
This option can set the session id so the output session information uses the
d6044 1
a6044 1
.Bd -literal
d6071 1
a6071 1
The key argument, this is only used in SSL v2.
d6073 3
a6075 2
This is the session start time, represented as an integer
in standard Unix format.
d6085 3
a6087 3
.Bd -literal
\& -----BEGIN SSL SESSION PARAMETERS-----
\& -----END SSL SESSION PARAMETERS-----
d6093 3
a6095 1
should be taken if the information is being output by a "real" application.
d6111 13
a6123 5
.Op Fl des
.Op Fl des3
.Op Fl rc2-40
.Op Fl rc2-64
.Op Fl rc2-128
d6128 1
a6128 1
.Op Fl inform Ar SMIME|PEM|DER
d6131 1
d6133 1
a6133 1
.Op Fl outform Ar SMIME|PEM|DER
d6139 5
d6193 1
a6193 1
.It Fl inform Ar SMIME|PEM|DER
d6206 1
a6206 1
structure, if no PKCS#7 structure is being input (for example with
d6209 1
a6209 1
.Fl sign )
d6215 1
a6215 1
.It Fl outform Ar SMIME|PEM|DER
d6246 2
a6247 1
This option adds plain text (text/plain)
d6257 1
a6257 1
containing trusted CA certificates, only used with
d6262 1
a6262 1
containing trusted CA certificates, only used with
d6268 4
a6271 1
.It Fl des des3 rc2-40 rc2-64 rc2-128
d6273 6
a6278 2
DES (56 bits), triple DES\s0 (168 bits)
or 40, 64 or 128 bit RC2, respectively; if not specified 40 bit RC2 is
d6283 4
a6286 3
When verifying a message, normally certificates (if any) included in
the message are searched for the signing certificate.
With this option only the certificates specified in the
d6293 2
a6294 2
Do not do chain verification of signers' certificates: that is don't
use the certificates in the signed message as untrusted CAs.
d6309 3
a6311 2
Normally the input message is converted to "canonical" format which is
effectively using CR and LF as end of line: as required by the
d6344 1
a6344 1
If this option is not specified then the private key must be included
d6351 2
d6356 1
a6356 1
.Ar arg
d6360 13
d6374 1
a6374 4
A
.Ar file
or
.Ar file Ns Li s
d6378 2
a6379 8
Multiple files can be specified separated by an OS-dependent character.
The separator is
.Cm \&;
for MS-Windows,
.Cm \&,
for OpenVMS, and
.Cm \&:
for all others.
d6406 2
a6407 1
clients won't display it properly (if at all).
d6412 3
a6414 2
A "signed and encrypted" message is one where a signed message is
then encrypted.
d6425 3
a6427 2
It is possible to sign messages "in parallel" by signing an already
signed message.
d6454 1
a6454 1
the signers certificates.
d6458 3
a6460 3
.Bd -literal
\& $ openssl smime -sign -in message.txt -text -out mail.msg \e
\&        -signer mycert.pem
d6464 3
a6466 3
.Bd -literal
\& $ openssl smime -sign -in message.txt -text -out mail.msg -nodetach \e
\&        -signer mycert.pem
d6471 3
a6473 3
.Bd -literal
\& $ openssl smime -sign -in in.txt -text -out mail.msg \e
\&        -signer mycert.pem -inkey mykey.pem -certfile mycerts.pem
d6476 3
a6478 1
Send a signed message under Unix directly to
d6481 4
a6484 4
.Bd -literal
\& $ openssl smime -sign -in in.txt -text -signer mycert.pem \e
\&        -from steve@@openssl.org -to someone@@somewhere \e
\&        -subject "Signed message" | sendmail someone@@somewhere
d6488 3
a6490 3
.Bd -literal
\& $ openssl smime -verify -in mail.msg -signer user.pem \e
\&	-out signedtext.txt
d6494 4
a6497 4
.Bd -literal
\& $ openssl smime -encrypt -in in.txt -from steve@@openssl.org \e
\&        -to someone@@somewhere -subject "Encrypted message" \e
\&        -des3 user.pem -out mail.msg
d6501 5
a6505 5
.Bd -literal
\& $ openssl smime -sign -in ml.txt -signer my.pem -text \e
\&        | openssl smime -encrypt -out mail.msg \e
\&        -from steve@@openssl.org -to someone@@somewhere \e
\&        -subject "Signed and Encrypted message" -des3 user.pem
d6516 4
a6519 2
.Pp
\& $ openssl smime -decrypt -in mail.msg -recip mycert.pem -inkey key.pem
d6525 3
a6527 3
.Bd -literal
\& -----BEGIN PKCS7-----
\& -----END PKCS7-----
d6531 3
a6533 3
.Bd -literal
\& $ openssl smime -verify -inform PEM -in signature.pem
\& 	-content content.txt
d6537 3
a6539 3
.Bd -literal
\& $ openssl smime -verify -inform DER -in signature.der
\& 	-content content.txt
d6553 1
a6553 1
Ideally a database should be maintained of a certificate for each email
d6567 1
a6567 1
v2 messages, the more complex
d6575 14
a6588 1
.Op Fl engine Ar id
d6590 1
a6590 1
.Op Cm mdc2
d6592 1
a6592 4
.Op Cm hmac
.Op Cm sha1
.Op Cm rmd160
.Op Cm idea-cbc
a6593 4
.Op Cm rc5-cbc
.Op Cm bf-cbc
.Op Cm des-cbc
.Op Cm des-ede3
d6595 2
d6601 8
a6608 8
.Op Cm dsa512
.Op Cm dsa1024
.Op Cm dsa2048
.Op Cm idea
.Op Cm rc2
.Op Cm des
.Op Cm rsa
.Op Cm blowfish
d6614 18
a6640 4
.It Cm [zero or more test algorithms]
If any options are given,
.Nm speed
tests those algorithms, otherwise all of the above are tested.
d6662 2
a6663 1
(SPKAC) files.
d6691 1
a6691 1
.Ar arg
d6707 2
a6708 2
Don't output the text version of the SPKAC (not used if an
SPKAC is being created).
d6710 2
a6711 2
Output the public key of an SPKAC (not used if an SPKAC is
being created).
d6718 1
a6718 1
.Nm req
d6726 1
a6726 1
\& $ openssl spkac -in spkac.cnf
d6730 1
a6730 1
\& $ openssl spkac -in spkac.cnf -noout -verify
d6732 2
a6733 1
Create an SPKAC using the challenge string "hello":
d6735 1
a6735 1
\& $ openssl spkac -key key.pem -challenge hello -out spkac.cnf
d6737 8
a6744 7
Example of an SPKAC, (long lines split up for clarity):
.Bd -literal
\& SPKAC=MIG5MGUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA1cCoq2Wa3Ixs47uI7F\e
\& PVwHVIPDx5yso105Y6zpozam135a8R0CpoRvkkigIyXfcCjiVi5oWk+6FfPaD03u\e
\& PFoQIDAQABFgVoZWxsbzANBgkqhkiG9w0BAQQFAANBAFpQtY/FojdwkJh1bEIYuc\e
\& 2EeM2KHTWPEepWYeawvHD0gQ3DngSC75YCWnnDdq+NQ3F+X4deMx9AaEglZtULwV\e
\& 4=
d6764 2
a6765 1
to be used in a "replay attack".
d6778 2
d6795 1
a6795 1
or have symbolic links to them of this form.
d6801 3
a6803 1
Under Unix the
d6844 10
d6858 1
a6858 1
.Cm \&- .
d6863 1
a6863 1
If no certificate filenames are included then an attempt is made to read
d6890 1
a6890 1
If a certificate is found which is its own issuer it is assumed
d6893 3
a6895 2
The process of 'looking up the issuers certificate' itself involves a number
of steps.
d6905 3
a6907 1
(if present) must match the subject key identifier (if present)
d6910 3
a6912 1
extension of the candidate issuer (if present) must permit certificate signing.
d6925 4
a6928 3
The supplied or "leaf" certificate must have extensions compatible with the
supplied purpose and all other certificates must also be valid
CA certificates.
d6957 2
a6958 2
.Bd -literal
\& server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024 bit)
d6962 1
a6962 1
The first line contains the name of the certificate being verified followed by
d6965 1
a6965 1
The depth is number of the certificate being verified when a
d6974 2
a6975 1
as "unused".
d7120 1
a7120 6
.Op Fl a
.Op Fl v
.Op Fl b
.Op Fl o
.Op Fl f
.Op Fl p
a7130 4
.It Fl v
The current
.Nm OpenSSL
version.
d7135 5
a7141 2
.It Fl c
Compilation flags.
d7144 4
a7147 3
.It Fl d
.Em OPENSSLDIR
setting.
d7165 5
a7169 5
.Op Fl inform Ar DER|PEM|NET
.Op Fl outform Ar DER|PEM|NET
.Op Fl keyform Ar DER|PEM
.Op Fl CAform Ar DER|PEM
.Op Fl CAkeyform Ar DER|PEM
d7172 1
d7184 1
d7188 1
d7196 1
d7207 1
a7207 1
.Op Cm -md2|-md5|-sha1|-mdc2
d7218 3
a7220 2
various forms, sign certificate requests like a "mini CA" or edit
certificate trust settings.
d7224 1
a7224 1
.Sh X509 INPUT, OUTPUT AND GENERAL PURPOSE OPTIONS
d7226 1
a7226 1
.It Fl inform Ar DER|PEM|NET
d7228 1
a7228 1
Normally the command will expect an X509 certificate,
d7241 2
a7242 3
.It Fl outform Ar DER|PEM|NET
This specifies the output format;
the options have the same meaning as the
d7253 8
a7260 1
.It Fl md2|-md5|-sha1|-mdc2
d7264 1
a7264 1
.Fl fingerprint , signkey
d7268 2
a7269 2
If not specified then MD5 is used.
If the key being used to sign with is a DSA key then
d7275 1
a7275 1
.Nm req
d7303 1
a7303 1
switch may be also be used more than once to set multiple options.
d7309 2
d7314 2
d7319 3
a7321 1
Outputs the "hash" of the certificate subject name.
d7367 2
a7368 1
and prohibited uses of the certificate and an "alias".
d7370 4
a7373 3
Normally when a certificate is being verified at least one certificate
must be "trusted".
By default a trusted certificate must be stored
d7405 2
a7406 1
for example "Steve's Certificate".
d7417 1
a7417 3
.Po Em SSL
 client use
.Pc ,
d7419 1
a7419 3
.Po Em SSL
 server use
.Pc
d7422 1
a7422 3
.Po Em S/MIME
 email
.Pc
d7435 1
a7435 1
For a more complete description see the
d7443 2
a7444 1
can thus behave like a "mini CA".
d7451 4
a7454 2
subject name (i.e. makes it self-signed), changes the public key to the
supplied value and changes the start and end dates.
d7474 2
a7475 2
Normally all extensions are retained.
.It Fl keyform Ar PEM|DER
d7477 1
a7477 4
.Po Em DER
 or
.Em PEM
.Pc
d7484 6
d7496 1
a7496 1
By default a certificate is expected on input.
d7514 1
a7514 1
.Em 0x ) .
d7518 1
a7518 1
When this option is present
d7520 2
a7521 1
behaves like a "mini CA".
d7524 1
a7524 1
digitally signed using the CAs private key.
d7534 1
a7534 1
If this option is not specified then it is assumed that the CA private key
d7551 1
a7551 1
For example if the CA certificate file is called
d7557 6
a7562 3
it will contain the serial number "02" and the certificate being signed will
have 1 as its serial number.
Normally if the
d7564 1
a7564 1
option is specified and the serial number file does not exist it is an error.
d7570 6
a7575 3
If this option is not specified then the extensions should either be
contained in the unnamed (default) section or the default section should
contain a variable called "extensions" which contains the section to use.
d7584 2
a7585 1
switch is present, the default "oneline"
d7588 2
a7589 3
Each option is described in detail below, all options can be preceded by
a
.Cm \&-
d7618 4
a7621 2
Escape the "special" characters required by RFC 2253 in a field that is
.Cm \& ,+"<>; .
d7623 1
a7623 1
.Cm \&#
d7628 6
a7633 3
That is, those with ASCII values less than
0x20 (space) and the delete (0x7f) character.
They are escaped using the RFC2253 \eXX notation (where XX are two hex
d7640 1
a7640 1
.Cm \&"
d7643 1
a7643 1
.Cm \&\e
d7648 1
a7648 1
If you are lucky enough to have a UTF8 compatible terminal then the use
d7653 3
a7655 1
may result in the correct display of multibyte (international) characters.
d7671 2
a7672 1
For example "BMPSTRING: Hello World".
d7677 1
a7677 1
Both options use the RFC2253 #XXXX... format.
d7679 3
a7681 2
Dump non-character string types (for example OCTET STRING); if this
option is not set then non-character string types will be displayed
d7695 3
a7697 2
The options ending in "space" additionally place a space after the
separator to make it more readable.
d7701 1
a7701 1
.Cm \&+
d7714 3
a7716 1
uses the "short name" form (CN for
d7729 1
a7729 1
.Cm \&=
d7745 4
a7748 2
Don't print header information: that is, the lines saying "Certificate"
and "Data".
d7793 3
a7795 2
In these examples the '\e' means the example should be all on one
line.
d7799 1
a7799 1
\& $ openssl x509 -in cert.pem -noout -text
d7803 1
a7803 1
\& $ openssl x509 -in cert.pem -noout -serial
d7807 1
a7807 1
\& $ openssl x509 -in cert.pem -noout -subject
d7809 1
a7809 1
Display the certificate subject name in RFC2253 form:
d7811 1
a7811 1
\& $ openssl x509 -in cert.pem -noout -subject -nameopt RFC2253
d7815 4
a7818 2
.Pp
\& $ openssl x509 -in cert.pem -noout -subject -nameopt oneline,-escmsb
d7822 1
a7822 1
\& $ openssl x509 -in cert.pem -noout -fingerprint
d7826 1
a7826 1
\& $ openssl x509 -sha1 -in cert.pem -noout -fingerprint
d7834 1
a7834 1
\& $ openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER
d7837 4
a7840 2
.Pp
\& $ openssl x509 -x509toreq -in cert.pem -out req.pem -signkey key.pem
d7844 3
a7846 3
.Bd -literal
\& $ openssl x509 -req -in careq.pem -extfile openssl.cnf -extensions \e
\&        v3_ca -signkey key.pem -out cacert.pem
d7851 2
a7852 2
.Bd -literal
\& $ openssl x509 -req -in req.pem -extfile openssl.cnf -extensions \e
d7857 5
a7861 4
client use and set its alias to "Steve's Class 1 CA":
.Bd -literal
\& $ openssl x509 -in cert.pem -addtrust clientAuth \e
\&        -setalias "Steve's Class 1 CA" -out trust.pem
d7867 3
a7869 3
.Bd -literal
\& -----BEGIN CERTIFICATE-----
\& -----END CERTIFICATE-----
d7873 3
a7875 3
.Bd -literal
\& -----BEGIN X509 CERTIFICATE-----
\& -----END X509 CERTIFICATE-----
d7879 3
a7881 3
.Bd -literal
\& -----BEGIN TRUSTED CERTIFICATE-----
\& -----END TRUSTED CERTIFICATE-----
d7893 2
a7894 1
This is commonly called a "fingerprint".
d7923 2
a7924 2
If the CA flag is true then it is a CA,
if the CA flag is false then it is not a CA.
d7930 4
a7933 3
extension is absent then the certificate is
considered to be a "possible CA"; other extensions are checked according
to the intended use of the certificate.
d7938 3
a7940 2
If the certificate is a V1 certificate (and thus has no extensions) and
it is self-signed, it is also assumed to be a CA but a warning is again
d7958 2
a7959 1
If this extension is present (whether critical or not)
d7973 2
a7974 1
"web client authentication" OID.
d7983 2
a7984 1
"web client authentication" OID.
d7991 2
a7992 1
"web server authentication" and/or one of the SGC OIDs.
d8002 2
a8003 1
"web server authentication" and/or one of the SGC OIDs.
d8019 2
a8020 1
"email protection" OID.
d8026 1
a8026 1
bit is not set in netscape certificate type, then the SSL
d8049 2
a8050 1
"email protection" OID.
@


1.6
log
@mop up; yet retain libcom_err
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.10 2003/07/16 09:05:58 jmc Exp $
d2220 1
a2220 1
argument uses an ASN1 DER encoded form compatible with RFC2459 (PKIX)
d3180 1
a3180 1
OCSP Response follows the rules specified in RFC2560.
d3476 2
a3477 2
The PKCS#7 routines only understand PKCS#7 v 1.5 as specified in RFC2315.
They cannot currently parse, for example, the new CMS as described in RFC2630.
d4476 1
a4476 1
This follows the PKIX recommendation in RFC2459.
d4481 1
a4481 1
will be used: this is the PKIX recommendation in RFC2459 after 2003.
d7253 1
a7253 1
Displays names compatible with RFC2253; equivalent to
d7274 1
a7274 1
Escape the "special" characters required by RFC2253 in a field that is
d7298 1
a7298 1
This is required by RFC2253.
d7352 1
a7352 1
This is required by RFC2253.
@


1.5
log
@merge cvs import - OpenBSD tree as of Thu Jun 19 16:13:15 UTC 2003
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.9 2003/06/12 12:59:51 jmc Exp $
a474 1
.Pp
a514 1
.Pp
a829 1
.Pp
a1055 1
.Pp
a1065 1
.Pp
a1104 1
.Pp
a1316 1
.br
a1440 1
.Pp
a1452 1
.Pp
a1466 1
.Pp
a1473 1
.Pp
a1480 1
.Pp
a1492 1
.Pp
a1506 1
.Pp
a1537 1
.Pp
a1546 1
.Pp
a1669 1
.Pp
a1754 1
.Pp
a2007 1
.Pp
a2158 1
.Pp
a2166 1
.Pp
a2290 1
.Pp
a2518 1
.Pp
a2525 1
.Pp
a2533 1
.Pp
a2540 1
.Pp
a2546 1
.Pp
a2553 1
.Pp
a2556 1
.Pp
a2563 1
.Pp
a2572 1
.Pp
a2577 1
.Pp
a2837 1
.Pp
a2844 1
.Pp
a2912 1
.br
a3222 1
.Pp
a3258 1
.Pp
a3266 1
.Pp
a3272 1
.Pp
a3280 1
.Pp
a3286 1
.Pp
a3292 1
.Pp
a3299 1
.Pp
a3397 1
.br
a3462 1
.Pp
a3468 1
.Pp
a3634 1
.Pp
a3640 1
.Pp
a3670 1
.Pp
a4010 1
.br
a4016 1
.Pp
a4022 1
.Pp
a4058 1
.Pp
a4548 1
.Pp
a4567 1
.Pp
a4633 1
.Pp
a4645 1
.br
a4649 1
.Pp
a4657 1
.Pp
a4663 1
.Pp
a4702 1
.Pp
a4729 1
.Pp
a4735 1
.Pp
a4755 1
.Pp
a4761 1
.Pp
a4774 1
.Pp
a4961 1
.Pp
a4969 1
.Pp
a5011 1
.br
a5110 1
.Pp
a5135 1
.Pp
a5168 1
.Pp
a5186 1
.Pp
a5677 1
.Pp
a5808 1
.Pp
a5848 1
.Pp
a6186 1
.Pp
a6192 1
.Pp
a6199 1
.Pp
a6207 1
.Pp
a6214 1
.Pp
a6220 1
.Pp
a6227 1
.Pp
a6249 1
.Pp
a6255 2
.br
.Pp
a6261 1
.Pp
a6329 1
.Pp
a6438 1
.Pp
a6635 1
.Pp
a6653 1
.Pp
a7112 1
.Pp
a7480 1
.Pp
a7487 1
.Pp
a7494 1
.Pp
a7502 1
.Pp
a7508 1
.Pp
a7514 1
.Pp
a7601 1
.Pp
@


1.4
log
@merge cvs import
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.8 2003/05/12 10:52:57 jmc Exp $
d7814 1
a7814 1
.Sh "HISTORY"
@


1.3
log
@merge conflicts; fix what(1) stdin
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.7 2003/04/30 12:11:44 jmc Exp $
a137 1
.Pp
d229 1
a229 1
.Sy Note:
a420 1
.Pp
d555 4
d585 1
d618 1
a618 1
.Sx CA NOTES
d727 8
d751 29
d855 1
a855 1
.Fl cert.
d1014 1
a1014 1
.Sy Note:
a1104 17
.Sh CA WARNINGS
The
.Nm ca
command is quirky and at times downright unfriendly.
.Pp
The
.Nm ca
utility was originally meant as an example of how to do things in a CA.
It was not supposed to be used as a full blown CA itself;
nevertheless some people are using it for this purpose.
.Pp
The
.Nm ca
command is effectively a single user command: no locking is
done on the various files and attempts to run more than one
.Nm ca
command on the same database can have unpredictable results.
d1106 1
a1106 1
.Sy Note:
a1134 3
CRL entry extensions cannot currently be created; only CRL extensions
can be added.
.Pp
d1177 17
d1421 2
d1443 3
d1447 1
a1447 1
.Cm SSL v3.0 cipher suites
d1450 10
a1459 10
\& SSL_RSA_WITH_NULL_MD5                   NULL-MD5
\& SSL_RSA_WITH_NULL_SHA                   NULL-SHA
\& SSL_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
\& SSL_RSA_WITH_RC4_128_MD5                RC4-MD5
\& SSL_RSA_WITH_RC4_128_SHA                RC4-SHA
\& SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
\& SSL_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
\& SSL_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
\& SSL_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
\& SSL_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
d1463 12
a1474 12
\& SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
\& SSL_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
\& SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
\& SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
\& SSL_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
\& SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
\& SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
\& SSL_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
\& SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
\& SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
\& SSL_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
\& SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
d1478 5
a1482 5
\& SSL_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
\& SSL_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
\& SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
\& SSL_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
\& SSL_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
d1486 3
a1488 3
\& SSL_FORTEZZA_KEA_WITH_NULL_SHA          Not implemented.
\& SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA  Not implemented.
\& SSL_FORTEZZA_KEA_WITH_RC4_128_SHA       Not implemented.
d1491 1
a1491 1
.Cm TLS v1.0 cipher suites
d1494 10
a1503 10
\& TLS_RSA_WITH_NULL_MD5                   NULL-MD5
\& TLS_RSA_WITH_NULL_SHA                   NULL-SHA
\& TLS_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
\& TLS_RSA_WITH_RC4_128_MD5                RC4-MD5
\& TLS_RSA_WITH_RC4_128_SHA                RC4-SHA
\& TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
\& TLS_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
\& TLS_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
\& TLS_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
\& TLS_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
d1507 12
a1518 12
\& TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
\& TLS_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
\& TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
\& TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
\& TLS_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
\& TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
\& TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
\& TLS_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
\& TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
\& TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
\& TLS_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
\& TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
d1522 5
a1526 5
\& TLS_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
\& TLS_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
\& TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
\& TLS_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
\& TLS_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
d1529 18
a1546 1
.Cm Additional Export 1024 and other cipher suites
d1548 3
a1550 1
.Sy Note:
d1554 17
a1570 17
\& TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA     EXP1024-DES-CBC-SHA
\& TLS_RSA_EXPORT1024_WITH_RC4_56_SHA      EXP1024-RC4-SHA
\& TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA EXP1024-DHE-DSS-DES-CBC-SHA
\& TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA  EXP1024-DHE-DSS-RC4-SHA
\& TLS_DHE_DSS_WITH_RC4_128_SHA            DHE-DSS-RC4-SHA
.Ed
.Pp
.Cm SSL v2.0 cipher suites
.Pp
.Bd -literal
\& SSL_CK_RC4_128_WITH_MD5                 RC4-MD5
\& SSL_CK_RC4_128_EXPORT40_WITH_MD5        EXP-RC4-MD5
\& SSL_CK_RC2_128_CBC_WITH_MD5             RC2-MD5
\& SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5    EXP-RC2-MD5
\& SSL_CK_IDEA_128_CBC_WITH_MD5            IDEA-CBC-MD5
\& SSL_CK_DES_64_CBC_WITH_MD5              DES-CBC-MD5
\& SSL_CK_DES_192_EDE3_CBC_WITH_MD5        DES-CBC3-MD5
a1571 1
.Pp
d1842 1
a1842 1
.Ar filename.
d1888 1
a1888 1
.Nm dhparam.
d1909 1
d1996 8
d2070 1
d2078 1
a2078 1
.Sy Note:
d2165 8
d2217 1
d2227 1
d2229 1
d2300 8
d2670 1
a2670 1
.Nm dhparam.
d2684 1
d2717 8
d2748 1
d2795 8
d2906 4
d2919 1
a2919 1
.Op Fl url Ar responder_url
d2922 1
a2922 1
.Op Fl CApath Ar file
d2925 2
a2926 1
.Op Fl verify_certs Ar file
d2928 1
d2931 1
a2931 1
.Op Fl no_sig_verify
d2935 11
a2945 2
.Op Fl validity_period Ar nsec
.Op Fl status_age Ar nsec
a2948 3
.Sy WARNING:
this documentation is preliminary and subject to change.
.Pp
d3000 2
d3060 1
a3060 1
.It Fl verify_certs Ar file
d3095 1
a3095 1
.It Fl no_sig_verify
a3139 1
.Pp
d3372 1
a3372 1
.Fl stdin,
a3414 1
.Pp
d3421 1
a3421 1
.Em $1$xxxxxxxx$8XJIcl6ZXqBMCK0qFevqT1 .
d3439 1
d3483 8
d3544 1
d3667 8
d4214 1
d4317 1
a4317 1
.Ar filename.
d4428 8
d4668 1
a4668 1
.Em organizationUnitName , stateOrPrivinceName .
d4793 2
a4794 2
\& -----BEGIN CERTIFICATE REQUEST----
\& -----END CERTIFICATE REQUEST----
d4800 2
a4801 2
\& -----BEGIN NEW CERTIFICATE REQUEST----
\& -----END NEW CERTIFICATE REQUEST----
d4898 1
d4915 2
d5015 8
d5271 1
d5297 2
d5301 1
d5413 5
d5561 1
d5718 6
d6335 2
a6336 2
\& -----BEGIN PKCS7----
\& -----END PKCS7----
d6448 1
d6504 8
d6981 1
d7034 8
d7050 1
a7050 1
.Sx X509 TRUST OPTIONS
d7309 1
a7309 1
.It Fl CAcreateserial Ar filename
d7588 1
a7588 1
client use and change set its alias to "Steve's Class 1 CA":
d7591 2
a7592 2
\& $ openssl x509 -in cert.pem -addtrust sslclient \e
\&        -alias "Steve's Class 1 CA" -out trust.pem
d7600 2
a7601 2
\& -----BEGIN CERTIFICATE----
\& -----END CERTIFICATE----
d7607 2
a7608 2
\& -----BEGIN X509 CERTIFICATE----
\& -----END X509 CERTIFICATE----
d7614 2
a7615 2
\& -----BEGIN TRUSTED CERTIFICATE----
\& -----END TRUSTED CERTIFICATE----
@


1.2
log
@hint: openssl(1) and openssltool(1) [former openssl(1) on BSD-mirabile]
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.5 2003/03/22 08:02:03 david Exp $
d10 1
a10 1
.\"    notice, this list of conditions and the following disclaimer. 
d54 1
a54 1
.\" 
d61 1
a61 1
.\" 
d68 1
a68 1
.\" 
d75 1
a75 1
.\" 
d90 1
a90 1
.\" 4. If you include any Windows specific code (or a derivative thereof) from 
d95 1
a95 1
.\" 
d107 1
a107 1
.\" 
d151 2
a152 2
library from the shell. 
It can be used for 
d158 1
a158 1
Creation of X.509 certificates, CSRs and CRLs 
d417 1
d440 1
a440 1
.Bl -tag -width Ds
d474 1
d480 1
a480 1
.Pp
d482 5
a486 5
.Pp
  229:d=3  hl=3 l= 141 prim: BIT STRING        
  373:d=2  hl=3 l= 162 cons: cont [ 3 ]        
  376:d=3  hl=3 l= 159 cons: SEQUENCE          
  379:d=4  hl=2 l=  29 cons: SEQUENCE          
d488 2
a489 2
  386:d=5  hl=2 l=  22 prim: OCTET STRING      
  410:d=4  hl=2 l= 112 cons: SEQUENCE          
d491 1
a491 1
  417:d=5  hl=2 l= 105 prim: OCTET STRING      
d493 1
a493 1
.Pp
d511 1
a511 1
Some knowledge of the ASN.1 structure is needed to interpret the output. 
d520 1
a520 1
\&    0:d=0  hl=3 l= 137 cons: SEQUENCE          
d523 1
d594 1
a594 1
.Bl -tag -width Ds
d619 1
a619 1
are assumed to be the names of files containing certificate requests. 
d726 1
a726 1
.Bl -tag -width Ds
d758 1
a758 1
can't handle V2 CRLs. 
d793 1
a793 1
.Bl -tag -width Ds
d798 1
a798 1
by whitespace and finally the long name. 
d832 1
a832 1
The number of days to certify a certificate for. 
d964 1
a964 1
tag in an HTML form to create a new private key. 
d1211 1
a1211 1
.Bl -tag -width -Ds
d1304 1
a1304 1
.Bl -tag -width Ds
d1501 1
a1502 1
.Pp
d1578 1
a1578 1
.Bl -tag -width Ds
d1587 1
a1587 1
This specifies the output format; the options have the same meaning as the 
d1666 1
a1666 1
.Bl -tag -width Ds
d1714 1
a1714 1
\& $ openssl crl2pkcs7 -nocrl -certfile newcert.pem 
d1762 1
a1762 1
.Bl -tag -width Ds
d1802 1
a1802 1
for all others. 
d1857 1
a1857 1
.Bl -tag -width Ds
d1870 1
a1870 1
This specifies the output format, the options have the same meaning as the 
d1924 1
a1924 1
If this value is present then the input file is ignored and 
d1935 1
d1951 1
a1951 1
programs are retained for now, but may have different purposes in future 
d2017 1
a2017 1
.Bl -tag -width Ds
d2037 1
a2037 1
This specifies the output format, the options have the same meaning as the 
d2069 1
a2069 1
These options encrypt the private key with the DES, triple DES, or the 
d2095 1
d2123 1
a2123 1
To convert a private key from PEM to DER format: 
d2155 1
a2155 1
.Bl -tag -width Ds
d2168 1
a2168 1
This specifies the output format; the options have the same meaning as the 
d2260 1
a2260 1
.Bl -tag -width Ds
d2605 1
a2605 1
.Bl -tag -width Ds
d2633 1
d2657 1
a2657 1
.Bl -tag -width Ds
d2670 1
a2670 1
These options encrypt the private key with the DES, triple DES, or the 
d2700 1
d2739 1
a2739 1
.Bl -tag -width Ds
d2841 1
a2841 1
.Bl -tag -width Ds
d3020 1
a3020 1
.Bl -tag -with DS
d3081 1
a3081 1
requests, default unlimited. 
d3263 1
a3263 1
.Bl -tag -width Ds
d3296 1
a3296 1
.Bl -tag -width Ds
d3306 1
d3332 1
a3332 1
.Bl -tag -width Ds
d3341 1
a3341 1
This specifies the output format, the options have the same meaning as the 
d3363 1
d3426 1
a3426 1
.Bl -tag -width Ds
d3448 1
a3448 1
This specifies the output format, the options have the same meaning as the 
d3492 1
a3492 1
Specifically the private key should be enclosed in a OCTET STRING,
d3538 1
d3583 2
a3584 3
.Bd -literal -offset indent
.It Ar \  \  PBE-MD2-DES PBE-MD5-DES
.br
d3587 1
a3587 2
.It Ar \  \  PBE-SHA1-RC2-64 PBE-MD2-RC2-64 PBE-MD5-RC2-64 PBE-SHA1-DES
.br
d3593 1
a3593 2
.It Ar \  \  PBE-SHA1-RC4-128 PBE-SHA1-RC4-40 PBE-SHA1-3DES PBE-SHA1-2DES PBE-SHA1-RC2-128 PBE-SHA1-RC2-40
.br
d3596 1
a3596 1
.Ed
d3688 1
a3688 1
.Bd -ragged -offset indent
d3743 1
a3743 1
.Ed
d3745 1
a3745 1
.Bd -ragged -offset indent
d3861 1
a3861 1
.Ed
d4012 1
a4012 1
.Bd -ragged -offset indent
d4087 1
a4087 1
.Bd -ragged -offset indent
d4100 1
a4100 1
This specifies the output format, the options have the same meaning as the 
d4246 1
a4246 1
This option causes field values to be interpreted as UTF8 strings, by 
d4290 1
a4290 1
.Ed
d4303 1
a4303 1
.Bd -ragged -offset indent
d4331 1
a4331 1
by whitespace and finally the long name. 
d4376 1
a4376 1
if the 
d4447 1
a4447 1
.Ed
d4783 1
a4783 1
.Bd -ragged -offset indent
d4802 1
a4802 1
This specifies the output format, the options have the same meaning as the 
d4838 1
a4838 1
These options encrypt the private key with the DES, triple DES, or the 
d4852 1
a4852 1
plain text, in addition to the encoded version. 
d4866 1
a4866 1
.Ed
d4920 1
a4920 1
format: 
d4965 1
a4965 1
.Bd -ragged -offset indent
d4979 1
a4979 1
The input file is an RSA public key. 
d4981 1
a4981 1
The input is a certificate containing an RSA public key. 
d5051 3
a5053 3
\&    0:d=0  hl=4 l= 742 cons: SEQUENCE          
\&    4:d=1  hl=4 l= 591 cons:  SEQUENCE          
\&    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]        
d5056 1
a5056 1
\&   16:d=2  hl=2 l=  13 cons:   SEQUENCE          
d5058 4
a5061 4
\&   29:d=3  hl=2 l=   0 prim:    NULL              
\&   31:d=2  hl=2 l=  92 cons:   SEQUENCE          
\&   33:d=3  hl=2 l=  11 cons:    SET               
\&   35:d=4  hl=2 l=   9 cons:     SEQUENCE          
d5065 1
a5065 1
\&  599:d=1  hl=2 l=  13 cons:  SEQUENCE          
d5067 1
a5067 1
\&  612:d=2  hl=2 l=   0 prim:   NULL              
d5085 2
a5086 2
\&    0:d=0  hl=2 l=  32 cons: SEQUENCE          
\&    2:d=1  hl=2 l=  12 cons:  SEQUENCE          
d5088 2
a5089 2
\&   14:d=2  hl=2 l=   0 prim:   NULL              
\&   16:d=1  hl=2 l=  16 prim:  OCTET STRING      
d5151 1
a5151 1
.Bd -ragged -offset indent
d5277 1
a5277 1
.Ed
d5404 1
a5404 1
.Bd -ragged -offset indent
d5567 1
a5567 1
.Ed
d5574 1
a5574 1
from the client is displayed and any key presses will be sent to the client. 
d5579 1
a5579 1
.Bd -ragged -offset indent
d5593 1
a5593 1
.Ed
d5664 1
a5664 1
.Bd -ragged -offset indent
d5677 1
a5677 1
This specifies the output format, the options have the same meaning as the 
d5691 1
a5691 1
plain text in addition to the encoded version. 
d5707 1
a5707 1
.Ed
d5725 1
a5725 1
.Bd -ragged -offset indent
d5746 1
a5746 1
.Ed
d5812 1
a5812 1
.Bd -ragged -offset indent
d5902 1
a5902 1
.Em MIME 
d6017 1
a6017 1
a message. 
d6026 1
a6026 1
.Ed
d6071 1
a6071 1
.Bd -ragged -offset indent
d6087 1
a6087 1
.Ed
d6245 1
a6245 1
.Bd -ragged -offset indent
d6259 1
a6259 1
.Ed
d6284 1
a6284 1
.Bd -ragged -offset indent
d6330 1
a6330 1
.Ed
d6384 1
a6384 1
.Op Fl 
d6392 1
a6392 1
.Bd -ragged -offset indent
d6446 1
a6446 1
.It Fl 
d6460 1
a6460 1
.Ed
d6482 1
a6482 1
If a certificate is found which is its own issuer it is assumed 
d6527 1
a6527 1
all purposes. 
d6563 1
a6563 1
.Bd -ragged -offset indent
d6685 1
a6685 1
.Ed
d6720 1
a6720 1
.Bd -ragged -offset indent
d6740 1
a6740 1
.Ed
d6811 1
a6811 1
.Bd -ragged -offset indent
d6829 1
a6829 1
the options have the same meaning as the 
d6851 1
a6851 1
.Ed
d6861 1
a6861 1
.Bd -ragged -offset indent
d6925 1
a6925 1
.Ed
d6953 1
a6953 1
.Bd -ragged -offset indent
d7007 1
a7007 1
.Ed
d7014 1
a7014 1
.Bd -ragged -offset indent
d7017 1
a7017 1
private key. 
d7114 1
a7114 1
For example if the CA certificate file is called 
d7133 1
a7133 1
.Ed
d7149 1
a7149 1
.Bd -ragged -offset indent
d7276 1
a7276 1
.Ed
d7285 1
a7285 1
.Bd -ragged -offset indent
d7333 1
a7333 1
.Ed
d7510 1
a7510 1
.Bd -ragged -offset indent
d7589 1
a7589 1
extension is absent. 
d7601 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.4 2003/03/18 12:58:22 david Exp $
d168 13
d1346 1
a1346 1
.It Ar eNULL, NULL
d4353 1
a4353 1
.Ar md5, sha1
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright  1968-2003  The authors of And contributors to UNIX, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import OpenBSD repository of CTM 3155 (roughly today at noon).
Mostly in order to go 3.3-current and ease further merges of
both OpenBSD and ELFdiffs after the MirBSD has been enabled
to build again.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.5 2003/03/22 08:02:03 david Exp $
d1333 1
a1333 1
.It Ar eNULL , NULL
d4340 1
a4340 1
.Ar md5 , sha1
@


1.1.1.3
log
@Import OpenBSD source tree of short before 17:00 UTC today
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.7 2003/04/30 12:11:44 jmc Exp $
d10 1
a10 1
.\"    notice, this list of conditions and the following disclaimer.
d54 1
a54 1
.\"
d61 1
a61 1
.\"
d68 1
a68 1
.\"
d75 1
a75 1
.\"
d90 1
a90 1
.\" 4. If you include any Windows specific code (or a derivative thereof) from
d95 1
a95 1
.\"
d107 1
a107 1
.\"
d151 2
a152 2
library from the shell.
It can be used for
d158 1
a158 1
Creation of X.509 certificates, CSRs and CRLs
a403 1
.El
d426 1
a426 1
.Bl -tag -width "XXXX"
a459 1
.El
d465 1
a465 1

d467 5
a471 5

  229:d=3  hl=3 l= 141 prim: BIT STRING
  373:d=2  hl=3 l= 162 cons: cont [ 3 ]
  376:d=3  hl=3 l= 159 cons: SEQUENCE
  379:d=4  hl=2 l=  29 cons: SEQUENCE
d473 2
a474 2
  386:d=5  hl=2 l=  22 prim: OCTET STRING
  410:d=4  hl=2 l= 112 cons: SEQUENCE
d476 1
a476 1
  417:d=5  hl=2 l= 105 prim: OCTET STRING
d478 1
a478 1

d496 1
a496 1
Some knowledge of the ASN.1 structure is needed to interpret the output.
d505 1
a505 1
\&    0:d=0  hl=3 l= 137 cons: SEQUENCE
a507 1
.Ed
d578 1
a578 1
.Bl -tag -width "XXXX"
d603 1
a603 1
are assumed to be the names of files containing certificate requests.
d710 1
a710 1
.Bl -tag -width "XXXX"
d742 1
a742 1
can't handle V2 CRLs.
d777 1
a777 1
.Bl -tag -width "XXXX"
d782 1
a782 1
by whitespace and finally the long name.
d816 1
a816 1
The number of days to certify a certificate for.
d948 1
a948 1
tag in an HTML form to create a new private key.
d1195 1
a1195 1
.Bl -tag -width "XXXX"
d1288 1
a1288 1
.Bl -tag -width "XXXX"
d1485 1
a1486 1
.Bd -literal
d1562 1
a1562 1
.Bl -tag -width "XXXX"
d1571 1
a1571 1
This specifies the output format; the options have the same meaning as the
d1650 1
a1650 1
.Bl -tag -width "XXXX"
d1698 1
a1698 1
\& $ openssl crl2pkcs7 -nocrl -certfile newcert.pem
d1746 1
a1746 1
.Bl -tag -width "XXXX"
d1786 1
a1786 1
for all others.
d1841 1
a1841 1
.Bl -tag -width "XXXX"
d1854 1
a1854 1
This specifies the output format, the options have the same meaning as the
d1908 1
a1908 1
If this value is present then the input file is ignored and
a1918 1
.El
d1934 1
a1934 1
programs are retained for now, but may have different purposes in future
d2000 1
a2000 1
.Bl -tag -width "XXXX"
d2020 1
a2020 1
This specifies the output format, the options have the same meaning as the
d2052 1
a2052 1
These options encrypt the private key with the DES, triple DES, or the
a2077 1
.El
d2105 1
a2105 1
To convert a private key from PEM to DER format:
d2137 1
a2137 1
.Bl -tag -width "XXXX"
d2150 1
a2150 1
This specifies the output format; the options have the same meaning as the
d2242 1
a2242 1
.Bl -tag -width "XXXX"
d2587 1
a2587 1
.Bl -tag -width "XXXX"
a2614 1
.El
d2638 1
a2638 1
.Bl -tag -width "XXXX"
d2651 1
a2651 1
These options encrypt the private key with the DES, triple DES, or the
a2680 1
.El
d2719 1
a2719 1
.Bl -tag -width "XXXX"
d2821 1
a2821 1
.Bl -tag -width "XXXX"
d3000 1
a3000 1
.Bl -tag -width "XXXX"
d3061 1
a3061 1
requests, default unlimited.
d3243 1
a3243 1
.Bl -tag -width "XXXX"
d3276 1
a3276 1
.Bl -tag -width "XXXX"
a3285 1
.El
d3311 1
a3311 1
.Bl -tag -width "XXXX"
d3320 1
a3320 1
This specifies the output format, the options have the same meaning as the
a3341 1
.El
d3404 1
a3404 1
.Bl -tag -width "XXXX"
d3426 1
a3426 1
This specifies the output format, the options have the same meaning as the
d3470 1
a3470 1
Specifically the private key should be enclosed in an OCTET STRING,
a3515 1
.El
d3560 3
a3562 2
.Bl -tag -width "XXXX"
.It Ar PBE-MD2-DES PBE-MD5-DES
d3565 2
a3566 1
.It Ar PBE-SHA1-RC2-64 PBE-MD2-RC2-64 PBE-MD5-RC2-64 PBE-SHA1-DES
d3572 2
a3573 1
.It Ar PBE-SHA1-RC4-128 PBE-SHA1-RC4-40 PBE-SHA1-3DES PBE-SHA1-2DES PBE-SHA1-RC2-128 PBE-SHA1-RC2-40
d3576 1
a3576 1
.El
d3668 1
a3668 1
.Bl -tag -width "XXXX"
d3723 1
a3723 1
.El
d3725 1
a3725 1
.Bl -tag -width "XXXX"
d3841 1
a3841 1
.El
d3992 1
a3992 1
.Bl -tag -width "XXXX"
d4067 1
a4067 1
.Bl -tag -width "XXXX"
d4080 1
a4080 1
This specifies the output format, the options have the same meaning as the
d4226 1
a4226 1
This option causes field values to be interpreted as UTF8 strings, by
d4270 1
a4270 1
.El
d4283 1
a4283 1
.Bl -tag -width "XXXX"
d4311 1
a4311 1
by whitespace and finally the long name.
d4356 1
a4356 1
if the
d4427 1
a4427 1
.El
d4763 1
a4763 1
.Bl -tag -width "XXXX"
d4782 1
a4782 1
This specifies the output format, the options have the same meaning as the
d4818 1
a4818 1
These options encrypt the private key with the DES, triple DES, or the
d4832 1
a4832 1
plain text, in addition to the encoded version.
d4846 1
a4846 1
.El
d4900 1
a4900 1
format:
d4945 1
a4945 1
.Bl -tag -width "XXXX"
d4959 1
a4959 1
The input file is an RSA public key.
d4961 1
a4961 1
The input is a certificate containing an RSA public key.
d5031 3
a5033 3
\&    0:d=0  hl=4 l= 742 cons: SEQUENCE
\&    4:d=1  hl=4 l= 591 cons:  SEQUENCE
\&    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
d5036 1
a5036 1
\&   16:d=2  hl=2 l=  13 cons:   SEQUENCE
d5038 4
a5041 4
\&   29:d=3  hl=2 l=   0 prim:    NULL
\&   31:d=2  hl=2 l=  92 cons:   SEQUENCE
\&   33:d=3  hl=2 l=  11 cons:    SET
\&   35:d=4  hl=2 l=   9 cons:     SEQUENCE
d5045 1
a5045 1
\&  599:d=1  hl=2 l=  13 cons:  SEQUENCE
d5047 1
a5047 1
\&  612:d=2  hl=2 l=   0 prim:   NULL
d5065 2
a5066 2
\&    0:d=0  hl=2 l=  32 cons: SEQUENCE
\&    2:d=1  hl=2 l=  12 cons:  SEQUENCE
d5068 2
a5069 2
\&   14:d=2  hl=2 l=   0 prim:   NULL
\&   16:d=1  hl=2 l=  16 prim:  OCTET STRING
d5131 1
a5131 1
.Bl -tag -width "XXXX"
d5257 1
a5257 1
.El
d5384 1
a5384 1
.Bl -tag -width "XXXX"
d5547 1
a5547 1
.El
d5554 1
a5554 1
from the client is displayed and any key presses will be sent to the client.
d5559 1
a5559 1
.Bl -tag -width "XXXX"
d5573 1
a5573 1
.El
d5644 1
a5644 1
.Bl -tag -width "XXXX"
d5657 1
a5657 1
This specifies the output format, the options have the same meaning as the
d5671 1
a5671 1
plain text in addition to the encoded version.
d5687 1
a5687 1
.El
d5705 1
a5705 1
.Bl -tag -width "XXXX"
d5726 1
a5726 1
.El
d5792 1
a5792 1
.Bl -tag -width "XXXX"
d5882 1
a5882 1
.Em MIME
d5997 1
a5997 1
a message.
d6006 1
a6006 1
.El
d6051 1
a6051 1
.Bl -tag -width "XXXX"
d6067 1
a6067 1
.El
d6225 1
a6225 1
.Bl -tag -width "XXXX"
d6239 1
a6239 1
.El
d6264 1
a6264 1
.Bl -tag -width "XXXX"
d6310 1
a6310 1
.El
d6364 1
a6364 1
.Op Fl
d6372 1
a6372 1
.Bl -tag -width "XXXX"
d6426 1
a6426 1
.It Fl
d6440 1
a6440 1
.El
d6462 1
a6462 1
If a certificate is found which is its own issuer it is assumed
d6507 1
a6507 1
all purposes.
d6543 1
a6543 1
.Bl -tag -width "XXXX"
d6665 1
a6665 1
.El
d6700 1
a6700 1
.Bl -tag -width "XXXX"
d6720 1
a6720 1
.El
d6791 1
a6791 1
.Bl -tag -width "XXXX"
d6809 1
a6809 1
the options have the same meaning as the
d6831 1
a6831 1
.El
d6841 1
a6841 1
.Bl -tag -width "XXXX"
d6905 1
a6905 1
.El
d6933 1
a6933 1
.Bl -tag -width "XXXX"
d6987 1
a6987 1
.El
d6994 1
a6994 1
.Bl -tag -width "XXXX"
d6997 1
a6997 1
private key.
d7094 1
a7094 1
For example if the CA certificate file is called
d7113 1
a7113 1
.El
d7129 1
a7129 1
.Bl -tag -width "XXXX"
d7256 1
a7256 1
.El
d7265 1
a7265 1
.Bl -tag -width "XXXX"
d7313 1
a7313 1
.El
d7490 1
a7490 1
.Bl -tag -width "XXXX"
d7569 1
a7569 1
extension is absent.
a7580 1
.El
@


1.1.1.4
log
@Sync to OpenBSD branch HEAD
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.8 2003/05/12 10:52:57 jmc Exp $
d138 1
d217 1
a217 1
.Sy Note :
d409 1
a543 4
.Op Fl crl_reason Ar reason
.Op Fl crl_hold Ar instruction
.Op Fl crl_compromise Ar time
.Op Fl crl_CA_compromise Ar time
a569 1
.Op Fl engine Ar id
d602 1
a602 1
.Sx SPKAC FORMAT
a710 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a726 29
.It Fl crl_reason Ar reason
Revocation reason, where
.Ar reason
is one of:
unspecified, keyCompromise, CACompromise, affiliationChanged, superseded,
cessationOfOperation, certificateHold or removeFromCRL.
The matching of
.Ar reason
is case insensitive.
Setting any revocation reason will make the CRL v2.
In practive removeFromCRL is not particularly useful because it is only used
in delta CRLs which are not currently implemented.
.It Fl crl_hold Ar instruction
This sets the CRL revocation reason code to certificateHold and the hold
instruction to
.Ar instruction
which must be an OID.
Although any OID can be used, only holdInstructionNone
(the use of which is discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.
.It Fl crl_compromise Ar time
This sets the revocation reason to keyCompromise and the compromise time to
.Ar time .
.Ar time
should be in GeneralizedTime format, i.e. YYYYMMDDHHMMSSZ.
.It Fl crl_CA_compromise Ar time
This is the same as
.Fl crl_compromise ,
except the revocation reason is set to CACompromise.
d802 1
a802 1
.Fl cert .
d961 1
a961 1
.Sy Note :
d1052 17
d1070 1
a1070 1
.Sy Note :
d1099 3
a1143 17
.Nm ca
command is quirky and at times downright unfriendly.
.Pp
The
.Nm ca
utility was originally meant as an example of how to do things in a CA.
It was not supposed to be used as a full blown CA itself:
nevertheless some people are using it for this purpose.
.Pp
The
.Nm ca
command is effectively a single user command: no locking is done on the
various files, and attempts to run more than one
.Nm ca
command on the same database can have unpredictable results.
.Pp
The
a1370 2
.It Ar AES
Cipher suites using AES.
a1390 3
It should be noted that several cipher suite names do not include the
authentication used, e.g. DES-CBC3-SHA.
In these cases, RSA authentication is used.
d1392 1
a1392 1
.Sy "SSL v3.0 cipher suites"
d1395 10
a1404 10
 SSL_RSA_WITH_NULL_MD5                   NULL-MD5
 SSL_RSA_WITH_NULL_SHA                   NULL-SHA
 SSL_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
 SSL_RSA_WITH_RC4_128_MD5                RC4-MD5
 SSL_RSA_WITH_RC4_128_SHA                RC4-SHA
 SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
 SSL_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
 SSL_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
 SSL_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
 SSL_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
d1408 12
a1419 12
 SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 SSL_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
 SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
 SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 SSL_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
 SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
 SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
 SSL_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
 SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
 SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
 SSL_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
 SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
d1423 5
a1427 5
 SSL_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
 SSL_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
 SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
 SSL_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
 SSL_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
d1431 3
a1433 3
 SSL_FORTEZZA_KEA_WITH_NULL_SHA          Not implemented.
 SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA  Not implemented.
 SSL_FORTEZZA_KEA_WITH_RC4_128_SHA       Not implemented.
d1436 1
a1436 1
.Sy "TLS v1.0 cipher suites"
d1439 10
a1448 10
 TLS_RSA_WITH_NULL_MD5                   NULL-MD5
 TLS_RSA_WITH_NULL_SHA                   NULL-SHA
 TLS_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
 TLS_RSA_WITH_RC4_128_MD5                RC4-MD5
 TLS_RSA_WITH_RC4_128_SHA                RC4-SHA
 TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
 TLS_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
 TLS_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
 TLS_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
 TLS_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
d1452 12
a1463 12
 TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 TLS_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
 TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
 TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
 TLS_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
 TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
 TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
 TLS_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
 TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
 TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
 TLS_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
 TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
d1467 5
a1471 5
 TLS_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
 TLS_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
 TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
 TLS_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
 TLS_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
d1474 1
a1474 18
.Sy "AES ciphersuites from RFC 3268, extending TLS v1.0"
.Bd -literal
 TLS_RSA_WITH_AES_128_CBC_SHA            AES128-SHA
 TLS_RSA_WITH_AES_256_CBC_SHA            AES256-SHA

 TLS_DH_DSS_WITH_AES_128_CBC_SHA         DH-DSS-AES128-SHA
 TLS_DH_DSS_WITH_AES_256_CBC_SHA         DH-DSS-AES256-SHA
 TLS_DH_RSA_WITH_AES_128_CBC_SHA         DH-RSA-AES128-SHA
 TLS_DH_RSA_WITH_AES_256_CBC_SHA         DH-RSA-AES256-SHA

 TLS_DHE_DSS_WITH_AES_128_CBC_SHA        DHE-DSS-AES128-SHA
 TLS_DHE_DSS_WITH_AES_256_CBC_SHA        DHE-DSS-AES256-SHA
 TLS_DHE_RSA_WITH_AES_128_CBC_SHA        DHE-RSA-AES128-SHA
 TLS_DHE_RSA_WITH_AES_256_CBC_SHA        DHE-RSA-AES256-SHA

 TLS_DH_anon_WITH_AES_128_CBC_SHA        ADH-AES128-SHA
 TLS_DH_anon_WITH_AES_256_CBC_SHA        ADH-AES256-SHA
.Ed
d1476 1
a1476 3
.Sy "Additional Export 1024 and other cipher suites"
.Pp
.Sy Note :
d1480 17
a1496 17
 TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA     EXP1024-DES-CBC-SHA
 TLS_RSA_EXPORT1024_WITH_RC4_56_SHA      EXP1024-RC4-SHA
 TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA EXP1024-DHE-DSS-DES-CBC-SHA
 TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA  EXP1024-DHE-DSS-RC4-SHA
 TLS_DHE_DSS_WITH_RC4_128_SHA            DHE-DSS-RC4-SHA
.Ed
.Pp
.Sy "SSL v2.0 cipher suites"
.Pp
.Bd -literal
 SSL_CK_RC4_128_WITH_MD5                 RC4-MD5
 SSL_CK_RC4_128_EXPORT40_WITH_MD5        EXP-RC4-MD5
 SSL_CK_RC2_128_CBC_WITH_MD5             RC2-MD5
 SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5    EXP-RC2-MD5
 SSL_CK_IDEA_128_CBC_WITH_MD5            IDEA-CBC-MD5
 SSL_CK_DES_64_CBC_WITH_MD5              DES-CBC-MD5
 SSL_CK_DES_192_EDE3_CBC_WITH_MD5        DES-CBC3-MD5
d1498 1
d1769 1
a1769 1
.Ar filename .
d1815 1
a1815 1
.Nm dhparam .
a1835 1
.Op Fl engine Ar id
a1921 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a1987 1
.Op Fl engine Ar id
d1995 1
a1995 1
.Sy Note :
a2081 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a2125 1
.Bk -words
a2134 1
.Op Fl engine Ar id
a2135 1
.Ek
a2205 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2568 1
a2568 1
.Nm dhparam .
a2581 1
.Op Fl engine Ar id
a2613 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a2636 1
.Op Fl engine Ar id
a2682 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a2785 4
.Op Fl signer Ar file
.Op Fl signkey Ar file
.Op Fl sign_other Ar file
.Op Fl no_certs
d2795 1
a2795 1
.Op Fl url Ar URL
d2798 1
a2798 1
.Op Fl CApath Ar dir
d2801 1
a2801 2
.Op Fl validity_period Ar n
.Op Fl status_age Ar n
a2802 1
.Op Fl verify_other Ar file
d2805 1
a2805 1
.Op Fl no_signature_verify
d2809 2
a2810 11
.Op Fl port Ar num
.Op Fl index Ar file
.Op Fl CA Ar file
.Op Fl rsigner Ar file
.Op Fl rkey Ar file
.Op Fl rother Ar file
.Op Fl resp_no_certs
.Op Fl nmin Ar n
.Op Fl ndays Ar n
.Op Fl resp_key_id
.Op Fl nrequest Ar n
d2814 3
a2867 2
.It Fl sign_other Ar filename
Additional certificates to include in the signed request.
d2926 1
a2926 1
.It Fl verify_other Ar file
d2961 1
a2961 1
.It Fl no_signature_verify
d3006 1
d3239 1
a3239 1
.Fl stdin ,
d3282 1
d3289 1
a3289 1
.Em $1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a. .
a3306 1
.Op Fl engine Ar id
a3349 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a3402 1
.Op Fl engine Ar id
a3524 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a4063 1
.Op Fl engine Ar id
d4166 1
a4166 1
.Ar filename .
a4276 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d4509 1
a4509 1
.Em organizationUnitName , stateOrProvinceName .
d4634 2
a4635 2
\& -----BEGIN CERTIFICATE REQUEST-----
\& -----END CERTIFICATE REQUEST-----
d4641 2
a4642 2
\& -----BEGIN NEW CERTIFICATE REQUEST-----
\& -----END NEW CERTIFICATE REQUEST-----
a4738 1
.Bk -words
a4754 2
.Op Fl engine Ar id
.Ek
a4852 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a5100 1
.Bk -words
a5125 2
.Op Fl starttls Ar protocol
.Op Fl starttls Ar protocol
a5127 1
.Ek
a5238 5
.It Fl starttls Ar protocol
Send the protocol-specific message(s) to switch to TLS for communication.
.Ar protocol
is a keyword for the intended protocol.
Currently, the only supported keyword is "smtp".
a5381 1
.Op Fl id_prefix Ar arg
a5537 6
.It Fl id_prefix Ar arg
Generate SSL/TLS session IDs prefixed by
.Ar arg .
This is mostly useful for testing any SSL/TLS code (e.g. proxies) that wish
to deal with multiple servers, when each of which might be generating a
unique range of session IDs (e.g. with a certain prefix).
d6149 2
a6150 2
\& -----BEGIN PKCS7-----
\& -----END PKCS7-----
a6261 1
.Op Fl engine Ar id
a6316 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
a6785 1
.Op Fl engine Ar id
a6837 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d6846 1
a6846 1
.Sx X509 TRUST SETTINGS
d7105 1
a7105 1
.It Fl CAcreateserial
d7384 1
a7384 1
client use and set its alias to "Steve's Class 1 CA":
d7387 2
a7388 2
\& $ openssl x509 -in cert.pem -addtrust clientAuth \e
\&        -setalias "Steve's Class 1 CA" -out trust.pem
d7396 2
a7397 2
\& -----BEGIN CERTIFICATE-----
\& -----END CERTIFICATE-----
d7403 2
a7404 2
\& -----BEGIN X509 CERTIFICATE-----
\& -----END X509 CERTIFICATE-----
d7410 2
a7411 2
\& -----BEGIN TRUSTED CERTIFICATE-----
\& -----END TRUSTED CERTIFICATE-----
@


1.1.1.5
log
@sync with OpenBSD, this gives us a fair amount of fixes
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.9 2003/06/12 12:59:51 jmc Exp $
d7801 1
a7801 1
.Sh HISTORY
@


1.1.1.6
log
@Synchronize source tree with OpenBSD
note: due to recent changes in the codebase of OpenBSD,
out libcom_err will be incompatible with theirs...
but this is no issue because we don't provide a dynamically
linked one, and theirs won't be provided longer any more anyways.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.10 2003/07/16 09:05:58 jmc Exp $
d462 1
d503 1
d819 1
d1046 1
d1057 1
d1097 1
d1310 1
d1435 1
d1448 1
d1463 1
d1471 1
d1479 1
d1492 1
d1507 1
d1539 1
d1549 1
d1673 1
d1759 1
d2013 1
d2165 1
d2174 1
d2299 1
d2528 1
d2536 1
d2545 1
d2553 1
d2560 1
d2568 1
d2572 1
d2580 1
d2590 1
d2596 1
d2857 1
d2865 1
d2934 1
d3245 1
d3282 1
d3291 1
d3298 1
d3307 1
d3314 1
d3321 1
d3329 1
d3428 1
d3494 1
d3501 1
d3668 1
d3675 1
d3706 1
d4047 1
d4054 1
d4061 1
d4098 1
d4589 1
d4609 1
d4676 1
d4689 1
d4694 1
d4703 1
d4710 1
d4750 1
d4778 1
d4785 1
d4806 1
d4813 1
d4827 1
d5015 1
d5024 1
d5067 1
d5167 1
d5193 1
d5227 1
d5246 1
d5738 1
d5870 1
d5911 1
d6250 1
d6257 1
d6265 1
d6274 1
d6282 1
d6289 1
d6297 1
d6320 1
d6327 2
d6335 1
d6404 1
d6514 1
d6712 1
d6731 1
d7191 1
d7560 1
d7568 1
d7576 1
d7585 1
d7592 1
d7599 1
d7687 1
@


1.1.1.7
log
@Import the complete OpenBSD source tree (base system)
as of CTM delta 3496 (roughly 1200 UTC today) into the
vendor branch.
Attention: this is a big update. Don't even try to
build this system, OpenBSD 3.4-beta, yet on your own.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.11 2003/08/08 10:13:33 jmc Exp $
d2207 1
a2207 1
argument uses an ASN1 DER encoded form compatible with RFC 2459 (PKIX)
d3167 1
a3167 1
OCSP Response follows the rules specified in RFC 2560.
d3463 2
a3464 2
The PKCS#7 routines only understand PKCS#7 v 1.5 as specified in RFC 2315.
They cannot currently parse, for example, the new CMS as described in RFC 2630.
d4463 1
a4463 1
This follows the PKIX recommendation in RFC 2459.
d4468 1
a4468 1
will be used: this is the PKIX recommendation in RFC 2459 after 2003.
d7240 1
a7240 1
Displays names compatible with RFC 2253; equivalent to
d7261 1
a7261 1
Escape the "special" characters required by RFC 2253 in a field that is
d7285 1
a7285 1
This is required by RFC 2253.
d7339 1
a7339 1
This is required by RFC 2253.
@


1.1.1.8
log
@Synchronize with OpenBSD 3.4-beta
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.13 2003/08/30 17:37:44 jmc Exp $
d129 1
a129 1
.Oo Cm list-standard-commands No |\ \&
d131 1
a131 1
.Cm \	\&\ \&\ \&\ \&\ \&list-cipher-commands
d141 2
a142 4
.Pq SSL v2/v3
and Transport Layer Security
.Pq TLS v1
network protocols and related cryptography standards required by them.
d153 1
a153 1
.Bl -bullet -offset indent -compact
d171 1
a171 1
.Pf ( Cm command
d174 2
a175 1
above),
d177 1
a177 1
.Pf ( Ar command_opts
d181 2
a182 1
.Sx SYNOPSIS ) .
d188 3
a190 4
output a list
.Pq one entry per line
of the names of all standard commands, message digest commands,
or cipher commands, respectively, that are available in the present
d201 1
a201 3
it returns 0
.Pq success
and prints
d229 1
a229 3
Certificate Authority
.Pq CA
Management.
d233 1
a233 3
Certificate Revocation List
.Pq CRL
Management.
d261 1
a261 1
Create or examine a Netscape certificate sequence.
d275 1
a275 3
X.509 Certificate Signing Request
.Pq CSR
Management.
a320 2
.It Cm md4
MD4 Digest.
d323 2
d333 1
a333 5
.Bl -tag -width Ds -compact
.It Cm aes-128-cbc | aes-128-ecb | aes-192-cbc | aes-192-ecb |
.It Cm aes-256-cbc | aes-256-ecb
AES Cipher.
.Pp
d336 1
a336 5
.Pp
.It Xo
.Cm bf | bf-cbc | bf-cfb |
.Cm bf-ecb | bf-ofb
.Xc
d338 1
a338 2
.Pp
.It Cm cast | cast-cbc
d340 1
a340 2
.Pp
.It Cm cast5-cbc | cast5-cfb | cast5-ecb | cast5-ofb
d342 2
a343 6
.Pp
.It Xo
.Cm des | des-cbc | des-cfb | des-ecb |
.Cm des-ede | des-ede-cbc
.Xc
.It Cm des-ede-cfb | des-ede-ofb | des-ofb
d345 1
a345 5
.Pp
.It Xo
.Cm des3 | desx | des-ede3 |
.Cm des-ede3-cbc | des-ede3-cfb | des-ede3-ofb
.Xc
d347 3
a349 5
.Pp
.It Xo
.Cm rc2 | rc2-40-cbc | rc2-64-cbc | rc2-cbc |
.Cm rc2-cfb | rc2-ecb | rc2-ofb
.Xc
d351 1
a351 2
.Pp
.It Cm rc4 | rc4-40
d353 2
d368 1
a368 1
.It Ar pass Ns : Ns Ar password
d374 2
a375 4
under
.Ux )
this form should only be used where security is not important.
.It Ar env Ns : Ns Ar var
d379 1
a379 1
(e.g.\&
d381 2
a382 4
under certain
.Ux
OSes) this option should be used with caution.
.It Ar file Ns : Ns Ar pathname
d391 1
a391 1
.Fl passout ,
d397 1
a397 1
.It Ar fd Ns : Ns Ar number
d409 1
a409 2
.Bk -words
.Op Fl inform Ar DER | PEM | TXT
a415 2
.Op Fl dump
.Op Fl dlimit Ar number
a417 1
.Ek
d426 1
a426 1
.It Fl inform Ar DER | PEM | TXT
d431 1
a431 4
.Pq the default
is base64 encoded.
.Ar TXT
is plain text.
d449 1
a449 9
Indents the output according to the
.Qq depth
of the structures.
.It Fl dump
Dump unknown data in hex form.
.It Fl dlimit Ar number
Dump the first
.Ar number
bytes of unknown data in hex form.
d451 1
a451 2
A file containing additional OBJECT IDENTIFIERs
.Pq OIDs .
d458 1
a458 3
This option can be used multiple times to
.Qq drill down
into a nested structure.
d471 1
a471 1
  381:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Subject Key Identifier
d474 1
a474 1
  412:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Authority Key Identifier
d487 1
a487 3
gives the header length
.Pq tag and length octets
of the current type.
d511 1
a511 2
numerical form
.Pq for example 1.2.3.4 .
d515 1
a515 1
Each line consists of three columns;
d518 3
a520 5
The second column is the
.Qq short name
which is a single word followed by whitespace.
The final column is the rest of the line and is the
.Qq long name .
d525 1
a525 1
.Dl \&"1.2.3.4	shortName	A long name\&"
d528 1
a528 2
The output of some ASN.1 types is not well handled
.Pq if at all .
a553 1
.Op Fl keyform Ar PEM | ENGINE
a569 2
.Op Fl status Ar serial
.Op Fl updatedb
d617 1
a617 3
serial number in hex with
.Qq .pem
appended.
a621 2
.It Fl keyform Ar PEM | ENGINE
Private key file format.
d625 1
a625 3
(e.g.\&
.Ux
with the
d631 1
a631 1
.Ar arg ,
d642 1
a642 1
.Pq the same as an ASN1 UTCTime structure .
d646 1
a646 1
.Pq the same as an ASN1 UTCTime structure .
d652 1
a652 1
.Ar md5
d654 1
a654 1
.Ar sha1 .
d657 1
a657 3
This option defines the CA
.Qq policy
to use.
d667 1
a667 1
.Qq certenr3 .
d671 1
a671 3
The newer control
.Qq Xenroll
does not need this option.
d673 1
a673 1
Normally, the DN order of a certificate is the same as the order of the
d686 1
a686 1
When this option is set, the EMAIL field is removed from the certificate's
d703 1
a703 2
If the extension section is present
.Pq even if it is empty ,
a711 5
.It Fl status Ar serial
Show status of certificate with serial number
.Ar serial .
.It Fl updatedb
Update database for expired certificates.
d716 1
a716 1
.Nm ca
d746 1
a746 1
In practice, removeFromCRL is not particularly useful because it is only used
d771 1
a771 4
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
d777 1
a777 2
if the CRL extension section is present
.Pq even if it is empty
d782 1
a782 2
It should be noted that some software
.Pq for example Netscape
d804 3
a806 5
.Bl -tag -width Ds -offset indent -compact
.It RANDFILE
.It preserve
.It msie_hack
.El
d816 1
a816 3
the configuration file or the command line equivalent
.Pq if any
used.
d828 1
a828 1
.Sq =
d869 1
a869 2
.Pq or the command line equivalents
must be present.
d905 2
a906 3
simply set this to
.Qq no .
If not present, the default is to allow for the EMAIL field in the
d935 1
a935 1
For convenience, the value
d937 1
a937 1
is accepted by both to produce a reasonable output.
d939 1
a939 1
If neither option is present, the format used in earlier versions of
d955 1
a955 1
.Ar copy ,
d959 1
a959 1
.Ar copyall ,
d973 4
a976 9
If the value is
.Qq match ,
then the field value must match the same field in the CA certificate.
If the value is
.Qq supplied ,
then it must be present.
If the value is
.Qq optional ,
then it may be present.
d995 2
a996 3
If it's necessary to include the same component twice,
then it can be preceded by a number and a
.Sq \&. .
d1019 1
a1019 3
would be created containing, for example,
.Qq 01
and the empty index file
d1024 1
a1024 1
.Dl $ openssl ca -in req.pem -out newcert.pem
d1028 1
a1028 1
.Dl $ openssl ca -in req.pem -extensions v3_ca -out newcert.pem
d1032 1
a1032 1
.Dl $ openssl ca -gencrl -out crl.pem
d1036 1
a1036 1
.Dl $ openssl ca -infiles req1.pem req2.pem req3.pem
d1040 1
a1040 1
.Dl $ openssl ca -spkac spkac.txt
d1042 7
a1048 8
A sample SPKAC file
.Pq the SPKAC line has been truncated for clarity :
.Bd -literal -offset indent
SPKAC=MIG0MGAwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAn7PDhCeV/xIxUg8V70YRxK
CN=Steve Test
emailAddress=steve@@openssl.org
0.OU=OpenSSL Group
1.OU=Another Group
d1056 1
a1056 1

d1058 1
a1058 1

d1062 1
a1062 1

d1067 1
a1067 1

d1071 1
a1071 1

d1074 1
a1074 1

d1077 2
a1078 2
\& copy_extensions = none                 #Don't copy extensions from request

d1090 1
a1090 1
configuration file entries, environment variables, or command line options.
d1092 1
a1092 1
.Bd -literal -offset indent
d1105 1
a1105 1
.Ev OPENSSL_CONF
d1136 1
a1136 2
.Pq perl script or GUI
can handle things properly.
d1177 1
a1177 1
If care is not taken, then it can be a security risk.
d1207 1
a1207 1
.D1 basicConstraints = CA:TRUE, pathlen:0
d1216 4
a1219 2
.Op Fl ssl2 | ssl3 | tls1
.Op Ar cipherlist
d1233 3
a1235 3
.Pq SSLv2 or SSLv3; the latter includes TLS ,
key exchange, authentication, encryption and mac algorithms used along with
any key size restrictions and whether the algorithm is classed as an
d1243 2
a1246 2
.It Fl ssl3
Only include SSL v3 ciphers.
d1249 1
a1249 1
.It Fl h , \&?
d1251 1
a1251 1
.It Ar cipherlist
d1280 1
a1280 1
.Sq +
d1290 1
a1290 2
.Sq \&! ,
.Sq - ,
d1292 1
a1292 1
.Sq + .
d1295 1
a1295 1
.Sq !\&
d1301 1
a1301 1
.Sq -
d1306 1
a1306 1
.Sq +
d1312 1
a1312 1
If the list includes any ciphers already present, they will be ignored;
d1315 1
a1315 1
Additionally, the cipher string
d1352 1
a1352 2
.Qq High
encryption cipher suites.
d1355 1
a1355 2
.Qq Medium
encryption cipher suites, currently those using 128-bit encryption.
d1357 1
a1357 2
.Qq Low
encryption cipher suites, currently those using 64- or 56-bit encryption
d1361 1
a1361 1
Including 40- and 56-bit algorithms.
d1363 1
a1363 1
40-bit export encryption algorithms
d1365 1
a1365 1
56-bit export encryption algorithms.
d1367 2
a1368 4
The
.Qq NULL
ciphers; that is those offering no encryption.
Because these offer no encryption at all and are a security risk,
d1373 2
a1374 3
These cipher suites are vulnerable to a
.Qq man in the middle
attack, so their use is normally discouraged.
d1392 1
a1392 1
Cipher suites using FORTEZZA key exchange, authentication, encryption
d1406 1
a1406 2
Cipher suites using DES
.Pq not triple DES .
d1411 2
d1426 80
a1505 31
.Ss SSL v3.0 cipher suites
.Bd -unfilled -offset indent
SSL_RSA_WITH_NULL_MD5                   NULL-MD5
SSL_RSA_WITH_NULL_SHA                   NULL-SHA
SSL_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
SSL_RSA_WITH_RC4_128_MD5                RC4-MD5
SSL_RSA_WITH_RC4_128_SHA                RC4-SHA
SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
SSL_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
SSL_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
SSL_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
SSL_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA

SSL_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
SSL_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
SSL_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
SSL_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
SSL_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
SSL_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
SSL_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
SSL_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA

SSL_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
SSL_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
SSL_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
SSL_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
d1507 4
a1510 16
SSL_FORTEZZA_KEA_WITH_NULL_SHA          Not implemented.
SSL_FORTEZZA_KEA_WITH_FORTEZZA_CBC_SHA  Not implemented.
SSL_FORTEZZA_KEA_WITH_RC4_128_SHA       Not implemented.
.Ed
.Ss TLS v1.0 cipher suites
.Bd -unfilled -offset indent
TLS_RSA_WITH_NULL_MD5                   NULL-MD5
TLS_RSA_WITH_NULL_SHA                   NULL-SHA
TLS_RSA_EXPORT_WITH_RC4_40_MD5          EXP-RC4-MD5
TLS_RSA_WITH_RC4_128_MD5                RC4-MD5
TLS_RSA_WITH_RC4_128_SHA                RC4-SHA
TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5      EXP-RC2-CBC-MD5
TLS_RSA_WITH_IDEA_CBC_SHA               IDEA-CBC-SHA
TLS_RSA_EXPORT_WITH_DES40_CBC_SHA       EXP-DES-CBC-SHA
TLS_RSA_WITH_DES_CBC_SHA                DES-CBC-SHA
TLS_RSA_WITH_3DES_EDE_CBC_SHA           DES-CBC3-SHA
d1512 4
a1515 12
TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
TLS_DH_DSS_WITH_DES_CBC_SHA             Not implemented.
TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA        Not implemented.
TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA    Not implemented.
TLS_DH_RSA_WITH_DES_CBC_SHA             Not implemented.
TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA        Not implemented.
TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-DSS-DES-CBC-SHA
TLS_DHE_DSS_WITH_DES_CBC_SHA            EDH-DSS-CBC-SHA
TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA       EDH-DSS-DES-CBC3-SHA
TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA   EXP-EDH-RSA-DES-CBC-SHA
TLS_DHE_RSA_WITH_DES_CBC_SHA            EDH-RSA-DES-CBC-SHA
TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA       EDH-RSA-DES-CBC3-SHA
d1517 2
a1518 23
TLS_DH_anon_EXPORT_WITH_RC4_40_MD5      EXP-ADH-RC4-MD5
TLS_DH_anon_WITH_RC4_128_MD5            ADH-RC4-MD5
TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA   EXP-ADH-DES-CBC-SHA
TLS_DH_anon_WITH_DES_CBC_SHA            ADH-DES-CBC-SHA
TLS_DH_anon_WITH_3DES_EDE_CBC_SHA       ADH-DES-CBC3-SHA
.Ed
.Ss AES ciphersuites from RFC 3268, extending TLS v1.0
.Bd -unfilled -offset indent
TLS_RSA_WITH_AES_128_CBC_SHA            AES128-SHA
TLS_RSA_WITH_AES_256_CBC_SHA            AES256-SHA

TLS_DH_DSS_WITH_AES_128_CBC_SHA         DH-DSS-AES128-SHA
TLS_DH_DSS_WITH_AES_256_CBC_SHA         DH-DSS-AES256-SHA
TLS_DH_RSA_WITH_AES_128_CBC_SHA         DH-RSA-AES128-SHA
TLS_DH_RSA_WITH_AES_256_CBC_SHA         DH-RSA-AES256-SHA

TLS_DHE_DSS_WITH_AES_128_CBC_SHA        DHE-DSS-AES128-SHA
TLS_DHE_DSS_WITH_AES_256_CBC_SHA        DHE-DSS-AES256-SHA
TLS_DHE_RSA_WITH_AES_128_CBC_SHA        DHE-RSA-AES128-SHA
TLS_DHE_RSA_WITH_AES_256_CBC_SHA        DHE-RSA-AES256-SHA

TLS_DH_anon_WITH_AES_128_CBC_SHA        ADH-AES128-SHA
TLS_DH_anon_WITH_AES_256_CBC_SHA        ADH-AES256-SHA
d1520 3
a1522 1
.Ss Additional Export 1024 and other cipher suites
d1525 17
a1541 16
.Bd -unfilled -offset indent
TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA     EXP1024-DES-CBC-SHA
TLS_RSA_EXPORT1024_WITH_RC4_56_SHA      EXP1024-RC4-SHA
TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA EXP1024-DHE-DSS-DES-CBC-SHA
TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA  EXP1024-DHE-DSS-RC4-SHA
TLS_DHE_DSS_WITH_RC4_128_SHA            DHE-DSS-RC4-SHA
.Ed
.Ss SSL v2.0 cipher suites
.Bd -unfilled -offset indent
SSL_CK_RC4_128_WITH_MD5                 RC4-MD5
SSL_CK_RC4_128_EXPORT40_WITH_MD5        EXP-RC4-MD5
SSL_CK_RC2_128_CBC_WITH_MD5             RC2-MD5
SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5    EXP-RC2-MD5
SSL_CK_IDEA_128_CBC_WITH_MD5            IDEA-CBC-MD5
SSL_CK_DES_64_CBC_WITH_MD5              DES-CBC-MD5
SSL_CK_DES_192_EDE3_CBC_WITH_MD5        DES-CBC3-MD5
d1557 1
a1557 1
.Dl $ openssl ciphers -v 'ALL:eNULL'
d1562 1
a1562 1
.Dl $ openssl ciphers -v 'ALL:!ADH:@@STRENGTH'
d1566 1
a1566 1
.Dl $ openssl ciphers -v '3DES:+RSA'
d1570 1
a1570 1
.Dl $ openssl ciphers -v 'RC4:!COMPLEMENTOFDEFAULT'
d1575 1
a1575 1
.Dl $ openssl ciphers -v 'RSA:!COMPLEMENTOFALL'
d1587 2
a1588 3
.Bk -words
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
a1593 1
.Op Fl fingerprint
a1598 1
.Ek
d1610 1
a1610 1
.It Fl inform Ar DER | PEM
d1613 1
a1613 1
format is a DER encoded CRL structure.
d1615 3
a1617 3
.Pq the default
is a base64 encoded version of the DER form with header and footer lines.
.It Fl outform Ar DER | PEM
a1633 2
.It Fl fingerprint
Print the CRL fingerprint.
d1657 3
a1659 3
.Bd -unfilled -offset indent
-----BEGIN X509 CRL-----
-----END X509 CRL-----
d1667 1
a1667 1
.Dl $ openssl crl -in crl.pem -outform DER -out crl.der
d1673 1
a1673 1
.Dl $ openssl crl -in crl.der -text -noout
d1675 1
a1675 1
Ideally, it should be possible to create a CRL using appropriate options
d1682 2
a1683 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d1693 1
a1693 2
.Qq certificates only
structure.
d1697 1
a1697 1
.It Fl inform Ar DER | PEM
d1700 1
a1700 1
format is a DER encoded CRL structure.
d1702 3
a1704 3
.Pq the default
is a base64 encoded version of the DER form with header and footer lines.
.It Fl outform Ar DER | PEM
d1707 1
a1707 1
format is a DER encoded PKCS#7 structure.
d1709 2
a1710 2
.Pq the default
is a base64 encoded version of the DER form with header and footer lines.
d1726 1
a1726 1
This option can be used more than once to read certificates from multiple
d1729 1
a1729 1
Normally, a CRL is included in the output file.
d1736 1
a1736 1
.Dl $ openssl crl2pkcs7 -in crl.pem -certfile cert.pem -out p7.pem
d1738 1
a1738 1
Create a PKCS#7 structure in
d1742 3
a1744 3
.Bd -literal -offset indent
$ openssl crl2pkcs7 -nocrl -certfile newcert.pem \e
	-certfile demoCA/cacert.pem -outform DER -out p7.der
d1765 1
a1765 5
.Bk -words
.Oo
.Fl md5 | md4 | md2 | sha1 |
.Fl sha | ripemd160 | dss1
.Oc
a1775 2
.Op Fl engine Ar id
.Op Fl keyform Ar PEM | ENGINE
a1776 1
.Ek
d1778 1
a1778 5
.Nm openssl
.Xo
.Cm md5 | md4 | md2 | sha1 |
.Cm sha | ripemd160
.Xc
d1793 1
a1793 1
Print out the digest in two-digit groups separated by colons; only relevant if
d1800 1
a1800 2
This is the default case for a
.Qq normal
d1812 1
a1812 4
The output is either
.Qq Verification OK
or
.Qq Verification Failure .
d1817 5
a1821 1
A file or files containing random data used to seed the random number
d1824 8
a1831 2
Multiple files can be specified separated by a
.Sq \&: .
a1833 10
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dgst
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl keyform Ar PEM | ENGINE
Key file format.
d1842 1
a1842 1
If you wish to sign or verify data using the DSA algorithm, then the dss1
d1854 1
a1854 2
Diffie-Hellman Parameter Management.
The
d1867 2
a1868 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d1875 2
a1876 1
.Op Fl 2 | 5
d1888 1
a1888 1
.It Fl inform Ar DER | PEM
d1899 2
a1900 2
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d1918 1
a1918 4
Otherwise,
.Qq strong
primes
.Pq such that (p-1)/2 is also prime
d1932 1
a1932 1
If present, then the input file is ignored and parameters are generated instead.
d1934 5
a1938 1
A file or files containing random data used to seed the random number generator,
d1941 8
a1948 2
Multiple files can be specified, separated by a
.Sq \&: .
d1954 1
a1954 1
If this value is present, then the input file is ignored and
d1969 1
a1969 1
.Nm dhparam
d1995 3
a1997 3
.Bd -unfilled -offset indent
-----BEGIN DH PARAMETERS-----
-----END DH PARAMETERS-----
d2024 2
a2025 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d2030 3
a2032 6
.Op Fl pubin
.Op Fl pubout
.Oo
.Fl des | des3 | aes128 | aes192 |
.Fl aes256
.Oc
d2036 2
d2056 1
a2056 1
.It Fl inform Ar DER | PEM
d2061 2
a2062 4
SEQUENCE consisting of the values of version
.Pq currently zero ,
p, q, g,
the public and private key components, respectively, as ASN.1 INTEGERs.
d2065 2
a2066 1
structure: it is an error if the key is not DSA.
d2074 2
a2075 2
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d2082 1
a2082 1
If the key is encrypted, a pass phrase will be prompted for.
d2086 1
a2086 1
.Ar arg ,
d2102 1
a2102 1
.Ar arg ,
d2106 1
a2106 4
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
d2108 1
a2108 1
AES ciphers, respectively, before outputting it.
d2121 1
a2121 1
Prints out the public/private key components and parameters.
d2127 1
a2127 1
By default, a private key is read from the input file.
d2130 1
a2130 1
By default, a private key is output.
d2137 1
a2137 1
.Nm dsa
d2146 3
a2148 3
.Bd -unfilled -offset indent
-----BEGIN DSA PRIVATE KEY-----
-----END DSA PRIVATE KEY-----
d2154 3
a2156 3
.Bd -unfilled -offset indent
-----BEGIN PUBLIC KEY-----
-----END PUBLIC KEY-----
d2161 1
a2161 1
.Dl $ openssl dsa -in key.pem -out keyout.pem
d2165 1
a2165 1
.Dl $ openssl dsa -in key.pem -des3 -out keyout.pem
d2169 1
a2169 1
.Dl $ openssl dsa -in key.pem -outform DER -out keyout.der
d2173 1
a2173 1
.Dl $ openssl dsa -in key.pem -text -noout
d2177 1
a2177 1
.Dl $ openssl dsa -in key.pem -pubout -out pubkey.pem
d2184 2
a2185 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d2199 1
a2199 1
command is used to manipulate or generate DSA parameter files.
d2203 1
a2203 1
.It Fl inform Ar DER | PEM
d2207 1
a2207 2
argument uses an ASN1 DER encoded form compatible with RFC 2459
.Pq PKIX
d2214 1
a2214 1
.It Fl outform Ar DER | PEM
d2224 1
a2224 1
parameter is included, then this option will be ignored.
d2246 5
a2250 1
A file or files containing random data used to seed the random number
d2253 8
a2260 2
Multiple files can be specified, separated by a
.Sq \&: .
d2265 1
a2265 3
If this option is included, then the input file
.Pq if any
is ignored.
d2270 1
a2270 1
.Nm dsaparam
d2278 3
a2280 3
.Bd -unfilled -offset indent
-----BEGIN DSA PARAMETERS-----
-----END DSA PARAMETERS-----
a2289 1
.Bk -words
a2293 2
.Op Fl salt
.Op Fl nosalt
a2299 1
.Op Fl S Ar salt
a2306 2
.Op Fl engine Ar id
.Ek
d2310 2
a2311 3
or explicitly provided.
Base64 encoding or decoding can also be performed either by itself
or in addition to the encryption or decryption.
d2326 1
a2326 1
.Ar arg ,
a2445 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm enc
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d2496 1
a2496 1
If padding is disabled, then the input data must be a multiple of the cipher
d2501 1
a2501 1
Blowfish and RC5 algorithms use a 128-bit key.
d2503 68
a2570 65
.Bd -unfilled -offset indent
aes-128-cbc        128-bit AES in CBC mode
aes128             Alias for aes-128-cbc
aes-128-cfb        128-bit AES in CFB mode
aes-128-ecb        128-bit AES in ECB mode
aes-128-ofb        128-bit AES in OFB mode

aes-192-cbc        192-bit AES in CBC mode
aes192             Alias for aes-192-cbc
aes-192-cfb        192-bit AES in CFB mode
aes-192-ecb        192-bit AES in ECB mode
aes-192-ofb        192-bit AES in OFB mode

aes-256-cbc        256-bit AES in CBC mode
aes256             Alias for aes-256-cbc
aes-256-cfb        256-bit AES in CFB mode
aes-256-ecb        256-bit AES in ECB mode
aes-256-ofb        256-bit AES in OFB mode

base64             Base 64

bf-cbc             Blowfish in CBC mode
bf                 Alias for bf-cbc
blowfish           Alias for bf-cbc
bf-cfb             Blowfish in CFB mode
bf-ecb             Blowfish in ECB mode
bf-ofb             Blowfish in OFB mode

cast-cbc           CAST in CBC mode
cast               Alias for cast-cbc
cast5-cbc          CAST5 in CBC mode
cast5-cfb          CAST5 in CFB mode
cast5-ecb          CAST5 in ECB mode
cast5-ofb          CAST5 in OFB mode

des-cbc            DES in CBC mode
des                Alias for des-cbc
des-cfb            DES in CBC mode
des-ofb            DES in OFB mode
des-ecb            DES in ECB mode

des-ede-cbc        Two key triple DES EDE in CBC mode
des-ede            Alias for des-ede
des-ede-cfb        Two key triple DES EDE in CFB mode
des-ede-ofb        Two key triple DES EDE in OFB mode

des-ede3-cbc       Three key triple DES EDE in CBC mode
des-ede3           Alias for des-ede3-cbc
des3               Alias for des-ede3-cbc
des-ede3-cfb       Three key triple DES EDE CFB mode
des-ede3-ofb       Three key triple DES EDE in OFB mode

desx-cbc           DESX algorithm
desx               Alias for desx-cbc

rc2-cbc            128-bit RC2 in CBC mode
rc2                Alias for rc2-cbc
rc2-cfb            128-bit RC2 in CBC mode
rc2-ecb            128-bit RC2 in CBC mode
rc2-ofb            128-bit RC2 in CBC mode
rc2-64-cbc         64-bit RC2 in CBC mode
rc2-40-cbc         40-bit RC2 in CBC mode

rc4                128-bit RC4
rc4-40             40-bit RC4
d2575 1
a2575 1
.Dl $ openssl base64 -in file.bin -out file.b64
d2579 1
a2579 1
.Dl $ openssl base64 -d -in file.b64 -out file.bin
d2583 1
a2583 1
.Dl $ openssl des3 -salt -in file.txt -out file.des3
d2587 1
a2587 1
.Dl "$ openssl des3 -d -salt -in file.des3 -out file.txt -k mypassword"
d2589 1
a2589 2
Encrypt a file then base64 encode it
(so it can be sent via mail for example)
d2592 1
a2592 1
.Dl $ openssl bf -a -salt -in file.txt -out file.bf
d2596 1
a2596 1
.Dl "$ openssl bf -d -salt -a -in file.bf -out file.txt"
d2598 1
a2598 1
Decrypt some data using a supplied 40-bit RC4 key:
d2600 1
a2600 1
.Dl $ openssl rc4-40 -in file.rc4 -out file.txt -K 0102030405
d2619 1
a2619 1
utility is currently undocumented.
d2624 1
a2624 2
Generation of Diffie-Hellman Parameters.
Replaced by
a2633 1
.Bk -words
d2635 3
a2639 4
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
a2640 1
.Ek
d2645 1
a2645 1
(which will typically be generated by the
d2651 1
a2651 4
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
d2653 1
a2653 1
or the AES ciphers, respectively, before outputting it.
d2657 5
a2661 1
A file or files containing random data used to seed the random number
d2664 8
a2671 2
Multiple files can be specified separated by a
.Sq \&: .
d2676 1
a2676 1
.Nm gendsa
a2694 5
.Bk -words
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
d2697 5
a2701 1
.Op Fl f4 | 3
a2704 1
.Ek
d2719 1
a2719 1
.Ar arg ,
d2723 1
a2723 4
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
d2725 1
a2725 1
AES ciphers, respectively, before outputting it.
d2731 1
a2731 1
.It Fl F4 | 3
d2735 4
a2738 1
A file or files
d2742 8
a2749 2
Multiple files can be specified separated by a
.Sq \&: .
d2754 1
a2754 1
.Nm genrsa
d2769 3
a2771 3
.Sq \&.
represents each number which has passed an initial sieve test;
.Sq +
d2774 1
a2774 1
.Pq the actual number depends on the key size .
d2783 1
a2783 2
they will be much larger
.Pq typically 1024 bits .
d2811 1
a2811 1
Normally, a Netscape certificate sequence will be input and the output
d2821 1
a2821 1
.Dl $ openssl nseq -in nseq.pem -out certs.pem
d2826 1
a2826 1
.Dl $ openssl nseq -in certs.pem -toseq -out nseq.pem
d2832 3
a2834 3
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
d2873 1
a2873 4
.Oo
.Fl host
.Ar hostname Ns : Ns Ar port
.Oc
d2901 2
a2902 6
The Online Certificate Status Protocol
.Pq OCSP
enables applications to determine the
.Pq revocation
state of an identified certificate
.Pq RFC 2560 .
d2908 2
a2909 2
create requests and send queries to an OCSP responder,
and behave like a mini OCSP server itself.
d2939 2
a2940 4
.Sq 0x .
Negative integers can also be specified by preceding the value with a
.Sq -
sign.
d2949 1
a2949 1
option is not present, then the private key is read from the same file
d2951 1
a2951 1
If neither option is specified, then the OCSP request is not signed.
d2980 1
a2980 1
Print out the text form of the OCSP request, response, or both, respectively.
d2996 2
a2997 7
Both HTTP and HTTPS
.Pq SSL/TLS
URLs can be specified.
.It Xo
.Fl host Ar hostname Ns : Ns Ar port ,
.Fl path Ar pathname
.Xc
d3005 1
a3005 3
specifies the HTTP path name to use, or
.Sq /
by default.
d3052 1
a3052 1
Don't verify the OCSP response signer's certificate at all.
d3059 3
a3061 3
Don't perform any additional checks on the OCSP response signer's certificate.
That is, do not make any checks to see if the signer's certificate is
authorised to provide the necessary status information:
d3082 1
a3082 1
time is omitted from a response, then this means that new status
d3089 1
a3089 1
By default, this additional check is not performed.
d3142 1
a3142 1
if not present, the file specified in the
d3162 1
a3162 1
If neither option is present, then the
d3164 1
a3164 1
field is omitted, meaning fresh revocation information is immediately available.
d3184 1
a3184 1
If the initial verify fails, then the OCSP verify process halts with an
d3195 1
a3195 1
Otherwise the root CA of the OCSP responder's CA is checked to see if it
d3199 1
a3199 1
If none of these checks is successful, then the OCSP verify fails.
d3203 1
a3203 2
.Pq and it is correctly configured ,
then verification will succeed.
d3210 2
a3211 3
.Bd -literal -offset indent
$ openssl x509 -in ocspCA.pem -addtrust OCSPSigning \e
	-out trustedCA.pem
d3214 1
a3214 1
Alternatively, the responder certificate itself can be explicitly trusted
d3220 1
a3220 1
Normally, only the
d3222 1
a3222 2
and
.Pq if the responder is a `global VA'
d3246 3
a3248 3
.Bd -literal -offset indent
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \e
	-reqout req.der
d3254 3
a3256 3
.Bd -literal -offset indent
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \e
	-url http://ocsp.myhost.com/ -resp_text -respout resp.der
d3260 3
a3262 2
.Pp
.Dl $ openssl ocsp -respin resp.der -text
d3268 3
a3270 3
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \e
	rcert.pem -CA demoCA/cacert.pem -text -out log.txt
d3274 3
a3276 3
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \e
	rcert.pem -CA demoCA/cacert.pem -nrequest 1
d3280 2
a3281 2
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
d3287 2
a3288 2
.Bd -literal -offset indent
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \e
a3304 1
.Op Fl reverse
d3318 1
a3318 3
The
.Ux
standard algorithm
d3320 1
a3320 3
and the MD5-based
.Bx
password algorithm
d3331 1
a3331 2
algorithm
.Pq default .
d3333 1
a3333 3
Use the MD5 based
.Bx
password algorithm
d3338 1
a3338 4
algorithm
.Pq Apache variant of the
.Bx
algorithm.
d3353 1
a3353 1
Don't output warnings when passwords given on the command line are truncated.
a3356 2
.It Fl reverse
Switch table columns.
d3359 2
a3360 1
.Dl $ openssl passwd -crypt -salt xx password
d3362 2
a3363 3
.Qq xxj31ZMTZzkVA .
.Pp
.Dl $ openssl passwd -1 -salt xxxxxxxx password
d3365 2
a3366 3
.Qq $1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a. .
.Pp
.Dl $ openssl passwd -apr1 -salt xxxxxxxx password
d3368 2
a3369 1
.Qq $apr1$xxxxxxxx$dxHfLAsjHkDRmG83UXe8K0 .
d3376 2
a3377 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d3396 1
a3396 1
.It Fl inform Ar DER | PEM
d3399 1
a3399 1
format is a DER encoded PKCS#7 v1.5 structure.
d3401 4
a3404 4
.Pq the default
is a base64 encoded version of the DER form with header and footer lines.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d3430 1
a3430 1
.Nm pkcs7
d3441 1
a3441 1
.Dl $ openssl pkcs7 -in file.pem -outform DER -out file.der
d3445 1
a3445 1
.Dl $ openssl pkcs7 -in file.pem -print_certs -out certs.pem
d3450 3
a3452 3
.Bd -unfilled -offset indent
-----BEGIN PKCS7-----
-----END PKCS7-----
d3456 3
a3458 3
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
d3472 2
a3473 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d3493 1
a3493 2
.Pq v1.5 and v2.0
and PKCS#12 algorithms.
d3498 1
a3498 1
Normally, a PKCS#8 private key is expected on input and a traditional format
d3504 1
a3504 1
.It Fl inform Ar DER | PEM
d3517 2
a3518 2
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d3525 1
a3525 1
If the key is encrypted, a pass phrase will be prompted for.
d3529 1
a3529 1
.Ar arg ,
d3544 1
a3544 1
.Ar arg ,
d3582 1
a3582 1
Normally, PKCS#8 private keys are encrypted with the password based
d3585 1
a3585 1
this uses 56-bit DES encryption but it was the strongest encryption
d3590 1
a3590 1
encryption algorithm such as 168-bit triple DES or 128-bit RC2, however
d3612 1
a3612 1
.Nm pkcs8
d3622 3
a3624 3
.Bd -unfilled -offset indent
-----BEGIN ENCRYPTED PRIVATE KEY-----
-----END ENCRYPTED PRIVATE KEY-----
d3628 3
a3630 3
.Bd -unfilled -offset indent
-----BEGIN PRIVATE KEY-----
-----END PRIVATE KEY-----
d3658 2
a3659 3
.Pp
.Bl -tag -width "XXXX" -compact
.It Ar PBE-MD2-DES | PBE-MD5-DES
d3662 1
a3662 2
.Pp
.It Ar PBE-SHA1-RC2-64 | PBE-MD2-RC2-64 | PBE-MD5-RC2-64 | PBE-SHA1-DES
d3667 2
a3668 4
They use either 64-bit RC2 or 56-bit DES.
.Pp
.It Ar PBE-SHA1-RC4-128 | PBE-SHA1-RC4-40 | PBE-SHA1-3DES | PBE-SHA1-2DES
.It Ar PBE-SHA1-RC2-128 | PBE-SHA1-RC2-40
d3670 1
a3670 1
allow strong encryption algorithms like triple DES or 128-bit RC2 to be used.
d3673 1
a3673 1
Convert a private key from traditional to PKCS#5 v2.0 format using triple DES:
d3675 1
a3675 1
.Dl "$ openssl pkcs8 -in key.pem -topk8 -v2 des3 -out enckey.pem"
d3677 1
a3677 2
Convert a private key to PKCS#8 using a PKCS#5 1.5 compatible algorithm
.Pq DES :
d3679 1
a3679 1
.Dl $ openssl pkcs8 -in key.pem -topk8 -out enckey.pem
d3681 3
a3683 6
Convert a private key to PKCS#8 using a PKCS#12 compatible algorithm
.Pq 3DES :
.Bd -literal -offset indent
$ openssl pkcs8 -in key.pem -topk8 -out enckey.pem \e
	-v1 PBE-SHA1-3DES
.Ed
d3687 1
a3687 1
.Dl "$ openssl pkcs8 -inform DER -nocrypt -in key.der -out key.pem"
d3691 1
a3691 1
.Dl $ openssl pkcs8 -in pk8.pem -out key.pem
d3694 2
a3695 2
pkcs-tng mailing list using triple DES, DES and RC2 with high iteration counts;
several people confirmed that they could decrypt the private
d3700 1
a3700 3
The format of PKCS#8 DSA
.Pq and other
private keys is not well documented:
a3716 1
.Bk -words
a3720 2
.Op Fl CApath Ar directory
.Op Fl CAfile Ar filename
d3732 3
a3734 4
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
a3747 2
.Op Fl engine Ar id
.Ek
d3751 1
a3751 2
command allows PKCS#12 files
.Pq sometimes referred to as PFX files
d3758 1
a3758 1
By default, a PKCS#12 file is parsed;
d3761 1
a3761 2
option
.Pq see below .
d3777 1
a3777 3
The PKCS#12 file
.Pq i.e. input file
password source.
d3779 1
a3779 1
.Ar arg ,
d3786 1
a3786 1
.Ar arg ,
d3794 1
a3794 2
Only output client certificates
.Pq not CA certificates .
d3796 1
a3796 2
Only output CA certificates
.Pq not client certificates .
d3804 6
a3809 7
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
Use DES, triple DES, or AES, respectively,
to encrypt private keys before outputting.
The default is triple DES.
d3844 1
a3844 3
This specifies the
.Qq friendly name
for the certificate and private key.
a3847 6
.It Fl CApath Ar directory
Directory of CAs
.Pq PEM format .
.It Fl CAfile Ar filename
File of CAs
.Pq PEM format .
d3849 1
a3849 3
This specifies the
.Qq friendly name
for other certificates.
d3855 1
a3855 3
The PKCS#12 file
.Pq i.e. output file
password source.
d3857 1
a3857 1
.Ar arg ,
d3864 1
a3864 1
.Ar arg ,
d3869 1
a3869 1
If this option is present, then an attempt is made to include the entire
d3872 1
a3872 1
If the search fails, it is considered a fatal error.
d3875 3
a3877 5
file unreadable by some
.Qq export grade
software.
By default, the private key is encrypted using triple DES and the
certificate using 40-bit RC2.
d3882 1
a3882 1
it is advisable to only use PKCS#12 algorithms.
d3889 1
a3889 3
Normally,
.Qq export grade
software will only allow 512-bit RSA keys to be
d3894 2
a3895 3
Signing only keys can be used for S/MIME signing, authenticode
.Pq ActiveX control signing
and SSL client authentication;
d3900 1
a3900 1
Unless you wish to produce files compatible with MSIE 4.0, you should leave
d3903 4
a3906 4
To discourage attacks by using large dictionaries of common passwords,
the algorithm that derives keys from passwords can have an iteration count
applied to it: this causes a certain part of the algorithm to be repeated
and slows it down.
d3909 1
a3909 1
By default, both MAC and encryption iteration counts are set to 2048;
d3918 1
a3918 1
This option is included for compatibility with previous versions; it used
d3921 4
a3924 1
A file or files
d3928 8
a3935 10
Multiple files can be specified separated by a
.Sq \&: .
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs12
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d3940 1
a3940 1
For PKCS#12 file parsing, only
d3951 1
a3951 1
.Fl clcerts , cacerts ,
d3954 1
a3954 1
options are present, then all certificates will be output in the order
d3965 1
a3965 1
If the CA certificates are required, then they can be output to a separate
d3978 1
a3978 1
Normally, the defaults are fine but occasionally software can't handle
d3982 1
a3982 1
can be used to reduce the private key encryption to 40-bit RC2.
d3989 1
a3989 1
.Dl $ openssl pkcs12 -in file.p12 -out file.pem
d3993 1
a3993 1
.Dl $ openssl pkcs12 -in file.p12 -clcerts -out file.pem
d3997 1
a3997 1
.Dl $ openssl pkcs12 -in file.p12 -out file.pem -nodes
d4001 1
a4001 1
.Dl $ openssl pkcs12 -in file.p12 -info -noout
d4004 2
a4005 2
.Bd -literal -offset indent
$ openssl pkcs12 -export -in file.pem -out file.p12 \e
d4010 2
a4011 2
.Bd -literal -offset indent
$ openssl pkcs12 -export -in file.pem -out file.p12 \e
d4023 2
a4024 3
from other implementations
.Pq MSIE or Netscape
could not be decrypted by
d4046 3
a4048 4
.Bd -literal -offset indent
$ old-openssl -in bad.p12 -out keycerts.pem
$ openssl -in keycerts.pem -export -name "My PKCS#12 file" \e
	-out fixed.p12
d4056 1
a4056 1
.Op Fl rand Ar file ...
a4057 1
.Op Fl engine Ar id
d4089 5
a4093 1
Use specified file or files, or EGD socket (see
d4096 8
a4103 2
Multiple files can be specified separated by a
.Sq \&: .
a4107 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rand
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d4115 2
a4116 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
d4128 2
a4129 10
.Oo Xo
.Fl newkey
.Ar rsa Ns : Ns Ar bits
.Xc
.Oc
.Oo Xo
.Fl newkey
.Ar dsa Ns : Ns Ar file
.Xc
.Oc
a4130 1
.Op Fl subject
d4132 1
a4132 1
.Op Fl keyform Ar DER | PEM
d4134 1
a4134 1
.Op Fl md5 | sha1 | md2 | md4
d4160 1
a4160 1
.It Fl inform Ar DER | PEM
d4171 2
a4172 2
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d4188 1
a4188 1
.Ar arg ,
d4199 1
a4199 1
.Ar arg ,
d4222 1
a4222 1
option is not used, it will generate a new RSA private
d4225 5
a4229 1
A file or files containing random data used to seed the random number generator,
d4232 8
a4239 2
Multiple files can be specified separated by a
.Sq \&: .
d4243 1
a4243 1
.Ar rsa Ns : Ns Ar nbits ,
d4249 1
a4249 1
.Ar dsa Ns : Ns Ar filename
d4257 1
a4257 1
.It Fl keyform Ar DER | PEM
d4261 1
a4261 1
.Ar PEM
d4270 1
a4270 1
If this option is specified and a private key is created, it
d4272 1
a4272 3
.It Fl subject
Output the request's subject.
.It Fl md5 | sha1 | md2 | md4
d4280 1
a4280 1
.Ev OPENSSL_CONF
d4286 2
a4287 5
.Em /type0=value0/type1=value1/type2=... ;
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
d4294 1
a4294 2
.Pq if any
are specified in the configuration file.
d4301 1
a4301 1
option is being used, this specifies the number of
d4307 1
a4307 1
.Sq 0x .
d4318 2
a4319 2
This option causes field values to be interpreted as UTF8 strings;
by default they are interpreted as ASCII.
d4334 1
a4334 1
By default, the
d4342 1
a4342 1
More precisely, the
d4357 1
a4357 3
Some software
.Pq Netscape certificate server
and some CAs need this.
d4376 1
a4376 1
section (i.e.\&
d4384 3
a4386 5
.It Ar input_password | output_password
The passwords for the input private key file
.Pq if present
and the output private key file
.Pq if one will be created .
d4417 1
a4417 1
.Sq =
d4428 1
a4428 1
and a private key is generated, it is
d4440 1
a4440 1
.Ar md5
d4442 2
a4443 2
.Ar sha1 .
If not present, then MD5 is used.
d4458 1
a4458 1
value is used, then only
d4466 1
a4466 1
option is used, then only
d4534 1
a4534 1
.Em no ,
d4536 4
a4539 4
.Bd -unfilled -offset indent
CN=My Name
OU=My Organization
emailAddress=someone@@somewhere.org
d4542 2
a4543 4
This allows external programs
.Pq e.g. GUI based
to generate a template file with all the field names and values
and just pass it to
d4555 5
a4559 5
.Bd -unfilled -offset indent
fieldName="prompt"
fieldName_default="default field value"
fieldName_min= 2
fieldName_max= 4
d4562 1
a4562 2
.Qq fieldName
is the field name being used, for example
d4564 2
a4565 4
.Pq or CN .
The
.Qq prompt
string is used to ask the user to enter the relevant details.
d4567 1
a4567 1
if no default value is present, then the field is omitted.
d4569 1
a4569 3
if the user just enters the
.Sq \&.
character.
d4587 1
a4587 1
To avoid this problem, if the
d4589 1
a4589 1
contains some characters followed by a full stop, they will be ignored.
d4592 1
a4592 2
can be input by calling it
.Qq 1.organizationName .
d4601 1
a4601 1
Additionally,
d4618 1
a4618 1
.Dl $ openssl req -in req.pem -text -verify -noout
d4621 3
a4623 3
.Bd -literal -offset indent
$ openssl genrsa -out key.pem 1024
$ openssl req -new -key key.pem -out req.pem
d4628 1
a4628 1
.Dl $ openssl req -newkey rsa:1024 -keyout key.pem -out req.pem
d4632 1
a4632 1
.Dl "$ openssl req -x509 -newkey rsa:1024 -keyout key.pem -out req.pem"
d4637 3
a4639 3
.Bd -unfilled -offset indent
1.2.3.4        shortName       A longer Name
1.2.3.6        otherName       Other longer Name
d4645 3
a4647 3
.Bd -unfilled -offset indent
testoid1=1.2.3.5
testoid2=${testoid1}.6
d4658 1
a4658 1

d4660 1
a4660 1

d4666 1
a4666 1

d4668 1
a4668 1

d4670 1
a4670 1

d4673 1
a4673 1

d4676 1
a4676 1

d4681 1
a4681 1

d4683 1
a4683 1

d4692 1
a4692 1

d4700 1
a4700 1

d4709 1
a4709 1

d4717 3
a4719 3
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE REQUEST-----
-----END CERTIFICATE REQUEST-----
d4722 4
a4725 6
Some software
.Pq some versions of Netscape certificate server
instead needs:
.Bd -unfilled -offset indent
-----BEGIN NEW CERTIFICATE REQUEST-----
-----END NEW CERTIFICATE REQUEST-----
d4736 3
a4738 3
extension which determines the type of key
.Pq signature only or general purpose
and any additional OIDs entered by the script in an
d4743 3
a4745 3
.Bd -unfilled -offset indent
Using configuration from /some/path/openssl.cnf
Unable to load config info
d4749 3
a4751 3
.Bd -unfilled -offset indent
unable to find 'distinguished_name' in config
problems making Certificate Request
d4756 2
a4757 3
Certain operations
.Pq like examining a certificate request
don't need a configuration file so its use isn't enforced.
d4762 3
a4764 3
.Bd -unfilled -offset indent
Attributes:
    a0:00
d4768 1
a4768 2
the correct empty SET OF structure
.Pq the DER encoding of which is 0xa0 0x00 .
d4771 1
a4771 1
.D1 Attributes:
d4773 2
a4774 2
then the SET OF is missing and the encoding is technically invalid
.Pq but it is tolerated .
d4780 1
a4780 1
.Ev OPENSSL_CONF ,
d4786 1
a4786 1
.Ev SSLEAY_CONF
d4790 2
a4791 4
handling of T61Strings
.Pq aka TeletexStrings
is broken: it effectively treats them as ISO-8859-1
.Pq Latin 1 ;
d4798 1
a4798 1
As a consequence of the T61String handling, the only correct way to represent
d4809 1
a4809 1
Other things, like extensions in certificate requests, are
d4812 1
a4812 1
.Em subjectAltName ,
d4820 2
a4821 2
.Op Fl inform Ar DER | NET | PEM
.Op Fl outform Ar DER | NET | PEM
d4827 3
a4829 4
.Oo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Oc
d4854 1
a4854 1
.It Fl inform Ar DER | NET | PEM
d4871 2
a4872 2
.It Fl outform Ar DER | NET | PEM
This specifies the output format; the options have the same meaning as the
d4884 1
a4884 1
.Ar arg ,
d4892 1
a4892 1
If any encryption options are set then, a pass phrase will be prompted for.
d4899 1
a4899 1
.Ar arg ,
d4907 1
a4907 4
.It Xo
.Fl des | des3 | aes128 |
.Fl aes192 | aes256
.Xc
d4909 1
a4909 1
AES ciphers, respectively, before outputting it.
d4930 1
a4930 1
By default, a private key is read from the input file: with this
d4933 1
a4933 1
By default, a private key is output:
d4940 1
a4940 1
.Nm rsa
d4949 3
a4951 3
.Bd -unfilled -offset indent
-----BEGIN RSA PRIVATE KEY-----
-----END RSA PRIVATE KEY-----
d4957 3
a4959 3
.Bd -unfilled -offset indent
-----BEGIN PUBLIC KEY-----
-----END PUBLIC KEY-----
d4972 2
a4973 4
and look for the string
.Qq private-key ,
then trace back to the byte sequence 0x30, 0x82
.Pq this is an ASN1 SEQUENCE .
d4986 1
a4986 1
.Dl $ openssl rsa -in key.pem -out keyout.pem
d4990 1
a4990 1
.Dl $ openssl rsa -in key.pem -des3 -out keyout.pem
d4998 1
a4998 1
.Dl $ openssl rsa -in key.pem -outform DER -out keyout.der
d5002 1
a5002 1
.Dl $ openssl rsa -in key.pem -text -noout
d5006 1
a5006 1
.Dl $ openssl rsa -in key.pem -pubout -out pubkey.pem
a5018 1
.Bk -words
a5021 1
.Op Fl keyform Ar DER | PEM
d5028 3
a5030 1
.Op Fl pkcs | oaep | ssl | raw
a5032 2
.Op Fl engine Ar id
.Ek
a5052 4
.It Fl keyform Ar DER | PEM
Private ket format.
Default is
.Ar PEM .
d5066 3
a5068 4
.It Fl pkcs | oaep | ssl | raw
The padding to use: PKCS#1 v1.5
.Pq the default ,
PKCS#1 OAEP, special padding used in SSL v2 backwards compatible handshakes,
d5078 1
a5078 1
Asn1parse the output data; this is useful when combined with the
a5080 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsautl
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d5089 1
a5089 1
.Dl "$ openssl rsautl -sign -in file -inkey key.pem -out sig"
d5093 1
a5093 1
.Dl $ openssl rsautl -verify -in sig -inkey key.pem
d5097 2
a5098 2
.Li "\ \&$ openssl rsautl -verify -in file -inkey key.pem -raw -hexdump"
.Bd -unfilled
d5109 2
a5110 3
The PKCS#1 block formatting is evident from this.
If this was done using encrypt and decrypt, the block would have been of type 2
.Pq the second byte
d5118 1
a5118 1
running
d5122 2
a5123 2
.Li "\ \&$ openssl asn1parse -in pca-cert.pem"
.Bd -unfilled
d5147 1
a5147 1
.Dl "$ openssl asn1parse -in pca-cert.pem -out sig -noout -strparse 614"
d5151 1
a5151 1
.Dl $ openssl x509 -in test/testx509.pem -pubout -noout >pubkey.pem
d5155 2
a5156 2
.Li "\ \&$ openssl rsautl -in sig -verify -asn1parse -inkey pubkey.pem -pubin"
.Bd -unfilled
d5162 1
a5162 1
\&   0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5  .F...Js.7...H%..
d5171 1
a5171 1
.Dl "$ openssl asn1parse -in pca-cert.pem -out tbs -noout -strparse 4"
d5174 4
a5177 3
.Pp
.Dl $ openssl md5 -c tbs
.D1 MD5(tbs)= f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5
d5186 1
a5186 3
.Oo
.Fl connect Ar host Ns : Ns Ar port
.Oc
a5194 1
.Op Fl prexit
a5209 1
.Op Fl serverpref
d5212 1
d5227 1
a5227 3
.It Xo
.Fl connect Ar host Ns : Ns Ar port
.Xc
d5233 1
a5233 1
If not specified, then an attempt is made to connect to the local host
d5240 1
a5240 1
If not specified, then the certificate file will be used.
d5255 1
a5255 3
This directory must be in
.Qq hash format ;
see
d5276 1
a5276 1
Normally, information will only be printed out once if the connection succeeds.
d5304 2
a5305 4
.It Xo
.Fl ssl2 | ssl3 | tls1 |
.Fl no_ssl2 | no_ssl3 | no_tls1
.Xc
d5307 1
a5307 1
By default, the initial handshake uses a method which should be compatible
a5319 3
.It Fl serverpref
Use server's cipher preferences
.Pq SSLv2 only .
d5322 1
a5322 1
Although the server determines which cipher suite is used, it should take
d5331 1
a5331 2
Currently, the only supported keyword is
.Qq smtp .
d5341 5
a5345 1
A file or files containing random data used to seed the random number generator,
d5348 9
a5356 2
Multiple files can be specified separated by a
.Sq \&: .
d5359 1
a5359 1
If a connection is established with an SSL server, then any data received
d5367 2
a5368 2
.Em R ;
if the line begins with a
d5376 1
a5376 1
.Dl $ openssl s_client -connect servername:443
d5378 3
a5380 5
would typically be used
.Pq HTTPS uses port 443 .
If the connection succeeds, then an HTTP command can be given such as
.Qq GET
to retrieve a web page.
d5382 2
a5383 2
If the handshake fails, then there are several possible causes; if it is
nothing obvious like no client certificate, then the
d5398 3
a5400 4
This is normally because the server is not sending the client's certificate
authority in its
.Qq acceptable CA list
when it requests a certificate.
d5412 1
a5412 1
option, it will not be used unless the server specifically requests
d5417 1
a5417 1
If there are problems verifying a server certificate, then the
a5459 1
.Op Fl serverpref
d5496 1
a5496 1
The certificate to use; most server's cipher suites require the use of a
d5499 2
a5500 3
.Pq DSA
key.
If not specified, then the filename
d5505 1
a5505 1
If not specified, then the certificate file will be used.
d5513 1
a5513 1
.Pq no additional certificate and key is used .
d5517 1
a5517 3
and some a DSS
.Pq DSA
key.
d5522 1
a5522 1
If this option is set, then no certificate is used.
d5524 1
a5524 1
.Pq currently just anonymous DH .
d5548 1
a5548 1
option, a certificate is requested but the client does not have to send one.
d5551 1
a5551 1
option, the client must supply a certificate or an error occurs.
d5556 1
a5556 3
This directory must be in
.Qq hash format ;
see
d5572 1
a5572 1
Tests non-blocking I/O.
d5574 1
a5574 1
Turns on non-blocking I/O.
d5579 2
a5580 4
.It Xo
.Fl ssl2 | ssl3 | tls1 |
.Fl no_ssl2 | no_ssl3 | no_tls1
.Xc
d5589 1
a5589 2
SSL code
.Pq \&? .
d5595 1
a5595 1
cipherlist is irrelevant.
a5598 2
.It Fl serverpref
Use server's cipher preferences.
d5635 3
a5637 5
This is mostly useful for testing any SSL/TLS code
.Pq e.g. proxies
that wish to deal with multiple servers, when each of which might be
generating a unique range of session IDs
.Pq e.g. with a certain prefix .
d5639 5
a5643 1
A file or files containing random data used to seed the random number generator,
d5646 8
a5653 2
Multiple files can be specified separated by a
.Sq \&: .
d5685 1
a5685 1
.Dl $ openssl s_server -accept 443 -www
d5689 3
a5691 4
Most web browsers
.Pq in particular Netscape and MSIE
only support RSA cipher suites, so they cannot connect to servers
which don't use a certificate carrying an RSA key or a version of
d5724 1
a5724 1
utility is currently undocumented.
d5731 2
a5732 2
.Op Fl inform Ar DER | PEM
.Op Fl outform Ar DER | PEM
a5735 1
.Op Fl cert
d5742 4
a5745 4
program processes the encoded version of the SSL session structure and
optionally prints out SSL session details
.Pq for example the SSL session master key
in human readable format.
d5751 1
a5751 1
.It Fl inform Ar DER | PEM
d5762 2
a5763 2
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
d5779 1
a5779 2
If a certificate is present in the session,
it will be output using this option;
d5782 1
a5782 1
option is also present, then it will be printed out in text form.
d5786 1
a5786 1
This option can set the session ID so the output session information uses the
d5796 1
a5796 1
.Bd -unfilled
d5823 1
a5823 1
The key argument; this is only used in SSL v2.
d5825 2
a5826 3
This is the session start time, represented as an integer in standard
.Ux
format.
d5836 3
a5838 3
.Bd -unfilled -offset indent
-----BEGIN SSL SESSION PARAMETERS-----
-----END SSL SESSION PARAMETERS-----
d5844 1
a5844 3
should be taken if the information is being output by a
.Qq real
application.
d5860 5
a5864 13
.Oo Xo
.Fl des | des3 | rc2-40 | rc2-64 |
.Fl rc2-128 | aes128 | aes192 | aes256
.Xc
.Oc
.Op Fl nointern
.Op Fl noverify
.Op Fl nochain
.Op Fl nosigs
.Op Fl nocerts
.Op Fl noattr
.Op Fl binary
.Op Fl nodetach
d5869 1
a5869 1
.Op Fl inform Ar SMIME | DER | PEM
a5871 1
.Op Fl keyform Ar PEM | ENGINE
d5873 1
a5873 1
.Op Fl outform Ar SMIME | DER | PEM
a5878 5
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl crl_check
.Op Fl crl_check_all
.Op Fl engine Ar id
d5928 1
a5928 1
.It Fl inform Ar SMIME | DER | PEM
d5941 1
a5941 1
structure; if no PKCS#7 structure is being input (for example with
d5944 1
a5944 1
.Fl sign ) ,
d5950 1
a5950 1
.It Fl outform Ar SMIME | DER | PEM
d5981 1
a5981 2
This option adds plain text
.Pq text/plain
d5991 1
a5991 1
containing trusted CA certificates; only used with
d5996 1
a5996 1
containing trusted CA certificates; only used with
d6002 1
a6002 4
.It Xo
.Fl des | des3 | rc2-40 | rc2-64 |
.Fl rc2-128 | aes128 | aes192 | aes256
.Xc
d6004 2
a6005 6
DES
.Pq 56 bits ,
triple DES
.Pq 168 bits ,
40-, 64-, or 128-bit RC2, or 128-, 192-, or 256-bit AES, respectively;
if not specified, 40-bit RC2 is
d6010 3
a6012 4
When verifying a message, normally certificates
.Pq if any
included in the message are searched for the signing certificate.
With this option, only the certificates specified in the
d6019 2
a6020 2
Do not do chain verification of signers' certificates: that is,
don't use the certificates in the signed message as untrusted CAs.
d6035 2
a6036 3
Normally, the input message is converted to
.Qq canonical
format which is effectively using CR and LF as end of line: as required by the
d6069 1
a6069 1
If this option is not specified, then the private key must be included
a6075 2
.It Fl keyform Ar PEM | ENGINE
Input private key format.
d6079 1
a6079 1
.Ar arg ,
a6082 13
.It Fl crl_check
Check revocation status of signer's certificate using CRLs.
.It Fl crl_check_all
Check revocation status of signer's certificate chain using CRLs.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm smime
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default
for all available algorithms.
d6084 4
a6087 1
A file or files
d6091 8
a6098 2
Multiple files can be specified separated by a
.Sq \&: .
d6125 1
a6125 2
clients won't display it properly
.Pq if at all .
d6130 2
a6131 3
A
.Qq signed and encrypted
message is one where a signed message is then encrypted.
d6142 2
a6143 3
It is possible to sign messages
.Qq in parallel
by signing an already signed message.
d6170 1
a6170 1
the signer's certificates.
d6174 3
a6176 3
.Bd -literal -offset indent
$ openssl smime -sign -in message.txt -text -out mail.msg \e
	-signer mycert.pem
d6180 3
a6182 3
.Bd -literal -offset indent
$ openssl smime -sign -in message.txt -text -out mail.msg \e
	-nodetach -signer mycert.pem
d6187 3
a6189 3
.Bd -literal -offset indent
$ openssl smime -sign -in in.txt -text -out mail.msg \e
	-signer mycert.pem -inkey mykey.pem -certfile mycerts.pem
d6192 1
a6192 3
Send a signed message under
.Ux
directly to
d6195 4
a6198 4
.Bd -literal -offset indent
$ openssl smime -sign -in in.txt -text -signer mycert.pem \e
	-from steve@@openssl.org -to someone@@somewhere \e
	-subject "Signed message" | sendmail someone@@somewhere
d6202 3
a6204 3
.Bd -literal -offset indent
$ openssl smime -verify -in mail.msg -signer user.pem \e
	-out signedtext.txt
d6208 4
a6211 4
.Bd -literal -offset indent
$ openssl smime -encrypt -in in.txt -from steve@@openssl.org \e
	-to someone@@somewhere -subject "Encrypted message" \e
	-des3 user.pem -out mail.msg
d6215 5
a6219 5
.Bd -literal -offset indent
$ openssl smime -sign -in ml.txt -signer my.pem -text | \e
	openssl smime -encrypt -out mail.msg \e
	-from steve@@openssl.org -to someone@@somewhere \e
	-subject "Signed and Encrypted message" -des3 user.pem
d6230 2
a6231 4
.Bd -literal -offset indent
$ openssl smime -decrypt -in mail.msg -recip mycert.pem \e
	-inkey key.pem"
.Ed
d6237 3
a6239 3
.Bd -unfilled -offset indent
-----BEGIN PKCS7-----
-----END PKCS7-----
d6243 3
a6245 3
.Bd -literal -offset indent
$ openssl smime -verify -inform PEM -in signature.pem \e
	-content content.txt
d6249 3
a6251 3
.Bd -literal -offset indent
$ openssl smime -verify -inform DER -in signature.der \e
	-content content.txt
d6265 1
a6265 1
Ideally, a database should be maintained of a certificate for each email
d6279 1
a6279 1
v2 messages; the more complex
d6287 10
a6296 6
.Bk -words
.Op Cm aes
.Op Cm aes-128-cbc
.Op Cm aes-192-cbc
.Op Cm aes-256-cbc
.Op Cm blowfish
a6297 1
.Op Cm des
d6300 5
d6308 1
a6308 4
.Op Cm hmac
.Op Cm md2
.Op Cm md4
.Op Cm md5
d6310 1
a6310 3
.Op Cm rc2-cbc
.Op Cm rc4
.Op Cm rmd160
d6312 1
a6312 12
.Op Cm rsa512
.Op Cm rsa1024
.Op Cm rsa2048
.Op Cm rsa4096
.Op Cm sha1
.Op Fl elapsed
.Op Fl evp Ar e
.Op Fl decrypt
.Op Fl mr
.Op Fl multi Ar number
.Op Fl engine Ar id
.Ek
a6317 18
.It Cm [zero or more test algorithms]
If any options are given,
.Nm speed
tests those algorithms, otherwise all of the above are tested.
.It Fl elapsed
Measure time in real time instead of CPU user time.
.It Fl evp Ar e
Use EVP
.Ar e .
.It Fl decrypt
Time decryption instead of encryption
.Pq only EVP .
.It Fl mr
Produce machine readable ouput.
.It Fl multi Ar number
Run
.Ar number
benchmarks in parallel.
d6327 4
d6352 1
a6352 2
.Pq SPKAC
files.
d6380 1
a6380 1
.Ar arg ,
d6396 2
a6397 2
Don't output the text version of the SPKAC
.Pq not used if an SPKAC is being created .
d6399 2
a6400 2
Output the public key of an SPKAC
.Pq not used if an SPKAC is being created .
d6407 1
a6407 1
.Nm spkac
d6415 1
a6415 1
.Dl $ openssl spkac -in spkac.cnf
d6419 1
a6419 1
.Dl $ openssl spkac -in spkac.cnf -noout -verify
d6421 1
a6421 2
Create an SPKAC using the challenge string
.Qq hello :
d6423 1
a6423 1
.Dl $ openssl spkac -key key.pem -challenge hello -out spkac.cnf
d6425 7
a6431 8
Example of an SPKAC,
.Pq long lines split up for clarity :
.Bd -unfilled -offset indent
SPKAC=MIG5MGUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA1cCoq2Wa3Ixs47uI7F\e
PVwHVIPDx5yso105Y6zpozam135a8R0CpoRvkkigIyXfcCjiVi5oWk+6FfPaD03u\e
PFoQIDAQABFgVoZWxsbzANBgkqhkiG9w0BAQQFAANBAFpQtY/FojdwkJh1bEIYuc\e
2EeM2KHTWPEepWYeawvHD0gQ3DngSC75YCWnnDdq+NQ3F+X4deMx9AaEglZtULwV\e
4=
d6451 1
a6451 2
to be used in a
.Qq replay attack .
a6463 2
.Op Fl crl_check
.Op Fl engine Ar id
d6479 1
a6479 1
or have symbolic links to them of this form
d6485 1
a6485 3
Under
.Ux ,
the
a6525 10
.It Fl crl_check
Check revocation status of signer's certificate using CRLs.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm verify
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d6530 1
a6530 1
.Sq - .
d6535 1
a6535 1
If no certificate filenames are included, then an attempt is made to read
d6562 1
a6562 1
If a certificate is found which is its own issuer, it is assumed
d6565 2
a6566 3
The process of
.Qq looking up the issuers certificate
itself involves a number of steps.
d6576 1
a6576 3
.Pq if present
must match the subject key identifier
.Pq if present
d6579 1
a6579 3
extension of the candidate issuer
.Pq if present
must permit certificate signing.
d6592 3
a6594 4
The supplied or
.Qq leaf
certificate must have extensions compatible with the supplied purpose
and all other certificates must also be valid CA certificates.
d6623 2
a6624 2
.Bd -unfilled
\& server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024-bit)
d6628 1
a6628 1
The first line contains the name of the certificate being verified, followed by
d6631 1
a6631 1
The depth is the number of the certificate being verified when a
d6640 1
a6640 2
as
.Qq unused .
d6785 6
a6790 1
.Op Fl abdfopv
d6801 4
a6808 5
.It Fl d
.Ev OPENSSLDIR
setting.
.It Fl f
Compilation flags.
d6811 2
d6815 3
a6817 4
.It Fl v
The current
.Nm OpenSSL
version.
d6835 5
a6839 5
.Op Fl inform Ar DER | PEM | NET
.Op Fl outform Ar DER | PEM | NET
.Op Fl keyform Ar DER | PEM
.Op Fl CAform Ar DER | PEM
.Op Fl CAkeyform Ar DER | PEM
a6841 1
.Op Fl passin Ar arg
a6852 1
.Op Fl pubkey
a6855 1
.Op Fl ocspid
a6862 1
.Op Fl checkend Ar arg
d6873 1
a6873 1
.Op Fl md2 | md5 | sha1
d6884 2
a6885 3
various forms, sign certificate requests like a
.Qq mini CA ,
or edit certificate trust settings.
d6889 1
a6889 1
.Sh X509 INPUT, OUTPUT, AND GENERAL PURPOSE OPTIONS
d6891 1
a6891 1
.It Fl inform Ar DER | PEM | NET
d6893 1
a6893 1
Normally, the command will expect an X509 certificate,
d6906 3
a6908 2
.It Fl outform Ar DER | PEM | NET
This specifies the output format; the options have the same meaning as the
d6919 1
a6919 8
.It Fl passin Ar arg
The key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl md2 | md5 | sha1
d6923 1
a6923 1
.Fl fingerprint , signkey ,
d6927 2
a6928 2
If not specified, then MD5 is used.
If the key being used to sign with is a DSA key, then
d6934 1
a6934 1
.Nm x509
d6962 1
a6962 1
switch may also be used more than once to set multiple options.
a6967 2
.It Fl ocspid
Print OCSP hash values for the subject name and public key.
a6970 2
.It Fl pubkey
Ouput the public key.
d6974 1
a6974 3
Outputs the
.Qq hash
of the certificate subject name.
d7020 1
a7020 2
and prohibited uses of the certificate and an
.Qq alias .
d7022 3
a7024 4
Normally, when a certificate is being verified at least one certificate
must be
.Qq trusted .
By default, a trusted certificate must be stored
d7056 1
a7056 2
for example
.Qq Steve's Certificate .
d7067 3
a7069 1
.Pq SSL client use ,
d7071 3
a7073 1
.Pq SSL server use ,
d7076 3
a7078 1
.Pq S/MIME email
d7091 1
a7091 1
For a more complete description, see the
d7099 1
a7099 2
can thus behave like a
.Qq mini CA .
d7106 2
a7107 4
subject name
.Pq i.e. makes it self-signed ,
changes the public key to the supplied value
and changes the start and end dates.
d7127 2
a7128 2
Normally, all extensions are retained.
.It Fl keyform Ar DER | PEM
d7130 4
a7133 1
.Pq DER or PEM
a7139 6
.It Fl checkend Ar arg
Check whether the certificate expires in the next
.Ar arg
seconds.
If so, exit with return value 1;
otherwise exit with return value 0.
d7146 1
a7146 1
By default, a certificate is expected on input.
d7164 1
a7164 1
.Sq 0x ) .
d7168 1
a7168 1
When this option is present,
d7170 1
a7170 2
behaves like a
.Qq mini CA .
d7173 1
a7173 1
digitally signed using the CA's private key.
d7183 1
a7183 1
If this option is not specified, then it is assumed that the CA private key
d7200 1
a7200 1
For example, if the CA certificate file is called
d7206 3
a7208 6
it will contain the serial number
.Sq 02
and the certificate being signed will have
.Sq 1
as its serial number.
Normally, if the
d7210 1
a7210 1
option is specified and the serial number file does not exist, it is an error.
d7216 3
a7218 6
If this option is not specified, then the extensions should either be
contained in the unnamed
.Pq default
section or the default section should contain a variable called
.Qq extensions
which contains the section to use.
d7227 1
a7227 2
switch is present, the default
.Qq oneline
d7230 3
a7232 2
Each option is described in detail below; all options can be preceded by a
.Sq -
d7261 2
a7262 4
Escape the
.Qq special
characters required by RFC 2253 in a field that is
.Dq \& ,+"<>; .
d7264 1
a7264 1
.Sq #
d7269 3
a7271 6
That is, those with ASCII values less than 0x20
.Pq space
and the delete
.Pq 0x7f
character.
They are escaped using the RFC 2253 \eXX notation (where XX are two hex
d7278 1
a7278 1
.Sq \&"
d7281 1
a7281 1
.Sq \e
d7286 1
a7286 1
If you are lucky enough to have a UTF8 compatible terminal, then the use
d7291 1
a7291 3
may result in the correct display of multibyte
.Pq international
characters.
d7307 1
a7307 2
For example
.Qq BMPSTRING: Hello World .
d7312 1
a7312 1
Both options use the RFC 2253 #XXXX... format.
d7314 2
a7315 3
Dump non-character string types
.Pq for example OCTET STRING ;
if this option is not set, then non-character string types will be displayed
d7329 2
a7330 3
The options ending in
.Qq space
additionally place a space after the separator to make it more readable.
d7334 1
a7334 1
.Sq +
d7347 1
a7347 3
uses the
.Qq short name
form (CN for
d7360 1
a7360 1
.Sq =
d7376 2
a7377 4
Don't print header information: that is, the lines saying
.Qq Certificate
and
.Qq Data .
d7422 2
a7423 3
In these examples the
.Sq \e
means the example should be all on one line.
d7427 1
a7427 1
.Dl $ openssl x509 -in cert.pem -noout -text
d7431 1
a7431 1
.Dl $ openssl x509 -in cert.pem -noout -serial
d7435 1
a7435 1
.Dl $ openssl x509 -in cert.pem -noout -subject
d7437 1
a7437 1
Display the certificate subject name in RFC 2253 form:
d7439 1
a7439 1
.Dl $ openssl x509 -in cert.pem -noout -subject -nameopt RFC2253
d7443 2
a7444 4
.Bd -literal -offset indent
$ openssl x509 -in cert.pem -noout -subject \e
	-nameopt oneline,-escmsb
.Ed
d7448 1
a7448 1
.Dl $ openssl x509 -in cert.pem -noout -fingerprint
d7452 1
a7452 1
.Dl $ openssl x509 -sha1 -in cert.pem -noout -fingerprint
d7460 1
a7460 1
.Dl "$ openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER"
d7463 2
a7464 4
.Bd -literal -offset indent
$ openssl x509 -x509toreq -in cert.pem -out req.pem \e
	-signkey key.pem
.Ed
d7468 3
a7470 3
.Bd -literal -offset indent
$ openssl x509 -req -in careq.pem -extfile openssl.cnf -extensions \e
	v3_ca -signkey key.pem -out cacert.pem
d7475 2
a7476 2
.Bd -literal -offset indent
$ openssl x509 -req -in req.pem -extfile openssl.cnf -extensions \e
d7481 4
a7484 5
client use and set its alias to
.Qq Steve's Class 1 CA :
.Bd -literal -offset indent
$ openssl x509 -in cert.pem -addtrust clientAuth \e
	-setalias "Steve's Class 1 CA" -out trust.pem
d7490 3
a7492 3
.Bd -unfilled -offset indent
-----BEGIN CERTIFICATE-----
-----END CERTIFICATE-----
d7496 3
a7498 3
.Bd -unfilled -offset indent
-----BEGIN X509 CERTIFICATE-----
-----END X509 CERTIFICATE-----
d7502 3
a7504 3
.Bd -unfilled -offset indent
-----BEGIN TRUSTED CERTIFICATE-----
-----END TRUSTED CERTIFICATE-----
d7516 1
a7516 2
This is commonly called a
.Qq fingerprint .
d7545 2
a7546 2
If the CA flag is true, then it is a CA;
if the CA flag is false, then it is not a CA.
d7552 3
a7554 4
extension is absent, then the certificate is
considered to be a
.Qq possible CA ;
other extensions are checked according to the intended use of the certificate.
d7559 2
a7560 3
If the certificate is a V1 certificate
.Pq and thus has no extensions
and it is self-signed, it is also assumed to be a CA but a warning is again
d7578 1
a7578 2
If this extension is present
.Pq whether critical or not ,
d7592 1
a7592 2
.Qq web client authentication
OID.
d7601 1
a7601 2
.Qq web client authentication
OID.
d7608 1
a7608 2
.Qq web server authentication
and/or one of the SGC OIDs.
d7618 1
a7618 2
.Qq web server authentication
and/or one of the SGC OIDs.
d7634 1
a7634 2
.Qq email protection
OID.
d7640 1
a7640 1
bit is not set in Netscape certificate type, then the SSL
d7663 1
a7663 2
.Qq email protection
OID.
@


1.1.1.9
log
@Release Time. Synchronize with OpenBSD 3.4-current (base system).
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.15 2003/09/02 18:56:35 jmc Exp $
d373 1
a373 1
Triple DES Cipher.
a8072 86
.\"
.\" FILES
.\"
.Sh FILES
.Bl -tag -width "/etc/ssl/openssl.cnf" -compact
.It /etc/ssl/
Default config directory for
.Nm openssl .
.It /etc/ssl/lib/
Unused.
.It /etc/ssl/private/
Default private key directory.
.It /etc/ssl/openssl.cnf
Default configuration file for
.Nm openssl .
.It /etc/ssl/x509v3.cnf
Default configuration file for
.Nm x509
certificates.
.El
.\"
.\" SEE ALSO
.\"
.Sh SEE ALSO
.Xr blowfish 3 ,
.Xr crypto 3 ,
.Xr des_crypt 3 ,
.Xr dsa 3 ,
.Xr HMAC 3 ,
.Xr md4 3 ,
.Xr md5 3 ,
.Xr RAND_egd 3 ,
.Xr rsa 3 ,
.Xr sha1 3 ,
.Xr ssl 3 ,
.Xr des_modes 7 ,
.Xr httpd 8 ,
.Xr sendmail 8 ,
.Xr ssl 8 ,
.Xr starttls 8
.Pp
.Rs
.%T The SSL Protocol
.%Q Netscape Communications Corp.
.%D February 9 1995
.Re
.Rs
.%T The SSL 3.0 Protocol
.%Q Netscape Communications Corp.
.%D November 18 1996
.Re
.Rs
.%R RFC 2246
.%T The TLS Protocol Version 1.0
.%D January 1999
.Re
.Rs
.%R RFC 2253
.%T "LDAPv3 Distinguished Names"
.%D December 1997
.Re
.Rs
.%R RFC 2315
.%T "PKCS #7: Cryptographic Message Syntax"
.%D March 1998
.Re
.Rs
.%R RFC 2459
.%T "X.509 Certificate and CRL Profile"
.%D January 1999
.Re
.Rs
.%R RFC 2560
.%T "Online Certificate Status Protocol \- OCSP"
.%D June 1999
.Re
.Rs
.%R RFC 2630
.%T "Cryptographic Message Syntax"
.%D June 1999
.Re
.Rs
.%R RFC 3268
.%T "Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security(TLS)"
.%D June 2002
.Re
@


1.1.1.10
log
@Time to import OpenBSD once again. Expect breakage.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.27 2003/12/21 15:00:41 jmc Exp $
d128 1
d131 1
a131 1
.Cm list-cipher-commands
d133 1
d334 2
a335 2
.It Cm ripemd160
RIPEMD-160 Digest.
d392 3
a394 3
If no password argument is given and a password is required,
then the user is prompted to enter one:
this will typically be read from the current terminal with echoing turned off.
d396 1
a396 1
.It Ar pass : Ns Ar password
d405 1
a405 1
.It Ar env : Ns Ar var
d414 1
a414 1
.It Ar file : Ns Ar pathname
d429 1
a429 1
.It Ar fd : Ns Ar number
d440 1
a440 1
.Nm openssl asn1parse
d442 7
a449 2
.Op Fl i
.Op Fl noout
a450 4
.Op Fl in Ar filename
.Op Fl inform Ar DER | PEM | TXT
.Op Fl length Ar number
.Op Fl offset Ar number
a451 1
.Op Fl out Ar filename
d461 1
a461 13
.Bl -tag -width "-noout"
.It Fl dlimit Ar number
Dump the first
.Ar number
bytes of unknown data in hex form.
.It Fl dump
Dump unknown data in hex form.
.It Fl i
Indents the output according to the
.Qq depth
of the structures.
.It Fl in Ar filename
The input file; default is standard input.
a464 1
.Pq Distinguished Encoding Rules
d467 2
a468 2
.Pq Privacy Enhanced Mail ,
the default, is base64 encoded.
d471 10
a480 2
.It Fl length Ar number
Number of bytes to parse; default is until end of file.
d485 12
d498 1
a498 1
A file containing additional object identifiers
a502 8
.It Fl out Ar filename
Output file to place the
.Em DER
encoded data into.
If this option is not present, then no encoded data will be output.
This is most useful when combined with the
.Fl strparse
option.
d504 1
a504 1
Parse the content octets of the ASN.1 object starting at
d512 2
a513 2
.Bd -literal -offset 2n
0:d=0  hl=4 l= 681 cons: SEQUENCE
d517 10
a526 10
229:d=3  hl=3 l= 141 prim: BIT STRING
373:d=2  hl=3 l= 162 cons: cont [ 3 ]
376:d=3  hl=3 l= 159 cons: SEQUENCE
379:d=4  hl=2 l=  29 cons: SEQUENCE
381:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Subject Key Identifier
386:d=5  hl=2 l=  22 prim: OCTET STRING
410:d=4  hl=2 l= 112 cons: SEQUENCE
412:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Authority Key Identifier
417:d=5  hl=2 l= 105 prim: OCTET STRING
524:d=4  hl=2 l=  12 cons: SEQUENCE
d541 1
a541 1
gives the length of the content octets.
d549 2
a550 2
In this example, the BIT STRING at offset 229 is the certificate public key.
The content octets of this will contain the public key information.
d555 3
a557 6
    0:d=0  hl=3 l= 137 cons: SEQUENCE
    3:d=1  hl=3 l= 129 prim: INTEGER           :E5D21E1F5C8D208EA7A2166C7FA
F9F6BDF2059669C60876DDB70840F1A5AAFA59699FE471F379F1DD6A487E7D5409AB6A88D4A
9746E24B91D8CF55DB3521015460C8EDE44EE8A4189F7A7BE77D6CD3A9AF2696F486855CF58
BF0EDF2B4068058C7A947F52548DDF7E15E96B385F86422BEA9064A3EE9
  135:d=1  hl=2 l=   3 prim: INTEGER           :010001
d560 1
a560 3
If an OID
.Pq object identifier
is not part of
d568 1
a568 1
Each line consists of three columns:
d580 1
a580 1
.Dl \&"1.2.3.4	shortname	A long name\&"
a590 8
.Op Fl batch
.Op Fl gencrl
.Op Fl infiles
.Op Fl msie_hack
.Op Fl noemailDN
.Op Fl notext
.Op Fl preserveDN
.Op Fl updatedb
a591 1
.Op Fl cert Ar file
d593 6
d600 1
a600 3
.Op Fl crl_compromise Ar time
.Op Fl crl_hold Ar instruction
.Op Fl crl_reason Ar reason
d602 1
d604 2
a605 1
.Op Fl crlhours Ar hours
d607 2
a608 6
.Op Fl enddate Ar date
.Op Fl engine Ar id
.Op Fl extensions Ar section
.Op Fl extfile Ar section
.Op Fl in Ar file
.Op Fl key Ar arg
d611 4
a614 2
.Op Fl md Ar arg
.Op Fl name Ar section
d616 1
d618 1
a618 3
.Op Fl passin Ar arg
.Op Fl policy Ar arg
.Op Fl revoke Ar file
d621 6
a626 1
.Op Fl startdate Ar date
d628 2
a629 1
.Op Fl subj Ar arg
a641 6
.It Fl batch
This sets the batch mode.
In this mode no questions will be asked
and all certificates will be certified automatically.
.It Fl cert Ar file
The CA certificate file.
d644 8
a651 32
.It Fl days Ar arg
The number of days to certify the certificate for.
.It Fl enddate Ar date
This allows the expiry date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm ca
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl extensions Ar section
The section of the configuration file containing certificate extensions
to be added when a certificate is issued (defaults to
.Em x509_extensions
unless the
.Fl extfile
option is used).
If no extension section is present, then a V1 certificate is created.
If the extension section is present
.Pq even if it is empty ,
then a V3 certificate is created.
.It Fl extfile Ar file
An additional configuration
.Ar file
to read certificate extensions from
(using the default section unless the
.Fl extensions
option is also used).
d656 8
d667 18
d693 21
a713 4
.It Fl keyfile Ar filename
The private key to sign requests with.
.It Fl keyform Ar PEM | ENGINE
Private key file format.
d721 9
d741 8
a748 8
.It Fl name Ar section
Specifies the configuration file
.Ar section
to use (overrides
.Cm default_ca
in the
.Cm ca
section).
d760 22
a781 50
.It Fl notext
Don't output the text form of a certificate to the output file.
.It Fl out Ar filename
The output file to output certificates to.
The default is standard output.
The certificate details will also be printed out to this file.
.It Fl outdir Ar directory
The
.Ar directory
to output certificates to.
The certificate will be written to a filename consisting of the
serial number in hex with
.Qq .pem
appended.
.It Fl passin Ar arg
The key password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl policy Ar arg
This option defines the CA
.Qq policy
to use.
This is a section in the configuration file which decides which fields
should be mandatory or match the CA certificate.
Check out the
.Sx CA POLICY FORMAT
section for more information.
.It Fl preserveDN
Normally, the DN order of a certificate is the same as the order of the
fields in the relevant policy section.
When this option is set, the order is the same as the request.
This is largely for compatibility with the older IE enrollment control
which would only accept certificates if their DNs matched the order of the
request.
This is not needed for Xenroll.
.It Fl spkac Ar filename
A file containing a single Netscape signed public key and challenge,
and additional field values to be signed by the CA.
See the
.Sx SPKAC FORMAT
section for information on the required format.
.It Fl ss_cert Ar filename
A single self-signed certificate to be signed by the CA.
.It Fl startdate Ar date
This allows the start date to be explicitly set.
The format of the date is YYMMDDHHMMSSZ
.Pq the same as an ASN1 UTCTime structure .
d787 8
a794 2
.It Fl verbose
This prints extra details about the operations being performed.
d798 13
a810 17
.It Fl crl_CA_compromise Ar time
This is the same as
.Fl crl_compromise ,
except the revocation reason is set to CACompromise.
.It Fl crl_compromise Ar time
This sets the revocation reason to keyCompromise and the compromise time to
.Ar time .
.Ar time
should be in GeneralizedTime format, i.e. YYYYMMDDHHMMSSZ.
.It Fl crl_hold Ar instruction
This sets the CRL revocation reason code to certificateHold and the hold
instruction to
.Ar instruction
which must be an OID.
Although any OID can be used, only holdInstructionNone
(the use of which is discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.
d823 27
a849 5
.It Fl crldays Ar num
The number of days before the next CRL is due.
This is the days from now to place in the CRL
.Em nextUpdate
field.
a863 18
.It Fl crlhours Ar num
The number of hours before the next CRL is due.
.It Fl gencrl
This option generates a CRL based on information in the index file.
.It Fl revoke Ar filename
A
.Ar filename
containing a certificate to revoke.
.It Fl subj Ar arg
Supersedes the subject name given in the request.
The
.Ar arg
must be formatted as
.Ar /type0=value0/type1=value1/type2=... ;
characters may be escaped by
.Sq \e
.Pq backslash ,
no spaces are skipped.
d902 19
d926 5
a930 26
.It Ar copy_extensions
Determines how extensions in certificate requests should be handled.
If set to
.Ar none
or this option is not present, then extensions are
ignored and not copied to the certificate.
If set to
.Ar copy ,
then any extensions present in the request that are not already present
are copied to the certificate.
If set to
.Ar copyall ,
then all extensions in the request are copied to the certificate:
if the extension is already present in the certificate it is deleted first.
See the
.Sx CA WARNINGS
section before using this option.
.Pp
The main use of this option is to allow a certificate request to supply
values for certain extensions such as
.Em subjectAltName .
.It Ar crl_extensions
The same as
.Fl crlexts .
.It Ar database
The text database file to use.
d932 4
a935 9
This file must be present, though initially it will be empty.
.It Ar default_crl_hours , default_crl_days
The same as the
.Fl crlhours
and
.Fl crldays
options.
These will only be used if neither command line option is present.
At least one of these must be present to generate a CRL.
d941 6
d955 8
d969 17
a985 6
.It Ar default_startdate
The same as the
.Fl startdate
option.
The start date to certify a certificate for.
If not set, the current time is used.
d997 7
d1022 1
a1022 1
.Em ca_default
d1034 14
a1047 23
.It Ar new_certs_dir
The same as the
.Fl outdir
command line option.
It specifies the directory where new certificates will be placed.
Mandatory.
.It Ar oid_file
This specifies a file containing additional object identifiers.
Each line of the file should consist of the numerical form of the
object identifier followed by whitespace, then the short name followed
by whitespace and finally the long name.
.It Ar oid_section
This specifies a section in the configuration file containing extra
object identifiers.
Each line should consist of the short name of the object identifier
followed by
.Sq =
and the numerical form.
The short and long names are the same when this option is used.
.It Ar policy
The same as
.Fl policy .
Mandatory.
d1049 6
a1054 22
.Sx CA POLICY FORMAT
section for more information.
.It Ar preserve
The same as
.Fl preserveDN .
.It Ar private_key
Same as the
.Fl keyfile
option.
The file containing the CA private key.
Mandatory.
.It Ar RANDFILE
A file used to read and write random number seed information,
or an EGD socket (see
.Xr RAND_egd 3 ) .
.It Ar serial
A text file containing the next serial number to use in hex.
Mandatory.
This file must be present and contain a valid serial number.
.It Ar x509_extensions
The same as
.Fl extensions .
d1170 2
a1171 2
\& nameopt        = ca_default            # Subject name display option
\& certopt        = ca_default            # Certificate display option
d1188 1
a1188 1
/etc/ssl/openssl.cnf           - master configuration file
d1311 1
a1311 1
.Op Fl h
a1312 1
.Op Fl v
d1316 1
a1316 1
.Nm ciphers
d1323 1
a1323 9
.Bl -tag -width "XXXXXX"
.It Fl h , \&?
Print a brief usage message.
.It Fl ssl2
Only include SSL v2 ciphers.
.It Fl ssl3
Only include SSL v3 ciphers.
.It Fl tls1
Only include TLS v1 ciphers.
d1337 8
d1438 1
a1438 1
All cipher suites except the
d1461 1
a1461 1
40-bit export encryption algorithms.
d1467 1
a1467 1
ciphers; that is, those offering no encryption.
d1667 1
a1667 1
.Ar COMPLEMENTOFALL
d1677 7
a1684 1
.Op Fl hash
a1687 2
.Op Fl noout
.Op Fl text
a1689 4
.Op Fl in Ar filename
.Op Fl inform Ar DER | PEM
.Op Fl out Ar filename
.Op Fl outform Ar DER | PEM
a1701 18
.It Fl CAfile Ar file
Verify the signature on a CRL by looking up the issuing certificate in
.Ar file .
.It Fl CApath Ar dir
Verify the signature on a CRL by looking up the issuing certificate in
.Ar dir .
This directory must be a standard certificate directory,
i.e. a hash of each subject name (using
.Cm x509 Fl hash )
should be linked to each certificate.
.It Fl fingerprint
Print the CRL fingerprint.
.It Fl hash
Output a hash of the issuer name.
This can be used to look up CRLs in a directory by issuer name.
.It Fl in Ar filename
This specifies the input filename to read from, or standard input if this
option is not specified.
d1709 19
d1738 10
a1747 11
.It Fl noout
Don't output the encoded version of the CRL.
.It Fl out Ar filename
Specifies the output filename to write to, or standard output by
default.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl text
Print out the CRL in text form.
d1767 1
a1767 1
.Dl $ openssl crl -in crl.der -inform DER -text -noout
d1776 2
a1777 3
.Bk -words
.Op Fl nocrl
.Op Fl certfile Ar filename
a1778 1
.Op Fl inform Ar DER | PEM
d1780 2
a1781 2
.Op Fl outform Ar DER | PEM
.Ek
a1791 13
.It Fl certfile Ar filename
Specifies a
.Ar filename
containing one or more certificates in
.Ar PEM
format.
All certificates in the file will be added to the PKCS#7 structure.
This option can be used more than once to read certificates from multiple
files.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read a CRL from or standard input if this option is not specified.
a1798 8
.It Fl nocrl
Normally, a CRL is included in the output file.
With this option, no CRL is
included in the output file and a CRL is not read from the input file.
.It Fl out Ar filename
Specifies the output
.Ar filename
to write the PKCS#7 structure to or standard output by default.
d1806 21
d1862 2
a1863 2
.Fl dss1 | md2 | md4 | md5 |
.Fl ripemd160 | sha | sha1
a1864 1
.Op Fl binary
d1868 1
a1868 2
.Op Fl engine Ar id
.Op Fl keyform Ar PEM | ENGINE
d1870 2
a1873 1
.Op Fl sign Ar filename
d1875 2
a1876 1
.Op Fl verify Ar filename
d1882 2
a1883 2
.Cm md2 | md4 | md5 |
.Cm ripemd160 | sha | sha1
d1897 1
a1897 3
.Bl -tag -width "-binary"
.It Fl binary
Output the digest or signature in binary form.
a1903 8
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dgst
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d1909 2
a1910 2
.It Fl keyform Ar PEM | ENGINE
Key file format.
d1913 5
a1917 2
.It Fl prverify Ar filename
Verify the signature using the private key in
d1923 3
a1931 3
.It Fl sign Ar filename
Digitally sign the digest using the private key in
.Ar filename .
d1934 10
a1943 7
.It Fl verify Ar filename
Verify the signature using the public key in
.Ar filename .
The output is either
.Qq Verification OK
or
.Qq Verification Failure .
d1978 4
a1981 3
.Op Fl 2 | 5
.Op Fl C
.Op Fl check
d1985 3
a1988 5
.Op Fl in Ar filename
.Op Fl inform Ar DER | PEM
.Op Fl out Ar filename
.Op Fl outform Ar DER | PEM
.Op Fl rand Ar file ...
d1994 4
a1997 44
command is used to manipulate DH parameter files.
.Pp
The options are as follows:
.Bl -tag -width "XXXX"
.It Fl 2 , 5
The generator to use, either 2 or 5.
2 is the default.
If present, then the input file is ignored and parameters are generated instead.
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dh Ns Ar numbits Ns Li ()
function.
.It Fl check
Check the DH parameters.
.It Fl dsaparam
If this option is used, DSA rather than DH parameters are read or created;
they are converted to DH format.
Otherwise,
.Qq strong
primes
.Pq such that (p-1)/2 is also prime
will be used for DH parameter generation.
.Pp
DH parameter generation with the
.Fl dsaparam
option is much faster,
and the recommended exponent length is shorter,
which makes DH key exchange more efficient.
Beware that with such DSA-style DH parameters,
a fresh DH key should be created for each use to
avoid small-subgroup attacks that may be possible otherwise.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dhparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read parameters from or standard input if this option is not specified.
d2009 8
a2016 9
.It Fl noout
This option inhibits the output of the encoded version of the parameters.
.It Ar numbits
This argument specifies that a parameter set should be generated of size
.Ar numbits .
It must be the last option.
If not present, then a value of 512 is used.
If this value is present, then the input file is ignored and
parameters are generated instead.
d2025 21
a2045 4
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
d2052 9
d2063 13
d2127 8
d2136 2
a2137 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
d2139 2
a2141 4
.Op Fl noout
.Op Fl pubin
.Op Fl pubout
.Op Fl text
a2142 6
.Op Fl in Ar filename
.Op Fl inform Ar DER | PEM
.Op Fl out Ar filename
.Op Fl outform Ar DER | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
a2159 30
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES, or the triple DES
ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified, the key is written in plain text.
This means that using the
.Nm dsa
utility to read in an encrypted key with no encryption option can be used to
remove the pass phrase from a key,
or by setting the encryption options it can be use to add or change
the pass phrase.
These options can only be used with
.Ar PEM
format output files.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read a key from or standard input if this option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
d2167 2
a2168 2
P, Q, G,
and the public and private key components, respectively, as ASN.1 INTEGERs.
d2176 1
a2176 1
it consists of the DER format base64
a2178 13
.It Fl modulus
This option prints out the value of the public key component of the key.
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl out Ar filename
This specifies the output
.Ar filename
to write a key to, or standard output if not specified.
If any encryption options are set then a pass phrase will be
prompted for.
The output filename should
.Em not
be the same as the input filename.
d2183 5
d2195 9
d2211 23
d2241 8
a2248 2
.It Fl text
Prints out the public/private key components and parameters.
d2292 6
d2299 1
a2300 2
.Op Fl noout
.Op Fl text
a2301 5
.Op Fl in Ar filename
.Op Fl inform Ar DER | PEM
.Op Fl out Ar filename
.Op Fl outform Ar DER | PEM
.Op Fl rand Ar file ...
a2310 23
.It Fl C
This option converts the parameters into C code.
The parameters can then be loaded by calling the
.Cm get_dsa Ns Ar XXX Ns Li ()
function.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm dsaparam
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl genkey
This option will generate a DSA either using the specified or generated
parameters.
.It Fl in Ar filename
This specifies the input
.Ar filename
to read parameters from, or standard input if this option is not specified.
If the
.Ar numbits
parameter is included, then this option will be ignored.
d2323 19
d2344 16
d2367 8
a2374 20
.It Fl out Ar filename
This specifies the output
.Ar filename
to write parameters to.
Standard output is used if this option is not present.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified, separated by a
.Sq \&: .
.It Fl text
This option prints out the DSA parameters in human readable form.
d2393 4
a2396 4
.Op Fl AadePp
.Op Fl debug
.Op Fl engine Ar id
.Op Fl nopad
d2398 4
a2401 5
.Op Fl salt
.Op Fl bufsize Ar number
.Op Fl in Ar filename
.Op Fl iv Ar IV
.Op Fl K Ar key
a2403 2
.Op Fl out Ar filename
.Op Fl pass Ar arg
d2405 8
d2423 41
a2463 4
.It Fl A
If the
.Fl a
option is set, then base64 process the data on one line.
d2470 22
a2491 21
.It Fl bufsize Ar number
Set the buffer size for I/O.
.It Fl d
Decrypt the input data.
.It Fl debug
Debug the BIOs used for I/O.
.It Fl e
Encrypt the input data: this is the default.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm enc
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar filename
The input
.Ar filename ;
standard input by default.
.It Fl iv Ar IV
d2493 1
a2493 2
.Ar IV
.Pq initialisation vector
a2495 11
When only the
.Ar key
is specified using the
.Fl K
option, the
.Ar IV
must explicitly be defined.
When a password is being specified using one of the other options,
the
.Ar IV
is generated from this password.
d2503 1
a2503 1
must be additionally specified using the
d2521 20
a2540 31
.It Fl k Ar password
The
.Ar password
to derive the key from.
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl kfile Ar filename
Read the password to derive the key from the first line of
.Ar filename .
This is for compatibility with previous versions of
.Nm OpenSSL .
Superseded by the
.Fl pass
option.
.It Fl nopad
Disable standard block padding.
.It Fl nosalt
Don't use a
.Ar salt
in the key derivation routines.
This is the default for compatibility with previous versions of
.Nm OpenSSL
and
.Nm SSLeay .
.It Fl out Ar filename
The output
.Ar filename ,
standard output by default.
d2543 1
a2543 2
.Ar salt ,
.Ar key ,
d2546 1
a2546 1
used, then immediately exit;
d2548 14
a2561 33
.It Fl p
Print out the
.Ar salt ,
.Ar key ,
and
.Ar IV
used.
.It Fl pass Ar arg
The password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl S Ar salt
The actual
.Ar salt
to use:
this must be represented as a string comprised only of hex digits.
.It Fl salt
Use a
.Ar salt
in the key derivation routines.
This option should
.Em ALWAYS
be used unless compatibility with previous versions of
.Nm OpenSSL
or
.Nm SSLeay
is required.
This option is only present on
.Nm OpenSSL
versions 0.9.5 or above.
d2657 1
a2658 1
des-ofb            DES in OFB mode
d2700 1
a2700 1
.Dl "$ openssl des3 -d -in file.des3 -out file.txt -k mypassword"
d2710 5
a2714 1
.Dl "$ openssl bf -d -a -in file.bf -out file.txt"
a2730 4
.Nm openssl errstr
.Op Fl stats
.Ar errno ...
.Pp
d2733 1
a2733 23
command performs error number to error string conversion,
generating a human-readable string representing the error code
.Ar errno .
The string is obtained through the
.Xr ERR_error_string_n 3
function and has the following format:
.Pp
.Dl error:[error code]:[library name]:[function name]:[reason string]
.Pp
.Bq error code
is an 8-digit hexadecimal number.
The remaining fields
.Bq library name ,
.Bq function name ,
and
.Bq reason string
are all ASCII text.
.Pp
The options are as follows:
.Bl -tag -width "-stats"
.It Fl stats
Print debugging statistics about various aspects of the hash table. 
.El
d2983 1
a2983 1
.Ar hostname : Ns Ar port
d3117 1
a3117 1
.Fl host Ar hostname : Ns Ar port ,
d4310 1
a4310 1
.Ar rsa : Ns Ar bits
d4315 1
a4315 1
.Ar dsa : Ns Ar file
d4422 1
a4422 1
.Ar rsa : Ns Ar nbits ,
d4428 1
a4428 1
.Ar dsa : Ns Ar filename
d5411 1
a5411 1
.Fl connect Ar host : Ns Ar port
d5455 1
a5455 1
.Fl connect Ar host : Ns Ar port
d5567 2
a5568 4
Currently, the only supported keywords are
.Qq smtp
and
.Qq pop3 .
d5825 1
a5825 1
This option enables a further workaround for some early Netscape
d6614 1
a6614 1
Produce machine readable output.
d7302 1
a7302 1
Output the public key.
a8100 1
.Xr ERR_error_string_n 3 ,
@


1.1.1.11
log
@Import OpenBSD again, for various reasons.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.28 2003/12/29 13:44:43 jmc Exp $
d2786 3
d2790 2
a2791 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
a2792 3
.Op Fl engine Ar id
.Op Fl out Ar filename
.Op Fl rand Ar file ...
d2806 2
a2807 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
d2809 2
a2810 2
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
d2812 7
a2818 1
If none of these options are specified, no encryption is used.
a2826 4
.It Fl out Ar filename
The output
.Ar filename .
If this argument is not specified, standard output is used.
a2832 6
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
d2836 1
a2836 1
much quicker than RSA key generation, for example.
d2844 2
a2845 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
a2846 2
.Op Fl engine Ar id
.Op Fl 3 | f4
d2849 1
d2851 1
d2861 11
d2873 2
a2874 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
d2876 4
a2879 4
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
If none of these options are specified, no encryption is used.
If encryption is used, a pass phrase is prompted for,
d2883 10
a2900 3
.It Fl 3 | f4
The public exponent to use, either 3 or 65537.
The default is 65537.
a2904 18
.It Fl out Ar filename
The output
.Ar filename .
If this argument is not specified, standard output is used.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl rand Ar file ...
A file or files
containing random data used to seed the random number
generator, or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
d2919 2
a2920 2
Because key generation is a random process,
the time taken to generate a key may vary somewhat.
@


1.1.1.12
log
@Import OpenBSD as of today again (seems pretty stable, I hope)

Prominent changes: more bgpd, tcpmd5; tcpdump/isakmpd fixes
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.31 2004/01/25 20:27:37 jmc Exp $
d412 1
a412 1
.It Ar file : Ns Ar path
d414 1
a414 1
.Ar path
d417 1
a417 1
.Ar path
d424 1
a424 1
.Ar path
d444 1
a444 1
.Op Fl in Ar file
d448 2
a449 2
.Op Fl oid Ar file
.Op Fl out Ar file
d470 1
a470 1
.It Fl in Ar file
d488 1
a488 1
.It Fl oid Ar file
d494 1
a494 1
.It Fl out Ar file
d605 1
a605 1
.Op Fl config Ar file
d652 1
a652 1
.It Fl config Ar file
d686 1
a686 1
.It Fl in Ar file
d688 1
a688 1
.Ar file
d701 1
a701 1
.It Fl keyfile Ar file
d744 1
a744 1
.It Fl out Ar file
d752 1
a752 1
The certificate will be written to a file consisting of the
d780 1
a780 1
.It Fl spkac Ar file
d786 1
a786 1
.It Fl ss_cert Ar file
d854 1
a854 1
.It Fl revoke Ar file
d856 1
a856 1
.Ar file
d1691 1
a1691 1
.Op Fl in Ar file
d1693 1
a1693 1
.Op Fl out Ar file
d1722 2
a1723 2
.It Fl in Ar file
This specifies the input file to read from, or standard input if this
d1744 2
a1745 2
.It Fl out Ar file
Specifies the output file to write to, or standard output by
d1783 2
a1784 2
.Op Fl certfile Ar file
.Op Fl in Ar file
d1786 1
a1786 1
.Op Fl out Ar file
d1799 1
a1799 1
.It Fl certfile Ar file
d1801 1
a1801 1
.Ar file
d1808 1
a1808 1
.It Fl in Ar file
d1810 1
a1810 1
.Ar file
d1823 1
a1823 1
.It Fl out Ar file
d1825 1
a1825 1
.Ar file
d1878 2
a1879 2
.Op Fl out Ar file
.Op Fl prverify Ar file
d1881 3
a1883 3
.Op Fl sign Ar file
.Op Fl signature Ar file
.Op Fl verify Ar file
d1928 3
a1930 3
.It Fl out Ar file
file to output to, or standard output by default.
.It Fl prverify Ar file
d1932 1
a1932 1
.Ar file .
d1943 1
a1943 1
.It Fl sign Ar file
d1945 2
a1946 2
.Ar file .
.It Fl signature Ar file
d1948 1
a1948 1
.It Fl verify Ar file
d1950 1
a1950 1
.Ar file .
d1996 1
a1996 1
.Op Fl in Ar file
d1998 1
a1998 1
.Op Fl out Ar file
d2046 1
a2046 1
.It Fl in Ar file
d2048 1
a2048 1
.Ar file
d2070 1
a2070 1
.It Fl out Ar file
d2072 1
a2072 1
.Ar file
d2151 1
a2151 1
.Op Fl in Ar file
d2153 1
a2153 1
.Op Fl out Ar file
d2199 1
a2199 1
.It Fl in Ar file
d2201 1
a2201 1
.Ar file
d2227 1
a2227 1
.It Fl out Ar file
d2229 1
a2229 1
.Ar file
d2311 1
a2311 1
.Op Fl in Ar file
d2313 1
a2313 1
.Op Fl out Ar file
d2341 1
a2341 1
.It Fl in Ar file
d2343 1
a2343 1
.Ar file
d2369 1
a2369 1
.It Fl out Ar file
d2371 1
a2371 1
.Ar file
d2414 1
a2414 1
.Op Fl in Ar file
d2418 2
a2419 2
.Op Fl kfile Ar file
.Op Fl out Ar file
d2458 1
a2458 1
.It Fl in Ar file
d2460 1
a2460 1
.Ar file ;
d2513 1
a2513 1
.It Fl kfile Ar file
d2515 1
a2515 1
.Ar file .
d2531 1
a2531 1
.It Fl out Ar file
d2533 1
a2533 1
.Ar file ,
d2768 1
a2768 1
Print debugging statistics about various aspects of the hash table.
d2791 1
a2791 1
.Op Fl out Ar file
d2821 1
a2821 1
.It Fl out Ar file
d2823 1
a2823 1
.Ar file .
d2853 1
a2853 1
.Op Fl out Ar file
d2891 1
a2891 1
.It Fl out Ar file
d2893 1
a2893 1
.Ar file .
d2937 2
a2939 2
.Op Fl in Ar file
.Op Fl out Ar file
d2949 2
a2950 2
.Bl -tag -width "-toseq"
.It Fl in Ar file
d2952 1
a2952 1
.Ar file
d2954 1
a2954 1
.It Fl out Ar file
d2956 1
a2956 1
.Ar file
d2989 1
a2989 1
It is used by the Netscape certificate server, for example.
d3003 7
a3009 2
.Op Fl no_cert_checks
.Op Fl no_cert_verify
a3010 6
.Op Fl no_chain
.Op Fl no_intern
.Op Fl no_nonce
.Op Fl no_signature_verify
.Op Fl nonce
.Op Fl noverify
a3011 2
.Op Fl resp_key_id
.Op Fl resp_no_certs
d3014 7
a3020 5
.Op Fl trust_other
.Op Fl CA Ar file
.Op Fl CAfile Ar file
.Op Fl CApath Ar path
.Op Fl cert Ar file
d3025 18
a3042 12
.Op Fl index Ar indexfile
.Op Fl issuer Ar file
.Op Fl ndays Ar days
.Op Fl nmin Ar minutes
.Op Fl nrequest Ar number
.Op Fl out Ar file
.Op Fl path Ar path
.Op Fl port Ar portnum
.Op Fl reqin Ar file
.Op Fl reqout Ar file
.Op Fl respin Ar file
.Op Fl respout Ar file
d3045 5
a3049 10
.Op Fl rsigner Ar file
.Op Fl serial Ar number
.Op Fl sign_other Ar file
.Op Fl signer Ar file
.Op Fl signkey Ar file
.Op Fl status_age Ar age
.Op Fl url Ar responder_url
.Op Fl VAfile Ar file
.Op Fl validity_period Ar nsec
.Op Fl verify_other Ar file
d3068 13
a3080 7
.It Fl CAfile Ar file , Fl CApath Ar path
.Ar file
or
.Ar path
containing trusted CA certificates.
These are used to verify the signature on the OCSP response.
.It Fl cert Ar file
d3082 1
a3082 1
.Ar file
d3087 17
a3103 4
.It Xo
.Fl host Ar hostname : Ns Ar port ,
.Fl path Ar path
.Xc
d3105 6
a3110 43
.Fl host
option is present, then the OCSP request is sent to the host
.Ar hostname
on port
.Ar port .
.Fl path
specifies the HTTP path name to use, or
.Sq /
by default.
.It Fl issuer Ar file
This specifies the current issuer certificate.
This option can be used multiple times.
The certificate specified in
.Ar file
must be in
.Ar PEM
format.
.It Fl no_cert_checks
Don't perform any additional checks on the OCSP response signer's certificate.
That is, do not make any checks to see if the signer's certificate is
authorised to provide the necessary status information:
as a result this option should only be used for testing purposes.
.It Fl no_cert_verify
Don't verify the OCSP response signer's certificate at all.
Since this option allows the OCSP response to be signed by any certificate,
it should only be used for testing purposes.
.It Fl no_certs
Don't include any certificates in signed request.
.It Fl no_chain
Do not use certificates in the response as additional untrusted CA
certificates.
.It Fl no_intern
Ignore certificates contained in the OCSP response
when searching for the signer's certificate.
With this option, the signer's certificate must be specified with either the
.Fl verify_certs
or
.Fl VAfile
options.
.It Fl no_signature_verify
Don't check the signature on the OCSP response.
Since this option tolerates invalid signatures on OCSP responses,
it will normally only be used for testing purposes.
a3135 10
.It Fl noverify
Don't attempt to verify the OCSP response signature or the
.Em nonce
values.
This option will normally only be used for debugging
since it disables all verification of the responder's certificate.
.It Fl out Ar file
Specify output
.Ar file ;
default is standard output.
d3138 3
d3147 1
a3147 1
.Fl serial , cert ,
d3151 9
a3159 24
.It Fl reqout Ar file , Fl respout Ar file
Write out the
.Ar DER
encoded certificate request or response to
.Ar file .
.It Fl serial Ar num
Same as the
.Fl cert
option except the certificate with serial number
.Ar num
is added to the request.
The serial number is interpreted as a decimal integer unless preceded by
.Sq 0x .
Negative integers can also be specified by preceding the value with a
.Sq -
sign.
.It Fl sign_other Ar file
Additional certificates to include in the signed request.
.It Fl signer Ar file , Fl signkey Ar file
Sign the OCSP request using the certificate specified in the
.Fl signer
option and the private key specified by the
.Fl signkey
option.
d3161 21
a3181 4
.Fl signkey
option is not present, then the private key is read from the same file
as the certificate.
If neither option is specified, then the OCSP request is not signed.
a3188 5
.It Fl url Ar responder_url
Specify the responder URL.
Both HTTP and HTTPS
.Pq SSL/TLS
URLs can be specified.
d3197 30
a3253 6
.It Fl verify_other Ar file
.Ar file
containing additional certificates to search when attempting to locate
the OCSP response signing certificate.
Some responders omit the actual signer's certificate from the response;
this option can be used to supply the necessary certificate in such cases.
a3256 3
.It Fl CA Ar file
CA certificate corresponding to the revocation information in
.Ar indexfile .
d3292 26
a3328 23
.It Fl nrequest Ar number
The OCSP server will exit after receiving
.Ar number
requests, default unlimited.
.It Fl port Ar portnum
Port to listen for OCSP requests on.
The port may also be specified using the
.Fl url
option.
.It Fl resp_key_id
Identify the signer certificate using the key ID;
default is to use the subject name.
.It Fl resp_no_certs
Don't include any certificates in the OCSP response.
.It Fl rkey Ar file
The private key to sign OCSP responses with;
if not present, the file specified in the
.Fl rsigner
option is used.
.It Fl rother Ar file
Additional certificates to include in the OCSP response.
.It Fl rsigner Ar file
The certificate to sign OCSP responses with.
d3426 1
a3426 1
Read in an OCSP response and print out in text form:
d3451 2
a3452 2
Query status information using request read from a file and write
the response to a second file:
d3462 6
a3467 1
.Op Fl 1 | apr1 | crypt
d3470 1
a3471 4
.Op Fl stdin
.Op Fl table
.Op Fl in Ar file
.Op Fl salt Ar string
d3499 5
a3515 17
.It Fl crypt
Use the
.Em crypt
algorithm
.Pq default .
.It Fl in Ar file
Read passwords from
.Ar file .
.It Fl noverify
Don't verify when reading a password from the terminal.
.It Fl quiet
Don't output warnings when passwords given on the command line are truncated.
.It Fl reverse
Switch table columns.
This only makes sense in conjunction with the
.Fl table
option.
d3521 3
d3527 4
d3534 2
d3557 2
a3558 2
.Op Fl in Ar file
.Op Fl out Ar file
d3586 1
a3586 1
.It Fl in Ar file
d3588 1
a3588 1
.Ar file
d3590 1
a3590 1
.It Fl out Ar file
d3592 1
a3592 1
.Ar file
d3653 1
a3653 1
.Op Fl in Ar file
d3655 1
a3655 1
.Op Fl out Ar file
d3701 1
a3701 1
.It Fl in Ar file
d3703 1
a3703 1
.Ar file
d3713 1
a3713 1
.It Fl out Ar file
d3715 1
a3715 1
.Ar file
d3910 2
a3911 2
.Op Fl inkey Ar file
.Op Fl certfile Ar file
d3913 1
a3913 1
.Op Fl CAfile Ar file
d3916 2
a3917 2
.Op Fl in Ar file
.Op Fl out Ar file
d3962 1
a3962 1
.It Fl in Ar file
d3964 1
a3964 1
.Ar file
d3967 1
a3967 1
.It Fl out Ar file
d3969 1
a3969 1
.Ar file
d4027 1
a4027 1
.It Fl out Ar file
d4029 1
a4029 1
.Ar file
d4032 1
a4032 1
.It Fl in Ar file
d4034 1
a4034 1
.Ar file
d4043 1
a4043 1
.It Fl inkey Ar file
d4051 2
a4052 2
.It Fl certfile Ar file
A file to read additional certificates from.
d4056 1
a4056 1
.It Fl CAfile Ar file
d4337 1
a4337 1
.Op Fl in Ar file
d4339 1
a4339 1
.Op Fl out Ar file
d4360 1
a4360 1
.Op Fl key Ar file
d4362 1
a4362 1
.Op Fl keyout Ar file
d4364 1
a4364 1
.Op Fl config Ar file
d4404 1
a4404 1
.It Fl in Ar file
d4406 1
a4406 1
.Ar file
d4421 1
a4421 1
.It Fl out Ar file
d4423 1
a4423 1
.Ar file
d4468 1
a4468 1
.Ar dsa : Ns Ar file
d4470 2
a4471 2
.Ar file .
.It Fl key Ar file
d4482 1
a4482 1
.It Fl keyout Ar file
d4484 1
a4484 1
.Ar file
d4497 1
a4497 1
.It Fl config Ar file
d4631 1
a4631 1
This is the default file to write a private key to.
d4650 1
a4650 1
This specifies a file in which random number seed information is
d5065 1
a5065 1
.Op Fl in Ar file
d5067 1
a5067 1
.Op Fl out Ar file
d5119 1
a5119 1
.It Fl in Ar file
d5121 1
a5121 1
.Ar file
d5132 1
a5132 1
.It Fl out Ar file
d5134 1
a5134 1
.Ar file
d5292 1
a5292 1
.It Fl in Ar file
d5294 1
a5294 1
.Ar file
d5297 1
a5297 1
.It Fl out Ar file
d5299 1
a5299 1
.Ar file
d5454 2
a5455 2
.Op Fl cert Ar file
.Op Fl key Ar file
d5457 1
a5457 1
.Op Fl CAfile Ar file
d5716 1
a5716 1
.Op Fl cert Ar file
d5718 1
a5718 1
.Op Fl dcert Ar file
d5720 1
a5720 1
.Op Fl dhparam Ar file
d5728 1
a5728 1
.Op Fl CAfile Ar file
d5773 1
a5773 1
If not specified, then the file
d5779 1
a5779 1
.It Fl dcert Ar file , Fl dkey Ar keyname
d5800 1
a5800 1
.It Fl dhparam Ar file
d6008 2
a6009 2
.Op Fl in Ar file
.Op Fl out Ar file
d6042 1
a6042 1
.It Fl in Ar file
d6044 1
a6044 1
.Ar file
d6046 1
a6046 1
.It Fl out Ar file
d6048 1
a6048 1
.Ar file
d6217 1
a6217 1
.It Fl in Ar file
d6240 1
a6240 1
.It Fl out Ar file
d6262 1
a6262 1
.It Fl content Ar file
d6676 2
a6677 2
.Op Fl in Ar file
.Op Fl out Ar file
d6698 1
a6698 1
.It Fl in Ar file
d6700 1
a6700 1
.Ar file
d6705 1
a6705 1
.It Fl out Ar file
d6707 1
a6707 1
.Ar file
d6892 1
a6892 1
If no certificate files are included, then an attempt is made to read
d7199 2
a7200 2
.Op Fl in Ar file
.Op Fl out Ar file
d7227 1
a7227 1
.Op Fl signkey Ar file
d7230 2
a7231 2
.Op Fl CA Ar file
.Op Fl CAkey Ar file
d7233 1
a7233 1
.Op Fl CAserial Ar file
d7238 1
a7238 1
.Op Fl extfile Ar file
d7274 1
a7274 1
.It Fl in Ar file
d7276 1
a7276 1
.Ar file
d7278 1
a7278 1
.It Fl out Ar file
d7280 1
a7280 1
.Ar file
d7475 1
a7475 1
.It Fl signkey Ar file
d7545 1
a7545 1
.It Fl CA Ar file
d7561 1
a7561 1
.It Fl CAkey Ar file
d7565 1
a7565 1
.It Fl CAserial Ar file
d7594 1
a7594 1
.It Fl extfile Ar file
@


1.1.1.13
log
@large-scale import of OpenBSD 3.5-current source base including many fixes
note: from now, we will not be binary compatible with OpenBSD apps any
longer (due to syscall numbering differences); both an OpenBSD compat and
a conversion tool for old MirOS #7 apps will be delivered later.

The src/ tree is locked from now.
@
text
@d1 1
a1 1
.\" $OpenBSD: openssl.1,v 1.42 2004/04/19 12:25:41 jmc Exp $
d113 1
a113 1
.\" OPENSSL
d479 1
a479 1
the default, is base64-encoded.
d495 4
a498 2
Output file to place the DER-encoded data into.
If this option is not present, no encoded data will be output.
d619 1
a619 1
.Op Fl key Ar keyfile
d675 1
a675 1
If no extension section is present, a V1 certificate is created.
d693 1
a693 1
.It Fl key Ar keyfile
d1277 1
a1277 1
If care is not taken, it can be a security risk.
d1352 1
a1352 1
If it is not included, the default cipher list will be used.
d1410 1
a1410 1
If none of these characters is present, the string is just interpreted
d1699 5
a1703 1
command processes CRL files in DER or PEM format.
d1710 1
a1710 1
.It Fl CApath Ar directory
d1728 1
a1728 1
format is a DER-encoded CRL structure.
d1731 1
a1731 1
is a base64-encoded version of the DER form with header and footer lines.
d1761 4
a1764 1
Convert a CRL file from PEM to DER:
d1768 3
a1770 1
Output the text form of a DER-encoded certificate:
d1802 3
a1804 1
containing one or more certificates in PEM format.
d1811 1
a1811 1
to read a CRL from, or standard input if this option is not specified.
d1815 1
a1815 1
format is a DER-encoded CRL structure.
d1818 1
a1818 1
is a base64-encoded version of the DER form with header and footer lines.
d1826 1
a1826 1
to write the PKCS#7 structure to, or standard output by default.
d1830 1
a1830 1
format is a DER-encoded PKCS#7 structure.
d1833 1
a1833 1
is a base64-encoded version of the DER form with header and footer lines.
d1840 3
a1842 1
Create a PKCS#7 structure in DER format with no CRL from several
d1854 1
a1854 1
This involves sending the DER-encoded output
d1858 3
a1860 1
The PEM-encoded form with the header and footer lines removed can be used to
d1963 1
a1963 1
If you wish to sign or verify data using the DSA algorithm, the dss1
d2013 1
a2013 1
If present, the input file is ignored and parameters are generated instead.
d2049 1
a2049 1
to read parameters from, or standard input if this option is not specified.
d2054 1
a2054 1
uses an ASN1 DER-encoded form compatible with the PKCS#3 DHparameter
d2059 1
a2059 1
it consists of the DER format base64-encoded with
d2067 2
a2068 2
If not present, a value of 512 is used.
If this value is present, the input file is ignored and
d2110 2
a2111 1
PEM format DH parameters use the header and footer lines:
d2188 3
a2190 1
These options can only be used with PEM format output files.
d2202 1
a2202 1
to read a key from, or standard input if this option is not specified.
d2208 1
a2208 1
argument with a private key uses an ASN1 DER-encoded form of an ASN.1
d2220 2
a2221 2
it consists of the DER format base64-encoded with additional header and footer
lines.
d2265 3
a2267 1
The PEM private key format uses the header and footer lines:
d2273 3
a2275 1
The PEM public key format uses the header and footer lines:
d2352 1
a2352 1
argument uses an ASN1 DER-encoded form compatible with RFC 2459
d2358 1
a2358 1
it consists of the DER format base64-encoded with additional header
d2365 2
a2366 1
If this option is included, the input file
d2391 2
a2392 1
PEM format DSA parameters use the header and footer lines:
d2438 1
a2438 1
This means that if encryption is taking place, the data is base64-encoded
d2440 1
a2440 1
If decryption is set, the input data is base64 decoded before
d2626 1
a2626 1
If padding is disabled, the input data must be a multiple of the cipher
d2953 1
a2953 1
to read, or standard input if this option is not specified.
d2956 1
a2956 1
.Ar file ,
d2977 3
a2979 1
The PEM-encoded form uses the same headers and footers as a certificate:
d2991 6
a2996 3
This program needs a few more options,
like allowing DER or PEM input and output files
and allowing multiple certificate files to be used.
d3020 1
a3020 1
.Op Fl CApath Ar directory
d3068 1
a3068 1
.It Fl CAfile Ar file , Fl CApath Ar directory
d3100 3
a3102 1
must be in PEM format.
d3177 3
a3179 1
Write out the DER-encoded certificate request or response to
d3204 1
a3204 1
If neither option is specified, the OCSP request is not signed.
d3307 1
a3307 1
If neither option is present, the
d3352 1
a3352 1
If the initial verify fails, the OCSP verify process halts with an
d3367 1
a3367 1
If none of these checks is successful, the OCSP verify fails.
d3560 4
a3563 1
.Op Fl noout
d3566 1
a3567 4
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
d3572 5
a3576 1
command processes PKCS#7 files in DER or PEM format.
a3579 12
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs7
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read from, or standard input if this option is not specified.
d3583 1
a3583 1
format is a DER-encoded PKCS#7 v1.5 structure.
d3586 1
a3586 10
is a base64-encoded version of the DER form with header and footer lines.
.It Fl noout
Don't output the encoded version of the PKCS#7 structure
(or certificates if
.Fl print_certs
is set).
.It Fl out Ar file
Specifies the output
.Ar file
to write to, or standard output by default.
d3591 8
d3601 1
a3601 1
They are preceded by their subject and issuer names in a one-line format.
d3605 13
d3620 4
a3623 1
Convert a PKCS#7 file from PEM to DER:
d3631 3
a3633 1
The PEM PKCS#7 format uses the header and footer lines:
a3654 5
.Op Fl embed
.Op Fl nocrypt
.Op Fl noiter
.Op Fl nooct
.Op Fl nsdb
a3655 2
.Op Fl engine Ar id
.Op Fl in Ar file
a3656 1
.Op Fl out Ar file
d3658 1
d3660 1
d3662 6
d3669 1
a3669 1
.Op Fl v2 Ar alg
d3682 24
a3705 17
.It Fl embed
This option generates DSA keys in a broken format.
The DSA parameters are embedded inside the
.Em PrivateKey
structure.
In this form the OCTET STRING contains an ASN1 SEQUENCE consisting of
two structures:
a SEQUENCE containing the parameters and an ASN1 INTEGER containing
the private key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs8
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
d3709 1
a3709 1
to read a key from, or standard input if this option is not specified.
d3711 22
a3732 6
.It Fl inform Ar DER | PEM
This specifies the input format.
If a PKCS#8 format key is expected on input,
then either a
DER- or PEM-encoded version of a PKCS#8 key will be expected.
Otherwise the DER or PEM format of the traditional format private key is used.
d3736 2
a3737 2
structures using an appropriate password-based encryption algorithm.
With this option, an unencrypted
d3742 1
a3742 1
Certain software such as some versions of Java code signing software use
a3743 5
.It Fl noiter
Use an iteration count of 1.
See the
.Sx PKCS12
section below for a detailed explanation of this option.
d3750 9
a3764 36
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output by default.
If any encryption options are set, a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl topk8
Normally, a PKCS#8 private key is expected on input and a traditional format
private key will be written.
With the
.Fl topk8
option the situation is reversed:
it reads a traditional format private key and writes a PKCS#8 format key.
.It Fl v1 Ar alg
This option specifies a PKCS#5 v1.5 or PKCS#12 algorithm to use.
A complete list of possible algorithms is included below.
d3767 1
a3767 1
Normally, PKCS#8 private keys are encrypted with the password-based
d3783 2
a3784 2
argument is the encryption algorithm to use; valid values include
.Ar des , des3 ,
d3790 11
d3803 3
a3805 1
The encrypted form of a PEM-encoded PKCS#8 file uses the following
d3819 1
a3819 1
counts are more secure than those encrypted using the traditional
d3822 1
a3822 1
So if additional security is considered important, the keys should be converted.
d3825 1
a3825 1
that most current implementations of PKCS#8 support.
d3827 1
a3827 1
Some software may use PKCS#12 password-based encryption algorithms
d3832 2
a3833 1
DER-encoded encrypted private keys in PKCS#8 format because the encryption
d3835 3
a3837 1
level whereas the traditional format includes them at a PEM level.
d3858 1
a3858 1
These algorithms use the PKCS#12 password-based encryption algorithm and
d3878 1
a3878 1
Read a DER-unencrypted PKCS#8 format private key:
d3896 1
a3896 1
it is hidden away in PKCS#11 v2.01, section 11.9;
d3913 1
a3913 5
.Oo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Oc
.Op Fl cacerts
d3915 11
d3927 2
a3928 2
.Op Fl descert
.Op Fl export
d3930 4
a3933 4
.Op Fl keyex
.Op Fl keysig
.Op Fl maciter
.Op Fl nocerts
d3936 1
a3936 4
.Op Fl nokeys
.Op Fl nomaciter
.Op Fl nomacver
.Op Fl noout
d3938 12
a3949 16
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl caname Ar name
.Op Fl certfile Ar file
.Op Fl certpbe Ar alg
.Op Fl engine Ar id
.Op Fl in Ar file
.Op Fl inkey Ar file
.Op Fl keypbe Ar alg
.Op Fl name Ar name
.Op Fl out Ar file
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Op Fl rand Ar file ...
.Ek
.Pp
a3966 13
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
Use AES, DES, or triple DES, respectively,
to encrypt private keys before outputting.
The default is triple DES.
.It Fl cacerts
Only output CA certificates
.Pq not client certificates .
.It Fl clcerts
Only output client certificates
.Pq not CA certificates .
a3971 14
.It Fl info
Output additional information about the PKCS#12 file structure,
algorithms used, and iteration counts.
.It Fl nocerts
No certificates at all will be output.
.It Fl nodes
Don't encrypt the private keys at all.
.It Fl nokeys
No private keys will be output.
.It Fl nomacver
Don't attempt to verify the integrity MAC before reading the file.
.It Fl noout
This option inhibits output of the keys and certificates to the output file
version of the PKCS#12 file.
d3976 4
a3979 2
They are all written in PEM format.
.It Fl passin Ar arg
d3995 27
d4029 32
d4064 1
a4064 4
.It Fl CApath Ar directory
Directory of CAs
.Pq PEM format .
.It Fl caname Ar name
d4072 16
a4087 10
.It Fl certfile Ar file
A file to read additional certificates from.
.It Fl certpbe Ar alg , Fl keypbe Ar alg
These options allow the algorithm used to encrypt the private key and
certificates to be selected.
Although any PKCS#5 v1.5 or PKCS#12 algorithms can be selected,
it is advisable to only use PKCS#12 algorithms.
See the list in the
.Sx PKCS12 NOTES
section for more information.
d4089 1
a4089 1
If this option is present, an attempt is made to include the entire
d4100 8
a4107 23
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm pkcs12
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl export
This option specifies that a PKCS#12 file will be created rather than
parsed.
.It Fl in Ar file
The
.Ar file
to read certificates and private keys from, standard input by default.
They must all be in PEM format.
The order doesn't matter but one private key and its corresponding
certificate should be present.
If additional certificates are present, they will also be included
in the PKCS#12 file.
.It Fl inkey Ar file
File to read private key from.
If not present, a private key must be present in the input file.
a4122 8
.It Fl maciter
This option is included for compatibility with previous versions; it used
to be needed to use MAC iterations counts but they are now used by default.
.It Fl name Ar name
This specifies the
.Qq friendly name
for the certificate and private key.
This name is typically displayed in list boxes by software importing the file.
d4142 3
a4144 21
.It Fl out Ar file
This specifies
.Ar file
to write the PKCS#12 file to.
Standard output is used by default.
.It Fl passin Ar arg
Pass phrase source to decrypt any input private keys with.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The PKCS#12 file
.Pq i.e. output file
password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
d4152 8
d4189 1
a4189 1
If the CA certificates are required, they can be output to a separate
d4281 2
a4284 2
.Op Fl out Ar file
.Op Fl rand Ar file ...
d4311 10
a4332 10
.It Fl out Ar file
Write to
.Ar file
instead of standard output.
.It Fl rand Ar file ...
Use specified file or files, or EGD socket (see
.Xr RAND_egd 3 )
for seeding the random number generator.
Multiple files can be specified separated by a
.Sq \&: .
d4340 10
a4349 3
.Op Fl asn1-kludge
.Op Fl batch
.Op Fl md2 | md4 | md5 | sha1
d4352 1
a4352 20
.Op Fl newhdr
.Op Fl nodes
.Op Fl noout
.Op Fl pubkey
.Op Fl subject
.Op Fl text
.Op Fl utf8
.Op Fl verbose
.Op Fl verify
.Op Fl x509
.Op Fl config Ar file
.Op Fl days Ar n
.Op Fl engine Ar id
.Op Fl extensions Ar section
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl key Ar keyfile
.Op Fl keyform Ar DER | PEM
.Op Fl keyout Ar file
.Op Fl nameopt Ar option
d4355 1
a4355 1
.Ar dsa : Ns Ar file
d4360 1
a4360 1
.Ar rsa : Ns Ar bits
d4363 14
a4376 5
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
.Op Fl rand Ar file ...
d4378 5
a4382 3
.Op Fl reqopt Ar option
.Op Fl set_serial Ar n
.Op Fl subj Ar arg
d4394 15
a4408 50
.It Fl asn1-kludge
By default, the
.Nm req
command outputs certificate requests containing
no attributes in the correct PKCS#10 format.
However certain CAs will only
accept requests containing no attributes in an invalid form: this
option produces this invalid format.
.Pp
More precisely, the
.Em Attributes
in a PKCS#10 certificate request are defined as a SET OF Attribute.
They are
.Em not
optional, so if no attributes are present then they should be encoded as an
empty SET OF.
The invalid form does not include the empty
SET OF, whereas the correct form does.
.Pp
It should be noted that very few CAs still require the use of this option.
.It Fl batch
Non-interactive mode.
.It Fl config Ar file
This allows an alternative configuration file to be specified;
this overrides the compile time filename or any specified in
the
.Ev OPENSSL_CONF
environment variable.
.It Fl days Ar n
When the
.Fl x509
option is being used, this specifies the number of
days to certify the certificate for.
The default is 30 days.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm req
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl extensions Ar section , Fl reqexts Ar section
These options specify alternative sections to include certificate
extensions (if the
.Fl x509
option is present) or certificate request extensions.
This allows several different sections to
be used in the same configuration file to specify requests for
a variety of purposes.
d4419 9
a4427 21
.It Fl inform Ar DER | PEM
This specifies the input format.
The
.Ar DER
argument uses an ASN1 DER-encoded form compatible with the PKCS#10.
The
.Ar PEM
form is the default format:
it consists of the DER format base64-encoded with additional header and
footer lines.
.It Fl key Ar keyfile
This specifies the file to read the private key from.
It also accepts PKCS#8 format private keys for PEM format files.
.It Fl keyform Ar DER | PEM
The format of the private key file specified in the
.Fl key
argument.
.Ar PEM
is the default.
.It Fl keyout Ar file
This gives the
d4429 14
a4442 7
to write the newly created private key to.
If this option is not specified, the filename present in the
configuration file is used.
.It Fl md2 | md4 | md5 | sha1
This specifies the message digest to sign the request with.
This overrides the digest algorithm specified in the configuration file.
This option is ignored for DSA requests: they always use SHA1.
d4446 2
a4447 9
.It Fl nameopt Ar option , Fl reqopt Ar option
These options determine how the subject or issuer names are displayed.
The
.Ar option
argument can be a single option or multiple options separated by commas.
Alternatively, these options may be used more than once to set multiple options.
See the
.Sx X509
section below for details.
d4458 6
a4463 6
.It Fl newhdr
Adds the word NEW to the PEM file header and footer lines
on the outputed request.
Some software
.Pq Netscape certificate server
and some CAs need this.
d4476 17
d4496 12
a4507 37
.It Fl noout
This option prevents output of the encoded version of the request.
.It Fl out Ar file
This specifies the output
.Ar file
to write to, or standard output by default.
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
.It Fl passin Ar arg
The input file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl passout Ar arg
The output file password source.
For more information about the format of
.Ar arg ,
see the
.Sx PASS PHRASE ARGUMENTS
section above.
.It Fl pubkey
Outputs the public key.
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl set_serial Ar n
Serial number to use when outputting a self-signed certificate.
This may be specified as a decimal value or a hex value if preceded by
.Sq 0x .
It is possible to use negative serial numbers but this is not recommended.
a4516 13
.It Fl subject
Output the request's subject.
.It Fl text
Prints out the certificate request in text form.
.It Fl utf8
This option causes field values to be interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
.It Fl verbose
Print extra details about the operations being performed.
.It Fl verify
Verifies the signature on the request.
d4528 74
d4616 10
a4625 12
.It Ar attributes
This specifies the section containing any request attributes: its format
is the same as
.Ar distinguished_name .
Typically these may contain the
.Em challengePassword
or
.Em unstructuredName
types.
They are currently ignored by
.Nm OpenSSL Ns Li 's
request signing utilities, but some CAs might want them.
d4628 1
a4628 1
If not specified, 512 is used.
a4640 34
.It Ar default_md
This option specifies the digest algorithm to use.
Possible values include
.Ar md5
and
.Ar sha1 .
If not present, MD5 is used.
This option can be overridden on the command line.
.It Ar distinguished_name
This specifies the section containing the distinguished name fields to
prompt for when generating a certificate or certificate request.
The format is described in the next section.
.It Ar encrypt_key
If this is set to
.Em no
and a private key is generated, it is
.Em not
encrypted.
This is equivalent to the
.Fl nodes
command line option.
For compatibility,
.Ar encrypt_rsa_key
is an equivalent option.
.It Ar input_password | output_password
The passwords for the input private key file
.Pq if present
and the output private key file
.Pq if one will be created .
The command line options
.Fl passin
and
.Fl passout
override the configuration file values.
a4653 10
.It Ar prompt
If set to the value
.Em no ,
this disables prompting of certificate fields
and just takes values from the config file directly.
It also changes the expected format of the
.Em distinguished_name
and
.Em attributes
sections.
d4659 20
a4678 6
.It Ar req_extensions
This specifies the configuration file section containing a list of
extensions to add to the certificate request.
It can be overridden by the
.Fl reqexts
command line switch.
d4714 6
a4719 7
.It Ar utf8
If set to the value
.Em yes ,
then field values are interpreted as UTF8 strings;
by default they are interpreted as ASCII.
This means that the field values, whether prompted from a terminal or
obtained from a configuration file, must be valid UTF8 strings.
d4728 33
d4805 2
a4806 2
If the user enters nothing, the default value is used;
if no default value is present, the field is omitted.
d4858 1
a4858 1
Examine and verify a certificate request:
d4956 3
a4958 1
The header and footer lines in the PEM format are normally:
d5068 7
d5076 2
a5077 2
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
d5079 3
a5082 2
.Op Fl modulus
.Op Fl noout
a5084 2
.Op Fl sgckey
.Op Fl text
a5085 6
.Op Fl in Ar file
.Op Fl inform Ar DER | NET | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | NET | PEM
.Op Fl passin Ar arg
.Op Fl passout Ar arg
a5102 30
.It Xo
.Fl aes128 | aes192 | aes256 |
.Fl des | des3
.Xc
These options encrypt the private key with the AES, DES,
or the triple DES ciphers, respectively, before outputting it.
A pass phrase is prompted for.
If none of these options is specified the key is written in plain text.
This means that using the
.Nm rsa
utility to read in an encrypted key with no encryption option can be used
to remove the pass phrase from a key, or by setting the encryption options
it can be used to add or change the pass phrase.
These options can only be used with PEM format output files.
.It Fl check
This option checks the consistency of an RSA private key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsa
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl in Ar file
This specifies the input
.Ar file
to read a key from, or standard input if this
option is not specified.
If the key is encrypted, a pass phrase will be prompted for.
d5108 1
a5108 1
uses an ASN1 DER-encoded form compatible with the PKCS#1
d5112 2
a5113 2
form is the default format: it consists of the DER format base64-encoded with
additional header and footer lines.
a5119 12
.It Fl noout
This option prevents output of the encoded version of the key.
.It Fl modulus
This option prints out the value of the modulus of the key.
.It Fl out Ar file
This specifies the output
.Ar file
to write a key to, or standard output if this option is not specified.
If any encryption options are set, a pass phrase will be prompted for.
The output filename should
.Em not
be the same as the input filename.
d5124 6
d5137 9
a5145 1
.It Fl passout Ar arg
a5151 7
.It Fl pubin
By default, a private key is read from the input file; with this
option a public key is read instead.
.It Fl pubout
By default, a private key is output;
with this option a public key will be output instead.
This option is automatically set if the input is a public key.
d5156 16
d5175 21
d5198 3
a5200 1
The PEM private key format uses the header and footer lines:
d5206 3
a5208 1
The PEM public key format uses the header and footer lines:
d5246 5
a5250 1
To convert a private key from PEM to DER format:
d5274 5
a5278 1
.Op Fl asn1parse
d5280 3
d5284 1
a5284 1
.Op Fl encrypt
d5286 1
a5286 4
.Op Fl oaep | pkcs | raw | ssl
.Op Fl pubin
.Op Fl sign
.Op Fl verify
a5287 4
.Op Fl in Ar file
.Op Fl inkey Ar file
.Op Fl keyform Ar DER | PEM
.Op Fl out Ar file
a5296 20
.It Fl asn1parse
Asn1parse the output data; this is useful when combined with the
.Fl verify
option.
.It Fl certin
The input is a certificate containing an RSA public key.
.It Fl decrypt
Decrypt the input data using an RSA private key.
.It Fl encrypt
Encrypt the input data using an RSA public key.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm rsautl
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl hexdump
Hex dump the output data.
d5300 1
a5300 1
to read data from, or standard input
d5302 5
a5312 16
.It Fl oaep | pkcs | raw | ssl
The padding to use:
PKCS#1 OAEP, PKCS#1 v1.5
.Pq the default ,
no padding,
or special padding used in SSL v2 backwards compatible handshakes, respectively.
For signatures, only
.Fl pkcs
and
.Fl raw
can be used.
.It Fl out Ar file
Specifies the output
.Ar file
to write to, or standard output by
default.
d5315 2
d5322 28
d5421 1
a5421 1
.Dl $ openssl x509 -in test/testx509.pem -pubkey -noout \*(Gtpubkey.pem
d5438 1
a5438 1
It can be seen that the digest used was MD5.
d5455 12
a5466 3
.Op Fl 4 | 6
.Op Fl bugs
.Op Fl crlf
a5467 1
.Op Fl ign_eof
d5469 2
d5472 6
a5477 1
.Op Fl nbio_test
d5481 1
a5481 4
.Op Fl pause
.Op Fl prexit
.Op Fl quiet
.Op Fl reconnect
a5482 8
.Op Fl showcerts
.Op Fl ssl2
.Op Fl ssl3
.Op Fl state
.Op Fl tls1
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
d5484 1
a5484 4
.Oo
.Fl connect Ar host : Ns Ar port |
.Ar host Ns / Ns Ar port
.Oc
a5485 1
.Op Fl key Ar keyfile
a5486 2
.Op Fl starttls Ar protocol
.Op Fl verify Ar depth
d5499 26
a5524 16
.It Fl 4
Specify that
.Nm s_client
should attempt connections using IPv4 only.
.It Fl 6
Specify that
.Nm s_client
should attempt connections using IPv6 only.
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A
.Ar file
containing trusted certificates to use during server authentication
and to use when attempting to build the client certificate chain.
d5535 8
a5542 64
.It Fl cert Ar file
The certificate to use, if one is requested by the server.
The default is not to use a certificate.
.It Fl cipher Ar cipherlist
This allows the cipher list sent by the client to be modified.
Although the server determines which cipher suite is used, it should take
the first supported cipher in the list sent by the client.
See the
.Sx CIPHERS
section above for more information.
.It Xo
.Fl connect Ar host : Ns Ar port |
.Ar host Ns / Ns Ar port
.Xc
This specifies the
.Ar host
and optional
.Ar port
to connect to.
If not specified, an attempt is made to connect to the local host
on port 4433.
Alternatively, the host and port pair may be separated using a forward-slash
character.
This form is useful for numeric IPv6 addresses.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF as required
by some servers.
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_client
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl ign_eof
Inhibit shutting down the connection when end of file is reached in the
input.
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl nbio_test
Tests non-blocking I/O.
.It Xo
.Fl no_ssl2 | no_ssl3 | no_tls1 |
.Fl ssl2 | ssl3 | tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2, or TLS as appropriate.
.Pp
Unfortunately there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.
Some servers only work if TLS is turned off with the
.Fl no_tls
option, others will only support SSL v2 and may need the
.Fl ssl2
option.
d5545 3
d5559 16
d5580 18
a5597 9
.It Fl rand Ar file ...
A file or files containing random data used to seed the random number generator,
or an EGD socket (see
.Xr RAND_egd 3 ) .
Multiple files can be specified separated by a
.Sq \&: .
.It Fl reconnect
Reconnects to the same server 5 times using the same session ID; this can
be used as a test that session caching is working.
d5601 7
a5607 3
.It Fl showcerts
Display the whole server certificate chain: normally only the server
certificate itself is displayed.
d5616 14
a5629 12
.It Fl state
Prints out the SSL session states.
.It Fl verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the
server certificate chain and turns on server certificate verification.
Currently the verify operation continues after errors so all the problems
with a certificate chain can be seen.
As a side effect the connection will never fail due to a server
certificate verify failure.
d5632 1
a5632 1
If a connection is established with an SSL server, any data received
d5653 1
a5653 1
If the connection succeeds, an HTTP command can be given such as
d5657 1
a5657 1
If the handshake fails, there are several possible causes; if it is
d5660 1
a5660 1
.Fl no_ssl2 , no_ssl3 ,
d5684 1
a5684 1
option and send an HTTP request for an appropriate page.
d5693 1
a5693 1
If there are problems verifying a server certificate, the
d5717 11
a5727 1
.Op Fl bugs
a5729 2
.Op Fl hack
.Op Fl HTTP
d5731 3
a5733 7
.Op Fl nbio
.Op Fl nbio_test
.Op Fl no_dhe
.Op Fl no_ssl2
.Op Fl no_ssl3
.Op Fl no_tls1
.Op Fl no_tmp_rsa
d5735 2
d5738 1
a5738 1
.Op Fl serverpref
a5740 1
.Op Fl state
d5742 7
d5750 1
a5750 10
.Op Fl www
.Op Fl accept Ar port
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Op Fl cipher Ar cipherlist
.Op Fl context Ar id
.Op Fl dcert Ar file
.Op Fl dhparam Ar file
.Op Fl dkey Ar file
a5752 1
.Op Fl key Ar keyfile
a5753 2
.Op Fl Verify Ar depth
.Op Fl verify Ar depth
d5768 5
a5772 19
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A file containing trusted certificates to use during client authentication
and to use when attempting to build the server certificate chain.
The list is also used in the list of acceptable client CAs passed to the
client when a certificate is requested.
.It Fl CApath Ar directory
The
.Ar directory
to use for client certificate verification.
This directory must be in
.Qq hash format ;
see
.Fl verify
for more information.
These are also used when building the server certificate chain.
.It Fl cert Ar file
d5778 1
a5778 1
If not specified, the file
d5781 4
a5784 16
.It Fl cipher Ar cipherlist
This allows the cipher list used by the server to be modified.
When the client sends a list of supported ciphers, the first client cipher
also included in the server list is used.
Because the client specifies the preference order, the order of the server
cipherlist is irrelevant.
See the
.Sx CIPHERS
section for more information.
.It Fl context Ar id
Sets the SSL context ID.
It can be given any string value.
If this option is not present, a default value will be used.
.It Fl crlf
This option translates a line feed from the terminal into CR+LF.
.It Fl dcert Ar file , Fl dkey Ar file
d5791 1
a5791 1
.Pq no additional certificate or key is used .
d5798 1
a5798 1
By using RSA and DSS certificates and keys,
d5801 4
a5804 2
.It Fl debug
Print extensive debugging information including a hex dump of all traffic.
d5809 1
a5809 1
If not specified, an attempt is made to
d5811 1
a5811 1
If this fails, a static set of parameters hard coded into the
d5813 87
a5899 13
program will be used.
.It Fl engine Ar id
Specifying an engine (by it's unique
.Ar id
string) will cause
.Nm s_server
to attempt to obtain a functional reference to the specified engine,
thus initialising it if needed.
The engine will then be set as the default for all available algorithms.
.It Fl hack
This option enables a further workaround for some early Netscape
SSL code
.Pq \&? .
d5905 1
a5905 1
is requested, the file
d5911 8
a5926 28
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
.It Fl msg
Show all protocol messages with hex dump.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl nbio_test
Tests non-blocking I/O.
.It Fl no_dhe
If this option is set, no DH parameters will be loaded, effectively
disabling the ephemeral DH cipher suites.
.It Xo
.Fl no_ssl2 | no_ssl3 | no_tls1 |
.Fl ssl2 | ssl3 | tls1
.Xc
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method which should be compatible
with all servers and permit them to use SSL v3, SSL v2, or TLS as appropriate.
.It Fl no_tmp_rsa
Certain export cipher suites sometimes use a temporary RSA key; this option
disables temporary RSA key generation.
.It Fl nocert
If this option is set, no certificate is used.
This restricts the cipher suites available to the anonymous ones
.Pq currently just anonymous DH .
.It Fl quiet
Inhibit printing of session and certificate information.
a5932 30
.It Fl serverpref
Use server's cipher preferences.
.It Fl state
Prints out the SSL session states.
.It Fl WWW
Emulates a simple web server.
Pages will be resolved relative to the current directory;
for example if the URL
.Pa https://myhost/page.html
is requested, the file
.Pa ./page.html
will be loaded.
.It Fl www
Sends a status message back to the client when it connects.
This includes lots of information about the ciphers used and various
session parameters.
The output is in HTML format so this option will normally be used with a
web browser.
.It Fl Verify Ar depth , Fl verify Ar depth
The verify
.Ar depth
to use.
This specifies the maximum length of the client certificate chain
and makes the server request a certificate from the client.
With the
.Fl Verify
option, the client must supply a certificate or an error occurs.
With the
.Fl verify
option, a certificate is requested but the client does not have to send one.
d5945 2
a5946 3
.It Ar P
Send some plain text down the underlying TCP connection: this should
cause the client to disconnect due to a protocol violation.
d5949 2
a5950 2
.It Ar q
End the current SSL connection, but still accept new connections.
d5953 3
a5955 2
.It Ar r
Renegotiate the SSL session.
d5966 1
a5966 1
can be used, for example.
a6001 19
.Nm openssl s_time
.Bk -words
.Op Fl bugs
.Op Fl nbio
.Op Fl new
.Op Fl reuse
.Op Fl ssl2
.Op Fl ssl3
.Op Fl CAfile Ar file
.Op Fl CApath Ar directory
.Op Fl cert Ar file
.Op Fl cipher Ar cipherlist
.Op Fl connect Ar host : Ns Ar port
.Op Fl key Ar keyfile
.Op Fl time Ar seconds
.Op Fl verify Ar depth
.Op Fl www Ar page
.Ek
.Pp
a6002 105
.Nm s_client
command implements a generic SSL/TLS client which connects to a
remote host using SSL/TLS.
It can request a page from the server and includes
the time to transfer the payload data in its timing measurements.
It measures the number of connections within a given timeframe,
the amount of data transferred
.Pq if any ,
and calculates the average time spent for one connection.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl bugs
There are several known bugs in SSL and TLS implementations.
Adding this option enables various workarounds.
.It Fl CAfile Ar file
A file containing trusted certificates to use during server authentication
and to use when attempting to build the client certificate chain.
.It Fl CApath Ar directory
The directory to use for server certificate verification.
This directory must be in
.Qq hash format ;
see
.Nm verify
for more information.
These are also used when building the client certificate chain.
.It Fl cert Ar file
The certificate to use, if one is requested by the server.
The default is not to use a certificate.
The file is in PEM format.
.It Fl cipher Ar cipherlist
This allows the cipher list sent by the client to be modified.
Although the server determines which cipher suite is used,
it should take the first supported cipher in the list sent by the client.
See the
.Nm ciphers
command for more information.
.It Fl connect Ar host : Ns Ar port
This specifies the host and optional port to connect to.
.It Fl key Ar keyfile
The private key to use.
If not specified, the certificate file will be used.
The file is in PEM format.
.It Fl nbio
Turns on non-blocking I/O.
.It Fl new
Performs the timing test using a new session ID for each connection.
If neither
.Fl new
nor
.Fl reuse
are specified,
they are both on by default and executed in sequence.
.It Fl reuse
Performs the timing test using the same session ID;
this can be used as a test that session caching is working.
If neither
.Fl new
nor
.Fl reuse
are specified,
they are both on by default and executed in sequence.
.It Fl ssl2 | ssl3
These options disable the use of certain SSL or TLS protocols.
By default, the initial handshake uses a method
which should be compatible with all servers and permit them to use
SSL v3, SSL v2, or TLS as appropriate.
The timing program is not as rich in options to turn protocols on and off as
the
.Nm s_client
program and may not connect to all servers.
.Pp
Unfortunately there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.
Some servers only work if TLS is turned off with the
.Fl ssl3
option;
others will only support SSL v2 and may need the
.Fl ssl2
option.
.It Fl time Ar seconds
Specifies how long
.Pq in seconds
.Nm s_time
should establish connections and
optionally transfer payload data from a server.
The default is 30 seconds.
Server and client performance and the link speed
determine how many connections
.Nm s_time
can establish.
.It Fl verify Ar depth
The verify depth to use.
This specifies the maximum length of the server certificate chain
and turns on server certificate verification.
Currently the verify operation continues after errors, so all the problems
with a certificate chain can be seen.
As a side effect,
the connection will never fail due to a server certificate verify failure.
.It Fl www Ar page
This specifies the page to GET from the server.
A value of
.Sq /
gets the index.htm[l] page.
If this parameter is not specified,
d6004 1
a6004 65
will only perform the handshake to establish SSL connections
but not transfer any payload data.
.El
.Sh S_TIME NOTES
.Nm s_client
can be used to measure the performance of an SSL connection.
To connect to an SSL HTTP server and get the default page the command
.Bd -literal -offset indent
$ openssl s_time -connect servername:443 -www / -CApath yourdir \e
	-CAfile yourfile.pem -cipher commoncipher [-ssl3]
.Ed
.Pp
would typically be used
.Pq HTTPS uses port 443 .
.Dq commoncipher
is a cipher to which both client and server can agree;
see the
.Nm ciphers
command for details.
.Pp
If the handshake fails, there are several possible causes:
if it is nothing obvious like no client certificate, the
.Fl bugs , ssl2 ,
and
.Fl ssl3
options can be tried in case it is a buggy server.
In particular you should play with these options
.Em before
submitting a bug report to an OpenSSL mailing list.
.Pp
A frequent problem when attempting to get client certificates working
is that a web client complains it has no certificates or gives an empty
list to choose from.
This is normally because the server is not sending
the clients certificate authority in its
.Qq acceptable CA list
when it requests a certificate.
By using
.Nm s_client ,
the CA list can be viewed and checked.
However some servers only request client authentication
after a specific URL is requested.
To obtain the list in this case, it is necessary to use the
.Fl prexit
option of
.Nm s_client
and send an HTTP request for an appropriate page.
.Pp
If a certificate is specified on the command line using the
.Fl cert
option,
it will not be used unless the server specifically requests
a client certificate.
Therefore merely including a client certificate
on the command line is no guarantee that the certificate works.
.Sh S_TIME BUGS
Because this program does not have all the options of the
.Nm s_client
program to turn protocols on and off,
you may not be able to measure the performance
of all protocols with all servers.
.Pp
The
.Fl verify
option should really exit if the server verification fails.
d6011 5
a6017 1
.Op Fl text
a6018 4
.Op Fl in Ar file
.Op Fl inform Ar DER | PEM
.Op Fl out Ar file
.Op Fl outform Ar DER | PEM
a6031 18
.It Fl cert
If a certificate is present in the session,
it will be output using this option;
if the
.Fl text
option is also present, then it will be printed out in text form.
.It Fl context Ar ID
This option can set the session ID so the output session information uses the
supplied
.Ar ID .
The
.Ar ID
can be any string of characters.
This option won't normally be used.
.It Fl in Ar file
This specifies the input
.Ar file
to read session information from, or standard input by default.
d6036 1
a6036 1
argument uses an ASN1 DER-encoded
d6042 9
a6050 3
format base64-encoded with additional header and footer lines.
.It Fl noout
This option prevents output of the encoded version of the session.
a6055 4
.It Fl outform Ar DER | PEM
This specifies the output format; the options have the same meaning as the
.Fl inform
option.
d6059 16
d6078 11
a6088 11
.Bd -literal
SSL-Session:
    Protocol  : TLSv1
    Cipher    : 0016
    Session-ID: 871E62626C554CE95488823752CBD5F3673A3EF3DCE9C67BD916C809914B40ED
    Session-ID-ctx: 01000000
    Master-Key: A7CEFC571974BE02CAC305269DC59F76EA9F0B180CB6642697A68251F2D2BB57E51DBBB4C7885573192AE9AEE220FACD
    Key-Arg   : None
    Start Time: 948459261
    Timeout   : 300 (sec)
    Verify return code 0 (ok)
d6092 1
a6092 2
.Pp
.Bl -tag -width "Verify return code " -compact
d6094 1
a6094 1
This is the protocol in use: TLSv1, SSLv3, or SSLv2.
d6116 3
a6118 1
The PEM-encoded session format uses the header and footer lines:
d6219 3
a6221 1
Takes an input message and writes out a PEM-encoded PKCS#7 structure.
d6234 1
a6234 1
.Ar PEM
d6236 1
a6236 1
.Ar DER
d6256 1
a6256 1
.Ar PEM
d6258 1
a6258 1
.Ar DER
d6293 1
a6293 1
.It Fl CApath Ar directory
d6364 3
a6366 1
The certificates should be in PEM format.
d6369 1
a6369 1
If a message is being verified, the signer's certificates will be
d6378 1
a6378 1
If this option is not specified, the private key must be included
d6421 1
a6421 1
When signing, many
d6558 1
a6558 1
base64-encoded structure and surrounding it with:
d6648 1
a6648 1
.It Bq Cm zero or more test algorithms
d6706 1
a6706 1
to read from, or standard input if this option is not specified.
d6713 1
a6713 1
to write to, or standard output by default.
d6846 3
a6848 1
should contain multiple certificates in PEM format, concatenated together.
d6897 1
a6897 1
If no certificate files are included, an attempt is made to read
d6899 3
a6901 1
They should all be in PEM format.
d6985 1
a6985 1
If all operations complete successfully, the certificate is considered
d7142 1
a7142 1
If they occur in both, only the certificates in the file will
d7282 1
a7282 1
to read a certificate from, or standard input if this option is not specified.
d7286 1
a7286 1
to write to, or standard output by default.
d7302 2
a7303 2
If not specified, MD5 is used.
If the key being used to sign with is a DSA key,
d7388 1
a7388 1
Prints out the digest of the DER-encoded version of the whole certificate
d7497 1
a7497 1
If the input is a certificate request, a self-signed certificate
d7568 1
a7568 1
If this option is not specified, it is assumed that the CA private key
d7601 1
a7601 1
If not specified, no extensions are added to the certificate.
d7604 1
a7604 1
If this option is not specified, the extensions should either be
d7655 1
a7655 1
.Dq \& ,+"\*(Lt\*(Gt; .
d7682 2
a7683 2
If you are lucky enough to have a UTF8 compatible terminal,
the use of this option (and
d7690 1
a7690 1
If this option is not present, multibyte characters larger than 0xff
d7715 1
a7715 1
if this option is not set, non-character string types will be displayed
d7862 5
a7866 1
Convert a certificate from PEM to DER format:
d7898 3
a7900 1
The PEM format uses the header and footer lines:
d7926 1
a7926 1
option takes the digest of the DER-encoded certificate.
d7957 2
a7958 2
If the CA flag is true, it is a CA;
if the CA flag is false, it is not a CA.
@


