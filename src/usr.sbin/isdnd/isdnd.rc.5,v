head	1.4;
access;
symbols
	tg-mergetmp-mirosx-1:1.4
	tg-mergefixes-1-branch:1.4.0.14
	tg-mergefixes-1-base:1.4
	MIROS_X:1.4.0.12
	MIROS_X_BASE:1.4
	MIRBSD_XP_MIRPPC:1.4.0.10
	MIRBSD_XP_SPARC_BASE:1.4
	MIRBSD_XP_SPARC:1.4.0.8
	MIRBSD_7quater:1.4
	MIRBSD_7_ALPHA:1.4.0.6
	MIRBSD_7:1.4.0.4
	MIRBSD_7ter:1.4
	MIRBSD_7_DEV:1.4.0.2
	MIRBSD_5:1.2
	MIRBSD_4:1.2;
locks; strict;
comment	@.\" @;


1.4
date	2003.10.03.14.58.40;	author tg;	state Stab;
branches;
next	1.3;

1.3
date	2003.09.01.22.33.52;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.04.06.14.13.27;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.25.21.53.20;	author tg;	state Exp;
branches;
next	;


desc
@@


1.4
log
@- Sync isdnd with NetBSD (adds load firmware capability)
- Make ppp portable (ifdefing) again
@
text
@.\" $NetBSD: isdnd.rc.5,v 1.17 2003/09/25 09:37:32 wiz Exp $
.\"
.\" Copyright (c) 1997, 2000 Hellmuth Michaelis. All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	_Id: isdnd.rc.5,v 1.13 2003/02/25 10:36:10 wiz Exp $
.\"
.\" $FreeBSD$
.\"
.\"     last edit-date: [Mon Oct  9 13:12:29 2000]
.\"
.Dd September 25, 2003
.Dt ISDND.RC 5
.Os
.Sh NAME
.Nm isdnd.rc
.Nd isdn4bsd ISDN connection management daemon config file format
.Sh DESCRIPTION
The file
.Pa /etc/isdn/isdnd.rc
contains (if not otherwise specified on the command line) the runtime
configuration for the
.Xr isdnd 8
ISDN connection management daemon which is part of the isdn4bsd package.
.Pp
The configuration file consists of keywords which start in column 1 followed by
one or more spaces or tabs, an equal sign, one or more spaces or tabs
and a keyword dependent parameter value.
.Pp
A line beginning with '#' is treated as a comment line.
.Pp
For keywords requiring the specification of a boolean value, the truth
value can be either
.Em yes
or
.Em on
while the false value can be either
.Em no
or
.Em off .
.Pp
The configuration file consists of one
.Em system
section, one or more optional
.Em controller
sections and one or more
.Em entry
sections.
In the
.Em system
section parameters regarding the daemon operation or parameters
not associated with a single remote connection can be set.
In the
.Em controller
section parameters regarding a particular controller can be set.
In the
.Em entry
section(s) parameters directly associated with a single remote
connection can be set.
.Pp
The following keywords are recognized by
.Nm isdnd :
.Pp
.Bl -tag -width system -compact
.It Li system
This keyword starts the system configuration section.
It must not have a parameter and may be used only once.
The keyword is mandatory.
The following keywords are valid in the system configuration section:
.Bl -tag -width useacctfile -compact
.It Li acctall
If this parameter is set to
.Em on ,
accounting information is written even if the local site was not charged
or no charging information is available or is not subscribed.
(optional)
.It Li acctfile
Specifies the name of the accounting file which is used when the keyword
.Em useacctfile
(see below) is set to
.Em on .
See also system keyword
.Em rotatesuffix .
If this keyword is omitted the system default is used.
(optional)
.It Li aliasing
If this parameter is set to
.Em on ,
alias processing of telephone-number to name is enabled (see also the
.Em aliasfile
keyword below).
The default is off.
(optional)
.It Li aliasfile
Specifies the name of the telephone number-to-name alias database file shared
with the
.Xr isdntel 8
utility when alias processing is enabled via the
.Em aliasing
keyword.
(optional)
.It Li beepconnect
In full-screen mode, if this parameter is set to
.Em on ,
ring the bell when connecting or disconnecting a call.
.It Li extcallattr
If this parameter is set to
.Em on ,
the extended caller attributes "screening indicator" and "presentation
indicator" are written to the log-file.
The default is off.
(optional)
.It Li holidayfile
Specifies the name of the holiday file containing the dates of holidays.
This file is used in conjunction with the
.Em valid
keyword to lookup the dates of holidays.
(optional)
.It Li isdntime
If this parameter is set to
.Em on ,
date/time information from the exchange (if provided) is written to the
log-file.
The default is off.
(optional)
.It Li mailer
This keyword is used to specify the path/name of a mail program which
which is able to use the "-s" flag to specify a subject on its
command line.
In case of a fatal error exit of
.Nm
this program is used to send mail to an administrator specified by
the keyword
.Em mailto .
(optional)
.It Li mailto
This keyword is used to specify the email address of someone to notify
in case of a fatal error exit of
.Nm .
(See also keyword
.Em mailer ) .
(optional)
.It Li monitor-allowed
If this parameter is set to
.Em on
or
.Em yes ,
monitoring via a local or remote machine is enabled.
This parameter is optional and is set to
.Em off
by default.
.It Li monitor-port
sets the TCP port number for remote monitoring.
This integer parameter is optional and is set to port 451 by default.
.It Li monitor
This keyword specifies a local socket name or a host or network for remote
monitoring.
The
.Em monitor
specification may either be:
.Pp
.Bl -tag -width Ds -compact
.It Ar the name of a local (UNIX-domain) socket
this MUST start with a "/", example: /var/run/isdn-monitor
.It Ar a dotted-quad host specification
example: 192.168.1.2
.It Ar a dotted-quad network address with netmask
example: 192.168.1.0/24
.It Ar a resolvable host name
example: localhost
.It Ar a resolvable network name with netmask
example: up-vision-net/24
.El
.It Li monitor-access
This keyword specifies the access rights for a previously used
.Em monitor
keyword.
The supported access rights are:
.Pp
.Bl -tag -width Ds -compact
.It Ar fullcmd
.It Ar restrictedcmd
.It Ar channelstate
.It Ar logevents
.It Ar callin
.It Ar callout
.El
.It Li ratesfile
Specifies the name of the ratesfile.
If this keyword is omitted the system default is used.
(optional)
.It Li regexpr
This keyword is used to specify regular expressions.
It can be specified
more than once up to a compile time dependent value (currently set to 5 by
the MAX_RE definition in the source).
.Pp
All specified regular expressions are compared to the log strings at runtime
and if a match is found, a program is run with the log text as a parameter
(see also the keyword
.Em regprog
below).
.Pp
For an explanation how regular expressions are specified, please have a
look at
.Xr re_format 7
and
.Xr regex 3 .
The
.Em extended
regular expression syntax is supported here.
.Pp
Hint: it might be necessary to properly quote the expression to avoid
improper interpretation by the configuration file parser.
(optional)
.It Li regprog
This keyword is used to specify the name of a program which is run in
case a corresponding regular expression is matched by a logging string.
.Nm Isdnd
expects to find the program below the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
(optional)
.It Li rotatesuffix
Specifies a suffix for renaming the log- and the accounting-filename.
In case
rotatesuffix is used and a USR1 signal is sent to isdnd, the log-file and the
accounting file is not only closed and reopened but the old log-file is also
renamed to the former filename with the rotatesuffix string appended.
If this keyword is omitted, the log-files are just closed and reopened; this
is also the default behavior.
(optional)
.\" .It Li rtprio
.\" Specifies the real-time priority
.\" .Nm isdnd
.\" runs at as an integer value in the range 0...31 with 0 being the highest
.\" priority.
.\" This keyword is optional; if not specified the process priority of
.\" .Nm isdnd
.\" is not touched in any way.
.\" ( See also
.\" .Xr rtprio 1
.\" ).
.\" This keyword is only available if.
.\" Nm
.\" was compiled with -DUSE_RTPRIO.
.\"
.It Li useacctfile
If this parameter is set to
.Em on
charging (if available) and accounting information is written to the
accounting file.
(optional)
.El
.It Li controller
This keyword starts the controller configuration section.
It must not have a parameter and may be used once for every controller.
The keyword is optional.
The following keywords are valid in a controller configuration section:
.Bl -tag -width useacctfile -compact
.It Li firmware
This keyword is used to specify the path of the firmware file that
will be loaded to the card once
.Nm isdnd
is started.
This keyword is useful with active ISDN cards.
.It Li protocol
This keyword is used to set the D-channel protocol for the S0-bus a
controller is connected to.
The following parameters are currently supported:
.Pp
.Bl -tag -width calledback -compact -offset
.It Ar dss1
The DSS1 or so-called "Euro-ISDN" D-channel protocol according to
ITU Recommendations Q.921 and Q.931.
.It Ar d64s
An ISDN leased line with a single B-channel (called D64S in Germany).
.El
.El
.It Li entry
This keyword starts one configuration entry.
It must not have a parameter.
This keyword must be used at least once.
The following keywords are valid in an entry section:
.Bl -tag -width unitlengthsrc -compact
.It Li answerprog
This keyword is used to specify the name of a program which is run in
case an incoming telephone connection specified
.Em answer
in its configuration entry.
The default name is
.Em answer .
.Nm Isdnd
expects to find this program beneath the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
(optional)
.It Li alert
is used to specify a time in seconds to wait before accepting a call.
This
keyword is only usable for incoming telephone calls (dialin-reaction = answer).
It is used to have a chance to accept an incoming call on the phone before
the answering machine starts to run.
The minimum value for the alert parameter
is 5 seconds and the maximum parameter allowed is 180 seconds.
(optional)
.It Li autoupdown
For network interfaces using ISDN as a transport medium it does not make
sense to mark the interfaces UP before running
.Nm isdnd .
Typically these interfaces are configured, but marked down, in the respective
.Pa ifconfig.*
file.
When starting,
.Nm isdnd
recognizes these interfaces (configured with some address, marked down, and
having a matching config entry) and marks them up.
On shutdown,
.Nm isdnd
marks all interfaces changed at startup DOWN again.
.Pp
In rare circumstances you might not want this automatic handling.
In this cases add an
.Em autoupdown=no
line to the config file entry.
.It Li b1protocol
The B channel layer 1 protocol used for this connection.
The keyword is mandatory.
The currently configurable values are:
.Pp
.Bl -tag -width Ds -compact
.It Ar hdlc
HDLC framing.
.It Ar raw
No framing at all (used for telephony).
.El
.It Li budget-calloutperiod
is used to specify a time period in seconds.
Within this period, the number of calls specified by
.Em budget-calloutncalls
are allowed to succeed, any further attempt to call out will be blocked for the rest
of the time left in the time period.
(optional)
.It Li budget-calloutncalls
The number of outgoing calls allowed within the time period specified by
.Em budget-calloutperiod .
(optional)
.It Li budget-calloutsfile
A path/filename to which the number of successful callouts are written.
The contents of the file is preserved when it exists during startup of isdnd.
The format of this file is: start time, last update time, number of calls.
(optional)
.It Li budget-calloutsfile-rotate
If set to
.Em on
rotate budget-calloutsfile every night when an attempt is made to update
the file on a new day.
The statistics for the previous day are written to
a file with the filename specified by budget-calloutsfile to which a hyphen
and the new day's (!) day of month number is appended.
(optional)
.It Li budget-callbackperiod
.It Li budget-callbackncalls
.It Li budget-callbacksfile
.It Li budget-calloutsfile-rotate
See
.Em budget-calloutperiod ,
.Em budget-calloutncalls and
.Em budget-calloutsfile
.Em budget-calloutsfile-rotate
above.
These are used to specify the budgets for calling back a remote site.
.It Li callbackwait
The time in seconds to wait between hanging up the call from a remote site
and calling back the remote site.
(optional)
.It Li calledbackwait
The time in seconds to wait for a remote site calling back the local site
after a call from the local site to the remote site has been made.
(optional)
.It Li connectprog
specifies a program run every time after a connection is established and
address negotiation is complete (i.e.: the connection is usable).
.Nm Isdnd
expects to find the program below the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
The programs specified by connect and disconnect will get the following
command line arguments: -d (device) -f (flag) [ -a (addr) ] where
.Em device
is the name of device, e.g. "ippp0",
.Em flag
will be "up" if connection just got up, or "down" if interface changed to down
state and
.Em addr
the address that got assigned to the interface as a dotted-quad IP address
(optional, only if it can be figured out by isdnd).
(optional)
.It Li dialin-reaction
Used to specify what to do when an incoming connection request is received.
The keyword is mandatory.
The currently supported parameters are:
.Pp
.Bl -tag -width calledback -compact -offset
.It Ar accept
Accept an incoming call.
.It Ar reject
Reject an incoming call.
.It Ar ignore
Ignore an incoming call.
.It Ar answer
Start telephone answering for an incoming voice call.
.It Ar callback
When a remote site calls, hang up and call back the remote site.
.El
.It Li dialout-type
This keyword is used to configure what type of dialout mode is used.
The keyword is mandatory.
The currently supported parameters are:
.Pp
.Bl -tag -width Ds -compact
.It Ar normal
Normal behavior, call the remote site which is supposed to accept the call.
.It Ar calledback
Callback behavior, call the remote side which rejects the call and calls
us back.
.El
.It Li dialrandincr
When dialing or re-dialing and this parameter is set to
.Em on ,
the dial retry time is added with a random value (currently 0...3 seconds)
to minimize the chance of two sites dialing synchronously so each gets a busy
each time it dials because the other side is also dialing.
.It Li dialretries
The number of dialing retries before giving up.
Setting this to
.Em -1
gives an unlimited number of retries! (optional)
.It Li direction
This keyword is used to configure if incoming and outgoing, incoming-only or
outgoing only connections are possible.
The keyword is optional, the default is
.Em inout .
.Pp
The currently supported parameters are:
.Pp
.Bl -tag -width Ds -compact
.It Ar inout
Normal behavior, connection establishment is possible from remote and local.
.It Ar in
Only incoming connections are possible.
.It Ar out
Only outgoing connections are possible.
.El
.It Li disconnectprog
specifies a program run every time after a connection was shut down.
.Nm Isdnd
expects to find the program below the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
(optional)
.It Li downtries
is used to configure the number of unsuccessful tries (= retry cycles!) before
the interface is disabled (for
.Em downtime
seconds).
(see also the keyword
.Em usedown
further up).
This keyword is optional.
.It Li downtime
is used to configure the time in seconds an interface is disabled
after the configured number of
.Em downtries .
(see also the keyword
.Em usedown
further up).
This keyword is optional and is set to 60 seconds by default.
.It Li earlyhangup
A (safety) time in seconds which specifies the time to hang up before an
expected next charging unit will occur.
(optional)
.It Li idle-algorithm-outgoing
The algorithm used to determine when to hang up an outgoing call when the
line becomes idle.
The current algorithms are:
.Pp
.Bl -tag -width calledback -compact -offset
.It Ar fix-unit-size
idle algorithm which assumes fixed sized changing units during the whole call.
.It Ar var-unit-size
idle algorithm which assumes that the charging is time based after the first
units time has expired.
.El
.It Li idletime-outgoing
The time in seconds an outgoing connection must be idle before hanging up.
An idle timeout of zero disables this functionality.
(optional)
.It Li idletime-incoming
The time in seconds an incoming connection must be idle before hanging up.
An idle timeout of zero disables this functionality.
(optional)
.It Li isdncontroller
The ISDN controller number to be used for connections for this entry.
(mandatory)
.It Li isdnchannel
The ISDN controller channel number to be used for connections for this entry.
In case a channel is explicitly selected here, the SETUP message will request
this channel but mark the request as
.Em preferred
(the indicated channel is preferred) instead of exclusive (only the indicated
channel is acceptable).
Thus the exchange is still free to select another
than the requested channel!
(mandatory)
.It Li isdntxdel-incoming
How long to delay the transmission of the first packet after a
successful connection is made for
.Em incoming
ISDN connections.
The specification unit is 1/100 second.
A zero (0) disables this feature and is the default value.
This feature is implemented (and makes
sense only) for the
.Xr irip 4
IP over raw HDLC ISDN driver.
(optional)
.It Li isdntxdel-outgoing
How long to delay the transmission of the first packet after a
successful connection is made for
.Em outgoing
ISDN connections.
The specification unit is 1/100 second.
A zero (0) disables this feature and is the default value.
This feature is implemented (and makes sense only) for the
.Xr irip 4
IP over raw HDLC ISDN driver.
(optional)
.It Li local-phone-dialout
The local telephone number used when the local site dials out.
When dialing
out to a remote site, the number specified here is put into the
.Em "Calling Party Number Information Element" .
.Pp
This keyword is mandatory for the
.Em irip
user-land interfaces.
.It Li local-phone-incoming
The local telephone number used for verifying the destination of incoming
calls.
When a remote site dials in, this number is used to verify that it
is the local site which the remote site wants to connect to.
It is compared
with the
.Em "Called Party Number Information Element"
got from the telephone exchange.
.Pp
This keyword is mandatory for the
.Em irip
interfaces.
.It Li name
Defines a symbolic name for this configuration entry.
Its purpose is to
use this name in the full-screen display for easy identification of a link
to a remote site and for accounting purposes.
(mandatory)
.It Li ppp-auth-paranoid
If set to
.Em no ,
the remote site is not required to prove its authenticity for connections
that are initiated by the local site.
The default is
.Em yes
and requires the remote site to always authenticate.
.Pp
This keyword is only used if
.Em ppp-send-auth
has been set to pap or chap for an
.Em ippp
PPP interface.
(optional)
.It Li ppp-auth-rechallenge
Set to
.Em no ,
if the other side does not support re-challenging for chap.
The default is
.Em yes ,
which causes verification of the remote site's authenticity once in a while.
.Pp
This keyword is only used if
.Em ppp-expect-auth
has been set to chap for an
.Em ippp
PPP interface.
(optional)
.It Li ppp-expect-auth
The local site expects the authenticity of the remote site to be proved by
the specified method.
The supported methods are:
.Pp
.Bl -tag -width Ds -compact
.It Ar none
Do not require the other side to authenticate.
Typical uses are dial-out to an ISP
(many ISPs do not authenticate themselves to clients)
or offering anonymous dial-in at the local site.
.It Ar chap
The preferred authentication method, which does not require a password to be sent
in the clear.
.It Ar pap
The unprotected authentication method, which allows anybody watching the wire
to grab name and password.
.El
.Pp
If
.Em ppp-auth-paranoid
is set to
.Em no
(the default is
.Em yes )
outgoing connections will not require the remote site to authenticate itself.
.Pp
This keyword is only used for the
.Em ippp
PPP interfaces.
(optional)
.It Li ppp-expect-name
The name that has to be provided by the remote site to prove its authenticity.
.Pp
This keyword is only used if
.Em ppp-expect-auth
has been set to pap or chap for an
.Em ippp
PPP interface.
(optional)
.It Li ppp-expect-password
The secret that has to be provided by the remote site to prove its authenticity.
.Pp
This keyword is only used if
.Em ppp-expect-auth
has been set to pap or chap for an
.Em ippp
PPP interface.
(optional)
.It Li ppp-send-auth
The authentication method required by the remote site.
The currently supported parameters are:
.Pp
.Bl -tag -width Ds -compact
.It Ar none
The remote site does not expect or support authentication.
.It Ar chap
The preferred authentication method, which does not require a password to be sent
in the clear.
.It Ar pap
The unprotected authentication method, which allows anybody watching the wire
to grab name and password.
.El
.Pp
This keyword is only used for the
.Em ippp
PPP interfaces.
(optional)
.It Li ppp-send-name
The authentication name sent to the remote site.
.Pp
This keyword is only used if
.Em ppp-send-auth
has been set to pap or chap for an
.Em ippp
PPP interface.
(optional)
.It Li ppp-send-password
The secret used to prove the local site's authenticity to the remote site.
.Pp
This keyword is only used if
.Em ppp-send-auth
has been set to pap or chap for an
.Em ippp
PPP interface.
(optional)
.It Li ratetype
The rate entry used from the rates file.
(optional)
.br
For example, ratetype=0 selects lines beginning "ra0" in /etc/isdn/isdnd.rates;
(typically ra0 lines are a set of tables for local call rates on different
days of the week \*[Am] times per day).
.It Li recoverytime
The time in seconds to wait between dial retries.
(optional)
.It Li remdial-handling
is used to specify the dialout behavior in case more than one outgoing
number is specified.
The currently supported parameters are:
.Pp
.Bl -tag -width Ds -compact
.It Ar first
For every new (non-retry) call setup, start with the first number.
.It Ar last
For every new (non-retry) call setup, start with the last number with
which a successful connection was made.
.It Ar next
For every new (non-retry) call setup, start with the next number which
follows the last one used.
.El
.It Li remote-phone-dialout
The remote telephone number used when the local site dials out.
When dialing
out to a remote site, the number specified here is put into the
.Em "Called Party Number Information Element" .
.Pp
This keyword is mandatory for the
.Em irip
interfaces.
It may be specified more than once to try to dial to several
numbers until one succeeds.
.It Li remote-phone-incoming
The remote telephone number used to verify an incoming call.
When a remote site
dials in, this number is used to verify that it is the correct remote site
which is herewith authorized to connect into the local system.
This parameter
is compared against the
.Em "Calling Party Number Information Element"
got from the telephone exchange.
.Pp
This keyword is mandatory for the irip interfaces.
.Pp
This keyword may have a wildcard parameter '*' to permit anyone dialing in.
.It Li unitlength
The length of a charging unit in seconds.
This is used in conjunction with
the idletime to decide when to hang up a connection.
(optional)
.It Li unitlengthsrc
This keyword is used to specify from which source
.Xr isdnd 8
takes the unitlength for short-hold mode.
The currently configurable values are:
.Pp
.Bl -tag -width Ds -compact
.It Ar none
Then unitlength is not specified anywhere.
.It Ar cmdl
Use the unitlength specified on the command line.
.It Ar conf
Use the unitlength specified in the configuration file with the keyword
.Em unitlength .
.It Ar rate
Use the unitlength from the ratesfile specified in the configuration
file with the keyword
.Em ratetype .
.It Ar aocd
Use a dynamically calculated unitlength in case AOCD is subscribed on
the ISDN line.
(AOCD is an acronym for ``Advice Of Charge During the call''
which is a service provided by the telecommunications (ie phone) provider,
to indicate billable units).
.El
.It Li usrdevicename
Specifies the user-land interface which is used for interfacing ISDN B channel
data to the user-land.
The keyword is mandatory.
This keyword accepts the following parameters:
.Pp
.Bl -tag -width Ds -compact
.It Ar irip
This parameter configures a raw HDLC IP over ISDN interface.
.It Ar ippp
This parameter configures a synchronous PPP over ISDN interface.
.It Ar rbch
This specifies a Raw B Channel access interface.
.It Ar isdntel
ISDN telephony.
.It Ar ing
configures a ISDN B-channel to NetGraph interface.
.El
.It Li usrdeviceunit
Specifies the unit number for the device which is specified with
usrdevicename.
.It Li usedown
is used to enable the use of the keywords
.Em downtries
and
.Em downtime
in the entries section(s).
It is used in the
.Nm isdnd
daemon to dynamically enable and disable the IP interfaces to avoid excessive
dialing activities in case of transient failures (such as busy lines).
This parameter is optional and is set to
.Em off
by default.
.It Li valid
.Em Note :
this feature is considered experimental!
The parameter to this keyword is a string specifying a time range within
which this entry is valid.
The time specification consists of a list of weekdays and/or a holiday
indicator ( see also the
.Em holidayfile
keyword in the system section ) separated by commas followed by an optional
daytime range specification in the form hh:mm-hh:mm.
The weekdays are specified as numbers from 0 to 6 and the number 7 for
holidays:
.Pp
.Bl -tag -width Ds -compact
.It Ar 0
Sunday
.It Ar 1
Monday
.It Ar 2
Tuesday
.It Ar 3
Wednesday
.It Ar 4
Thursday
.It Ar 5
Friday
.It Ar 6
Saturday
.It Ar 7
a Holiday
.El
.Pp
The following examples describe the "T-ISDN xxl" tariff of the german Telekom:
.Bl -tag -width Ds -compact
.It Ar 1,2,3,4,5,6,09:00-18:00
Monday through Saturday, daytime 9:00 to 18:00
.It Ar 1,2,3,4,5,6,18:00-9:00
Monday through Saturday, nighttime 18:00 to 9:00
.It Ar 0,7
Sunday and on holidays, all 24 hours
.El
.Pp
The use of this keyword is optional.
.El
.El
.Sh IDLETIME CALCULATION AND SHORT-HOLD MODE
.Bl -tag -width indent -compact
.It Li incoming calls
It is assumed that the calling side knows most about charging structures and
such and as a consequence only the keyword
.Em idletime-incoming
has a function for incoming calls.
.Pp
For incoming calls the line is constantly monitored, and in case there was
not traffic taking place for the time in seconds specified by
.Em idletime-incoming
the call is closed.
.Pp
Typically,
.Em idletime-incoming
is used as a last resort and is therefore set much higher than a charging
unit time: typical values are one to five minutes.
.It Li outgoing calls
Outgoing call disconnect time can be set up in one of three ways:
.Bl -tag -width indent -compact
.It Li simple mode
For simple mode, the
.Em idle-algorithm-outgoing
must be
.Em fix-unit-size
and the selected
.Em unitlength
must be 0 (zero) and
.Em idletime-outgoing
greater zero.
.Pp
The outgoing traffic is constantly monitored, and in case there was
not traffic taking place for the time in seconds specified by
.Em idletime-outgoing
the call is closed.
.Pp
Typical values in simple mode are 10 to 30 seconds.
.It Li shorthold mode for fixed unit charging
For shorthold mode, the
.Em idle-algorithm-outgoing
 must be
.Em fix-unit-size
 and the selected
.Em unitlength
and
.Em idletime-outgoing
must be greater than 0 (zero);
.Em earlyhangup
must be \*[Ge] 0 (zero).
.Bd -literal
|\*[Lt]unchecked-window\*[Gt]|\*[Lt]checkwindow\*[Gt]|\*[Lt]safetywindow\*[Gt]|
|                  |             |              |
+------------------+-------------+--------------+
|                  |             |              |
|                  |\*[Lt]-idle-time-\*[Gt]|\*[Lt]earlyhangup-\*[Gt]|
|\*[Lt]--------------unitlength---------------------\*[Gt]|
.Ed
.Pp
During the unchecked window which is (unitlength - (idle-time+earlyhangup))
in length, no idle check is done.
After the unchecked window has ended,
the line is checked for idle-time length if no traffic takes place.
In case
there was traffic detected in the check-window, the same procedure is restarted
at the beginning of the next unit.
In case no traffic was detected during
the check-window, the line is closed at the end of the check window.
.Pp
Notice:
.Em unitlength
must (!) be greater than the sum of
.Em idletime-outgoing
and
.Em earlyhangup !
.It Li shorthold mode for variable unit charging
For shorthold mode, the
.Em idle-algorithm-outgoing
must be
.Em var-unit-size
and the selected
.Em unitlength
and
.Em idletime-outgoing
must be greater than 0 (zero);
.Pp
This shorthold mode is suitable when your calls are billed on
the elapse time of the call plus a fixed connection charge.
For example British Telecom bill this way.
.Pp
Each call is divided into two periods, the first is the
.Em unchecked
period and the second is the
.Em checked .
The
.Em checked
period starts 1 second before the first units time expires.
.Pp
During the
.Em checked
period if there is no traffic for
.Em idle-time
seconds the call is disconnected.
.Pp
.Bd -literal
|\*[Lt]---unchecked------------------\*[Gt]|\*[Lt]------checked------\*[Gt]
+------------------+-------------+
|                  |\*[Lt]-idle-time-\*[Gt]|
|\*[Lt]--------------unitlength-------\*[Gt]|
.Ed
.Pp
Experience shows that useful values for idle-time are from 15 to 30 seconds.
.Pp
If idle-time is too short an application that is not yet finished with the
network will cause a new call to be placed.
.Pp
.El
.El
.Sh FILES
.Bl -tag -width /etc/isdn/isdnd.rc -compact
.It Pa /etc/isdn/isdnd.rc
The default configuration file for the
.Nm isdnd
ISDN daemon.
.El
.Sh SEE ALSO
.Xr regex 3 ,
.Xr re_format 7 ,
.Xr isdnd 8 ,
.Xr isdnmonitor 8
.Sh AUTHORS
The
.Xr isdnd 8
daemon and this manual page were written by
.An Hellmuth Michaelis Aq hm@@kts.org .
.Pp
Additions to this manual page by
.An Barry Scott Aq barry@@scottb.demon.co.uk .
@


1.3
log
@updates from NetBSD
@
text
@d1 1
a1 1
.\" $NetBSD: isdnd.rc.5,v 1.15 2003/05/14 12:12:31 wiz Exp $
d32 1
a32 1
.Dd October 9, 2000
d86 3
a88 2
This keyword starts the system configuration section. It must not
have a parameter and may be used only once. The keyword is mandatory.
d95 2
a96 1
or no charging information is available or is not subscribed. (optional)
d104 2
a105 1
If this keyword is omitted the system default is used. (optional)
d111 3
a113 1
keyword below). The default is off. (optional)
d120 2
a121 1
keyword. (optional)
d131 2
a132 1
The default is off. (optional)
d137 2
a138 1
keyword to lookup the dates of holidays. (optional)
d143 3
a145 1
log-file. The default is off. (optional)
d149 2
a150 1
command line. In case of a fatal error exit of
d177 2
a178 1
monitoring. The
d197 2
a198 1
keyword. The supported access rights are:
d209 3
a211 2
Specifies the name of the ratesfile. If this keyword is omitted the system
default is used. (optional)
d213 2
a214 1
This keyword is used to specify regular expressions. It can be specified
d245 2
a246 1
Specifies a suffix for renaming the log- and the accounting-filename. In case
d251 2
a252 1
is also the default behavior. (optional)
d257 2
a258 1
.\" priority. This keyword is optional; if not specified the process priority of
d272 2
a273 1
accounting file. (optional)
d276 4
a279 4
This keyword starts the controller configuration section. It must not
have a parameter and may be used once for every controller. The keyword
is optional. The following keywords are valid in a controller
configuration section:
d281 6
d289 2
a290 2
controller is connected to. The following parameters are currently
supported:
d301 2
a302 1
This keyword starts one configuration entry. It must not have a parameter.
d310 2
a311 1
in its configuration entry. The default name is
d319 2
a320 1
is used to specify a time in seconds to wait before accepting a call. This
d323 2
a324 1
the answering machine starts to run. The minimum value for the alert parameter
d333 2
a334 1
file.  When starting,
d337 2
a338 1
having a matching config entry) and marks them up. On shutdown,
d347 2
a348 1
The B channel layer 1 protocol used for this connection. The keyword is mandatory.
d358 2
a359 2
is used to specify a time period in seconds. Within this period, the number of calls
specified by
d362 2
a363 1
of the time left in the time period. (optional)
d377 2
a378 1
the file on a new day. The statistics for the previous day are written to
d380 2
a381 1
and the new day's (!) day of month number is appended. (optional)
d391 2
a392 1
above. These are used to specify the budgets for calling back a remote site.
d395 2
a396 1
and calling back the remote site. (optional)
d399 2
a400 1
after a call from the local site to the remote site has been made. (optional)
d417 2
a418 1
(optional, only if it can be figured out by isdnd). (optional)
d489 2
a490 1
further up). This keyword is optional.
d501 2
a502 1
expected next charging unit will occur. (optional)
d505 2
a506 1
line becomes idle. The current algorithms are:
d532 2
a533 1
channel is acceptable). Thus the exchange is still free to select another
d540 4
a543 2
ISDN connections. The specification unit is 1/100 second. A zero (0) disables
this feature and is the default value. This feature is implemented (and makes
d546 2
a547 1
IP over raw HDLC ISDN driver. (optional)
d552 4
a555 3
ISDN connections. The specification unit is 1/100 second. A zero (0) disables
this feature and is the default value. This feature is implemented (and makes
sense only) for the
d557 2
a558 1
IP over raw HDLC ISDN driver. (optional)
d560 2
a561 1
The local telephone number used when the local site dials out. When dialing
d570 4
a573 2
calls. When a remote site dials in, this number is used to verify that it
is the local site which the remote site wants to connect to. It is compared
d582 2
a583 1
Defines a symbolic name for this configuration entry. Its purpose is to
d585 2
a586 1
to a remote site and for accounting purposes. (mandatory)
d623 2
a624 1
Do not require the other side to authenticate. Typical uses are dial-out to an ISP
d703 2
a704 1
The rate entry used from the rates file. (optional)
d710 2
a711 1
The time in seconds to wait between dial retries. (optional)
d728 2
a729 1
The remote telephone number used when the local site dials out. When dialing
d735 2
a736 1
interfaces. It may be specified more than once to try to dial to several
d739 2
a740 1
The remote telephone number used to verify an incoming call. When a remote site
d742 2
a743 1
which is herewith authorized to connect into the local system. This parameter
d752 4
a755 2
The length of a charging unit in seconds. This is used in conjunction with
the idletime to decide when to hang up a connection. (optional)
d759 2
a760 1
takes the unitlength for short-hold mode. The currently configurable values are:
d776 2
a777 1
the ISDN line. (AOCD is an acronym for ``Advice Of Charge During the call''
d783 2
a784 1
data to the user-land. The keyword is mandatory.
d807 2
a808 1
in the entries section(s). It is used in the
d919 4
a922 2
in length, no idle check is done. After the unchecked window has ended,
the line is checked for idle-time length if no traffic takes place. In case
d924 2
a925 1
at the beginning of the next unit. In case no traffic was detected during
@


1.2
log
@pull in the remaining ISDN man pages and the daemon from NetBSD,
replacing the postcard-ware ones

I still think it's okay to send Hellmuth a postcard, though.
@
text
@d1 1
a1 1
.\" $NetBSD: isdnd.rc.5,v 1.13 2003/02/25 10:36:10 wiz Exp $
d373 1
a373 1
is the name of device, e.g. "isp0",
d517 1
a517 1
.Em ipr
d528 1
a528 1
.Em ipr
d546 1
a546 1
.Em isp
d560 1
a560 1
.Em isp
d590 1
a590 1
.Em isp
d599 1
a599 1
.Em isp
d608 1
a608 1
.Em isp
d627 1
a627 1
.Em isp
d636 1
a636 1
.Em isp
d645 1
a645 1
.Em isp
d677 1
a677 1
.Em ipr
d688 1
a688 1
This keyword is mandatory for the ipr interfaces.
d812 1
a812 1
Outgoing call disconnect time can be setup in one of three ways:
@


1.1
log
@Import ISDN (i4b) into MirBSD
Done:
 - kernel support
 - (commented out) entries in GENERIC
 - MAKEDEV file with licence issues
 - isdnd

Not done:
 - testing
 - configuration files

Not planned:
 - more stuff from i4b (voicemail, fax, etc)
@
text
@d1 3
a3 2
.\" $MirBSD$
.\" Copyright (c) 1997, 1999 Hellmuth Michaelis. All rights reserved.
d26 3
a28 1
.\"	_Id: isdnd.rc.5,v 1.39 1999/12/07 10:56:04 hm Exp $ 
d30 1
a30 1
.\"     last edit-date: [Tue Dec  7 11:52:40 1999]
d32 3
a34 2
.Dd October 11, 1999
.Dt isdnd.rc 5
d42 1
a42 1
configuration for the 
d71 1
a71 1
section parameters regarding the daemon operation or parameters 
a84 1

d86 1
a86 1
This keyword starts the system configuration section. It must not 
a89 1

a94 1

d98 1
a98 1
(see below) is set to 
a102 1

a108 1

d111 2
a112 2
with the 
.Xr isdntel 1
a115 1

d117 1
a117 1
In fullscreen mode, if this parameter is set to
d120 11
a130 1

d135 1
a135 2
logfile. The default is off. (optional)

d138 1
a138 1
which is able to use the "-s" flag to specify a subject on its 
a144 1

d150 1
a150 2
.Em mailer
).
a151 1

d154 2
a155 2
.Em on 
or 
a160 1

a163 1

d166 2
a167 2
monitoring. The 
.Em monitor 
d170 1
a170 1
.Bl -tag -width Ds -compact -offset
a181 1

d183 1
a183 1
This keyword specifies the access rights for a previously used 
d187 1
a187 1
.Bl -tag -width Ds -compact -offset
a194 1

a197 1

a220 1

a228 1

d230 3
a232 3
Specifies a suffix for renaming the log- and the accountingfilename. In case
rotatesuffix is used and a USR1 signal is sent to isdnd, the logfile and the
accounting file is not only closed and reopened but the old logfile is also
d234 16
a249 17
If this keyword is omitted, the logfiles are just closed and reopened; this
is also the default behaviour. (optional)

.It Li rtprio
Specifies the realtime priority 
.Nm isdnd
runs at as an integer value in the range 0...31 with 0 being the highest
priority. This keyword is optional; if not specified the process priority of 
.Nm isdnd
is not touched in any way.
( See also
.Xr rtprio 1 
).
This keyword is only available if
.Nm
was compiled with -DUSE_RTPRIO.

a254 1

a255 1

d257 1
a257 1
This keyword starts the controller configuration section. It must not 
d259 1
a259 1
is optional. The following keywords are valid in a controller 
a261 1

d263 1
a263 1
This keyword is used to set the D-channel protocol for the S0-bus a 
a274 1

a279 1

a290 1

d298 17
a314 1

d319 1
a319 1
.Bl -tag -width Ds -compact -offset
d325 32
a356 1

a359 1

d363 17
a379 1

d395 1
a395 1
When a remote site calls, hangup and call back the remote site.
a396 1

d402 1
a402 1
.Bl -tag -width Ds -compact -offset
a408 1

a414 1

d416 4
a419 2
The number of dialing retries before giving up. (optional)

a424 1

d428 1
a428 1
.Bl -tag -width Ds -compact -offset
d436 7
a442 1

a450 1

d452 2
a453 2
is used to configure the time in seconds an interface is disabled 
after the configured number of 
a458 1

d460 1
a460 1
A (safety) time in seconds which specifies the time to hangup before an
a461 1

a464 1

a472 1

a476 1

a480 1

a483 1

d490 1
a490 1
channel is acceptable). Thus the exchange is still free to select another 
a492 1

d494 2
a495 4
A delay value suitable for the
.Em timeout()
kernel subroutine to delay the transmittion of the first packet after a
successfull connection is made by this value for 
d498 1
a498 1
this feature and is the default value. This feature is implemented (and makes 
d500 1
a500 1
.Xr i4bipr 4
a501 1

d503 2
a504 4
A delay value suitable for the
.Em timeout()
kernel subroutine to delay the transmittion of the first packet after a
successfull connection is made by this value for 
d506 1
a506 1
ISDN connections. The specification unit is 1/100 second. A zero (0) disables   
d509 1
a509 1
.Xr i4bipr 4
a510 1

d516 3
a518 4
This keyword is mandatory for the 
.Em ipr 
userland interfaces.

d521 1
a521 1
calls. When a remote site dials in, this number is used to verify that it 
d527 3
a529 2
This keyword is mandatory for the ipr interfaces.

d531 1
a531 1
Defines a symbolic name for this configuration entry. It's purpose is to
d534 114
a647 1

d653 1
a653 2
days of the week & times per day).

a655 1

d657 1
a657 1
is used to specify the dialout behavior in case more than one outgoing 
d661 1
a661 1
.Bl -tag -width Ds -compact -offset
a670 1

a679 1

d684 1
a684 1
is compared against the 
a690 1

d693 1
a693 2
the idletime to decide when to hangup a connection. (optional)

d697 1
a697 1
takes the unitlength for shorthold mode. The currently configurable values are:
d699 1
a699 1
.Bl -tag -width Ds -compact -offset
d701 1
a701 1
Then unitlength is not specified anywhere. 
d703 1
a703 1
Use the unitlength specified on the commandline.
a716 1

d718 2
a719 2
Specifies the userland interface which is used for interfacing ISDN B channel
data to the userland. The keyword is mandatory.
d722 2
a723 2
.Bl -tag -width Ds -compact -offset
.It Ar ipr
d725 1
a725 1
.It Ar isp
d728 2
a729 2
This specifies a Raw B CHannel access interface.
.It Ar tel
d731 2
a733 1

a736 1

d749 43
a791 27

.It Li connectprog
specifies a program run everytime after a connection is established and
address negotiation is complete (i.e.: the connection is useable).
.Nm Isdnd
expects to find the program below the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
The programs specified by connect and disconnect will get the following
command line arguments: -d (device) -f (flag) [ -a (addr) ] where 
.Em device
is the name of device, e.g. "isp0", 
.Em flag
will be "up" if connection just got up, or "down" if interface changed to down 
state and
.Em addr
the address that got assigned to the interface as a dotted-quad ip address
(optional, only if it can be figured out by isdnd). (optional)

.It Li disconnectprog
specifies a program run everytime after a connection was shut down.
.Nm Isdnd
expects to find the program below the path
.Pa /etc/isdn
which is prepended to the string specified as a parameter to this keyword.
(optional)

d794 2
a795 3

.Sh IDLETIME CALCULATION AND SHORTHOLD MODE
.Bl -tag -width incoming calls -compact
a810 1

d813 1
a813 2

.Bl -tag -width shorthold mode -compact
d815 1
a815 1
For simple mode, the 
d823 1
a823 1
greater zero. 
a830 1

d832 1
a832 1
For shorthold mode, the 
d837 2
a838 2
.Em unitlength 
and 
d841 2
a842 2
.Em earlyhangup must be >= 0 (zero).

d844 1
a844 2

|<unchecked-window>|<checkwindow>|<safetywindow>|
d848 2
a849 3
|                  |<-idle-time->|<earlyhangup->|
|<--------------unitlength--------------------->|

d851 1
a851 1

d859 1
a859 1
Notice: 
a864 1

d866 1
a866 1
For shorthold mode, the 
d871 1
a871 1
.Em unitlength 
a875 1

a879 1

d883 2
a884 2
.Em checked
. The
a893 1

d895 1
a895 2

|<---unchecked------------------>|<------checked------>
d897 2
a898 3
|                  |<-idle-time->|
|<--------------unitlength------->|

d900 1
a900 1

a907 3

.Pp

a914 1

d916 3
a918 1
.Xr isdnd 8
d920 2
a921 5
.Xr regex 3
.Xr re_format 7

.Sh AUTHOR
The 
d923 2
a924 2
daemon and this manual page were written by Hellmuth Michaelis. 
He can be reached at hm@@kts.org.
d926 2
a927 1
Additions to this manual page by Barry Scott (barry@@scottb.demon.co.uk).
@

