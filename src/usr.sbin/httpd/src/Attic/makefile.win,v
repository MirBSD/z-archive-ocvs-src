head	1.2;
access;
symbols
	aphttpd-1_3_33:1.1.8.3
	tg-mergetmp-1:1.1.1.1
	aphttpd-1_3_31:1.1.8.3
	ASF:1.1.8
	apache-1_3_29:1.1.8.2
	apache-1_3_28:1.1.8.1
	apache:1.1.8
	cvs-200308171200:1.1.1.1
	ctm-3496:1.1.1.1
	ctm-3449:1.1.1.1
	ctm-3437:1.1.1.1
	cvs-200307191805:1.1.1.1
	ctm-3425:1.1.1.1
	cvs-200307091500:1.1.1.1
	ctm-3389:1.1.1.1
	cvs-200306291430:1.1.1.1
	ctm-3341:1.1.1.1
	MIRBSD_5:1.1.1.1
	cvs-200306082100:1.1.1.1
	ctm-3316:1.1.1.1
	ctm-3272:1.1.1.1
	ctm-3264:1.1.1.1
	cvs-200305071630:1.1.1.1
	MIRBSD_4:1.1.1.1
	ctm-3203:1.1.1.1
	cvs-20030410-1130:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2003.07.19.16.11.26;	author tg;	state dead;
branches;
next	1.1;

1.1
date	2003.03.22.17.55.23;	author tg;	state Exp;
branches
	1.1.1.1
	1.1.8.1;
next	;

1.1.1.1
date	2003.03.22.17.55.23;	author tg;	state Exp;
branches;
next	;

1.1.8.1
date	2003.10.29.14.04.50;	author tg;	state Exp;
branches;
next	1.1.8.2;

1.1.8.2
date	2003.10.29.14.28.22;	author tg;	state Exp;
branches;
next	1.1.8.3;

1.1.8.3
date	2004.07.15.17.04.18;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@o Update to Apache 1.3.28
o Retain OpenBSD changes
o Retain IPv6 changes
o Retain local (MirBSD) changes
o Remove some unused files
  o SSL stuff is in src/etc/ssl.certs.shar
  o SSL demonstration stuff is not needed
  o Windows®, Novell® Netware®, OS/2®, Cygwin, etc.
@
text
@# Makefile for Windows NT and Windows 95/98/2000

# Targets are:
#   _apacher   - build Apache in Release mode
#   _apached   - build Apache in Debug mode
#   installr   - build and install a Release build
#   installd   - build and install a Debug build
#   clean      - remove (most) generated files
#   _cleanr    - remove (most) files generated by a Release build
#   _cleand    - remove (most) files generated by a Debug build
#
# The default installation directory is \Apache. This can be changed
# with the INSTDIR macro, for example:
#
#   nmake /f Makefile.win INSTDIR="d:\Program Files\Apache" installr
#
# Note: this does *NOT* change the compiled in default "server root"
# Also be aware that certain awk's will not accept backslahed names,
# so the server root should be given in forward slashes (quoted),
# preferably with the drive designation!

!IF "$(INSTDIR)" == ""
INSTDIR=\Apache
!MESSAGE Using default install directory \Apache
!ENDIF 

!IF "$(MAKE)" == "NMAKE"
# Microsoft NMake options
MAKEOPT=-nologo
!ELSEIF "$(MAKE)" == "make"
# Borland make options 
# Borland build of Apache is highly experimental and unsupported.
MAKEOPT=-s -N
!ELSE
!MESSAGE Warning: unrecognized build command "$(MAKE)"
!ENDIF

default:        _apacher

_apacher: 
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=R LONG=Release _build

_apached: 
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=D LONG=Debug   _build

installr: 
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=R LONG=Release _build _install

installd: 
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=D LONG=Debug   _build _install

_cleanr:  
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=R LONG=Release CTARGET=CLEAN _build

_cleand:  
	$(MAKE) $(MAKEOPT) -f Makefile.win SHORT=D LONG=Debug   CTARGET=CLEAN _build

clean:	_cleanr _cleand


_build:
#	echo LONG $(LONG) SHORT $(SHORT) x
	cd os\win32
	 $(MAKE) $(MAKEOPT) -f ApacheOS.mak CFG="ApacheOS - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f Win9xConHook.mak CFG="Win9xConHook - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..\..
	cd regex
	 $(MAKE) $(MAKEOPT) -f regex.mak CFG="regex - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..
	cd ap
	 $(MAKE) $(MAKEOPT) -f ap.mak CFG="ap - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..
	cd support
	 $(MAKE) $(MAKEOPT) -f htpasswd.mak CFG="htpasswd - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f htdigest.mak CFG="htdigest - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f logresolve.mak CFG="logresolve - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f rotatelogs.mak CFG="rotatelogs - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..
	cd lib\expat-lite
	 $(MAKE) $(MAKEOPT) -f xmltok.mak CFG="xmltok - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f xmlparse.mak CFG="xmlparse - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..\..
	cd lib\sdbm
	 $(MAKE) $(MAKEOPT) -f sdbm.mak CFG="sdbm - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..\..
	cd main
	 $(MAKE) $(MAKEOPT) -f gen_uri_delims.mak CFG="gen_uri_delims - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f gen_test_char.mak CFG="gen_test_char - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..
	 -del $(LONG)\buildmark.obj
	 $(MAKE) $(MAKEOPT) -f ApacheCore.mak CFG="ApacheCore - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f Apache.mak CFG="Apache - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd os\win32
	 $(MAKE) $(MAKEOPT) -f mod_status.mak CFG="mod_status - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_info.mak CFG="mod_info - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_auth_anon.mak CFG="mod_auth_anon - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_digest.mak CFG="mod_digest - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_cern_meta.mak CFG="mod_cern_meta - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_expires.mak CFG="mod_expires - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_headers.mak CFG="mod_headers - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_speling.mak CFG="mod_speling - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_usertrack.mak CFG="mod_usertrack - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_rewrite.mak CFG="mod_rewrite - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_auth_digest.mak CFG="mod_auth_digest - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_auth_dbm.mak CFG="mod_auth_dbm - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_proxy.mak CFG="mod_proxy - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_unique_id.mak CFG="mod_unique_id - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_vhost_alias.mak CFG="mod_vhost_alias - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	 $(MAKE) $(MAKEOPT) -f mod_mime_magic.mak CFG="mod_mime_magic - Win32 $(LONG)" RECURSE=0 $(CTARGET)
	cd ..\..

_install:
	-mkdir "$(INSTDIR)"
	-mkdir "$(INSTDIR)\bin"
	-mkdir "$(INSTDIR)\cgi-bin"
	-mkdir "$(INSTDIR)\conf"
        -mkdir "$(INSTDIR)\htdocs"
        -mkdir "$(INSTDIR)\icons"
        -mkdir "$(INSTDIR)\include"
        -mkdir "$(INSTDIR)\include\regex"
        -mkdir "$(INSTDIR)\include\sdbm"
        -mkdir "$(INSTDIR)\include\xml"
	-mkdir "$(INSTDIR)\lib"
	-mkdir "$(INSTDIR)\libexec"
	-mkdir "$(INSTDIR)\logs"
	-mkdir "$(INSTDIR)\modules"
	-mkdir "$(INSTDIR)\proxy"
	copy $(LONG)\Apache.exe "$(INSTDIR)"
	copy $(LONG)\ApacheCore.dll "$(INSTDIR)"
	copy os\win32\$(LONG)\Win9xConHook.dll "$(INSTDIR)"
	copy lib\expat-lite\$(LONG)\xmltok.dll "$(INSTDIR)"
	copy lib\expat-lite\$(LONG)\xmlparse.dll "$(INSTDIR)"
	copy os\win32\$(LONG)\mod_status.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_info.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_anon.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_digest.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_cern_meta.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_expires.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_headers.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_rewrite.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_speling.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_usertrack.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_digest.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_dbm.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_proxy.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_unique_id.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_vhost_alias.so "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_mime_magic.so "$(INSTDIR)\modules"
	copy support\$(LONG)\htpasswd.exe "$(INSTDIR)\bin"
	copy support\$(LONG)\htdigest.exe "$(INSTDIR)\bin"
	copy support\$(LONG)\logresolve.exe "$(INSTDIR)\bin"
	copy support\$(LONG)\rotatelogs.exe "$(INSTDIR)\bin"
	copy ..\cgi-bin\printenv "$(INSTDIR)\cgi-bin\printenv.pl"
        -xcopy ..\htdocs "$(INSTDIR)\htdocs" /s /d < <<
A
<<
	xcopy include\*.h "$(INSTDIR)\include" /d < <<
A
<<
	xcopy os\win32\*.h "$(INSTDIR)\include" /d < <<
A
<<
	xcopy regex\*.h "$(INSTDIR)\include\regex" /d < <<
A
<<
	xcopy lib\sdbm\*.h "$(INSTDIR)\include\sdbm" /d < <<
A
<<
	xcopy lib\expat-lite\*.h "$(INSTDIR)\include\xml" /d < <<
A
<<
        -xcopy ..\icons "$(INSTDIR)\icons" /s /d < <<
A
<<
	copy ap\Lib$(SHORT)\ap.lib "$(INSTDIR)\lib"
	copy os\win32\Lib$(SHORT)\ApacheOS.lib "$(INSTDIR)\lib"
	copy regex\Lib$(SHORT)\regex.lib "$(INSTDIR)\lib"
	copy lib\sdbm\Lib$(SHORT)\sdbm.lib "$(INSTDIR)\lib"
	copy $(LONG)\ApacheCore.exp "$(INSTDIR)\libexec"
	copy $(LONG)\ApacheCore.lib "$(INSTDIR)\libexec"
	copy os\win32\$(LONG)\Win9xConHook.exp "$(INSTDIR)\libexec"
	copy os\win32\$(LONG)\Win9xConHook.lib "$(INSTDIR)\libexec"
	copy lib\expat-lite\$(LONG)\xmltok.exp "$(INSTDIR)\libexec"
	copy lib\expat-lite\$(LONG)\xmltok.lib "$(INSTDIR)\libexec"
	copy lib\expat-lite\$(LONG)\xmlparse.exp "$(INSTDIR)\libexec"
	copy lib\expat-lite\$(LONG)\xmlparse.lib "$(INSTDIR)\libexec"
        copy ..\conf\magic "$(INSTDIR)\conf\magic.default"
        if not exist "$(INSTDIR)\conf\magic" \
            copy "$(INSTDIR)\conf\magic.default" "$(INSTDIR)\conf\magic"
        copy ..\conf\mime.types "$(INSTDIR)\conf\mime.types.default"
        if not exist "$(INSTDIR)\conf\mime.types" \
            copy "$(INSTDIR)\conf\mime.types.default" "$(INSTDIR)\conf\mime.types"
	copy ..\conf\access.conf-dist "$(INSTDIR)\conf\access.default.conf"
	if not exist "$(INSTDIR)\conf\access.conf" \
            copy "$(INSTDIR)\conf\access.default.conf" "$(INSTDIR)\conf\access.conf"
	copy ..\conf\srm.conf-dist "$(INSTDIR)\conf\srm.default.conf"
	if not exist "$(INSTDIR)\conf\srm.conf" \
            copy "$(INSTDIR)\conf\srm.default.conf" "$(INSTDIR)\conf\srm.conf"
	awk -f <<script.awk "..\conf\httpd.conf-dist-win" "$(INSTDIR)\conf\httpd.default.conf" "$(INSTDIR)"
    BEGIN { 
        srcfl = ARGV[1];
        dstfl = ARGV[2];
        serverroot = ARGV[3];
        gsub( /\\/, "/", serverroot );
        while ( ( getline < srcfl ) > 0 ) {
            gsub( /@@@@ServerRoot@@@@/, serverroot );
            print $$0 > dstfl;
        }
    }
<<
	if not exist "$(INSTDIR)\conf\httpd.conf" \
            copy "$(INSTDIR)\conf\httpd.default.conf" "$(INSTDIR)\conf\httpd.conf" 
	awk -f <<script.awk "support\dbmmanage" >"$(INSTDIR)\bin\dbmmanage.pl"
    { if ( $$0 !~ /^#.*-lsdbm/) {
          gsub( /AnyDBM_File::ISA = qw\(.*\)/, "AnyDBM_File::ISA = qw(SDBM_File)" ); 
      } 
      print $$0;
    }
<<
	awk -f <<script2.awk "support\apxs.pl" "$(INSTDIR)" >"$(INSTDIR)\bin\apxs.pl"
    BEGIN {
          target = ARGV[2];
          gsub( /\\/, "/", target );
          delete ARGV[2];
    }
    { if ( $$0 ~ /@@/) {
          gsub( /@@TARGET@@/,            "httpd" ); 
          gsub( /@@CC@@/,                "cl" ); 
          gsub( /@@CFLAGS@@/,            "-nologo -MD -W3 -O2 -DNDEBUG -DWIN32 -D_WINDOWS -FD" ); 
          gsub( /@@CFLAGS_SHLIB@@/,      "-DSHARED_MODULE" ); 
          gsub( /@@LD_SHLIB@@/,          "link" ); 
          gsub( /@@LDFLAGS_MOD_SHLIB@@/, "-nologo -subsystem:windows -dll -libpath:\"" target "/libexec\" -incremental:no -map -machine:I386" ); 
          gsub( /@@LIBS_SHLIB@@/,        "ApacheCore.lib kernel32.lib advapi32.lib wsock32.lib ws2_32.lib" ); 
          gsub( /@@prefix@@/,            target  ); 
          gsub( /@@sbindir@@/,           target ); 
          gsub( /@@includedir@@/,        target "/include" ); 
          gsub( /@@libexecdir@@/,        target "/modules" ); 
          gsub( /@@sysconfdir@@/,        target "/conf" ); 
      } 
      print $$0;
    }
<<
@


1.1
log
@Initial revision
@
text
@@


1.1.8.1
log
@Import Apache HTTPD 1.3.28 into vendor branch to ease update
@
text
@d90 1
a186 29
	copy $(LONG)\Apache.pdb "$(INSTDIR)"
	copy $(LONG)\ApacheCore.pdb "$(INSTDIR)"
	copy os\win32\$(LONG)\Win9xConHook.pdb "$(INSTDIR)"
	copy lib\expat-lite\$(LONG)\xmltok.pdb "$(INSTDIR)"
	copy lib\expat-lite\$(LONG)\xmlparse.pdb "$(INSTDIR)"
	copy os\win32\$(LONG)\mod_status.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_info.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_anon.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_digest.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_cern_meta.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_expires.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_headers.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_rewrite.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_speling.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_usertrack.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_digest.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_auth_dbm.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_proxy.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_unique_id.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_vhost_alias.pdb "$(INSTDIR)\modules"
	copy os\win32\$(LONG)\mod_mime_magic.pdb "$(INSTDIR)\modules"
	copy support\$(LONG)\htpasswd.pdb "$(INSTDIR)\bin"
	copy support\$(LONG)\htdigest.pdb "$(INSTDIR)\bin"
	copy support\$(LONG)\logresolve.pdb "$(INSTDIR)\bin"
	copy support\$(LONG)\rotatelogs.pdb "$(INSTDIR)\bin"
	copy ap\Lib$(SHORT)\ap.pdb "$(INSTDIR)\lib"
	copy os\win32\Lib$(SHORT)\ApacheOS.pdb "$(INSTDIR)\lib"
	copy regex\Lib$(SHORT)\regex.pdb "$(INSTDIR)\lib"
	copy lib\sdbm\Lib$(SHORT)\sdbm.pdb "$(INSTDIR)\lib"
@


1.1.8.2
log
@Import the new Apache HTTPD 1.3.29 as seen on slashdot
@
text
@a126 5
	copy ..\ABOUT_APACHE "$(INSTDIR)\ABOUT_APACHE.TXT"
	copy ..\Announcement "$(INSTDIR)\Announcement.txt"
	copy ..\LICENSE "$(INSTDIR)\LICENSE.TXT"
	copy ..\README-WIN.TXT "$(INSTDIR)"
	copy ..\WARNING-WIN.TXT "$(INSTDIR)"
@


1.1.8.3
log
@The Apache(TM) Webserver, version 1.3.31
@
text
@a129 1
	copy ..\NOTICE "$(INSTDIR)\NOTICE.TXT"
@


1.1.1.1
log
@Import OpenBSD 3.3 source repository from CTM 3132 the first time
This opens an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@
